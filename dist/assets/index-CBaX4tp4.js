(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function qI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var RE={exports:{}},pd={},PE={exports:{}},dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vf=Symbol.for("react.element"),YI=Symbol.for("react.portal"),QI=Symbol.for("react.fragment"),JI=Symbol.for("react.strict_mode"),ZI=Symbol.for("react.profiler"),eF=Symbol.for("react.provider"),tF=Symbol.for("react.context"),rF=Symbol.for("react.forward_ref"),nF=Symbol.for("react.suspense"),iF=Symbol.for("react.memo"),sF=Symbol.for("react.lazy"),Ax=Symbol.iterator;function aF(t){return t===null||typeof t!="object"?null:(t=Ax&&t[Ax]||t["@@iterator"],typeof t=="function"?t:null)}var DE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bE=Object.assign,OE={};function Yl(t,e,r){this.props=t,this.context=e,this.refs=OE,this.updater=r||DE}Yl.prototype.isReactComponent={};Yl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function LE(){}LE.prototype=Yl.prototype;function mg(t,e,r){this.props=t,this.context=e,this.refs=OE,this.updater=r||DE}var gg=mg.prototype=new LE;gg.constructor=mg;bE(gg,Yl.prototype);gg.isPureReactComponent=!0;var Ix=Array.isArray,ME=Object.prototype.hasOwnProperty,_g={current:null},BE={key:!0,ref:!0,__self:!0,__source:!0};function VE(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)ME.call(e,n)&&!BE.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:vf,type:t,key:s,ref:a,props:i,_owner:_g.current}}function oF(t,e){return{$$typeof:vf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function vg(t){return typeof t=="object"&&t!==null&&t.$$typeof===vf}function lF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Fx=/\/+/g;function xp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lF(""+t.key):e.toString(36)}function z0(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case vf:case YI:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+xp(a,0):n,Ix(i)?(r="",t!=null&&(r=t.replace(Fx,"$&/")+"/"),z0(i,e,r,"",function(c){return c})):i!=null&&(vg(i)&&(i=oF(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Fx,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",Ix(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+xp(s,o);a+=z0(s,e,r,l,i)}else if(l=aF(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+xp(s,o++),a+=z0(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function n0(t,e,r){if(t==null)return t;var n=[],i=0;return z0(t,n,"","",function(s){return e.call(r,s,i++)}),n}function cF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Nn={current:null},H0={transition:null},uF={ReactCurrentDispatcher:Nn,ReactCurrentBatchConfig:H0,ReactCurrentOwner:_g};function UE(){throw Error("act(...) is not supported in production builds of React.")}dt.Children={map:n0,forEach:function(t,e,r){n0(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return n0(t,function(){e++}),e},toArray:function(t){return n0(t,function(e){return e})||[]},only:function(t){if(!vg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};dt.Component=Yl;dt.Fragment=QI;dt.Profiler=ZI;dt.PureComponent=mg;dt.StrictMode=JI;dt.Suspense=nF;dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uF;dt.act=UE;dt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=bE({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=_g.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)ME.call(e,l)&&!BE.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:vf,type:t.type,key:i,ref:s,props:n,_owner:a}};dt.createContext=function(t){return t={$$typeof:tF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:eF,_context:t},t.Consumer=t};dt.createElement=VE;dt.createFactory=function(t){var e=VE.bind(null,t);return e.type=t,e};dt.createRef=function(){return{current:null}};dt.forwardRef=function(t){return{$$typeof:rF,render:t}};dt.isValidElement=vg;dt.lazy=function(t){return{$$typeof:sF,_payload:{_status:-1,_result:t},_init:cF}};dt.memo=function(t,e){return{$$typeof:iF,type:t,compare:e===void 0?null:e}};dt.startTransition=function(t){var e=H0.transition;H0.transition={};try{t()}finally{H0.transition=e}};dt.unstable_act=UE;dt.useCallback=function(t,e){return Nn.current.useCallback(t,e)};dt.useContext=function(t){return Nn.current.useContext(t)};dt.useDebugValue=function(){};dt.useDeferredValue=function(t){return Nn.current.useDeferredValue(t)};dt.useEffect=function(t,e){return Nn.current.useEffect(t,e)};dt.useId=function(){return Nn.current.useId()};dt.useImperativeHandle=function(t,e,r){return Nn.current.useImperativeHandle(t,e,r)};dt.useInsertionEffect=function(t,e){return Nn.current.useInsertionEffect(t,e)};dt.useLayoutEffect=function(t,e){return Nn.current.useLayoutEffect(t,e)};dt.useMemo=function(t,e){return Nn.current.useMemo(t,e)};dt.useReducer=function(t,e,r){return Nn.current.useReducer(t,e,r)};dt.useRef=function(t){return Nn.current.useRef(t)};dt.useState=function(t){return Nn.current.useState(t)};dt.useSyncExternalStore=function(t,e,r){return Nn.current.useSyncExternalStore(t,e,r)};dt.useTransition=function(){return Nn.current.useTransition()};dt.version="18.3.1";PE.exports=dt;var Yt=PE.exports;const jE=qI(Yt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fF=Yt,hF=Symbol.for("react.element"),dF=Symbol.for("react.fragment"),pF=Object.prototype.hasOwnProperty,mF=fF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gF={key:!0,ref:!0,__self:!0,__source:!0};function WE(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)pF.call(e,n)&&!gF.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:hF,type:t,key:s,ref:a,props:i,_owner:mF.current}}pd.Fragment=dF;pd.jsx=WE;pd.jsxs=WE;RE.exports=pd;var P=RE.exports,Im={},zE={exports:{}},Zn={},HE={exports:{}},$E={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(re,ye){var X=re.length;re.push(ye);e:for(;0<X;){var Ce=X-1>>>1,ce=re[Ce];if(0<i(ce,ye))re[Ce]=ye,re[X]=ce,X=Ce;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var ye=re[0],X=re.pop();if(X!==ye){re[0]=X;e:for(var Ce=0,ce=re.length,fe=ce>>>1;Ce<fe;){var le=2*(Ce+1)-1,De=re[le],K=le+1,se=re[K];if(0>i(De,X))K<ce&&0>i(se,De)?(re[Ce]=se,re[K]=X,Ce=K):(re[Ce]=De,re[le]=X,Ce=le);else if(K<ce&&0>i(se,X))re[Ce]=se,re[K]=X,Ce=K;else break e}}return ye}function i(re,ye){var X=re.sortIndex-ye.sortIndex;return X!==0?X:re.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,p=!1,g=!1,x=!1,_=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(re){for(var ye=r(c);ye!==null;){if(ye.callback===null)n(c);else if(ye.startTime<=re)n(c),ye.sortIndex=ye.expirationTime,e(l,ye);else break;ye=r(c)}}function R(re){if(x=!1,v(re),!g)if(r(l)!==null)g=!0,Re(U);else{var ye=r(c);ye!==null&&de(R,ye.startTime-re)}}function U(re,ye){g=!1,x&&(x=!1,m(T),T=-1),p=!0;var X=h;try{for(v(ye),d=r(l);d!==null&&(!(d.expirationTime>ye)||re&&!A());){var Ce=d.callback;if(typeof Ce=="function"){d.callback=null,h=d.priorityLevel;var ce=Ce(d.expirationTime<=ye);ye=t.unstable_now(),typeof ce=="function"?d.callback=ce:d===r(l)&&n(l),v(ye)}else n(l);d=r(l)}if(d!==null)var fe=!0;else{var le=r(c);le!==null&&de(R,le.startTime-ye),fe=!1}return fe}finally{d=null,h=X,p=!1}}var H=!1,E=null,T=-1,k=5,C=-1;function A(){return!(t.unstable_now()-C<k)}function b(){if(E!==null){var re=t.unstable_now();C=re;var ye=!0;try{ye=E(!0,re)}finally{ye?N():(H=!1,E=null)}}else H=!1}var N;if(typeof w=="function")N=function(){w(b)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,he=we.port2;we.port1.onmessage=b,N=function(){he.postMessage(null)}}else N=function(){_(b,0)};function Re(re){E=re,H||(H=!0,N())}function de(re,ye){T=_(function(){re(t.unstable_now())},ye)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(re){re.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,Re(U))},t.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<re?Math.floor(1e3/re):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(re){switch(h){case 1:case 2:case 3:var ye=3;break;default:ye=h}var X=h;h=ye;try{return re()}finally{h=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(re,ye){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var X=h;h=re;try{return ye()}finally{h=X}},t.unstable_scheduleCallback=function(re,ye,X){var Ce=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Ce+X:Ce):X=Ce,re){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=X+ce,re={id:u++,callback:ye,priorityLevel:re,startTime:X,expirationTime:ce,sortIndex:-1},X>Ce?(re.sortIndex=X,e(c,re),r(l)===null&&re===r(c)&&(x?(m(T),T=-1):x=!0,de(R,X-Ce))):(re.sortIndex=ce,e(l,re),g||p||(g=!0,Re(U))),re},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(re){var ye=h;return function(){var X=h;h=ye;try{return re.apply(this,arguments)}finally{h=X}}}})($E);HE.exports=$E;var _F=HE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vF=Yt,Yn=_F;function ve(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GE=new Set,xu={};function To(t,e){Al(t,e),Al(t+"Capture",e)}function Al(t,e){for(xu[t]=e,t=0;t<e.length;t++)GE.add(e[t])}var ks=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fm=Object.prototype.hasOwnProperty,xF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nx={},Rx={};function yF(t){return Fm.call(Rx,t)?!0:Fm.call(Nx,t)?!1:xF.test(t)?Rx[t]=!0:(Nx[t]=!0,!1)}function wF(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EF(t,e,r,n){if(e===null||typeof e>"u"||wF(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rn(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var qr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){qr[t]=new Rn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];qr[e]=new Rn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){qr[t]=new Rn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){qr[t]=new Rn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){qr[t]=new Rn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){qr[t]=new Rn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){qr[t]=new Rn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){qr[t]=new Rn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){qr[t]=new Rn(t,5,!1,t.toLowerCase(),null,!1,!1)});var xg=/[\-:]([a-z])/g;function yg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xg,yg);qr[e]=new Rn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xg,yg);qr[e]=new Rn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xg,yg);qr[e]=new Rn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){qr[t]=new Rn(t,1,!1,t.toLowerCase(),null,!1,!1)});qr.xlinkHref=new Rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){qr[t]=new Rn(t,1,!1,t.toLowerCase(),null,!0,!0)});function wg(t,e,r,n){var i=qr.hasOwnProperty(e)?qr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EF(e,r,i,n)&&(r=null),n||i===null?yF(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ds=vF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,i0=Symbol.for("react.element"),Qo=Symbol.for("react.portal"),Jo=Symbol.for("react.fragment"),Eg=Symbol.for("react.strict_mode"),Nm=Symbol.for("react.profiler"),XE=Symbol.for("react.provider"),KE=Symbol.for("react.context"),Tg=Symbol.for("react.forward_ref"),Rm=Symbol.for("react.suspense"),Pm=Symbol.for("react.suspense_list"),kg=Symbol.for("react.memo"),Ws=Symbol.for("react.lazy"),qE=Symbol.for("react.offscreen"),Px=Symbol.iterator;function wc(t){return t===null||typeof t!="object"?null:(t=Px&&t[Px]||t["@@iterator"],typeof t=="function"?t:null)}var rr=Object.assign,yp;function Oc(t){if(yp===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);yp=e&&e[1]||""}return`
`+yp+t}var wp=!1;function Ep(t,e){if(!t||wp)return"";wp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{wp=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Oc(t):""}function TF(t){switch(t.tag){case 5:return Oc(t.type);case 16:return Oc("Lazy");case 13:return Oc("Suspense");case 19:return Oc("SuspenseList");case 0:case 2:case 15:return t=Ep(t.type,!1),t;case 11:return t=Ep(t.type.render,!1),t;case 1:return t=Ep(t.type,!0),t;default:return""}}function Dm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Jo:return"Fragment";case Qo:return"Portal";case Nm:return"Profiler";case Eg:return"StrictMode";case Rm:return"Suspense";case Pm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case KE:return(t.displayName||"Context")+".Consumer";case XE:return(t._context.displayName||"Context")+".Provider";case Tg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case kg:return e=t.displayName||null,e!==null?e:Dm(t.type)||"Memo";case Ws:e=t._payload,t=t._init;try{return Dm(t(e))}catch{}}return null}function kF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dm(e);case 8:return e===Eg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fa(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function YE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function SF(t){var e=YE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function s0(t){t._valueTracker||(t._valueTracker=SF(t))}function QE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=YE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function lh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bm(t,e){var r=e.checked;return rr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Dx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=fa(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function JE(t,e){e=e.checked,e!=null&&wg(t,"checked",e,!1)}function Om(t,e){JE(t,e);var r=fa(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lm(t,e.type,r):e.hasOwnProperty("defaultValue")&&Lm(t,e.type,fa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function bx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Lm(t,e,r){(e!=="number"||lh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Lc=Array.isArray;function fl(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+fa(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Mm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ve(91));return rr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ox(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ve(92));if(Lc(r)){if(1<r.length)throw Error(ve(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:fa(r)}}function ZE(t,e){var r=fa(e.value),n=fa(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Lx(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function eT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?eT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var a0,tT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(a0=a0||document.createElement("div"),a0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=a0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yu(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Gc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CF=["Webkit","ms","Moz","O"];Object.keys(Gc).forEach(function(t){CF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gc[e]=Gc[t]})});function rT(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Gc.hasOwnProperty(t)&&Gc[t]?(""+e).trim():e+"px"}function nT(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=rT(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var AF=rr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vm(t,e){if(e){if(AF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ve(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ve(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ve(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ve(62))}}function Um(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jm=null;function Sg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Wm=null,hl=null,dl=null;function Mx(t){if(t=wf(t)){if(typeof Wm!="function")throw Error(ve(280));var e=t.stateNode;e&&(e=xd(e),Wm(t.stateNode,t.type,e))}}function iT(t){hl?dl?dl.push(t):dl=[t]:hl=t}function sT(){if(hl){var t=hl,e=dl;if(dl=hl=null,Mx(t),e)for(t=0;t<e.length;t++)Mx(e[t])}}function aT(t,e){return t(e)}function oT(){}var Tp=!1;function lT(t,e,r){if(Tp)return t(e,r);Tp=!0;try{return aT(t,e,r)}finally{Tp=!1,(hl!==null||dl!==null)&&(oT(),sT())}}function wu(t,e){var r=t.stateNode;if(r===null)return null;var n=xd(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ve(231,e,typeof r));return r}var zm=!1;if(ks)try{var Ec={};Object.defineProperty(Ec,"passive",{get:function(){zm=!0}}),window.addEventListener("test",Ec,Ec),window.removeEventListener("test",Ec,Ec)}catch{zm=!1}function IF(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var Xc=!1,ch=null,uh=!1,Hm=null,FF={onError:function(t){Xc=!0,ch=t}};function NF(t,e,r,n,i,s,a,o,l){Xc=!1,ch=null,IF.apply(FF,arguments)}function RF(t,e,r,n,i,s,a,o,l){if(NF.apply(this,arguments),Xc){if(Xc){var c=ch;Xc=!1,ch=null}else throw Error(ve(198));uh||(uh=!0,Hm=c)}}function ko(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function cT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Bx(t){if(ko(t)!==t)throw Error(ve(188))}function PF(t){var e=t.alternate;if(!e){if(e=ko(t),e===null)throw Error(ve(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Bx(i),t;if(s===n)return Bx(i),e;s=s.sibling}throw Error(ve(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ve(189))}}if(r.alternate!==n)throw Error(ve(190))}if(r.tag!==3)throw Error(ve(188));return r.stateNode.current===r?t:e}function uT(t){return t=PF(t),t!==null?fT(t):null}function fT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=fT(t);if(e!==null)return e;t=t.sibling}return null}var hT=Yn.unstable_scheduleCallback,Vx=Yn.unstable_cancelCallback,DF=Yn.unstable_shouldYield,bF=Yn.unstable_requestPaint,pr=Yn.unstable_now,OF=Yn.unstable_getCurrentPriorityLevel,Cg=Yn.unstable_ImmediatePriority,dT=Yn.unstable_UserBlockingPriority,fh=Yn.unstable_NormalPriority,LF=Yn.unstable_LowPriority,pT=Yn.unstable_IdlePriority,md=null,Yi=null;function MF(t){if(Yi&&typeof Yi.onCommitFiberRoot=="function")try{Yi.onCommitFiberRoot(md,t,void 0,(t.current.flags&128)===128)}catch{}}var Ni=Math.clz32?Math.clz32:UF,BF=Math.log,VF=Math.LN2;function UF(t){return t>>>=0,t===0?32:31-(BF(t)/VF|0)|0}var o0=64,l0=4194304;function Mc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function hh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Mc(o):(s&=a,s!==0&&(n=Mc(s)))}else a=r&~i,a!==0?n=Mc(a):s!==0&&(n=Mc(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ni(e),i=1<<r,n|=t[r],e&=~i;return n}function jF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WF(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Ni(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=jF(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function $m(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function mT(){var t=o0;return o0<<=1,!(o0&4194240)&&(o0=64),t}function kp(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function xf(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ni(e),t[e]=r}function zF(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Ni(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Ag(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ni(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Lt=0;function gT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var _T,Ig,vT,xT,yT,Gm=!1,c0=[],Qs=null,Js=null,Zs=null,Eu=new Map,Tu=new Map,Hs=[],HF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ux(t,e){switch(t){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":Eu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tu.delete(e.pointerId)}}function Tc(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=wf(e),e!==null&&Ig(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function $F(t,e,r,n,i){switch(e){case"focusin":return Qs=Tc(Qs,t,e,r,n,i),!0;case"dragenter":return Js=Tc(Js,t,e,r,n,i),!0;case"mouseover":return Zs=Tc(Zs,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Eu.set(s,Tc(Eu.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Tu.set(s,Tc(Tu.get(s)||null,t,e,r,n,i)),!0}return!1}function wT(t){var e=za(t.target);if(e!==null){var r=ko(e);if(r!==null){if(e=r.tag,e===13){if(e=cT(r),e!==null){t.blockedOn=e,yT(t.priority,function(){vT(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Xm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);jm=n,r.target.dispatchEvent(n),jm=null}else return e=wf(r),e!==null&&Ig(e),t.blockedOn=r,!1;e.shift()}return!0}function jx(t,e,r){$0(t)&&r.delete(e)}function GF(){Gm=!1,Qs!==null&&$0(Qs)&&(Qs=null),Js!==null&&$0(Js)&&(Js=null),Zs!==null&&$0(Zs)&&(Zs=null),Eu.forEach(jx),Tu.forEach(jx)}function kc(t,e){t.blockedOn===e&&(t.blockedOn=null,Gm||(Gm=!0,Yn.unstable_scheduleCallback(Yn.unstable_NormalPriority,GF)))}function ku(t){function e(i){return kc(i,t)}if(0<c0.length){kc(c0[0],t);for(var r=1;r<c0.length;r++){var n=c0[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Qs!==null&&kc(Qs,t),Js!==null&&kc(Js,t),Zs!==null&&kc(Zs,t),Eu.forEach(e),Tu.forEach(e),r=0;r<Hs.length;r++)n=Hs[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Hs.length&&(r=Hs[0],r.blockedOn===null);)wT(r),r.blockedOn===null&&Hs.shift()}var pl=Ds.ReactCurrentBatchConfig,dh=!0;function XF(t,e,r,n){var i=Lt,s=pl.transition;pl.transition=null;try{Lt=1,Fg(t,e,r,n)}finally{Lt=i,pl.transition=s}}function KF(t,e,r,n){var i=Lt,s=pl.transition;pl.transition=null;try{Lt=4,Fg(t,e,r,n)}finally{Lt=i,pl.transition=s}}function Fg(t,e,r,n){if(dh){var i=Xm(t,e,r,n);if(i===null)bp(t,e,n,ph,r),Ux(t,n);else if($F(i,t,e,r,n))n.stopPropagation();else if(Ux(t,n),e&4&&-1<HF.indexOf(t)){for(;i!==null;){var s=wf(i);if(s!==null&&_T(s),s=Xm(t,e,r,n),s===null&&bp(t,e,n,ph,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else bp(t,e,n,null,r)}}var ph=null;function Xm(t,e,r,n){if(ph=null,t=Sg(n),t=za(t),t!==null)if(e=ko(t),e===null)t=null;else if(r=e.tag,r===13){if(t=cT(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ph=t,null}function ET(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OF()){case Cg:return 1;case dT:return 4;case fh:case LF:return 16;case pT:return 536870912;default:return 16}default:return 16}}var Gs=null,Ng=null,G0=null;function TT(){if(G0)return G0;var t,e=Ng,r=e.length,n,i="value"in Gs?Gs.value:Gs.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return G0=i.slice(t,1<n?1-n:void 0)}function X0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function u0(){return!0}function Wx(){return!1}function ei(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?u0:Wx,this.isPropagationStopped=Wx,this}return rr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=u0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=u0)},persist:function(){},isPersistent:u0}),e}var Ql={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rg=ei(Ql),yf=rr({},Ql,{view:0,detail:0}),qF=ei(yf),Sp,Cp,Sc,gd=rr({},yf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sc&&(Sc&&t.type==="mousemove"?(Sp=t.screenX-Sc.screenX,Cp=t.screenY-Sc.screenY):Cp=Sp=0,Sc=t),Sp)},movementY:function(t){return"movementY"in t?t.movementY:Cp}}),zx=ei(gd),YF=rr({},gd,{dataTransfer:0}),QF=ei(YF),JF=rr({},yf,{relatedTarget:0}),Ap=ei(JF),ZF=rr({},Ql,{animationName:0,elapsedTime:0,pseudoElement:0}),e3=ei(ZF),t3=rr({},Ql,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),r3=ei(t3),n3=rr({},Ql,{data:0}),Hx=ei(n3),i3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=a3[t])?!!e[t]:!1}function Pg(){return o3}var l3=rr({},yf,{key:function(t){if(t.key){var e=i3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=X0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?s3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pg,charCode:function(t){return t.type==="keypress"?X0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?X0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),c3=ei(l3),u3=rr({},gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$x=ei(u3),f3=rr({},yf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pg}),h3=ei(f3),d3=rr({},Ql,{propertyName:0,elapsedTime:0,pseudoElement:0}),p3=ei(d3),m3=rr({},gd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),g3=ei(m3),_3=[9,13,27,32],Dg=ks&&"CompositionEvent"in window,Kc=null;ks&&"documentMode"in document&&(Kc=document.documentMode);var v3=ks&&"TextEvent"in window&&!Kc,kT=ks&&(!Dg||Kc&&8<Kc&&11>=Kc),Gx=" ",Xx=!1;function ST(t,e){switch(t){case"keyup":return _3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Zo=!1;function x3(t,e){switch(t){case"compositionend":return CT(e);case"keypress":return e.which!==32?null:(Xx=!0,Gx);case"textInput":return t=e.data,t===Gx&&Xx?null:t;default:return null}}function y3(t,e){if(Zo)return t==="compositionend"||!Dg&&ST(t,e)?(t=TT(),G0=Ng=Gs=null,Zo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kT&&e.locale!=="ko"?null:e.data;default:return null}}var w3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!w3[t.type]:e==="textarea"}function AT(t,e,r,n){iT(n),e=mh(e,"onChange"),0<e.length&&(r=new Rg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var qc=null,Su=null;function E3(t){BT(t,0)}function _d(t){var e=rl(t);if(QE(e))return t}function T3(t,e){if(t==="change")return e}var IT=!1;if(ks){var Ip;if(ks){var Fp="oninput"in document;if(!Fp){var qx=document.createElement("div");qx.setAttribute("oninput","return;"),Fp=typeof qx.oninput=="function"}Ip=Fp}else Ip=!1;IT=Ip&&(!document.documentMode||9<document.documentMode)}function Yx(){qc&&(qc.detachEvent("onpropertychange",FT),Su=qc=null)}function FT(t){if(t.propertyName==="value"&&_d(Su)){var e=[];AT(e,Su,t,Sg(t)),lT(E3,e)}}function k3(t,e,r){t==="focusin"?(Yx(),qc=e,Su=r,qc.attachEvent("onpropertychange",FT)):t==="focusout"&&Yx()}function S3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _d(Su)}function C3(t,e){if(t==="click")return _d(e)}function A3(t,e){if(t==="input"||t==="change")return _d(e)}function I3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Li=typeof Object.is=="function"?Object.is:I3;function Cu(t,e){if(Li(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Fm.call(e,i)||!Li(t[i],e[i]))return!1}return!0}function Qx(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jx(t,e){var r=Qx(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qx(r)}}function NT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?NT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function RT(){for(var t=window,e=lh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=lh(t.document)}return e}function bg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function F3(t){var e=RT(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&NT(r.ownerDocument.documentElement,r)){if(n!==null&&bg(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Jx(r,s);var a=Jx(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var N3=ks&&"documentMode"in document&&11>=document.documentMode,el=null,Km=null,Yc=null,qm=!1;function Zx(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;qm||el==null||el!==lh(n)||(n=el,"selectionStart"in n&&bg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yc&&Cu(Yc,n)||(Yc=n,n=mh(Km,"onSelect"),0<n.length&&(e=new Rg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=el)))}function f0(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var tl={animationend:f0("Animation","AnimationEnd"),animationiteration:f0("Animation","AnimationIteration"),animationstart:f0("Animation","AnimationStart"),transitionend:f0("Transition","TransitionEnd")},Np={},PT={};ks&&(PT=document.createElement("div").style,"AnimationEvent"in window||(delete tl.animationend.animation,delete tl.animationiteration.animation,delete tl.animationstart.animation),"TransitionEvent"in window||delete tl.transitionend.transition);function vd(t){if(Np[t])return Np[t];if(!tl[t])return t;var e=tl[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in PT)return Np[t]=e[r];return t}var DT=vd("animationend"),bT=vd("animationiteration"),OT=vd("animationstart"),LT=vd("transitionend"),MT=new Map,ey="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ta(t,e){MT.set(t,e),To(e,[t])}for(var Rp=0;Rp<ey.length;Rp++){var Pp=ey[Rp],R3=Pp.toLowerCase(),P3=Pp[0].toUpperCase()+Pp.slice(1);Ta(R3,"on"+P3)}Ta(DT,"onAnimationEnd");Ta(bT,"onAnimationIteration");Ta(OT,"onAnimationStart");Ta("dblclick","onDoubleClick");Ta("focusin","onFocus");Ta("focusout","onBlur");Ta(LT,"onTransitionEnd");Al("onMouseEnter",["mouseout","mouseover"]);Al("onMouseLeave",["mouseout","mouseover"]);Al("onPointerEnter",["pointerout","pointerover"]);Al("onPointerLeave",["pointerout","pointerover"]);To("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));To("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));To("onBeforeInput",["compositionend","keypress","textInput","paste"]);To("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));To("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));To("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bc));function ty(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,RF(n,e,void 0,t),t.currentTarget=null}function BT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;ty(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;ty(i,o,c),s=l}}}if(uh)throw t=Hm,uh=!1,Hm=null,t}function $t(t,e){var r=e[e1];r===void 0&&(r=e[e1]=new Set);var n=t+"__bubble";r.has(n)||(VT(e,t,2,!1),r.add(n))}function Dp(t,e,r){var n=0;e&&(n|=4),VT(r,t,n,e)}var h0="_reactListening"+Math.random().toString(36).slice(2);function Au(t){if(!t[h0]){t[h0]=!0,GE.forEach(function(r){r!=="selectionchange"&&(D3.has(r)||Dp(r,!1,t),Dp(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[h0]||(e[h0]=!0,Dp("selectionchange",!1,e))}}function VT(t,e,r,n){switch(ET(e)){case 1:var i=XF;break;case 4:i=KF;break;default:i=Fg}r=i.bind(null,e,r,t),i=void 0,!zm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function bp(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=za(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}lT(function(){var c=s,u=Sg(r),d=[];e:{var h=MT.get(t);if(h!==void 0){var p=Rg,g=t;switch(t){case"keypress":if(X0(r)===0)break e;case"keydown":case"keyup":p=c3;break;case"focusin":g="focus",p=Ap;break;case"focusout":g="blur",p=Ap;break;case"beforeblur":case"afterblur":p=Ap;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=zx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=QF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=h3;break;case DT:case bT:case OT:p=e3;break;case LT:p=p3;break;case"scroll":p=qF;break;case"wheel":p=g3;break;case"copy":case"cut":case"paste":p=r3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=$x}var x=(e&4)!==0,_=!x&&t==="scroll",m=x?h!==null?h+"Capture":null:h;x=[];for(var w=c,v;w!==null;){v=w;var R=v.stateNode;if(v.tag===5&&R!==null&&(v=R,m!==null&&(R=wu(w,m),R!=null&&x.push(Iu(w,R,v)))),_)break;w=w.return}0<x.length&&(h=new p(h,g,null,r,u),d.push({event:h,listeners:x}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&r!==jm&&(g=r.relatedTarget||r.fromElement)&&(za(g)||g[Ss]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?za(g):null,g!==null&&(_=ko(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(x=zx,R="onMouseLeave",m="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(x=$x,R="onPointerLeave",m="onPointerEnter",w="pointer"),_=p==null?h:rl(p),v=g==null?h:rl(g),h=new x(R,w+"leave",p,r,u),h.target=_,h.relatedTarget=v,R=null,za(u)===c&&(x=new x(m,w+"enter",g,r,u),x.target=v,x.relatedTarget=_,R=x),_=R,p&&g)t:{for(x=p,m=g,w=0,v=x;v;v=jo(v))w++;for(v=0,R=m;R;R=jo(R))v++;for(;0<w-v;)x=jo(x),w--;for(;0<v-w;)m=jo(m),v--;for(;w--;){if(x===m||m!==null&&x===m.alternate)break t;x=jo(x),m=jo(m)}x=null}else x=null;p!==null&&ry(d,h,p,x,!1),g!==null&&_!==null&&ry(d,_,g,x,!0)}}e:{if(h=c?rl(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var U=T3;else if(Kx(h))if(IT)U=A3;else{U=S3;var H=k3}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(U=C3);if(U&&(U=U(t,c))){AT(d,U,r,u);break e}H&&H(t,h,c),t==="focusout"&&(H=h._wrapperState)&&H.controlled&&h.type==="number"&&Lm(h,"number",h.value)}switch(H=c?rl(c):window,t){case"focusin":(Kx(H)||H.contentEditable==="true")&&(el=H,Km=c,Yc=null);break;case"focusout":Yc=Km=el=null;break;case"mousedown":qm=!0;break;case"contextmenu":case"mouseup":case"dragend":qm=!1,Zx(d,r,u);break;case"selectionchange":if(N3)break;case"keydown":case"keyup":Zx(d,r,u)}var E;if(Dg)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Zo?ST(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(kT&&r.locale!=="ko"&&(Zo||T!=="onCompositionStart"?T==="onCompositionEnd"&&Zo&&(E=TT()):(Gs=u,Ng="value"in Gs?Gs.value:Gs.textContent,Zo=!0)),H=mh(c,T),0<H.length&&(T=new Hx(T,t,null,r,u),d.push({event:T,listeners:H}),E?T.data=E:(E=CT(r),E!==null&&(T.data=E)))),(E=v3?x3(t,r):y3(t,r))&&(c=mh(c,"onBeforeInput"),0<c.length&&(u=new Hx("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=E))}BT(d,e)})}function Iu(t,e,r){return{instance:t,listener:e,currentTarget:r}}function mh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=wu(t,r),s!=null&&n.unshift(Iu(t,s,i)),s=wu(t,e),s!=null&&n.push(Iu(t,s,i))),t=t.return}return n}function jo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ry(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=wu(r,s),l!=null&&a.unshift(Iu(r,l,o))):i||(l=wu(r,s),l!=null&&a.push(Iu(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var b3=/\r\n?/g,O3=/\u0000|\uFFFD/g;function ny(t){return(typeof t=="string"?t:""+t).replace(b3,`
`).replace(O3,"")}function d0(t,e,r){if(e=ny(e),ny(t)!==e&&r)throw Error(ve(425))}function gh(){}var Ym=null,Qm=null;function Jm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zm=typeof setTimeout=="function"?setTimeout:void 0,L3=typeof clearTimeout=="function"?clearTimeout:void 0,iy=typeof Promise=="function"?Promise:void 0,M3=typeof queueMicrotask=="function"?queueMicrotask:typeof iy<"u"?function(t){return iy.resolve(null).then(t).catch(B3)}:Zm;function B3(t){setTimeout(function(){throw t})}function Op(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),ku(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ku(e)}function ea(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Jl=Math.random().toString(36).slice(2),Gi="__reactFiber$"+Jl,Fu="__reactProps$"+Jl,Ss="__reactContainer$"+Jl,e1="__reactEvents$"+Jl,V3="__reactListeners$"+Jl,U3="__reactHandles$"+Jl;function za(t){var e=t[Gi];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ss]||r[Gi]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=sy(t);t!==null;){if(r=t[Gi])return r;t=sy(t)}return e}t=r,r=t.parentNode}return null}function wf(t){return t=t[Gi]||t[Ss],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function rl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ve(33))}function xd(t){return t[Fu]||null}var t1=[],nl=-1;function ka(t){return{current:t}}function Gt(t){0>nl||(t.current=t1[nl],t1[nl]=null,nl--)}function zt(t,e){nl++,t1[nl]=t.current,t.current=e}var ha={},vn=ka(ha),Mn=ka(!1),io=ha;function Il(t,e){var r=t.type.contextTypes;if(!r)return ha;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Bn(t){return t=t.childContextTypes,t!=null}function _h(){Gt(Mn),Gt(vn)}function ay(t,e,r){if(vn.current!==ha)throw Error(ve(168));zt(vn,e),zt(Mn,r)}function UT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ve(108,kF(t)||"Unknown",i));return rr({},r,n)}function vh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ha,io=vn.current,zt(vn,t),zt(Mn,Mn.current),!0}function oy(t,e,r){var n=t.stateNode;if(!n)throw Error(ve(169));r?(t=UT(t,e,io),n.__reactInternalMemoizedMergedChildContext=t,Gt(Mn),Gt(vn),zt(vn,t)):Gt(Mn),zt(Mn,r)}var hs=null,yd=!1,Lp=!1;function jT(t){hs===null?hs=[t]:hs.push(t)}function j3(t){yd=!0,jT(t)}function Sa(){if(!Lp&&hs!==null){Lp=!0;var t=0,e=Lt;try{var r=hs;for(Lt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}hs=null,yd=!1}catch(i){throw hs!==null&&(hs=hs.slice(t+1)),hT(Cg,Sa),i}finally{Lt=e,Lp=!1}}return null}var il=[],sl=0,xh=null,yh=0,ai=[],oi=0,so=null,ps=1,ms="";function Ma(t,e){il[sl++]=yh,il[sl++]=xh,xh=t,yh=e}function WT(t,e,r){ai[oi++]=ps,ai[oi++]=ms,ai[oi++]=so,so=t;var n=ps;t=ms;var i=32-Ni(n)-1;n&=~(1<<i),r+=1;var s=32-Ni(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ps=1<<32-Ni(e)+i|r<<i|n,ms=s+t}else ps=1<<s|r<<i|n,ms=t}function Og(t){t.return!==null&&(Ma(t,1),WT(t,1,0))}function Lg(t){for(;t===xh;)xh=il[--sl],il[sl]=null,yh=il[--sl],il[sl]=null;for(;t===so;)so=ai[--oi],ai[oi]=null,ms=ai[--oi],ai[oi]=null,ps=ai[--oi],ai[oi]=null}var Kn=null,Xn=null,Qt=!1,Si=null;function zT(t,e){var r=ci(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function ly(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Kn=t,Xn=ea(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Kn=t,Xn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=so!==null?{id:ps,overflow:ms}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=ci(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Kn=t,Xn=null,!0):!1;default:return!1}}function r1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function n1(t){if(Qt){var e=Xn;if(e){var r=e;if(!ly(t,e)){if(r1(t))throw Error(ve(418));e=ea(r.nextSibling);var n=Kn;e&&ly(t,e)?zT(n,r):(t.flags=t.flags&-4097|2,Qt=!1,Kn=t)}}else{if(r1(t))throw Error(ve(418));t.flags=t.flags&-4097|2,Qt=!1,Kn=t}}}function cy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Kn=t}function p0(t){if(t!==Kn)return!1;if(!Qt)return cy(t),Qt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jm(t.type,t.memoizedProps)),e&&(e=Xn)){if(r1(t))throw HT(),Error(ve(418));for(;e;)zT(t,e),e=ea(e.nextSibling)}if(cy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ve(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Xn=ea(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Xn=null}}else Xn=Kn?ea(t.stateNode.nextSibling):null;return!0}function HT(){for(var t=Xn;t;)t=ea(t.nextSibling)}function Fl(){Xn=Kn=null,Qt=!1}function Mg(t){Si===null?Si=[t]:Si.push(t)}var W3=Ds.ReactCurrentBatchConfig;function Cc(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ve(309));var n=r.stateNode}if(!n)throw Error(ve(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ve(284));if(!r._owner)throw Error(ve(290,t))}return t}function m0(t,e){throw t=Object.prototype.toString.call(e),Error(ve(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function uy(t){var e=t._init;return e(t._payload)}function $T(t){function e(m,w){if(t){var v=m.deletions;v===null?(m.deletions=[w],m.flags|=16):v.push(w)}}function r(m,w){if(!t)return null;for(;w!==null;)e(m,w),w=w.sibling;return null}function n(m,w){for(m=new Map;w!==null;)w.key!==null?m.set(w.key,w):m.set(w.index,w),w=w.sibling;return m}function i(m,w){return m=ia(m,w),m.index=0,m.sibling=null,m}function s(m,w,v){return m.index=v,t?(v=m.alternate,v!==null?(v=v.index,v<w?(m.flags|=2,w):v):(m.flags|=2,w)):(m.flags|=1048576,w)}function a(m){return t&&m.alternate===null&&(m.flags|=2),m}function o(m,w,v,R){return w===null||w.tag!==6?(w=zp(v,m.mode,R),w.return=m,w):(w=i(w,v),w.return=m,w)}function l(m,w,v,R){var U=v.type;return U===Jo?u(m,w,v.props.children,R,v.key):w!==null&&(w.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ws&&uy(U)===w.type)?(R=i(w,v.props),R.ref=Cc(m,w,v),R.return=m,R):(R=eh(v.type,v.key,v.props,null,m.mode,R),R.ref=Cc(m,w,v),R.return=m,R)}function c(m,w,v,R){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=Hp(v,m.mode,R),w.return=m,w):(w=i(w,v.children||[]),w.return=m,w)}function u(m,w,v,R,U){return w===null||w.tag!==7?(w=qa(v,m.mode,R,U),w.return=m,w):(w=i(w,v),w.return=m,w)}function d(m,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=zp(""+w,m.mode,v),w.return=m,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case i0:return v=eh(w.type,w.key,w.props,null,m.mode,v),v.ref=Cc(m,null,w),v.return=m,v;case Qo:return w=Hp(w,m.mode,v),w.return=m,w;case Ws:var R=w._init;return d(m,R(w._payload),v)}if(Lc(w)||wc(w))return w=qa(w,m.mode,v,null),w.return=m,w;m0(m,w)}return null}function h(m,w,v,R){var U=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return U!==null?null:o(m,w,""+v,R);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case i0:return v.key===U?l(m,w,v,R):null;case Qo:return v.key===U?c(m,w,v,R):null;case Ws:return U=v._init,h(m,w,U(v._payload),R)}if(Lc(v)||wc(v))return U!==null?null:u(m,w,v,R,null);m0(m,v)}return null}function p(m,w,v,R,U){if(typeof R=="string"&&R!==""||typeof R=="number")return m=m.get(v)||null,o(w,m,""+R,U);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case i0:return m=m.get(R.key===null?v:R.key)||null,l(w,m,R,U);case Qo:return m=m.get(R.key===null?v:R.key)||null,c(w,m,R,U);case Ws:var H=R._init;return p(m,w,v,H(R._payload),U)}if(Lc(R)||wc(R))return m=m.get(v)||null,u(w,m,R,U,null);m0(w,R)}return null}function g(m,w,v,R){for(var U=null,H=null,E=w,T=w=0,k=null;E!==null&&T<v.length;T++){E.index>T?(k=E,E=null):k=E.sibling;var C=h(m,E,v[T],R);if(C===null){E===null&&(E=k);break}t&&E&&C.alternate===null&&e(m,E),w=s(C,w,T),H===null?U=C:H.sibling=C,H=C,E=k}if(T===v.length)return r(m,E),Qt&&Ma(m,T),U;if(E===null){for(;T<v.length;T++)E=d(m,v[T],R),E!==null&&(w=s(E,w,T),H===null?U=E:H.sibling=E,H=E);return Qt&&Ma(m,T),U}for(E=n(m,E);T<v.length;T++)k=p(E,m,T,v[T],R),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?T:k.key),w=s(k,w,T),H===null?U=k:H.sibling=k,H=k);return t&&E.forEach(function(A){return e(m,A)}),Qt&&Ma(m,T),U}function x(m,w,v,R){var U=wc(v);if(typeof U!="function")throw Error(ve(150));if(v=U.call(v),v==null)throw Error(ve(151));for(var H=U=null,E=w,T=w=0,k=null,C=v.next();E!==null&&!C.done;T++,C=v.next()){E.index>T?(k=E,E=null):k=E.sibling;var A=h(m,E,C.value,R);if(A===null){E===null&&(E=k);break}t&&E&&A.alternate===null&&e(m,E),w=s(A,w,T),H===null?U=A:H.sibling=A,H=A,E=k}if(C.done)return r(m,E),Qt&&Ma(m,T),U;if(E===null){for(;!C.done;T++,C=v.next())C=d(m,C.value,R),C!==null&&(w=s(C,w,T),H===null?U=C:H.sibling=C,H=C);return Qt&&Ma(m,T),U}for(E=n(m,E);!C.done;T++,C=v.next())C=p(E,m,T,C.value,R),C!==null&&(t&&C.alternate!==null&&E.delete(C.key===null?T:C.key),w=s(C,w,T),H===null?U=C:H.sibling=C,H=C);return t&&E.forEach(function(b){return e(m,b)}),Qt&&Ma(m,T),U}function _(m,w,v,R){if(typeof v=="object"&&v!==null&&v.type===Jo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case i0:e:{for(var U=v.key,H=w;H!==null;){if(H.key===U){if(U=v.type,U===Jo){if(H.tag===7){r(m,H.sibling),w=i(H,v.props.children),w.return=m,m=w;break e}}else if(H.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Ws&&uy(U)===H.type){r(m,H.sibling),w=i(H,v.props),w.ref=Cc(m,H,v),w.return=m,m=w;break e}r(m,H);break}else e(m,H);H=H.sibling}v.type===Jo?(w=qa(v.props.children,m.mode,R,v.key),w.return=m,m=w):(R=eh(v.type,v.key,v.props,null,m.mode,R),R.ref=Cc(m,w,v),R.return=m,m=R)}return a(m);case Qo:e:{for(H=v.key;w!==null;){if(w.key===H)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){r(m,w.sibling),w=i(w,v.children||[]),w.return=m,m=w;break e}else{r(m,w);break}else e(m,w);w=w.sibling}w=Hp(v,m.mode,R),w.return=m,m=w}return a(m);case Ws:return H=v._init,_(m,w,H(v._payload),R)}if(Lc(v))return g(m,w,v,R);if(wc(v))return x(m,w,v,R);m0(m,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(r(m,w.sibling),w=i(w,v),w.return=m,m=w):(r(m,w),w=zp(v,m.mode,R),w.return=m,m=w),a(m)):r(m,w)}return _}var Nl=$T(!0),GT=$T(!1),wh=ka(null),Eh=null,al=null,Bg=null;function Vg(){Bg=al=Eh=null}function Ug(t){var e=wh.current;Gt(wh),t._currentValue=e}function i1(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ml(t,e){Eh=t,Bg=al=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ln=!0),t.firstContext=null)}function di(t){var e=t._currentValue;if(Bg!==t)if(t={context:t,memoizedValue:e,next:null},al===null){if(Eh===null)throw Error(ve(308));al=t,Eh.dependencies={lanes:0,firstContext:t}}else al=al.next=t;return e}var Ha=null;function jg(t){Ha===null?Ha=[t]:Ha.push(t)}function XT(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,jg(e)):(r.next=i.next,i.next=r),e.interleaved=r,Cs(t,n)}function Cs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var zs=!1;function Wg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ta(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,wt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Cs(t,r)}return i=n.interleaved,i===null?(e.next=e,jg(n)):(e.next=i.next,i.next=e),n.interleaved=e,Cs(t,r)}function K0(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ag(t,r)}}function fy(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Th(t,e,r,n){var i=t.updateQueue;zs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,x=o;switch(h=e,p=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){d=g.call(p,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,h=typeof g=="function"?g.call(p,d,h):g,h==null)break e;d=rr({},d,h);break e;case 2:zs=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);oo|=a,t.lanes=a,t.memoizedState=d}}function hy(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ve(191,i));i.call(n)}}}var Ef={},Qi=ka(Ef),Nu=ka(Ef),Ru=ka(Ef);function $a(t){if(t===Ef)throw Error(ve(174));return t}function zg(t,e){switch(zt(Ru,e),zt(Nu,t),zt(Qi,Ef),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Bm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Bm(e,t)}Gt(Qi),zt(Qi,e)}function Rl(){Gt(Qi),Gt(Nu),Gt(Ru)}function qT(t){$a(Ru.current);var e=$a(Qi.current),r=Bm(e,t.type);e!==r&&(zt(Nu,t),zt(Qi,r))}function Hg(t){Nu.current===t&&(Gt(Qi),Gt(Nu))}var er=ka(0);function kh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Mp=[];function $g(){for(var t=0;t<Mp.length;t++)Mp[t]._workInProgressVersionPrimary=null;Mp.length=0}var q0=Ds.ReactCurrentDispatcher,Bp=Ds.ReactCurrentBatchConfig,ao=0,tr=null,Sr=null,Mr=null,Sh=!1,Qc=!1,Pu=0,z3=0;function tn(){throw Error(ve(321))}function Gg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Li(t[r],e[r]))return!1;return!0}function Xg(t,e,r,n,i,s){if(ao=s,tr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,q0.current=t===null||t.memoizedState===null?X3:K3,t=r(n,i),Qc){s=0;do{if(Qc=!1,Pu=0,25<=s)throw Error(ve(301));s+=1,Mr=Sr=null,e.updateQueue=null,q0.current=q3,t=r(n,i)}while(Qc)}if(q0.current=Ch,e=Sr!==null&&Sr.next!==null,ao=0,Mr=Sr=tr=null,Sh=!1,e)throw Error(ve(300));return t}function Kg(){var t=Pu!==0;return Pu=0,t}function zi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?tr.memoizedState=Mr=t:Mr=Mr.next=t,Mr}function pi(){if(Sr===null){var t=tr.alternate;t=t!==null?t.memoizedState:null}else t=Sr.next;var e=Mr===null?tr.memoizedState:Mr.next;if(e!==null)Mr=e,Sr=t;else{if(t===null)throw Error(ve(310));Sr=t,t={memoizedState:Sr.memoizedState,baseState:Sr.baseState,baseQueue:Sr.baseQueue,queue:Sr.queue,next:null},Mr===null?tr.memoizedState=Mr=t:Mr=Mr.next=t}return Mr}function Du(t,e){return typeof e=="function"?e(t):e}function Vp(t){var e=pi(),r=e.queue;if(r===null)throw Error(ve(311));r.lastRenderedReducer=t;var n=Sr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((ao&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,tr.lanes|=u,oo|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Li(n,e.memoizedState)||(Ln=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,tr.lanes|=s,oo|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Up(t){var e=pi(),r=e.queue;if(r===null)throw Error(ve(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Li(s,e.memoizedState)||(Ln=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function YT(){}function QT(t,e){var r=tr,n=pi(),i=e(),s=!Li(n.memoizedState,i);if(s&&(n.memoizedState=i,Ln=!0),n=n.queue,qg(ek.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Mr!==null&&Mr.memoizedState.tag&1){if(r.flags|=2048,bu(9,ZT.bind(null,r,n,i,e),void 0,null),Br===null)throw Error(ve(349));ao&30||JT(r,e,i)}return i}function JT(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=tr.updateQueue,e===null?(e={lastEffect:null,stores:null},tr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function ZT(t,e,r,n){e.value=r,e.getSnapshot=n,tk(e)&&rk(t)}function ek(t,e,r){return r(function(){tk(e)&&rk(t)})}function tk(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Li(t,r)}catch{return!0}}function rk(t){var e=Cs(t,1);e!==null&&Ri(e,t,1,-1)}function dy(t){var e=zi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Du,lastRenderedState:t},e.queue=t,t=t.dispatch=G3.bind(null,tr,t),[e.memoizedState,t]}function bu(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=tr.updateQueue,e===null?(e={lastEffect:null,stores:null},tr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function nk(){return pi().memoizedState}function Y0(t,e,r,n){var i=zi();tr.flags|=t,i.memoizedState=bu(1|e,r,void 0,n===void 0?null:n)}function wd(t,e,r,n){var i=pi();n=n===void 0?null:n;var s=void 0;if(Sr!==null){var a=Sr.memoizedState;if(s=a.destroy,n!==null&&Gg(n,a.deps)){i.memoizedState=bu(e,r,s,n);return}}tr.flags|=t,i.memoizedState=bu(1|e,r,s,n)}function py(t,e){return Y0(8390656,8,t,e)}function qg(t,e){return wd(2048,8,t,e)}function ik(t,e){return wd(4,2,t,e)}function sk(t,e){return wd(4,4,t,e)}function ak(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ok(t,e,r){return r=r!=null?r.concat([t]):null,wd(4,4,ak.bind(null,e,t),r)}function Yg(){}function lk(t,e){var r=pi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function ck(t,e){var r=pi();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function uk(t,e,r){return ao&21?(Li(r,e)||(r=mT(),tr.lanes|=r,oo|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ln=!0),t.memoizedState=r)}function H3(t,e){var r=Lt;Lt=r!==0&&4>r?r:4,t(!0);var n=Bp.transition;Bp.transition={};try{t(!1),e()}finally{Lt=r,Bp.transition=n}}function fk(){return pi().memoizedState}function $3(t,e,r){var n=na(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},hk(t))dk(e,r);else if(r=XT(t,e,r,n),r!==null){var i=An();Ri(r,t,n,i),pk(r,e,n)}}function G3(t,e,r){var n=na(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(hk(t))dk(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Li(o,a)){var l=e.interleaved;l===null?(i.next=i,jg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=XT(t,e,i,n),r!==null&&(i=An(),Ri(r,t,n,i),pk(r,e,n))}}function hk(t){var e=t.alternate;return t===tr||e!==null&&e===tr}function dk(t,e){Qc=Sh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function pk(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Ag(t,r)}}var Ch={readContext:di,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},X3={readContext:di,useCallback:function(t,e){return zi().memoizedState=[t,e===void 0?null:e],t},useContext:di,useEffect:py,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Y0(4194308,4,ak.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Y0(4194308,4,t,e)},useInsertionEffect:function(t,e){return Y0(4,2,t,e)},useMemo:function(t,e){var r=zi();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=zi();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=$3.bind(null,tr,t),[n.memoizedState,t]},useRef:function(t){var e=zi();return t={current:t},e.memoizedState=t},useState:dy,useDebugValue:Yg,useDeferredValue:function(t){return zi().memoizedState=t},useTransition:function(){var t=dy(!1),e=t[0];return t=H3.bind(null,t[1]),zi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=tr,i=zi();if(Qt){if(r===void 0)throw Error(ve(407));r=r()}else{if(r=e(),Br===null)throw Error(ve(349));ao&30||JT(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,py(ek.bind(null,n,s,t),[t]),n.flags|=2048,bu(9,ZT.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=zi(),e=Br.identifierPrefix;if(Qt){var r=ms,n=ps;r=(n&~(1<<32-Ni(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Pu++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=z3++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},K3={readContext:di,useCallback:lk,useContext:di,useEffect:qg,useImperativeHandle:ok,useInsertionEffect:ik,useLayoutEffect:sk,useMemo:ck,useReducer:Vp,useRef:nk,useState:function(){return Vp(Du)},useDebugValue:Yg,useDeferredValue:function(t){var e=pi();return uk(e,Sr.memoizedState,t)},useTransition:function(){var t=Vp(Du)[0],e=pi().memoizedState;return[t,e]},useMutableSource:YT,useSyncExternalStore:QT,useId:fk,unstable_isNewReconciler:!1},q3={readContext:di,useCallback:lk,useContext:di,useEffect:qg,useImperativeHandle:ok,useInsertionEffect:ik,useLayoutEffect:sk,useMemo:ck,useReducer:Up,useRef:nk,useState:function(){return Up(Du)},useDebugValue:Yg,useDeferredValue:function(t){var e=pi();return Sr===null?e.memoizedState=t:uk(e,Sr.memoizedState,t)},useTransition:function(){var t=Up(Du)[0],e=pi().memoizedState;return[t,e]},useMutableSource:YT,useSyncExternalStore:QT,useId:fk,unstable_isNewReconciler:!1};function Ti(t,e){if(t&&t.defaultProps){e=rr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function s1(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:rr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Ed={isMounted:function(t){return(t=t._reactInternals)?ko(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=An(),i=na(t),s=xs(n,i);s.payload=e,r!=null&&(s.callback=r),e=ta(t,s,i),e!==null&&(Ri(e,t,i,n),K0(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=An(),i=na(t),s=xs(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=ta(t,s,i),e!==null&&(Ri(e,t,i,n),K0(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=An(),n=na(t),i=xs(r,n);i.tag=2,e!=null&&(i.callback=e),e=ta(t,i,n),e!==null&&(Ri(e,t,n,r),K0(e,t,n))}};function my(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Cu(r,n)||!Cu(i,s):!0}function mk(t,e,r){var n=!1,i=ha,s=e.contextType;return typeof s=="object"&&s!==null?s=di(s):(i=Bn(e)?io:vn.current,n=e.contextTypes,s=(n=n!=null)?Il(t,i):ha),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ed,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function gy(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Ed.enqueueReplaceState(e,e.state,null)}function a1(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Wg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=di(s):(s=Bn(e)?io:vn.current,i.context=Il(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(s1(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ed.enqueueReplaceState(i,i.state,null),Th(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Pl(t,e){try{var r="",n=e;do r+=TF(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function jp(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function o1(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Y3=typeof WeakMap=="function"?WeakMap:Map;function gk(t,e,r){r=xs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ih||(Ih=!0,_1=n),o1(t,e)},r}function _k(t,e,r){r=xs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){o1(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){o1(t,e),typeof n!="function"&&(ra===null?ra=new Set([this]):ra.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function _y(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Y3;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=uN.bind(null,t,e,r),e.then(t,t))}function vy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function xy(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=xs(-1,1),e.tag=2,ta(r,e,1))),r.lanes|=1),t)}var Q3=Ds.ReactCurrentOwner,Ln=!1;function yn(t,e,r,n){e.child=t===null?GT(e,null,r,n):Nl(e,t.child,r,n)}function yy(t,e,r,n,i){r=r.render;var s=e.ref;return ml(e,i),n=Xg(t,e,r,n,s,i),r=Kg(),t!==null&&!Ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,As(t,e,i)):(Qt&&r&&Og(e),e.flags|=1,yn(t,e,n,i),e.child)}function wy(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!i_(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,vk(t,e,s,n,i)):(t=eh(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Cu,r(a,n)&&t.ref===e.ref)return As(t,e,i)}return e.flags|=1,t=ia(s,n),t.ref=e.ref,t.return=e,e.child=t}function vk(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Cu(s,n)&&t.ref===e.ref)if(Ln=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Ln=!0);else return e.lanes=t.lanes,As(t,e,i)}return l1(t,e,r,n,i)}function xk(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},zt(ll,zn),zn|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,zt(ll,zn),zn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,zt(ll,zn),zn|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,zt(ll,zn),zn|=n;return yn(t,e,i,r),e.child}function yk(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function l1(t,e,r,n,i){var s=Bn(r)?io:vn.current;return s=Il(e,s),ml(e,i),r=Xg(t,e,r,n,s,i),n=Kg(),t!==null&&!Ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,As(t,e,i)):(Qt&&n&&Og(e),e.flags|=1,yn(t,e,r,i),e.child)}function Ey(t,e,r,n,i){if(Bn(r)){var s=!0;vh(e)}else s=!1;if(ml(e,i),e.stateNode===null)Q0(t,e),mk(e,r,n),a1(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=di(c):(c=Bn(r)?io:vn.current,c=Il(e,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&gy(e,a,n,c),zs=!1;var h=e.memoizedState;a.state=h,Th(e,n,a,i),l=e.memoizedState,o!==n||h!==l||Mn.current||zs?(typeof u=="function"&&(s1(e,r,u,n),l=e.memoizedState),(o=zs||my(e,r,o,n,h,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,KT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Ti(e.type,o),a.props=c,d=e.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=di(l):(l=Bn(r)?io:vn.current,l=Il(e,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||h!==l)&&gy(e,a,n,l),zs=!1,h=e.memoizedState,a.state=h,Th(e,n,a,i);var g=e.memoizedState;o!==d||h!==g||Mn.current||zs?(typeof p=="function"&&(s1(e,r,p,n),g=e.memoizedState),(c=zs||my(e,r,c,n,h,g,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return c1(t,e,r,n,s,i)}function c1(t,e,r,n,i,s){yk(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&oy(e,r,!1),As(t,e,s);n=e.stateNode,Q3.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Nl(e,t.child,null,s),e.child=Nl(e,null,o,s)):yn(t,e,o,s),e.memoizedState=n.state,i&&oy(e,r,!0),e.child}function wk(t){var e=t.stateNode;e.pendingContext?ay(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ay(t,e.context,!1),zg(t,e.containerInfo)}function Ty(t,e,r,n,i){return Fl(),Mg(i),e.flags|=256,yn(t,e,r,n),e.child}var u1={dehydrated:null,treeContext:null,retryLane:0};function f1(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ek(t,e,r){var n=e.pendingProps,i=er.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),zt(er,i&1),t===null)return n1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Sd(a,n,0,null),t=qa(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=f1(r),e.memoizedState=u1,t):Qg(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return J3(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ia(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=ia(o,s):(s=qa(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?f1(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=u1,n}return s=t.child,t=s.sibling,n=ia(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Qg(t,e){return e=Sd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function g0(t,e,r,n){return n!==null&&Mg(n),Nl(e,t.child,null,r),t=Qg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function J3(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=jp(Error(ve(422))),g0(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=Sd({mode:"visible",children:n.children},i,0,null),s=qa(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Nl(e,t.child,null,a),e.child.memoizedState=f1(a),e.memoizedState=u1,s);if(!(e.mode&1))return g0(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ve(419)),n=jp(s,n,void 0),g0(t,e,a,n)}if(o=(a&t.childLanes)!==0,Ln||o){if(n=Br,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Cs(t,i),Ri(n,t,i,-1))}return n_(),n=jp(Error(ve(421))),g0(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=fN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Xn=ea(i.nextSibling),Kn=e,Qt=!0,Si=null,t!==null&&(ai[oi++]=ps,ai[oi++]=ms,ai[oi++]=so,ps=t.id,ms=t.overflow,so=e),e=Qg(e,n.children),e.flags|=4096,e)}function ky(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),i1(t.return,e,r)}function Wp(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Tk(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(yn(t,e,n.children,r),n=er.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ky(t,r,e);else if(t.tag===19)ky(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(zt(er,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&kh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Wp(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&kh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Wp(e,!0,r,null,s);break;case"together":Wp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Q0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function As(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),oo|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ve(153));if(e.child!==null){for(t=e.child,r=ia(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ia(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Z3(t,e,r){switch(e.tag){case 3:wk(e),Fl();break;case 5:qT(e);break;case 1:Bn(e.type)&&vh(e);break;case 4:zg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;zt(wh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(zt(er,er.current&1),e.flags|=128,null):r&e.child.childLanes?Ek(t,e,r):(zt(er,er.current&1),t=As(t,e,r),t!==null?t.sibling:null);zt(er,er.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Tk(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),zt(er,er.current),n)break;return null;case 22:case 23:return e.lanes=0,xk(t,e,r)}return As(t,e,r)}var kk,h1,Sk,Ck;kk=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};h1=function(){};Sk=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,$a(Qi.current);var s=null;switch(r){case"input":i=bm(t,i),n=bm(t,n),s=[];break;case"select":i=rr({},i,{value:void 0}),n=rr({},n,{value:void 0}),s=[];break;case"textarea":i=Mm(t,i),n=Mm(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=gh)}Vm(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(xu.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(xu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&$t("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Ck=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ac(t,e){if(!Qt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function rn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function eN(t,e,r){var n=e.pendingProps;switch(Lg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(e),null;case 1:return Bn(e.type)&&_h(),rn(e),null;case 3:return n=e.stateNode,Rl(),Gt(Mn),Gt(vn),$g(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(p0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Si!==null&&(y1(Si),Si=null))),h1(t,e),rn(e),null;case 5:Hg(e);var i=$a(Ru.current);if(r=e.type,t!==null&&e.stateNode!=null)Sk(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ve(166));return rn(e),null}if(t=$a(Qi.current),p0(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Gi]=e,n[Fu]=s,t=(e.mode&1)!==0,r){case"dialog":$t("cancel",n),$t("close",n);break;case"iframe":case"object":case"embed":$t("load",n);break;case"video":case"audio":for(i=0;i<Bc.length;i++)$t(Bc[i],n);break;case"source":$t("error",n);break;case"img":case"image":case"link":$t("error",n),$t("load",n);break;case"details":$t("toggle",n);break;case"input":Dx(n,s),$t("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},$t("invalid",n);break;case"textarea":Ox(n,s),$t("invalid",n)}Vm(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&d0(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&d0(n.textContent,o,t),i=["children",""+o]):xu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&$t("scroll",n)}switch(r){case"input":s0(n),bx(n,s,!0);break;case"textarea":s0(n),Lx(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=gh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=eT(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Gi]=e,t[Fu]=n,kk(t,e,!1,!1),e.stateNode=t;e:{switch(a=Um(r,n),r){case"dialog":$t("cancel",t),$t("close",t),i=n;break;case"iframe":case"object":case"embed":$t("load",t),i=n;break;case"video":case"audio":for(i=0;i<Bc.length;i++)$t(Bc[i],t);i=n;break;case"source":$t("error",t),i=n;break;case"img":case"image":case"link":$t("error",t),$t("load",t),i=n;break;case"details":$t("toggle",t),i=n;break;case"input":Dx(t,n),i=bm(t,n),$t("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=rr({},n,{value:void 0}),$t("invalid",t);break;case"textarea":Ox(t,n),i=Mm(t,n),$t("invalid",t);break;default:i=n}Vm(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?nT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&tT(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&yu(t,l):typeof l=="number"&&yu(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xu.hasOwnProperty(s)?l!=null&&s==="onScroll"&&$t("scroll",t):l!=null&&wg(t,s,l,a))}switch(r){case"input":s0(t),bx(t,n,!1);break;case"textarea":s0(t),Lx(t);break;case"option":n.value!=null&&t.setAttribute("value",""+fa(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?fl(t,!!n.multiple,s,!1):n.defaultValue!=null&&fl(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=gh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return rn(e),null;case 6:if(t&&e.stateNode!=null)Ck(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ve(166));if(r=$a(Ru.current),$a(Qi.current),p0(e)){if(n=e.stateNode,r=e.memoizedProps,n[Gi]=e,(s=n.nodeValue!==r)&&(t=Kn,t!==null))switch(t.tag){case 3:d0(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&d0(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gi]=e,e.stateNode=n}return rn(e),null;case 13:if(Gt(er),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Qt&&Xn!==null&&e.mode&1&&!(e.flags&128))HT(),Fl(),e.flags|=98560,s=!1;else if(s=p0(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(ve(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ve(317));s[Gi]=e}else Fl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;rn(e),s=!1}else Si!==null&&(y1(Si),Si=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||er.current&1?Rr===0&&(Rr=3):n_())),e.updateQueue!==null&&(e.flags|=4),rn(e),null);case 4:return Rl(),h1(t,e),t===null&&Au(e.stateNode.containerInfo),rn(e),null;case 10:return Ug(e.type._context),rn(e),null;case 17:return Bn(e.type)&&_h(),rn(e),null;case 19:if(Gt(er),s=e.memoizedState,s===null)return rn(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Ac(s,!1);else{if(Rr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=kh(t),a!==null){for(e.flags|=128,Ac(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return zt(er,er.current&1|2),e.child}t=t.sibling}s.tail!==null&&pr()>Dl&&(e.flags|=128,n=!0,Ac(s,!1),e.lanes=4194304)}else{if(!n)if(t=kh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ac(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Qt)return rn(e),null}else 2*pr()-s.renderingStartTime>Dl&&r!==1073741824&&(e.flags|=128,n=!0,Ac(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pr(),e.sibling=null,r=er.current,zt(er,n?r&1|2:r&1),e):(rn(e),null);case 22:case 23:return r_(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?zn&1073741824&&(rn(e),e.subtreeFlags&6&&(e.flags|=8192)):rn(e),null;case 24:return null;case 25:return null}throw Error(ve(156,e.tag))}function tN(t,e){switch(Lg(e),e.tag){case 1:return Bn(e.type)&&_h(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Rl(),Gt(Mn),Gt(vn),$g(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Hg(e),null;case 13:if(Gt(er),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ve(340));Fl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Gt(er),null;case 4:return Rl(),null;case 10:return Ug(e.type._context),null;case 22:case 23:return r_(),null;case 24:return null;default:return null}}var _0=!1,fn=!1,rN=typeof WeakSet=="function"?WeakSet:Set,Be=null;function ol(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){or(t,e,n)}else r.current=null}function d1(t,e,r){try{r()}catch(n){or(t,e,n)}}var Sy=!1;function nN(t,e){if(Ym=dh,t=RT(),bg(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var p;d!==r||i!==0&&d.nodeType!==3||(o=a+i),d!==s||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===t)break t;if(h===r&&++c===i&&(o=a),h===s&&++u===n&&(l=a),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Qm={focusedElem:t,selectionRange:r},dh=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,_=g.memoizedState,m=e.stateNode,w=m.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ti(e.type,x),_);m.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(R){or(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return g=Sy,Sy=!1,g}function Jc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&d1(e,r,s)}i=i.next}while(i!==n)}}function Td(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function p1(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Ak(t){var e=t.alternate;e!==null&&(t.alternate=null,Ak(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gi],delete e[Fu],delete e[e1],delete e[V3],delete e[U3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Ik(t){return t.tag===5||t.tag===3||t.tag===4}function Cy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ik(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function m1(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=gh));else if(n!==4&&(t=t.child,t!==null))for(m1(t,e,r),t=t.sibling;t!==null;)m1(t,e,r),t=t.sibling}function g1(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(g1(t,e,r),t=t.sibling;t!==null;)g1(t,e,r),t=t.sibling}var zr=null,ki=!1;function Us(t,e,r){for(r=r.child;r!==null;)Fk(t,e,r),r=r.sibling}function Fk(t,e,r){if(Yi&&typeof Yi.onCommitFiberUnmount=="function")try{Yi.onCommitFiberUnmount(md,r)}catch{}switch(r.tag){case 5:fn||ol(r,e);case 6:var n=zr,i=ki;zr=null,Us(t,e,r),zr=n,ki=i,zr!==null&&(ki?(t=zr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):zr.removeChild(r.stateNode));break;case 18:zr!==null&&(ki?(t=zr,r=r.stateNode,t.nodeType===8?Op(t.parentNode,r):t.nodeType===1&&Op(t,r),ku(t)):Op(zr,r.stateNode));break;case 4:n=zr,i=ki,zr=r.stateNode.containerInfo,ki=!0,Us(t,e,r),zr=n,ki=i;break;case 0:case 11:case 14:case 15:if(!fn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&d1(r,e,a),i=i.next}while(i!==n)}Us(t,e,r);break;case 1:if(!fn&&(ol(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){or(r,e,o)}Us(t,e,r);break;case 21:Us(t,e,r);break;case 22:r.mode&1?(fn=(n=fn)||r.memoizedState!==null,Us(t,e,r),fn=n):Us(t,e,r);break;default:Us(t,e,r)}}function Ay(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new rN),e.forEach(function(n){var i=hN.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function yi(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:zr=o.stateNode,ki=!1;break e;case 3:zr=o.stateNode.containerInfo,ki=!0;break e;case 4:zr=o.stateNode.containerInfo,ki=!0;break e}o=o.return}if(zr===null)throw Error(ve(160));Fk(s,a,i),zr=null,ki=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){or(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Nk(e,t),e=e.sibling}function Nk(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(yi(e,t),Vi(t),n&4){try{Jc(3,t,t.return),Td(3,t)}catch(x){or(t,t.return,x)}try{Jc(5,t,t.return)}catch(x){or(t,t.return,x)}}break;case 1:yi(e,t),Vi(t),n&512&&r!==null&&ol(r,r.return);break;case 5:if(yi(e,t),Vi(t),n&512&&r!==null&&ol(r,r.return),t.flags&32){var i=t.stateNode;try{yu(i,"")}catch(x){or(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&JE(i,s),Um(o,a);var c=Um(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?nT(i,d):u==="dangerouslySetInnerHTML"?tT(i,d):u==="children"?yu(i,d):wg(i,u,d,c)}switch(o){case"input":Om(i,s);break;case"textarea":ZE(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?fl(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?fl(i,!!s.multiple,s.defaultValue,!0):fl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Fu]=s}catch(x){or(t,t.return,x)}}break;case 6:if(yi(e,t),Vi(t),n&4){if(t.stateNode===null)throw Error(ve(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){or(t,t.return,x)}}break;case 3:if(yi(e,t),Vi(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ku(e.containerInfo)}catch(x){or(t,t.return,x)}break;case 4:yi(e,t),Vi(t);break;case 13:yi(e,t),Vi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(e_=pr())),n&4&&Ay(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(fn=(c=fn)||u,yi(e,t),fn=c):yi(e,t),Vi(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Be=t,u=t.child;u!==null;){for(d=Be=u;Be!==null;){switch(h=Be,p=h.child,h.tag){case 0:case 11:case 14:case 15:Jc(4,h,h.return);break;case 1:ol(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){or(n,r,x)}}break;case 5:ol(h,h.return);break;case 22:if(h.memoizedState!==null){Fy(d);continue}}p!==null?(p.return=h,Be=p):Fy(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=rT("display",a))}catch(x){or(t,t.return,x)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(x){or(t,t.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:yi(e,t),Vi(t),n&4&&Ay(t);break;case 21:break;default:yi(e,t),Vi(t)}}function Vi(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Ik(r)){var n=r;break e}r=r.return}throw Error(ve(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(yu(i,""),n.flags&=-33);var s=Cy(t);g1(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Cy(t);m1(t,o,a);break;default:throw Error(ve(161))}}catch(l){or(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function iN(t,e,r){Be=t,Rk(t)}function Rk(t,e,r){for(var n=(t.mode&1)!==0;Be!==null;){var i=Be,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||_0;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||fn;o=_0;var c=fn;if(_0=a,(fn=l)&&!c)for(Be=i;Be!==null;)a=Be,l=a.child,a.tag===22&&a.memoizedState!==null?Ny(i):l!==null?(l.return=a,Be=l):Ny(i);for(;s!==null;)Be=s,Rk(s),s=s.sibling;Be=i,_0=o,fn=c}Iy(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Be=s):Iy(t)}}function Iy(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:fn||Td(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!fn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Ti(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&hy(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}hy(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&ku(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}fn||e.flags&512&&p1(e)}catch(h){or(e,e.return,h)}}if(e===t){Be=null;break}if(r=e.sibling,r!==null){r.return=e.return,Be=r;break}Be=e.return}}function Fy(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Be=r;break}Be=e.return}}function Ny(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Td(4,e)}catch(l){or(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){or(e,i,l)}}var s=e.return;try{p1(e)}catch(l){or(e,s,l)}break;case 5:var a=e.return;try{p1(e)}catch(l){or(e,a,l)}}}catch(l){or(e,e.return,l)}if(e===t){Be=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Be=o;break}Be=e.return}}var sN=Math.ceil,Ah=Ds.ReactCurrentDispatcher,Jg=Ds.ReactCurrentOwner,fi=Ds.ReactCurrentBatchConfig,wt=0,Br=null,kr=null,Xr=0,zn=0,ll=ka(0),Rr=0,Ou=null,oo=0,kd=0,Zg=0,Zc=null,On=null,e_=0,Dl=1/0,fs=null,Ih=!1,_1=null,ra=null,v0=!1,Xs=null,Fh=0,eu=0,v1=null,J0=-1,Z0=0;function An(){return wt&6?pr():J0!==-1?J0:J0=pr()}function na(t){return t.mode&1?wt&2&&Xr!==0?Xr&-Xr:W3.transition!==null?(Z0===0&&(Z0=mT()),Z0):(t=Lt,t!==0||(t=window.event,t=t===void 0?16:ET(t.type)),t):1}function Ri(t,e,r,n){if(50<eu)throw eu=0,v1=null,Error(ve(185));xf(t,r,n),(!(wt&2)||t!==Br)&&(t===Br&&(!(wt&2)&&(kd|=r),Rr===4&&$s(t,Xr)),Vn(t,n),r===1&&wt===0&&!(e.mode&1)&&(Dl=pr()+500,yd&&Sa()))}function Vn(t,e){var r=t.callbackNode;WF(t,e);var n=hh(t,t===Br?Xr:0);if(n===0)r!==null&&Vx(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Vx(r),e===1)t.tag===0?j3(Ry.bind(null,t)):jT(Ry.bind(null,t)),M3(function(){!(wt&6)&&Sa()}),r=null;else{switch(gT(n)){case 1:r=Cg;break;case 4:r=dT;break;case 16:r=fh;break;case 536870912:r=pT;break;default:r=fh}r=Vk(r,Pk.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Pk(t,e){if(J0=-1,Z0=0,wt&6)throw Error(ve(327));var r=t.callbackNode;if(gl()&&t.callbackNode!==r)return null;var n=hh(t,t===Br?Xr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Nh(t,n);else{e=n;var i=wt;wt|=2;var s=bk();(Br!==t||Xr!==e)&&(fs=null,Dl=pr()+500,Ka(t,e));do try{lN();break}catch(o){Dk(t,o)}while(!0);Vg(),Ah.current=s,wt=i,kr!==null?e=0:(Br=null,Xr=0,e=Rr)}if(e!==0){if(e===2&&(i=$m(t),i!==0&&(n=i,e=x1(t,i))),e===1)throw r=Ou,Ka(t,0),$s(t,n),Vn(t,pr()),r;if(e===6)$s(t,n);else{if(i=t.current.alternate,!(n&30)&&!aN(i)&&(e=Nh(t,n),e===2&&(s=$m(t),s!==0&&(n=s,e=x1(t,s))),e===1))throw r=Ou,Ka(t,0),$s(t,n),Vn(t,pr()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ve(345));case 2:Ba(t,On,fs);break;case 3:if($s(t,n),(n&130023424)===n&&(e=e_+500-pr(),10<e)){if(hh(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){An(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Zm(Ba.bind(null,t,On,fs),e);break}Ba(t,On,fs);break;case 4:if($s(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Ni(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=pr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*sN(n/1960))-n,10<n){t.timeoutHandle=Zm(Ba.bind(null,t,On,fs),n);break}Ba(t,On,fs);break;case 5:Ba(t,On,fs);break;default:throw Error(ve(329))}}}return Vn(t,pr()),t.callbackNode===r?Pk.bind(null,t):null}function x1(t,e){var r=Zc;return t.current.memoizedState.isDehydrated&&(Ka(t,e).flags|=256),t=Nh(t,e),t!==2&&(e=On,On=r,e!==null&&y1(e)),t}function y1(t){On===null?On=t:On.push.apply(On,t)}function aN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Li(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function $s(t,e){for(e&=~Zg,e&=~kd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ni(e),n=1<<r;t[r]=-1,e&=~n}}function Ry(t){if(wt&6)throw Error(ve(327));gl();var e=hh(t,0);if(!(e&1))return Vn(t,pr()),null;var r=Nh(t,e);if(t.tag!==0&&r===2){var n=$m(t);n!==0&&(e=n,r=x1(t,n))}if(r===1)throw r=Ou,Ka(t,0),$s(t,e),Vn(t,pr()),r;if(r===6)throw Error(ve(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ba(t,On,fs),Vn(t,pr()),null}function t_(t,e){var r=wt;wt|=1;try{return t(e)}finally{wt=r,wt===0&&(Dl=pr()+500,yd&&Sa())}}function lo(t){Xs!==null&&Xs.tag===0&&!(wt&6)&&gl();var e=wt;wt|=1;var r=fi.transition,n=Lt;try{if(fi.transition=null,Lt=1,t)return t()}finally{Lt=n,fi.transition=r,wt=e,!(wt&6)&&Sa()}}function r_(){zn=ll.current,Gt(ll)}function Ka(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,L3(r)),kr!==null)for(r=kr.return;r!==null;){var n=r;switch(Lg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&_h();break;case 3:Rl(),Gt(Mn),Gt(vn),$g();break;case 5:Hg(n);break;case 4:Rl();break;case 13:Gt(er);break;case 19:Gt(er);break;case 10:Ug(n.type._context);break;case 22:case 23:r_()}r=r.return}if(Br=t,kr=t=ia(t.current,null),Xr=zn=e,Rr=0,Ou=null,Zg=kd=oo=0,On=Zc=null,Ha!==null){for(e=0;e<Ha.length;e++)if(r=Ha[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Ha=null}return t}function Dk(t,e){do{var r=kr;try{if(Vg(),q0.current=Ch,Sh){for(var n=tr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Sh=!1}if(ao=0,Mr=Sr=tr=null,Qc=!1,Pu=0,Jg.current=null,r===null||r.return===null){Rr=1,Ou=e,kr=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Xr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=vy(a);if(p!==null){p.flags&=-257,xy(p,a,o,s,e),p.mode&1&&_y(s,c,e),e=p,l=c;var g=e.updateQueue;if(g===null){var x=new Set;x.add(l),e.updateQueue=x}else g.add(l);break e}else{if(!(e&1)){_y(s,c,e),n_();break e}l=Error(ve(426))}}else if(Qt&&o.mode&1){var _=vy(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),xy(_,a,o,s,e),Mg(Pl(l,o));break e}}s=l=Pl(l,o),Rr!==4&&(Rr=2),Zc===null?Zc=[s]:Zc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=gk(s,l,e);fy(s,m);break e;case 1:o=l;var w=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ra===null||!ra.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=_k(s,o,e);fy(s,R);break e}}s=s.return}while(s!==null)}Lk(r)}catch(U){e=U,kr===r&&r!==null&&(kr=r=r.return);continue}break}while(!0)}function bk(){var t=Ah.current;return Ah.current=Ch,t===null?Ch:t}function n_(){(Rr===0||Rr===3||Rr===2)&&(Rr=4),Br===null||!(oo&268435455)&&!(kd&268435455)||$s(Br,Xr)}function Nh(t,e){var r=wt;wt|=2;var n=bk();(Br!==t||Xr!==e)&&(fs=null,Ka(t,e));do try{oN();break}catch(i){Dk(t,i)}while(!0);if(Vg(),wt=r,Ah.current=n,kr!==null)throw Error(ve(261));return Br=null,Xr=0,Rr}function oN(){for(;kr!==null;)Ok(kr)}function lN(){for(;kr!==null&&!DF();)Ok(kr)}function Ok(t){var e=Bk(t.alternate,t,zn);t.memoizedProps=t.pendingProps,e===null?Lk(t):kr=e,Jg.current=null}function Lk(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=tN(r,e),r!==null){r.flags&=32767,kr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rr=6,kr=null;return}}else if(r=eN(r,e,zn),r!==null){kr=r;return}if(e=e.sibling,e!==null){kr=e;return}kr=e=t}while(e!==null);Rr===0&&(Rr=5)}function Ba(t,e,r){var n=Lt,i=fi.transition;try{fi.transition=null,Lt=1,cN(t,e,r,n)}finally{fi.transition=i,Lt=n}return null}function cN(t,e,r,n){do gl();while(Xs!==null);if(wt&6)throw Error(ve(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ve(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(zF(t,s),t===Br&&(kr=Br=null,Xr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||v0||(v0=!0,Vk(fh,function(){return gl(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=fi.transition,fi.transition=null;var a=Lt;Lt=1;var o=wt;wt|=4,Jg.current=null,nN(t,r),Nk(r,t),F3(Qm),dh=!!Ym,Qm=Ym=null,t.current=r,iN(r),bF(),wt=o,Lt=a,fi.transition=s}else t.current=r;if(v0&&(v0=!1,Xs=t,Fh=i),s=t.pendingLanes,s===0&&(ra=null),MF(r.stateNode),Vn(t,pr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ih)throw Ih=!1,t=_1,_1=null,t;return Fh&1&&t.tag!==0&&gl(),s=t.pendingLanes,s&1?t===v1?eu++:(eu=0,v1=t):eu=0,Sa(),null}function gl(){if(Xs!==null){var t=gT(Fh),e=fi.transition,r=Lt;try{if(fi.transition=null,Lt=16>t?16:t,Xs===null)var n=!1;else{if(t=Xs,Xs=null,Fh=0,wt&6)throw Error(ve(331));var i=wt;for(wt|=4,Be=t.current;Be!==null;){var s=Be,a=s.child;if(Be.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Be=c;Be!==null;){var u=Be;switch(u.tag){case 0:case 11:case 15:Jc(8,u,s)}var d=u.child;if(d!==null)d.return=u,Be=d;else for(;Be!==null;){u=Be;var h=u.sibling,p=u.return;if(Ak(u),u===c){Be=null;break}if(h!==null){h.return=p,Be=h;break}Be=p}}}var g=s.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var _=x.sibling;x.sibling=null,x=_}while(x!==null)}}Be=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Be=a;else e:for(;Be!==null;){if(s=Be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Jc(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,Be=m;break e}Be=s.return}}var w=t.current;for(Be=w;Be!==null;){a=Be;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,Be=v;else e:for(a=w;Be!==null;){if(o=Be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Td(9,o)}}catch(U){or(o,o.return,U)}if(o===a){Be=null;break e}var R=o.sibling;if(R!==null){R.return=o.return,Be=R;break e}Be=o.return}}if(wt=i,Sa(),Yi&&typeof Yi.onPostCommitFiberRoot=="function")try{Yi.onPostCommitFiberRoot(md,t)}catch{}n=!0}return n}finally{Lt=r,fi.transition=e}}return!1}function Py(t,e,r){e=Pl(r,e),e=gk(t,e,1),t=ta(t,e,1),e=An(),t!==null&&(xf(t,1,e),Vn(t,e))}function or(t,e,r){if(t.tag===3)Py(t,t,r);else for(;e!==null;){if(e.tag===3){Py(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ra===null||!ra.has(n))){t=Pl(r,t),t=_k(e,t,1),e=ta(e,t,1),t=An(),e!==null&&(xf(e,1,t),Vn(e,t));break}}e=e.return}}function uN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=An(),t.pingedLanes|=t.suspendedLanes&r,Br===t&&(Xr&r)===r&&(Rr===4||Rr===3&&(Xr&130023424)===Xr&&500>pr()-e_?Ka(t,0):Zg|=r),Vn(t,e)}function Mk(t,e){e===0&&(t.mode&1?(e=l0,l0<<=1,!(l0&130023424)&&(l0=4194304)):e=1);var r=An();t=Cs(t,e),t!==null&&(xf(t,e,r),Vn(t,r))}function fN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Mk(t,r)}function hN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ve(314))}n!==null&&n.delete(e),Mk(t,r)}var Bk;Bk=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Mn.current)Ln=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Ln=!1,Z3(t,e,r);Ln=!!(t.flags&131072)}else Ln=!1,Qt&&e.flags&1048576&&WT(e,yh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Q0(t,e),t=e.pendingProps;var i=Il(e,vn.current);ml(e,r),i=Xg(null,e,n,t,i,r);var s=Kg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bn(n)?(s=!0,vh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Wg(e),i.updater=Ed,e.stateNode=i,i._reactInternals=e,a1(e,n,t,r),e=c1(null,e,n,!0,s,r)):(e.tag=0,Qt&&s&&Og(e),yn(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Q0(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=pN(n),t=Ti(n,t),i){case 0:e=l1(null,e,n,t,r);break e;case 1:e=Ey(null,e,n,t,r);break e;case 11:e=yy(null,e,n,t,r);break e;case 14:e=wy(null,e,n,Ti(n.type,t),r);break e}throw Error(ve(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ti(n,i),l1(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ti(n,i),Ey(t,e,n,i,r);case 3:e:{if(wk(e),t===null)throw Error(ve(387));n=e.pendingProps,s=e.memoizedState,i=s.element,KT(t,e),Th(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Pl(Error(ve(423)),e),e=Ty(t,e,n,r,i);break e}else if(n!==i){i=Pl(Error(ve(424)),e),e=Ty(t,e,n,r,i);break e}else for(Xn=ea(e.stateNode.containerInfo.firstChild),Kn=e,Qt=!0,Si=null,r=GT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Fl(),n===i){e=As(t,e,r);break e}yn(t,e,n,r)}e=e.child}return e;case 5:return qT(e),t===null&&n1(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Jm(n,i)?a=null:s!==null&&Jm(n,s)&&(e.flags|=32),yk(t,e),yn(t,e,a,r),e.child;case 6:return t===null&&n1(e),null;case 13:return Ek(t,e,r);case 4:return zg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Nl(e,null,n,r):yn(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ti(n,i),yy(t,e,n,i,r);case 7:return yn(t,e,e.pendingProps,r),e.child;case 8:return yn(t,e,e.pendingProps.children,r),e.child;case 12:return yn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,zt(wh,n._currentValue),n._currentValue=a,s!==null)if(Li(s.value,a)){if(s.children===i.children&&!Mn.current){e=As(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=xs(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),i1(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ve(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),i1(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}yn(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,ml(e,r),i=di(i),n=n(i),e.flags|=1,yn(t,e,n,r),e.child;case 14:return n=e.type,i=Ti(n,e.pendingProps),i=Ti(n.type,i),wy(t,e,n,i,r);case 15:return vk(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ti(n,i),Q0(t,e),e.tag=1,Bn(n)?(t=!0,vh(e)):t=!1,ml(e,r),mk(e,n,i),a1(e,n,i,r),c1(null,e,n,!0,t,r);case 19:return Tk(t,e,r);case 22:return xk(t,e,r)}throw Error(ve(156,e.tag))};function Vk(t,e){return hT(t,e)}function dN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(t,e,r,n){return new dN(t,e,r,n)}function i_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function pN(t){if(typeof t=="function")return i_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tg)return 11;if(t===kg)return 14}return 2}function ia(t,e){var r=t.alternate;return r===null?(r=ci(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function eh(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")i_(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Jo:return qa(r.children,i,s,e);case Eg:a=8,i|=8;break;case Nm:return t=ci(12,r,e,i|2),t.elementType=Nm,t.lanes=s,t;case Rm:return t=ci(13,r,e,i),t.elementType=Rm,t.lanes=s,t;case Pm:return t=ci(19,r,e,i),t.elementType=Pm,t.lanes=s,t;case qE:return Sd(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case XE:a=10;break e;case KE:a=9;break e;case Tg:a=11;break e;case kg:a=14;break e;case Ws:a=16,n=null;break e}throw Error(ve(130,t==null?t:typeof t,""))}return e=ci(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function qa(t,e,r,n){return t=ci(7,t,n,e),t.lanes=r,t}function Sd(t,e,r,n){return t=ci(22,t,n,e),t.elementType=qE,t.lanes=r,t.stateNode={isHidden:!1},t}function zp(t,e,r){return t=ci(6,t,null,e),t.lanes=r,t}function Hp(t,e,r){return e=ci(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mN(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kp(0),this.expirationTimes=kp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kp(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function s_(t,e,r,n,i,s,a,o,l){return t=new mN(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ci(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wg(s),t}function gN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qo,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Uk(t){if(!t)return ha;t=t._reactInternals;e:{if(ko(t)!==t||t.tag!==1)throw Error(ve(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ve(171))}if(t.tag===1){var r=t.type;if(Bn(r))return UT(t,r,e)}return e}function jk(t,e,r,n,i,s,a,o,l){return t=s_(r,n,!0,t,i,s,a,o,l),t.context=Uk(null),r=t.current,n=An(),i=na(r),s=xs(n,i),s.callback=e??null,ta(r,s,i),t.current.lanes=i,xf(t,i,n),Vn(t,n),t}function Cd(t,e,r,n){var i=e.current,s=An(),a=na(i);return r=Uk(r),e.context===null?e.context=r:e.pendingContext=r,e=xs(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=ta(i,e,a),t!==null&&(Ri(t,i,a,s),K0(t,i,a)),a}function Rh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Dy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function a_(t,e){Dy(t,e),(t=t.alternate)&&Dy(t,e)}function _N(){return null}var Wk=typeof reportError=="function"?reportError:function(t){console.error(t)};function o_(t){this._internalRoot=t}Ad.prototype.render=o_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ve(409));Cd(t,e,null,null)};Ad.prototype.unmount=o_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;lo(function(){Cd(null,t,null,null)}),e[Ss]=null}};function Ad(t){this._internalRoot=t}Ad.prototype.unstable_scheduleHydration=function(t){if(t){var e=xT();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Hs.length&&e!==0&&e<Hs[r].priority;r++);Hs.splice(r,0,t),r===0&&wT(t)}};function l_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Id(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function by(){}function vN(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Rh(a);s.call(c)}}var a=jk(e,n,t,0,null,!1,!1,"",by);return t._reactRootContainer=a,t[Ss]=a.current,Au(t.nodeType===8?t.parentNode:t),lo(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Rh(l);o.call(c)}}var l=s_(t,0,!1,null,null,!1,!1,"",by);return t._reactRootContainer=l,t[Ss]=l.current,Au(t.nodeType===8?t.parentNode:t),lo(function(){Cd(e,l,r,n)}),l}function Fd(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Rh(a);o.call(l)}}Cd(e,a,t,i)}else a=vN(r,e,t,i,n);return Rh(a)}_T=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Mc(e.pendingLanes);r!==0&&(Ag(e,r|1),Vn(e,pr()),!(wt&6)&&(Dl=pr()+500,Sa()))}break;case 13:lo(function(){var n=Cs(t,1);if(n!==null){var i=An();Ri(n,t,1,i)}}),a_(t,1)}};Ig=function(t){if(t.tag===13){var e=Cs(t,134217728);if(e!==null){var r=An();Ri(e,t,134217728,r)}a_(t,134217728)}};vT=function(t){if(t.tag===13){var e=na(t),r=Cs(t,e);if(r!==null){var n=An();Ri(r,t,e,n)}a_(t,e)}};xT=function(){return Lt};yT=function(t,e){var r=Lt;try{return Lt=t,e()}finally{Lt=r}};Wm=function(t,e,r){switch(e){case"input":if(Om(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=xd(n);if(!i)throw Error(ve(90));QE(n),Om(n,i)}}}break;case"textarea":ZE(t,r);break;case"select":e=r.value,e!=null&&fl(t,!!r.multiple,e,!1)}};aT=t_;oT=lo;var xN={usingClientEntryPoint:!1,Events:[wf,rl,xd,iT,sT,t_]},Ic={findFiberByHostInstance:za,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yN={bundleType:Ic.bundleType,version:Ic.version,rendererPackageName:Ic.rendererPackageName,rendererConfig:Ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ds.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uT(t),t===null?null:t.stateNode},findFiberByHostInstance:Ic.findFiberByHostInstance||_N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var x0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!x0.isDisabled&&x0.supportsFiber)try{md=x0.inject(yN),Yi=x0}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xN;Zn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l_(e))throw Error(ve(200));return gN(t,e,null,r)};Zn.createRoot=function(t,e){if(!l_(t))throw Error(ve(299));var r=!1,n="",i=Wk;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=s_(t,1,!1,null,null,r,!1,n,i),t[Ss]=e.current,Au(t.nodeType===8?t.parentNode:t),new o_(e)};Zn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ve(188)):(t=Object.keys(t).join(","),Error(ve(268,t)));return t=uT(e),t=t===null?null:t.stateNode,t};Zn.flushSync=function(t){return lo(t)};Zn.hydrate=function(t,e,r){if(!Id(e))throw Error(ve(200));return Fd(null,t,e,!0,r)};Zn.hydrateRoot=function(t,e,r){if(!l_(t))throw Error(ve(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=Wk;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=jk(e,null,t,1,r??null,i,!1,s,a),t[Ss]=e.current,Au(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Ad(e)};Zn.render=function(t,e,r){if(!Id(e))throw Error(ve(200));return Fd(null,t,e,!1,r)};Zn.unmountComponentAtNode=function(t){if(!Id(t))throw Error(ve(40));return t._reactRootContainer?(lo(function(){Fd(null,null,t,!1,function(){t._reactRootContainer=null,t[Ss]=null})}),!0):!1};Zn.unstable_batchedUpdates=t_;Zn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Id(r))throw Error(ve(200));if(t==null||t._reactInternals===void 0)throw Error(ve(38));return Fd(t,e,r,!1,n)};Zn.version="18.3.1-next-f1338f8080-20240426";function zk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zk)}catch(t){console.error(t)}}zk(),zE.exports=Zn;var wN=zE.exports,Oy=wN;Im.createRoot=Oy.createRoot,Im.hydrateRoot=Oy.hydrateRoot;var EN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const TN=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ir=(t,e)=>{const r=Yt.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,children:o,...l},c)=>Yt.createElement("svg",{ref:c,...EN,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:`lucide lucide-${TN(t)}`,...l},[...e.map(([u,d])=>Yt.createElement(u,d)),...(Array.isArray(o)?o:[o])||[]]));return r.displayName=`${t}`,r},kN=ir("Bean",[["path",{d:"M10.165 6.598C9.954 7.478 9.64 8.36 9 9c-.64.64-1.521.954-2.402 1.165A6 6 0 0 0 8 22c7.732 0 14-6.268 14-14a6 6 0 0 0-11.835-1.402Z",key:"1tvzk7"}],["path",{d:"M5.341 10.62a4 4 0 1 0 5.279-5.28",key:"2cyri2"}]]),Ly=ir("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),$p=ir("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]),My=ir("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),SN=ir("Egg",[["path",{d:"M12 22c6.23-.05 7.87-5.57 7.5-10-.36-4.34-3.95-9.96-7.5-10-3.55.04-7.14 5.66-7.5 10-.37 4.43 1.27 9.95 7.5 10z",key:"1c39pg"}]]),CN=ir("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),By=ir("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),Hk=ir("Fish",[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]]),$k=ir("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),AN=ir("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),IN=ir("Milk",[["path",{d:"M8 2h8",key:"1ssgc1"}],["path",{d:"M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2",key:"qtp12x"}],["path",{d:"M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0",key:"ygeh44"}]]),FN=ir("Nut",[["path",{d:"M12 4V2",key:"1k5q1u"}],["path",{d:"M5 10v4a7.004 7.004 0 0 0 5.277 6.787c.412.104.802.292 1.102.592L12 22l.621-.621c.3-.3.69-.488 1.102-.592A7.003 7.003 0 0 0 19 14v-4",key:"1tgyif"}],["path",{d:"M12 4C8 4 4.5 6 4 8c-.243.97-.919 1.952-2 3 1.31-.082 1.972-.29 3-1 .54.92.982 1.356 2 2 1.452-.647 1.954-1.098 2.5-2 .595.995 1.151 1.427 2.5 2 1.31-.621 1.862-1.058 2.5-2 .629.977 1.162 1.423 2.5 2 1.209-.548 1.68-.967 2-2 1.032.916 1.683 1.157 3 1-1.297-1.036-1.758-2.03-2-3-.5-2-4-4-8-4Z",key:"tnsqj"}]]),Vy=ir("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Wo=ir("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),NN=ir("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Uy=ir("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Gk=ir("Soup",[["path",{d:"M12 21a9 9 0 0 0 9-9H3a9 9 0 0 0 9 9Z",key:"4rw317"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M19.5 12 22 6",key:"shfsr5"}],["path",{d:"M16.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.73 1.62",key:"rpc6vp"}],["path",{d:"M11.25 3c.27.1.8.53.74 1.36-.05.83-.93 1.2-.98 2.02-.06.78.33 1.24.72 1.62",key:"1lf63m"}],["path",{d:"M6.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.74 1.62",key:"97tijn"}]]),Ph=ir("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]),y0=ir("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),RN=ir("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),PN=ir("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]),DN=ir("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]),jy=ir("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Wy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke=function(t,e){if(!t)throw Zl(e)},Zl=function(t){return new Error("Firebase Database ("+Xk.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},bN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},c_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,d=(s&3)<<4|o>>4;let h=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(h=64)),n.push(r[u],r[d],r[h],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Kk(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):bN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const d=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||d==null)throw new ON;const h=s<<2|o>>4;if(n.push(h),c!==64){const p=o<<4&240|c>>2;if(n.push(p),d!==64){const g=c<<6&192|d;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class ON extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qk=function(t){const e=Kk(t);return c_.encodeByteArray(e,!0)},Dh=function(t){return qk(t).replace(/\./g,"")},w1=function(t){try{return c_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(t){return Yk(void 0,t)}function Yk(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const r=e;return new Date(r.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)!e.hasOwnProperty(r)||!MN(r)||(t[r]=Yk(t[r],e[r]));return t}function MN(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=()=>BN().__FIREBASE_DEFAULTS__,UN=()=>{if(typeof process>"u"||typeof Wy>"u")return;const t=Wy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},jN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&w1(t[1]);return e&&JSON.parse(e)},u_=()=>{try{return VN()||UN()||jN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},WN=t=>{var e,r;return(r=(e=u_())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Qk=t=>{const e=WN(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Jk=()=>{var t;return(t=u_())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Dh(JSON.stringify(r)),Dh(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(eS())}function zN(){var t;const e=(t=u_())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function HN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $N(){return Xk.NODE_ADMIN===!0}function GN(){return!zN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function XN(){try{return typeof indexedDB=="object"}catch{return!1}}function KN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN="FirebaseError";class ec extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=qN,Object.setPrototypeOf(this,ec.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,rS.prototype.create)}}class rS{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?YN(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new ec(i,o,n)}}function YN(t,e){return t.replace(QN,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const QN=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){return JSON.parse(t)}function Ir(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=function(t){let e={},r={},n={},i="";try{const s=t.split(".");e=Lu(w1(s[0])||""),r=Lu(w1(s[1])||""),i=s[2],n=r.d||{},delete r.d}catch{}return{header:e,claims:r,data:n,signature:i}},JN=function(t){const e=nS(t),r=e.claims;return!!r&&typeof r=="object"&&r.hasOwnProperty("iat")},ZN=function(t){const e=nS(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function bl(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function zy(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function bh(t,e,r){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=e.call(r,t[i],i,t));return n}function E1(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(Hy(s)&&Hy(a)){if(!E1(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Hy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,r){r||(r=0);const n=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)n[d]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(let d=0;d<16;d++)n[d]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(let d=16;d<80;d++){const h=n[d-3]^n[d-8]^n[d-14]^n[d-16];n[d]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],a=this.chain_[2],o=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=o^s&(a^o),u=1518500249):(c=s^a^o,u=1859775393):d<60?(c=s&a|o&(s|a),u=2400959708):(c=s^a^o,u=3395469782);const h=(i<<5|i>>>27)+c+l+u+n[d]&4294967295;l=o,o=a,a=(s<<30|s>>>2)&4294967295,s=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+o&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,r){if(e==null)return;r===void 0&&(r=e.length);const n=r-this.blockSize;let i=0;const s=this.buf_;let a=this.inbuf_;for(;i<r;){if(a===0)for(;i<=n;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<r;)if(s[a]=e.charCodeAt(i),++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}else for(;i<r;)if(s[a]=e[i],++a,++i,a===this.blockSize){this.compress_(s),a=0;break}}this.inbuf_=a,this.total_+=r}digest(){const e=[];let r=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=r&255,r/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[n]=this.chain_[i]>>s&255,++n;return e}}function Nd(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i>=55296&&i<=56319){const s=i-55296;n++,ke(n<t.length,"Surrogate pair missing trail surrogate.");const a=t.charCodeAt(n)-56320;i=65536+(s<<10)+a}i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):i<65536?(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Rd=function(t){let e=0;for(let r=0;r<t.length;r++){const n=t.charCodeAt(r);n<128?e++:n<2048?e+=2:n>=55296&&n<=56319?(e+=4,r++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(t){return t&&t._delegate?t._delegate:t}class Ol{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Tf;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sR(e))try{this.getOrInitializeService({instanceIdentifier:Va})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Va){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Va){return this.instances.has(e)}getOptions(e=Va){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:iR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Va){return this.component?this.component.multipleInstances?e:Va:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iR(t){return t===Va?void 0:t}function sR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new nR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(vt||(vt={}));const oR={debug:vt.DEBUG,verbose:vt.VERBOSE,info:vt.INFO,warn:vt.WARN,error:vt.ERROR,silent:vt.SILENT},lR=vt.INFO,cR={[vt.DEBUG]:"log",[vt.VERBOSE]:"log",[vt.INFO]:"info",[vt.WARN]:"warn",[vt.ERROR]:"error"},uR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=cR[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f_{constructor(e){this.name=e,this._logLevel=lR,this._logHandler=uR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vt.DEBUG,...e),this._logHandler(this,vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vt.VERBOSE,...e),this._logHandler(this,vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vt.INFO,...e),this._logHandler(this,vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vt.WARN,...e),this._logHandler(this,vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vt.ERROR,...e),this._logHandler(this,vt.ERROR,...e)}}const fR=(t,e)=>e.some(r=>t instanceof r);let $y,Gy;function hR(){return $y||($y=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dR(){return Gy||(Gy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iS=new WeakMap,T1=new WeakMap,sS=new WeakMap,Gp=new WeakMap,h_=new WeakMap;function pR(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(sa(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&iS.set(r,t)}).catch(()=>{}),h_.set(e,t),e}function mR(t){if(T1.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});T1.set(t,e)}let k1={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return T1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sS.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return sa(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function gR(t){k1=t(k1)}function _R(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Xp(this),e,...r);return sS.set(n,e.sort?e.sort():[e]),sa(n)}:dR().includes(t)?function(...e){return t.apply(Xp(this),e),sa(iS.get(this))}:function(...e){return sa(t.apply(Xp(this),e))}}function vR(t){return typeof t=="function"?_R(t):(t instanceof IDBTransaction&&mR(t),fR(t,hR())?new Proxy(t,k1):t)}function sa(t){if(t instanceof IDBRequest)return pR(t);if(Gp.has(t))return Gp.get(t);const e=vR(t);return e!==t&&(Gp.set(t,e),h_.set(e,t)),e}const Xp=t=>h_.get(t);function xR(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=sa(a);return n&&a.addEventListener("upgradeneeded",l=>{n(sa(a.result),l.oldVersion,l.newVersion,sa(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const yR=["get","getKey","getAll","getAllKeys","count"],wR=["put","add","delete","clear"],Kp=new Map;function Xy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Kp.get(e))return Kp.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=wR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||yR.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Kp.set(e,s),s}gR(t=>({...t,get:(e,r,n)=>Xy(e,r)||t.get(e,r,n),has:(e,r)=>!!Xy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(TR(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function TR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const S1="@firebase/app",Ky="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new f_("@firebase/app"),kR="@firebase/app-compat",SR="@firebase/analytics-compat",CR="@firebase/analytics",AR="@firebase/app-check-compat",IR="@firebase/app-check",FR="@firebase/auth",NR="@firebase/auth-compat",RR="@firebase/database",PR="@firebase/data-connect",DR="@firebase/database-compat",bR="@firebase/functions",OR="@firebase/functions-compat",LR="@firebase/installations",MR="@firebase/installations-compat",BR="@firebase/messaging",VR="@firebase/messaging-compat",UR="@firebase/performance",jR="@firebase/performance-compat",WR="@firebase/remote-config",zR="@firebase/remote-config-compat",HR="@firebase/storage",$R="@firebase/storage-compat",GR="@firebase/firestore",XR="@firebase/vertexai-preview",KR="@firebase/firestore-compat",qR="firebase",YR="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1="[DEFAULT]",QR={[S1]:"fire-core",[kR]:"fire-core-compat",[CR]:"fire-analytics",[SR]:"fire-analytics-compat",[IR]:"fire-app-check",[AR]:"fire-app-check-compat",[FR]:"fire-auth",[NR]:"fire-auth-compat",[RR]:"fire-rtdb",[PR]:"fire-data-connect",[DR]:"fire-rtdb-compat",[bR]:"fire-fn",[OR]:"fire-fn-compat",[LR]:"fire-iid",[MR]:"fire-iid-compat",[BR]:"fire-fcm",[VR]:"fire-fcm-compat",[UR]:"fire-perf",[jR]:"fire-perf-compat",[WR]:"fire-rc",[zR]:"fire-rc-compat",[HR]:"fire-gcs",[$R]:"fire-gcs-compat",[GR]:"fire-fst",[KR]:"fire-fst-compat",[XR]:"fire-vertex","fire-js":"fire-js",[qR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu=new Map,JR=new Map,A1=new Map;function qy(t,e){try{t.container.addComponent(e)}catch(r){Is.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Bu(t){const e=t.name;if(A1.has(e))return Is.debug(`There were multiple attempts to register component ${e}.`),!1;A1.set(e,t);for(const r of Mu.values())qy(r,t);for(const r of JR.values())qy(r,t);return!0}function aS(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},aa=new rS("app","Firebase",ZR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ol("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw aa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=YR;function lS(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:C1,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw aa.create("bad-app-name",{appName:String(i)});if(r||(r=Jk()),!r)throw aa.create("no-options");const s=Mu.get(i);if(s){if(E1(r,s.options)&&E1(n,s.config))return s;throw aa.create("duplicate-app",{appName:i})}const a=new aR(i);for(const l of A1.values())a.addComponent(l);const o=new e6(r,n,a);return Mu.set(i,o),o}function d_(t=C1){const e=Mu.get(t);if(!e&&t===C1&&Jk())return lS();if(!e)throw aa.create("no-app",{appName:t});return e}function t6(){return Array.from(Mu.values())}function oa(t,e,r){var n;let i=(n=QR[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Is.warn(o.join(" "));return}Bu(new Ol(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r6="firebase-heartbeat-database",n6=1,Vu="firebase-heartbeat-store";let qp=null;function cS(){return qp||(qp=xR(r6,n6,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vu)}catch(r){console.warn(r)}}}}).catch(t=>{throw aa.create("idb-open",{originalErrorMessage:t.message})})),qp}async function i6(t){try{const r=(await cS()).transaction(Vu),n=await r.objectStore(Vu).get(uS(t));return await r.done,n}catch(e){if(e instanceof ec)Is.warn(e.message);else{const r=aa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Is.warn(r.message)}}}async function Yy(t,e){try{const n=(await cS()).transaction(Vu,"readwrite");await n.objectStore(Vu).put(e,uS(t)),await n.done}catch(r){if(r instanceof ec)Is.warn(r.message);else{const n=aa.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Is.warn(n.message)}}}function uS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=1024,a6=30*24*60*60*1e3;class o6{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new c6(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Qy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=a6}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Is.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Qy(),{heartbeatsToSend:n,unsentEntries:i}=l6(this._heartbeatsCache.heartbeats),s=Dh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Is.warn(r),""}}}function Qy(){return new Date().toISOString().substring(0,10)}function l6(t,e=s6){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Jy(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Jy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class c6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return XN()?KN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await i6(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Yy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Yy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Jy(t){return Dh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(t){Bu(new Ol("platform-logger",e=>new ER(e),"PRIVATE")),Bu(new Ol("heartbeat",e=>new o6(e),"PRIVATE")),oa(S1,Ky,t),oa(S1,Ky,"esm2017"),oa("fire-js","")}u6("");var f6="firebase",h6="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oa(f6,h6,"app");var Zy={};const e2="@firebase/database",t2="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fS="";function d6(t){fS=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,r){r==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ir(r))}get(e){const r=this.domStorage_.getItem(this.prefixedName_(e));return r==null?null:Lu(r)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,r){r==null?delete this.cache_[e]:this.cache_[e]=r}get(e){return rs(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new p6(e)}}catch{}return new m6},Ga=hS("localStorage"),g6=hS("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=new f_("@firebase/database"),_6=function(){let t=1;return function(){return t++}}(),dS=function(t){const e=rR(t),r=new tR;r.update(e);const n=r.digest();return c_.encodeByteArray(n)},kf=function(...t){let e="";for(let r=0;r<t.length;r++){const n=t[r];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?e+=kf.apply(null,n):typeof n=="object"?e+=Ir(n):e+=n,e+=" "}return e};let tu=null,r2=!0;const v6=function(t,e){ke(!0,"Can't turn on custom loggers persistently."),_l.logLevel=vt.VERBOSE,tu=_l.log.bind(_l)},$r=function(...t){if(r2===!0&&(r2=!1,tu===null&&g6.get("logging_enabled")===!0&&v6()),tu){const e=kf.apply(null,t);tu(e)}},Sf=function(t){return function(...e){$r(t,...e)}},I1=function(...t){const e="FIREBASE INTERNAL ERROR: "+kf(...t);_l.error(e)},Fs=function(...t){const e=`FIREBASE FATAL ERROR: ${kf(...t)}`;throw _l.error(e),new Error(e)},In=function(...t){const e="FIREBASE WARNING: "+kf(...t);_l.warn(e)},x6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&In("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},p_=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},y6=function(t){if(document.readyState==="complete")t();else{let e=!1;const r=function(){if(!document.body){setTimeout(r,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&r()}),window.attachEvent("onload",r))}},Ll="[MIN_NAME]",co="[MAX_NAME]",Co=function(t,e){if(t===e)return 0;if(t===Ll||e===co)return-1;if(e===Ll||t===co)return 1;{const r=n2(t),n=n2(e);return r!==null?n!==null?r-n===0?t.length-e.length:r-n:-1:n!==null?1:t<e?-1:1}},w6=function(t,e){return t===e?0:t<e?-1:1},Fc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ir(e))},m_=function(t){if(typeof t!="object"||t===null)return Ir(t);const e=[];for(const n in t)e.push(n);e.sort();let r="{";for(let n=0;n<e.length;n++)n!==0&&(r+=","),r+=Ir(e[n]),r+=":",r+=m_(t[e[n]]);return r+="}",r},pS=function(t,e){const r=t.length;if(r<=e)return[t];const n=[];for(let i=0;i<r;i+=e)i+e>r?n.push(t.substring(i,r)):n.push(t.substring(i,i+e));return n};function Yr(t,e){for(const r in t)t.hasOwnProperty(r)&&e(r,t[r])}const mS=function(t){ke(!p_(t),"Invalid JSON number");const e=11,r=52,n=(1<<e-1)-1;let i,s,a,o,l;t===0?(s=0,a=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-n)?(o=Math.min(Math.floor(Math.log(t)/Math.LN2),n),s=o+n,a=Math.round(t*Math.pow(2,r-o)-Math.pow(2,r))):(s=0,a=Math.round(t/Math.pow(2,1-n-r))));const c=[];for(l=r;l;l-=1)c.push(a%2?1:0),a=Math.floor(a/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},E6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},T6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function k6(t,e){let r="Unknown Error";t==="too_big"?r="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?r="Client doesn't have permission to access the desired data.":t==="unavailable"&&(r="The service is unavailable");const n=new Error(t+" at "+e._path.toString()+": "+r);return n.code=t.toUpperCase(),n}const S6=new RegExp("^-?(0*)\\d{1,10}$"),C6=-2147483648,A6=2147483647,n2=function(t){if(S6.test(t)){const e=Number(t);if(e>=C6&&e<=A6)return e}return null},tc=function(t){try{t()}catch(e){setTimeout(()=>{const r=e.stack||"";throw In("Exception was thrown by user callback.",r),e},Math.floor(0))}},I6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ru=function(t,e){const r=setTimeout(t,e);return typeof r=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(r):typeof r=="object"&&r.unref&&r.unref(),r};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e,r){this.appName_=e,this.appCheckProvider=r,this.appCheck=r==null?void 0:r.getImmediate({optional:!0}),this.appCheck||r==null||r.get().then(n=>this.appCheck=n)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((r,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){var r;(r=this.appCheckProvider)===null||r===void 0||r.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){In(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e,r,n){this.appName_=e,this.firebaseOptions_=r,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(r=>r&&r.code==="auth/token-not-initialized"?($r("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)):new Promise((r,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(r,n):r(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(r=>r.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(r=>r.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',In(e)}}class th{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}th.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="5",gS="v",_S="s",vS="r",xS="f",yS=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,wS="ls",ES="p",F1="ac",TS="websocket",kS="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,r,n,i,s=!1,a="",o=!1,l=!1){this.secure=r,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=a,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ga.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ga.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",r=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${r}`}}function R6(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function CS(t,e,r){ke(typeof e=="string","typeof type must == string"),ke(typeof r=="object","typeof params must == object");let n;if(e===TS)n=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===kS)n=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);R6(t)&&(r.ns=t.namespace);const i=[];return Yr(r,(s,a)=>{i.push(s+"="+a)}),n+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(){this.counters_={}}incrementCounter(e,r=1){rs(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=r}get(){return LN(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp={},Qp={};function __(t){const e=t.toString();return Yp[e]||(Yp[e]=new P6),Yp[e]}function D6(t,e){const r=t.toString();return Qp[r]||(Qp[r]=e()),Qp[r]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,r){this.closeAfterResponse=e,this.onClose=r,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,r){for(this.pendingResponses[e]=r;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<n.length;++i)n[i]&&tc(()=>{this.onMessage_(n[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="start",O6="close",L6="pLPCommand",M6="pRTLPCB",AS="id",IS="pw",FS="ser",B6="cb",V6="seg",U6="ts",j6="d",W6="dframe",NS=1870,RS=30,z6=NS-RS,H6=25e3,$6=3e4;class cl{constructor(e,r,n,i,s,a,o){this.connId=e,this.repoInfo=r,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=a,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Sf(e),this.stats_=__(r),this.urlFn=l=>(this.appCheckToken&&(l[F1]=this.appCheckToken),CS(r,kS,l))}open(e,r){this.curSegmentNum=0,this.onDisconnect_=r,this.myPacketOrderer=new b6(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor($6)),y6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new v_((...s)=>{const[a,o,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,a===i2)this.id=o,this.password=l;else if(a===O6)o?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(o,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+a)},(...s)=>{const[a,o]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(a,o)},()=>{this.onClosed_()},this.urlFn);const n={};n[i2]="t",n[FS]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[B6]=this.scriptTagHolder.uniqueCallbackIdentifier),n[gS]=g_,this.transportSessionId&&(n[_S]=this.transportSessionId),this.lastSessionId&&(n[wS]=this.lastSessionId),this.applicationId&&(n[ES]=this.applicationId),this.appCheckToken&&(n[F1]=this.appCheckToken),typeof location<"u"&&location.hostname&&yS.test(location.hostname)&&(n[vS]=xS);const i=this.urlFn(n);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){cl.forceAllow_=!0}static forceDisallow(){cl.forceDisallow_=!0}static isAvailable(){return cl.forceAllow_?!0:!cl.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!E6()&&!T6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const r=Ir(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=qk(r),i=pS(n,z6);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,r){this.myDisconnFrame=document.createElement("iframe");const n={};n[W6]="t",n[AS]=e,n[IS]=r,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const r=Ir(e).length;this.bytesReceived+=r,this.stats_.incrementCounter("bytes_received",r)}}class v_{constructor(e,r,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=_6(),window[L6+this.uniqueCallbackIdentifier]=e,window[M6+this.uniqueCallbackIdentifier]=r,this.myIFrame=v_.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(o){$r("frame writing exception"),o.stack&&$r(o.stack),$r(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||$r("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,r){for(this.myID=e,this.myPW=r,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[AS]=this.myID,e[IS]=this.myPW,e[FS]=this.currentSerial;let r=this.urlFn(e),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+RS+n.length<=NS;){const a=this.pendingSegs.shift();n=n+"&"+V6+i+"="+a.seg+"&"+U6+i+"="+a.ts+"&"+j6+i+"="+a.d,i++}return r=r+n,this.addLongPollTag_(r,this.currentSerial),!0}else return!1}enqueueSegment(e,r,n){this.pendingSegs.push({seg:e,ts:r,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,r){this.outstandingRequests.add(r);const n=()=>{this.outstandingRequests.delete(r),this.newRequest_()},i=setTimeout(n,Math.floor(H6)),s=()=>{clearTimeout(i),n()};this.addTag(e,s)}addTag(e,r){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const i=n.readyState;(!i||i==="loaded"||i==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),r())},n.onerror=()=>{$r("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6=16384,X6=45e3;let Oh=null;typeof MozWebSocket<"u"?Oh=MozWebSocket:typeof WebSocket<"u"&&(Oh=WebSocket);class Ci{constructor(e,r,n,i,s,a,o){this.connId=e,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Sf(this.connId),this.stats_=__(r),this.connURL=Ci.connectionURL_(r,a,o,i,n),this.nodeAdmin=r.nodeAdmin}static connectionURL_(e,r,n,i,s){const a={};return a[gS]=g_,typeof location<"u"&&location.hostname&&yS.test(location.hostname)&&(a[vS]=xS),r&&(a[_S]=r),n&&(a[wS]=n),i&&(a[F1]=i),s&&(a[ES]=s),CS(e,TS,a)}open(e,r){this.onDisconnect=r,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ga.set("previous_websocket_failure",!0);try{let n;$N(),this.mySock=new Oh(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const i=n.message||n.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Ci.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(r);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&Oh!==null&&!Ci.forceDisallow_}static previouslyFailed(){return Ga.isInMemoryStorage||Ga.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ga.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const n=Lu(r);this.onMessage(n)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ke(this.frames===null,"We already have a frame buffer"),e.length<=6){const r=Number(e);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const r=e.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{const n=this.extractFrameCount_(r);n!==null&&this.appendFrame_(n)}}send(e){this.resetKeepAlive();const r=Ir(e);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const n=pS(r,G6);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(X6))}sendString_(e){try{this.mySock.send(e)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ci.responsesRequiredToBeHealthy=2;Ci.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[cl,Ci]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const r=Ci&&Ci.isAvailable();let n=r&&!Ci.previouslyFailed();if(e.webSocketOnly&&(r||In("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Ci];else{const i=this.transports_=[];for(const s of Uu.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Uu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Uu.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6=6e4,q6=5e3,Y6=10*1024,Q6=100*1024,Jp="t",s2="d",J6="s",a2="r",Z6="e",o2="o",l2="a",c2="n",u2="p",eP="h";class tP{constructor(e,r,n,i,s,a,o,l,c,u){this.id=e,this.repoInfo_=r,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=a,this.onReady_=o,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Sf("c:"+this.id+":"),this.transportManager_=new Uu(r),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(r,n)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ru(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Q6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Y6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return r=>{e===this.conn_?this.onConnectionLost_(r):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return r=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(r):e===this.secondaryConn_?this.onSecondaryMessageReceived_(r):this.log_("message on old connection"))}}sendRequest(e){const r={t:"d",d:e};this.sendData_(r)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Jp in e){const r=e[Jp];r===l2?this.upgradeIfSecondaryHealthy_():r===a2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):r===o2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const r=Fc("t",e),n=Fc("d",e);if(r==="c")this.onSecondaryControl_(n);else if(r==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+r)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:u2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:l2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:c2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const r=Fc("t",e),n=Fc("d",e);r==="c"?this.onControl_(n):r==="d"&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const r=Fc(Jp,e);if(s2 in e){const n=e[s2];if(r===eP){const i=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(r===c2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else r===J6?this.onConnectionShutdown_(n):r===a2?this.onReset_(n):r===Z6?I1("Server Error: "+n):r===o2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):I1("Unknown control packet command: "+r)}}onHandshake_(e){const r=e.ts,n=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,r),g_!==n&&In("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),ru(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(K6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,r){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(r,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ru(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(q6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:u2,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ga.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{put(e,r,n,i){}merge(e,r,n,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,r,n){}onDisconnectMerge(e,r,n){}onDisconnectCancel(e,r){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(e){this.allowedEvents_=e,this.listeners_={},ke(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...r){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let i=0;i<n.length;i++)n[i].callback.apply(n[i].context,r)}}on(e,r,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:r,context:n});const i=this.getInitialEvent(e);i&&r.apply(n,i)}off(e,r,n){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===r&&(!n||n===i[s].context)){i.splice(s,1);return}}validateEventType_(e){ke(this.allowedEvents_.find(r=>r===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends DS{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!tS()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Lh}getInitialEvent(e){return ke(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=32,h2=768;class Vt{constructor(e,r){if(r===void 0){this.pieces_=e.split("/");let n=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=r}toString(){let e="";for(let r=this.pieceNum_;r<this.pieces_.length;r++)this.pieces_[r]!==""&&(e+="/"+this.pieces_[r]);return e||"/"}}function kt(){return new Vt("")}function pt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function da(t){return t.pieces_.length-t.pieceNum_}function Wt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Vt(t.pieces_,e)}function x_(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function rP(t){let e="";for(let r=t.pieceNum_;r<t.pieces_.length;r++)t.pieces_[r]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[r])));return e||"/"}function ju(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function bS(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let r=t.pieceNum_;r<t.pieces_.length-1;r++)e.push(t.pieces_[r]);return new Vt(e,0)}function cr(t,e){const r=[];for(let n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);if(e instanceof Vt)for(let n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);else{const n=e.split("/");for(let i=0;i<n.length;i++)n[i].length>0&&r.push(n[i])}return new Vt(r,0)}function ft(t){return t.pieceNum_>=t.pieces_.length}function Cn(t,e){const r=pt(t),n=pt(e);if(r===null)return e;if(r===n)return Cn(Wt(t),Wt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function nP(t,e){const r=ju(t,0),n=ju(e,0);for(let i=0;i<r.length&&i<n.length;i++){const s=Co(r[i],n[i]);if(s!==0)return s}return r.length===n.length?0:r.length<n.length?-1:1}function OS(t,e){if(da(t)!==da(e))return!1;for(let r=t.pieceNum_,n=e.pieceNum_;r<=t.pieces_.length;r++,n++)if(t.pieces_[r]!==e.pieces_[n])return!1;return!0}function ui(t,e){let r=t.pieceNum_,n=e.pieceNum_;if(da(t)>da(e))return!1;for(;r<t.pieces_.length;){if(t.pieces_[r]!==e.pieces_[n])return!1;++r,++n}return!0}class iP{constructor(e,r){this.errorPrefix_=r,this.parts_=ju(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=Rd(this.parts_[n]);LS(this)}}function sP(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Rd(e),LS(t)}function aP(t){const e=t.parts_.pop();t.byteLength_-=Rd(e),t.parts_.length>0&&(t.byteLength_-=1)}function LS(t){if(t.byteLength_>h2)throw new Error(t.errorPrefix_+"has a key path longer than "+h2+" bytes ("+t.byteLength_+").");if(t.parts_.length>f2)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+f2+") or object contains a cycle "+Ua(t))}function Ua(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_ extends DS{constructor(){super(["visible"]);let e,r;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(r="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(r="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(r="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(r="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,r&&document.addEventListener(r,()=>{const n=!document[e];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}static getInstance(){return new y_}getInitialEvent(e){return ke(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=1e3,oP=60*5*1e3,d2=30*1e3,lP=1.3,cP=3e4,uP="server_kill",p2=3;class ys extends PS{constructor(e,r,n,i,s,a,o,l){if(super(),this.repoInfo_=e,this.applicationId_=r,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=o,this.authOverride_=l,this.id=ys.nextPersistentConnectionId_++,this.log_=Sf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Nc,this.maxReconnectDelay_=oP,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");y_.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Lh.getInstance().on("online",this.onOnline_,this)}sendRequest(e,r,n){const i=++this.requestNumber_,s={r:i,a:e,b:r};this.log_(Ir(s)),ke(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),n&&(this.requestCBHash_[i]=n)}get(e){this.initConnection_();const r=new Tf,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:a=>{const o=a.d;a.s==="ok"?r.resolve(o):r.reject(o)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(e,r,n,i){this.initConnection_();const s=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),ke(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ke(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");const o={onComplete:i,hashFn:r,query:e,tag:n};this.listens.get(a).set(s,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const r=this.outstandingGets_[e];this.sendRequest("g",r.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})}sendListen_(e){const r=e.query,n=r._path.toString(),i=r._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n},a="q";e.tag&&(s.q=r._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(a,s,o=>{const l=o.d,c=o.s;ys.warnOnListenWarnings_(l,r),(this.listens.get(n)&&this.listens.get(n).get(i))===e&&(this.log_("listen response",o),c!=="ok"&&this.removeListen_(n,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,r){if(e&&typeof e=="object"&&rs(e,"w")){const n=bl(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const i='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();In(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||ZN(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=d2)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,r=JN(e)?"auth":"gauth",n={cred:e};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(r,n,i=>{const s=i.s,a=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const r=e.s,n=e.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,n)})}unlisten(e,r){const n=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),ke(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,e._queryObject,r)}sendUnlisten_(e,r,n,i){this.log_("Unlisten on "+e+" for "+r);const s={p:e},a="n";i&&(s.q=n,s.t=i),this.sendRequest(a,s)}onDisconnectPut(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:r,onComplete:n})}onDisconnectMerge(e,r,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,r,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:r,onComplete:n})}onDisconnectCancel(e,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(e,r,n,i){const s={p:r,d:n};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,a=>{i&&setTimeout(()=>{i(a.s,a.d)},Math.floor(0))})}put(e,r,n,i){this.putInternal("p",e,r,n,i)}merge(e,r,n,i){this.putInternal("m",e,r,n,i)}putInternal(e,r,n,i,s){this.initConnection_();const a={p:r,d:n};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:e,request:a,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+r)}sendPut_(e){const r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,n=>{if(n.s!=="ok"){const s=n.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ir(e));const r=e.r,n=this.requestCBHash_[r];n&&(delete this.requestCBHash_[r],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,r){this.log_("handleServerMessage",e,r),e==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):e==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):e==="c"?this.onListenRevoked_(r.p,r.q):e==="ac"?this.onAuthRevoked_(r.s,r.d):e==="apc"?this.onAppCheckRevoked_(r.s,r.d):e==="sd"?this.onSecurityDebugPacket_(r):I1("Unrecognized action received from server: "+Ir(e)+`
Are you using the latest client?`)}onReady_(e,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ke(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Nc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Nc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>cP&&(this.reconnectDelay_=Nc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-e);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lP)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+ys.nextConnectionId_++,s=this.lastSessionId;let a=!1,o=null;const l=function(){o?o.close():(a=!0,n())},c=function(d){ke(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);a?$r("getToken() completed but was canceled"):($r("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=h&&h.token,o=new tP(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,r,n,p=>{In(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(uP)},s))}catch(d){this.log_("Failed to get token: "+d),a||(this.repoInfo_.nodeAdmin&&In(d),l())}}}interrupt(e){$r("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){$r("Resuming connection for reason: "+e),delete this.interruptReasons_[e],zy(this.interruptReasons_)&&(this.reconnectDelay_=Nc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const r=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const r=this.outstandingPuts_[e];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,r){let n;r?n=r.map(s=>m_(s)).join("$"):n="default";const i=this.removeListen_(e,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,r){const n=new Vt(e).toString();let i;if(this.listens.has(n)){const s=this.listens.get(n);i=s.get(r),s.delete(r),s.size===0&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(e,r){$r("Auth token revoked: "+e+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=p2&&(this.reconnectDelay_=d2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,r){$r("App check token revoked: "+e+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=p2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const r of e.values())this.sendListen_(r);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let r="js";e["sdk."+r+"."+fS.replace(/\./g,"-")]=1,tS()?e["framework.cordova"]=1:HN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Lh.getInstance().currentlyOnline();return zy(this.interruptReasons_)&&e}}ys.nextPersistentConnectionId_=0;ys.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,r){this.name=e,this.node=r}static Wrap(e,r){return new ct(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,r){const n=new ct(Ll,e),i=new ct(Ll,r);return this.compare(n,i)!==0}minPost(){return ct.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w0;class MS extends Pd{static get __EMPTY_NODE(){return w0}static set __EMPTY_NODE(e){w0=e}compare(e,r){return Co(e.name,r.name)}isDefinedOn(e){throw Zl("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,r){return!1}minPost(){return ct.MIN}maxPost(){return new ct(co,w0)}makePost(e,r){return ke(typeof e=="string","KeyIndex indexValue must always be a string."),new ct(e,w0)}toString(){return".key"}}const vl=new MS;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E0=class{constructor(e,r,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let a=1;for(;!e.isEmpty();)if(e=e,a=r?n(e.key,r):1,i&&(a*=-1),a<0)this.isReverse_?e=e.left:e=e.right;else if(a===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),r;if(this.resultGenerator_?r=this.resultGenerator_(e.key,e.value):r={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return r}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Hn=class Vc{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Vc.RED,this.left=i??Ki.EMPTY_NODE,this.right=s??Ki.EMPTY_NODE}copy(e,r,n,i,s){return new Vc(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i=i.copy(null,r,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ki.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,r){let n,i;if(n=this,r(e,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,r),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),r(e,n.key)===0){if(n.right.isEmpty())return Ki.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,r))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Vc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Vc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Hn.RED=!0;Hn.BLACK=!1;class fP{copy(e,r,n,i,s){return this}insert(e,r,n){return new Hn(e,r,null)}remove(e,r){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Ki=class rh{constructor(e,r=rh.EMPTY_NODE){this.comparator_=e,this.root_=r}insert(e,r){return new rh(this.comparator_,this.root_.insert(e,r,this.comparator_).copy(null,null,Hn.BLACK,null,null))}remove(e){return new rh(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Hn.BLACK,null,null))}get(e){let r,n=this.root_;for(;!n.isEmpty();){if(r=this.comparator_(e,n.key),r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}getPredecessorKey(e){let r,n=this.root_,i=null;for(;!n.isEmpty();)if(r=this.comparator_(e,n.key),r===0){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else r<0?n=n.left:r>0&&(i=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new E0(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,r){return new E0(this.root_,e,this.comparator_,!1,r)}getReverseIteratorFrom(e,r){return new E0(this.root_,e,this.comparator_,!0,r)}getReverseIterator(e){return new E0(this.root_,null,this.comparator_,!0,e)}};Ki.EMPTY_NODE=new fP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(t,e){return Co(t.name,e.name)}function w_(t,e){return Co(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let N1;function dP(t){N1=t}const BS=function(t){return typeof t=="number"?"number:"+mS(t):"string:"+t},VS=function(t){if(t.isLeafNode()){const e=t.val();ke(typeof e=="string"||typeof e=="number"||typeof e=="object"&&rs(e,".sv"),"Priority must be a string or number.")}else ke(t===N1||t.isEmpty(),"priority of unexpected type.");ke(t===N1||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m2;class br{constructor(e,r=br.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=r,this.lazyHash_=null,ke(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),VS(this.priorityNode_)}static set __childrenNodeConstructor(e){m2=e}static get __childrenNodeConstructor(){return m2}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new br(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:br.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ft(e)?this:pt(e)===".priority"?this.priorityNode_:br.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,r){return null}updateImmediateChild(e,r){return e===".priority"?this.updatePriority(r):r.isEmpty()&&e!==".priority"?this:br.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,r).updatePriority(this.priorityNode_)}updateChild(e,r){const n=pt(e);return n===null?r:r.isEmpty()&&n!==".priority"?this:(ke(n!==".priority"||da(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,br.__childrenNodeConstructor.EMPTY_NODE.updateChild(Wt(e),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,r){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+BS(this.priorityNode_.val())+":");const r=typeof this.value_;e+=r+":",r==="number"?e+=mS(this.value_):e+=this.value_,this.lazyHash_=dS(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===br.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof br.__childrenNodeConstructor?-1:(ke(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const r=typeof e.value_,n=typeof this.value_,i=br.VALUE_TYPE_ORDER.indexOf(r),s=br.VALUE_TYPE_ORDER.indexOf(n);return ke(i>=0,"Unknown leaf type: "+r),ke(s>=0,"Unknown leaf type: "+n),i===s?n==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const r=e;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}br.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let US,jS;function pP(t){US=t}function mP(t){jS=t}class gP extends Pd{compare(e,r){const n=e.node.getPriority(),i=r.node.getPriority(),s=n.compareTo(i);return s===0?Co(e.name,r.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,r){return!e.getPriority().equals(r.getPriority())}minPost(){return ct.MIN}maxPost(){return new ct(co,new br("[PRIORITY-POST]",jS))}makePost(e,r){const n=US(e);return new ct(r,new br("[PRIORITY-POST]",n))}toString(){return".priority"}}const ur=new gP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P=Math.log(2);class vP{constructor(e){const r=s=>parseInt(Math.log(s)/_P,10),n=s=>parseInt(Array(s+1).join("1"),2);this.count=r(e+1),this.current_=this.count-1;const i=n(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Mh=function(t,e,r,n){t.sort(e);const i=function(l,c){const u=c-l;let d,h;if(u===0)return null;if(u===1)return d=t[l],h=r?r(d):d,new Hn(h,d.node,Hn.BLACK,null,null);{const p=parseInt(u/2,10)+l,g=i(l,p),x=i(p+1,c);return d=t[p],h=r?r(d):d,new Hn(h,d.node,Hn.BLACK,g,x)}},s=function(l){let c=null,u=null,d=t.length;const h=function(g,x){const _=d-g,m=d;d-=g;const w=i(_+1,m),v=t[_],R=r?r(v):v;p(new Hn(R,v.node,x,null,w))},p=function(g){c?(c.left=g,c=g):(u=g,c=g)};for(let g=0;g<l.count;++g){const x=l.nextBitIsOne(),_=Math.pow(2,l.count-(g+1));x?h(_,Hn.BLACK):(h(_,Hn.BLACK),h(_,Hn.RED))}return u},a=new vP(t.length),o=s(a);return new Ki(n||e,o)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;const zo={};class gs{constructor(e,r){this.indexes_=e,this.indexSet_=r}static get Default(){return ke(zo&&ur,"ChildrenNode.ts has not been loaded"),Zp=Zp||new gs({".priority":zo},{".priority":ur}),Zp}get(e){const r=bl(this.indexes_,e);if(!r)throw new Error("No index defined for "+e);return r instanceof Ki?r:null}hasIndex(e){return rs(this.indexSet_,e.toString())}addIndex(e,r){ke(e!==vl,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const s=r.getIterator(ct.Wrap);let a=s.getNext();for(;a;)i=i||e.isDefinedOn(a.node),n.push(a),a=s.getNext();let o;i?o=Mh(n,e.getCompare()):o=zo;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=o,new gs(u,c)}addToIndexes(e,r){const n=bh(this.indexes_,(i,s)=>{const a=bl(this.indexSet_,s);if(ke(a,"Missing index implementation for "+s),i===zo)if(a.isDefinedOn(e.node)){const o=[],l=r.getIterator(ct.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&o.push(c),c=l.getNext();return o.push(e),Mh(o,a.getCompare())}else return zo;else{const o=r.get(e.name);let l=i;return o&&(l=l.remove(new ct(e.name,o))),l.insert(e,e.node)}});return new gs(n,this.indexSet_)}removeFromIndexes(e,r){const n=bh(this.indexes_,i=>{if(i===zo)return i;{const s=r.get(e.name);return s?i.remove(new ct(e.name,s)):i}});return new gs(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rc;class Xe{constructor(e,r,n){this.children_=e,this.priorityNode_=r,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&VS(this.priorityNode_),this.children_.isEmpty()&&ke(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Rc||(Rc=new Xe(new Ki(w_),null,gs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Rc}updatePriority(e){return this.children_.isEmpty()?this:new Xe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const r=this.children_.get(e);return r===null?Rc:r}}getChild(e){const r=pt(e);return r===null?this:this.getImmediateChild(r).getChild(Wt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,r){if(ke(r,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(r);{const n=new ct(e,r);let i,s;r.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(e,r),s=this.indexMap_.addToIndexes(n,this.children_));const a=i.isEmpty()?Rc:this.priorityNode_;return new Xe(i,a,s)}}updateChild(e,r){const n=pt(e);if(n===null)return r;{ke(pt(e)!==".priority"||da(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(Wt(e),r);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const r={};let n=0,i=0,s=!0;if(this.forEachChild(ur,(a,o)=>{r[a]=o.val(e),n++,s&&Xe.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):s=!1}),!e&&s&&i<2*n){const a=[];for(const o in r)a[o]=r[o];return a}else return e&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+BS(this.getPriority().val())+":"),this.forEachChild(ur,(r,n)=>{const i=n.hash();i!==""&&(e+=":"+r+":"+i)}),this.lazyHash_=e===""?"":dS(e)}return this.lazyHash_}getPredecessorChildName(e,r,n){const i=this.resolveIndex_(n);if(i){const s=i.getPredecessorKey(new ct(e,r));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(e){const r=this.getFirstChildName(e);return r?new ct(r,this.children_.get(r)):null}getLastChildName(e){const r=this.resolveIndex_(e);if(r){const n=r.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(e){const r=this.getLastChildName(e);return r?new ct(r,this.children_.get(r)):null}forEachChild(e,r){const n=this.resolveIndex_(e);return n?n.inorderTraversal(i=>r(i.name,i.node)):this.children_.inorderTraversal(r)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ct.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,r){const n=this.resolveIndex_(r);if(n)return n.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ct.Wrap);let s=i.peek();for(;s!=null&&r.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Cf?-1:0}withIndex(e){if(e===vl||this.indexMap_.hasIndex(e))return this;{const r=this.indexMap_.addIndex(e,this.children_);return new Xe(this.children_,this.priorityNode_,r)}}isIndexed(e){return e===vl||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const r=e;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){const n=this.getIterator(ur),i=r.getIterator(ur);let s=n.getNext(),a=i.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=n.getNext(),a=i.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(e){return e===vl?null:this.indexMap_.get(e.toString())}}Xe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xP extends Xe{constructor(){super(new Ki(w_),Xe.EMPTY_NODE,gs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Xe.EMPTY_NODE}isEmpty(){return!1}}const Cf=new xP;Object.defineProperties(ct,{MIN:{value:new ct(Ll,Xe.EMPTY_NODE)},MAX:{value:new ct(co,Cf)}});MS.__EMPTY_NODE=Xe.EMPTY_NODE;br.__childrenNodeConstructor=Xe;dP(Cf);mP(Cf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP=!0;function Ar(t,e=null){if(t===null)return Xe.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),ke(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const r=t;return new br(r,Ar(e))}if(!(t instanceof Array)&&yP){const r=[];let n=!1;if(Yr(t,(a,o)=>{if(a.substring(0,1)!=="."){const l=Ar(o);l.isEmpty()||(n=n||!l.getPriority().isEmpty(),r.push(new ct(a,l)))}}),r.length===0)return Xe.EMPTY_NODE;const s=Mh(r,hP,a=>a.name,w_);if(n){const a=Mh(r,ur.getCompare());return new Xe(s,Ar(e),new gs({".priority":a},{".priority":ur}))}else return new Xe(s,Ar(e),gs.Default)}else{let r=Xe.EMPTY_NODE;return Yr(t,(n,i)=>{if(rs(t,n)&&n.substring(0,1)!=="."){const s=Ar(i);(s.isLeafNode()||!s.isEmpty())&&(r=r.updateImmediateChild(n,s))}}),r.updatePriority(Ar(e))}}pP(Ar);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP extends Pd{constructor(e){super(),this.indexPath_=e,ke(!ft(e)&&pt(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,r){const n=this.extractChild(e.node),i=this.extractChild(r.node),s=n.compareTo(i);return s===0?Co(e.name,r.name):s}makePost(e,r){const n=Ar(e),i=Xe.EMPTY_NODE.updateChild(this.indexPath_,n);return new ct(r,i)}maxPost(){const e=Xe.EMPTY_NODE.updateChild(this.indexPath_,Cf);return new ct(co,e)}toString(){return ju(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP extends Pd{compare(e,r){const n=e.node.compareTo(r.node);return n===0?Co(e.name,r.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,r){return!e.equals(r)}minPost(){return ct.MIN}maxPost(){return ct.MAX}makePost(e,r){const n=Ar(e);return new ct(r,n)}toString(){return".value"}}const TP=new EP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(t){return{type:"value",snapshotNode:t}}function Ml(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Wu(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function zu(t,e,r){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:r}}function kP(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(e){this.index_=e}updateChild(e,r,n,i,s,a){ke(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(r);return o.getChild(i).equals(n.getChild(i))&&o.isEmpty()===n.isEmpty()||(a!=null&&(n.isEmpty()?e.hasChild(r)?a.trackChildChange(Wu(r,o)):ke(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(Ml(r,n)):a.trackChildChange(zu(r,n,o))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(r,n).withIndex(this.index_)}updateFullNode(e,r,n){return n!=null&&(e.isLeafNode()||e.forEachChild(ur,(i,s)=>{r.hasChild(i)||n.trackChildChange(Wu(i,s))}),r.isLeafNode()||r.forEachChild(ur,(i,s)=>{if(e.hasChild(i)){const a=e.getImmediateChild(i);a.equals(s)||n.trackChildChange(zu(i,s,a))}else n.trackChildChange(Ml(i,s))})),r.withIndex(this.index_)}updatePriority(e,r){return e.isEmpty()?Xe.EMPTY_NODE:e.updatePriority(r)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e){this.indexedFilter_=new E_(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Hu.getStartPost_(e),this.endPost_=Hu.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const r=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return r&&n}updateChild(e,r,n,i,s,a){return this.matches(new ct(r,n))||(n=Xe.EMPTY_NODE),this.indexedFilter_.updateChild(e,r,n,i,s,a)}updateFullNode(e,r,n){r.isLeafNode()&&(r=Xe.EMPTY_NODE);let i=r.withIndex(this.index_);i=i.updatePriority(Xe.EMPTY_NODE);const s=this;return r.forEachChild(ur,(a,o)=>{s.matches(new ct(a,o))||(i=i.updateImmediateChild(a,Xe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,n)}updatePriority(e,r){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const r=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),r)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const r=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),r)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e){this.withinDirectionalStart=r=>this.reverse_?this.withinEndPost(r):this.withinStartPost(r),this.withinDirectionalEnd=r=>this.reverse_?this.withinStartPost(r):this.withinEndPost(r),this.withinStartPost=r=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),r);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=r=>{const n=this.index_.compare(r,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new Hu(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,r,n,i,s,a){return this.rangedFilter_.matches(new ct(r,n))||(n=Xe.EMPTY_NODE),e.getImmediateChild(r).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,r,n,i,s,a):this.fullLimitUpdateChild_(e,r,n,s,a)}updateFullNode(e,r,n){let i;if(r.isLeafNode()||r.isEmpty())i=Xe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<r.numChildren()&&r.isIndexed(this.index_)){i=Xe.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=r.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=r.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let a=0;for(;s.hasNext()&&a<this.limit_;){const o=s.getNext();if(this.withinDirectionalStart(o))if(this.withinDirectionalEnd(o))i=i.updateImmediateChild(o.name,o.node),a++;else break;else continue}}else{i=r.withIndex(this.index_),i=i.updatePriority(Xe.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let a=0;for(;s.hasNext();){const o=s.getNext();a<this.limit_&&this.withinDirectionalStart(o)&&this.withinDirectionalEnd(o)?a++:i=i.updateImmediateChild(o.name,Xe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,n)}updatePriority(e,r){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,r,n,i,s){let a;if(this.reverse_){const d=this.index_.getCompare();a=(h,p)=>d(p,h)}else a=this.index_.getCompare();const o=e;ke(o.numChildren()===this.limit_,"");const l=new ct(r,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(o.hasChild(r)){const d=o.getImmediateChild(r);let h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===r||o.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const p=h==null?1:a(h,l);if(u&&!n.isEmpty()&&p>=0)return s!=null&&s.trackChildChange(zu(r,n,d)),o.updateImmediateChild(r,n);{s!=null&&s.trackChildChange(Wu(r,d));const x=o.updateImmediateChild(r,Xe.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s!=null&&s.trackChildChange(Ml(h.name,h.node)),x.updateImmediateChild(h.name,h.node)):x}}else return n.isEmpty()?e:u&&a(c,l)>=0?(s!=null&&(s.trackChildChange(Wu(c.name,c.node)),s.trackChildChange(Ml(r,n))),o.updateImmediateChild(r,n).updateImmediateChild(c.name,Xe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ur}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ke(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ke(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ll}hasEnd(){return this.endSet_}getIndexEndValue(){return ke(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ke(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:co}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ke(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ur}copy(){const e=new T_;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function CP(t){return t.loadsAllData()?new E_(t.getIndex()):t.hasLimit()?new SP(t):new Hu(t)}function g2(t){const e={};if(t.isDefault())return e;let r;if(t.index_===ur?r="$priority":t.index_===TP?r="$value":t.index_===vl?r="$key":(ke(t.index_ instanceof wP,"Unrecognized index type!"),r=t.index_.toString()),e.orderBy=Ir(r),t.startSet_){const n=t.startAfterSet_?"startAfter":"startAt";e[n]=Ir(t.indexStartValue_),t.startNameSet_&&(e[n]+=","+Ir(t.indexStartName_))}if(t.endSet_){const n=t.endBeforeSet_?"endBefore":"endAt";e[n]=Ir(t.indexEndValue_),t.endNameSet_&&(e[n]+=","+Ir(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function _2(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let r=t.viewFrom_;r===""&&(t.isViewFromLeft()?r="l":r="r"),e.vf=r}return t.index_!==ur&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh extends PS{constructor(e,r,n,i){super(),this.repoInfo_=e,this.onDataUpdate_=r,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=Sf("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,r){return r!==void 0?"tag$"+r:(ke(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,r,n,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const a=Bh.getListenId_(e,n),o={};this.listens_[a]=o;const l=g2(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,n),bl(this.listens_,a)===o){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,r){const n=Bh.getListenId_(e,r);delete this.listens_[n]}get(e){const r=g2(e._queryParams),n=e._path.toString(),i=new Tf;return this.restRequest_(n+".json",r,(s,a)=>{let o=a;s===404&&(o=null,s=null),s===null?(this.onDataUpdate_(n,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise}refreshAuthToken(e){}restRequest_(e,r={},n){return r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(r.auth=i.accessToken),s&&s.token&&(r.ac=s.token);const a=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+eR(r);this.log_("Sending REST request for "+a);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&o.readyState===4){this.log_("REST Response for "+a+" received. status:",o.status,"response:",o.responseText);let l=null;if(o.status>=200&&o.status<300){try{l=Lu(o.responseText)}catch{In("Failed to parse JSON response for "+a+": "+o.responseText)}n(null,l)}else o.status!==401&&o.status!==404&&In("Got unsuccessful REST response for "+a+" Status: "+o.status),n(o.status);n=null}},o.open("GET",a,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(){this.rootNode_=Xe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,r){this.rootNode_=this.rootNode_.updateChild(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(){return{value:null,children:new Map}}function zS(t,e,r){if(ft(e))t.value=r,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,r);else{const n=pt(e);t.children.has(n)||t.children.set(n,Vh());const i=t.children.get(n);e=Wt(e),zS(i,e,r)}}function R1(t,e,r){t.value!==null?r(e,t.value):IP(t,(n,i)=>{const s=new Vt(e.toString()+"/"+n);R1(i,s,r)})}function IP(t,e){t.children.forEach((r,n)=>{e(n,r)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),r=Object.assign({},e);return this.last_&&Yr(this.last_,(n,i)=>{r[n]=r[n]-i}),this.last_=e,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=10*1e3,NP=30*1e3,RP=5*60*1e3;class PP{constructor(e,r){this.server_=r,this.statsToReport_={},this.statsListener_=new FP(e);const n=v2+(NP-v2)*Math.random();ru(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),r={};let n=!1;Yr(e,(i,s)=>{s>0&&rs(this.statsToReport_,i)&&(r[i]=s,n=!0)}),n&&this.server_.reportStats(r),ru(this.reportStats_.bind(this),Math.floor(Math.random()*2*RP))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ai;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ai||(Ai={}));function k_(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function S_(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function C_(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,r,n){this.path=e,this.affectedTree=r,this.revert=n,this.type=Ai.ACK_USER_WRITE,this.source=k_()}operationForChild(e){if(ft(this.path)){if(this.affectedTree.value!=null)return ke(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const r=this.affectedTree.subtree(new Vt(e));return new Uh(kt(),r,this.revert)}}else return ke(pt(this.path)===e,"operationForChild called for unrelated child."),new Uh(Wt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,r){this.source=e,this.path=r,this.type=Ai.LISTEN_COMPLETE}operationForChild(e){return ft(this.path)?new $u(this.source,kt()):new $u(this.source,Wt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,r,n){this.source=e,this.path=r,this.snap=n,this.type=Ai.OVERWRITE}operationForChild(e){return ft(this.path)?new uo(this.source,kt(),this.snap.getImmediateChild(e)):new uo(this.source,Wt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,r,n){this.source=e,this.path=r,this.children=n,this.type=Ai.MERGE}operationForChild(e){if(ft(this.path)){const r=this.children.subtree(new Vt(e));return r.isEmpty()?null:r.value?new uo(this.source,kt(),r.value):new Bl(this.source,kt(),r)}else return ke(pt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Bl(this.source,Wt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,r,n){this.node_=e,this.fullyInitialized_=r,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ft(e))return this.isFullyInitialized()&&!this.filtered_;const r=pt(e);return this.isCompleteForChild(r)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function bP(t,e,r,n){const i=[],s=[];return e.forEach(a=>{a.type==="child_changed"&&t.index_.indexedValueChanged(a.oldSnap,a.snapshotNode)&&s.push(kP(a.childName,a.snapshotNode))}),Pc(t,i,"child_removed",e,n,r),Pc(t,i,"child_added",e,n,r),Pc(t,i,"child_moved",s,n,r),Pc(t,i,"child_changed",e,n,r),Pc(t,i,"value",e,n,r),i}function Pc(t,e,r,n,i,s){const a=n.filter(o=>o.type===r);a.sort((o,l)=>LP(t,o,l)),a.forEach(o=>{const l=OP(t,o,s);i.forEach(c=>{c.respondsTo(o.type)&&e.push(c.createEvent(l,t.query_))})})}function OP(t,e,r){return e.type==="value"||e.type==="child_removed"||(e.prevName=r.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function LP(t,e,r){if(e.childName==null||r.childName==null)throw Zl("Should only compare child_ events.");const n=new ct(e.childName,e.snapshotNode),i=new ct(r.childName,r.snapshotNode);return t.index_.compare(n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(t,e){return{eventCache:t,serverCache:e}}function nu(t,e,r,n){return Dd(new pa(e,r,n),t.serverCache)}function HS(t,e,r,n){return Dd(t.eventCache,new pa(e,r,n))}function jh(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function fo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let em;const MP=()=>(em||(em=new Ki(w6)),em);class jt{constructor(e,r=MP()){this.value=e,this.children=r}static fromObject(e){let r=new jt(null);return Yr(e,(n,i)=>{r=r.set(new Vt(n),i)}),r}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,r){if(this.value!=null&&r(this.value))return{path:kt(),value:this.value};if(ft(e))return null;{const n=pt(e),i=this.children.get(n);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Wt(e),r);return s!=null?{path:cr(new Vt(n),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ft(e))return this;{const r=pt(e),n=this.children.get(r);return n!==null?n.subtree(Wt(e)):new jt(null)}}set(e,r){if(ft(e))return new jt(r,this.children);{const n=pt(e),s=(this.children.get(n)||new jt(null)).set(Wt(e),r),a=this.children.insert(n,s);return new jt(this.value,a)}}remove(e){if(ft(e))return this.children.isEmpty()?new jt(null):new jt(null,this.children);{const r=pt(e),n=this.children.get(r);if(n){const i=n.remove(Wt(e));let s;return i.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,i),this.value===null&&s.isEmpty()?new jt(null):new jt(this.value,s)}else return this}}get(e){if(ft(e))return this.value;{const r=pt(e),n=this.children.get(r);return n?n.get(Wt(e)):null}}setTree(e,r){if(ft(e))return r;{const n=pt(e),s=(this.children.get(n)||new jt(null)).setTree(Wt(e),r);let a;return s.isEmpty()?a=this.children.remove(n):a=this.children.insert(n,s),new jt(this.value,a)}}fold(e){return this.fold_(kt(),e)}fold_(e,r){const n={};return this.children.inorderTraversal((i,s)=>{n[i]=s.fold_(cr(e,i),r)}),r(e,this.value,n)}findOnPath(e,r){return this.findOnPath_(e,kt(),r)}findOnPath_(e,r,n){const i=this.value?n(r,this.value):!1;if(i)return i;if(ft(e))return null;{const s=pt(e),a=this.children.get(s);return a?a.findOnPath_(Wt(e),cr(r,s),n):null}}foreachOnPath(e,r){return this.foreachOnPath_(e,kt(),r)}foreachOnPath_(e,r,n){if(ft(e))return this;{this.value&&n(r,this.value);const i=pt(e),s=this.children.get(i);return s?s.foreachOnPath_(Wt(e),cr(r,i),n):new jt(null)}}foreach(e){this.foreach_(kt(),e)}foreach_(e,r){this.children.inorderTraversal((n,i)=>{i.foreach_(cr(e,n),r)}),this.value&&r(e,this.value)}foreachChild(e){this.children.inorderTraversal((r,n)=>{n.value&&e(r,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.writeTree_=e}static empty(){return new Pi(new jt(null))}}function iu(t,e,r){if(ft(e))return new Pi(new jt(r));{const n=t.writeTree_.findRootMostValueAndPath(e);if(n!=null){const i=n.path;let s=n.value;const a=Cn(i,e);return s=s.updateChild(a,r),new Pi(t.writeTree_.set(i,s))}else{const i=new jt(r),s=t.writeTree_.setTree(e,i);return new Pi(s)}}}function P1(t,e,r){let n=t;return Yr(r,(i,s)=>{n=iu(n,cr(e,i),s)}),n}function x2(t,e){if(ft(e))return Pi.empty();{const r=t.writeTree_.setTree(e,new jt(null));return new Pi(r)}}function D1(t,e){return Ao(t,e)!=null}function Ao(t,e){const r=t.writeTree_.findRootMostValueAndPath(e);return r!=null?t.writeTree_.get(r.path).getChild(Cn(r.path,e)):null}function y2(t){const e=[],r=t.writeTree_.value;return r!=null?r.isLeafNode()||r.forEachChild(ur,(n,i)=>{e.push(new ct(n,i))}):t.writeTree_.children.inorderTraversal((n,i)=>{i.value!=null&&e.push(new ct(n,i.value))}),e}function la(t,e){if(ft(e))return t;{const r=Ao(t,e);return r!=null?new Pi(new jt(r)):new Pi(t.writeTree_.subtree(e))}}function b1(t){return t.writeTree_.isEmpty()}function Vl(t,e){return $S(kt(),t.writeTree_,e)}function $S(t,e,r){if(e.value!=null)return r.updateChild(t,e.value);{let n=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(ke(s.value!==null,"Priority writes must always be leaf nodes"),n=s.value):r=$S(cr(t,i),s,r)}),!r.getChild(t).isEmpty()&&n!==null&&(r=r.updateChild(cr(t,".priority"),n)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(t,e){return qS(e,t)}function BP(t,e,r,n,i){ke(n>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:r,writeId:n,visible:i}),i&&(t.visibleWrites=iu(t.visibleWrites,e,r)),t.lastWriteId=n}function VP(t,e,r,n){ke(n>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:r,writeId:n,visible:!0}),t.visibleWrites=P1(t.visibleWrites,e,r),t.lastWriteId=n}function UP(t,e){for(let r=0;r<t.allWrites.length;r++){const n=t.allWrites[r];if(n.writeId===e)return n}return null}function jP(t,e){const r=t.allWrites.findIndex(o=>o.writeId===e);ke(r>=0,"removeWrite called with nonexistent writeId.");const n=t.allWrites[r];t.allWrites.splice(r,1);let i=n.visible,s=!1,a=t.allWrites.length-1;for(;i&&a>=0;){const o=t.allWrites[a];o.visible&&(a>=r&&WP(o,n.path)?i=!1:ui(n.path,o.path)&&(s=!0)),a--}if(i){if(s)return zP(t),!0;if(n.snap)t.visibleWrites=x2(t.visibleWrites,n.path);else{const o=n.children;Yr(o,l=>{t.visibleWrites=x2(t.visibleWrites,cr(n.path,l))})}return!0}else return!1}function WP(t,e){if(t.snap)return ui(t.path,e);for(const r in t.children)if(t.children.hasOwnProperty(r)&&ui(cr(t.path,r),e))return!0;return!1}function zP(t){t.visibleWrites=GS(t.allWrites,HP,kt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function HP(t){return t.visible}function GS(t,e,r){let n=Pi.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const a=s.path;let o;if(s.snap)ui(r,a)?(o=Cn(r,a),n=iu(n,o,s.snap)):ui(a,r)&&(o=Cn(a,r),n=iu(n,kt(),s.snap.getChild(o)));else if(s.children){if(ui(r,a))o=Cn(r,a),n=P1(n,o,s.children);else if(ui(a,r))if(o=Cn(a,r),ft(o))n=P1(n,kt(),s.children);else{const l=bl(s.children,pt(o));if(l){const c=l.getChild(Wt(o));n=iu(n,kt(),c)}}}else throw Zl("WriteRecord should have .snap or .children")}}return n}function XS(t,e,r,n,i){if(!n&&!i){const s=Ao(t.visibleWrites,e);if(s!=null)return s;{const a=la(t.visibleWrites,e);if(b1(a))return r;if(r==null&&!D1(a,kt()))return null;{const o=r||Xe.EMPTY_NODE;return Vl(a,o)}}}else{const s=la(t.visibleWrites,e);if(!i&&b1(s))return r;if(!i&&r==null&&!D1(s,kt()))return null;{const a=function(c){return(c.visible||i)&&(!n||!~n.indexOf(c.writeId))&&(ui(c.path,e)||ui(e,c.path))},o=GS(t.allWrites,a,e),l=r||Xe.EMPTY_NODE;return Vl(o,l)}}}function $P(t,e,r){let n=Xe.EMPTY_NODE;const i=Ao(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ur,(s,a)=>{n=n.updateImmediateChild(s,a)}),n;if(r){const s=la(t.visibleWrites,e);return r.forEachChild(ur,(a,o)=>{const l=Vl(la(s,new Vt(a)),o);n=n.updateImmediateChild(a,l)}),y2(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}else{const s=la(t.visibleWrites,e);return y2(s).forEach(a=>{n=n.updateImmediateChild(a.name,a.node)}),n}}function GP(t,e,r,n,i){ke(n||i,"Either existingEventSnap or existingServerSnap must exist");const s=cr(e,r);if(D1(t.visibleWrites,s))return null;{const a=la(t.visibleWrites,s);return b1(a)?i.getChild(r):Vl(a,i.getChild(r))}}function XP(t,e,r,n){const i=cr(e,r),s=Ao(t.visibleWrites,i);if(s!=null)return s;if(n.isCompleteForChild(r)){const a=la(t.visibleWrites,i);return Vl(a,n.getNode().getImmediateChild(r))}else return null}function KP(t,e){return Ao(t.visibleWrites,e)}function qP(t,e,r,n,i,s,a){let o;const l=la(t.visibleWrites,e),c=Ao(l,kt());if(c!=null)o=c;else if(r!=null)o=Vl(l,r);else return[];if(o=o.withIndex(a),!o.isEmpty()&&!o.isLeafNode()){const u=[],d=a.getCompare(),h=s?o.getReverseIteratorFrom(n,a):o.getIteratorFrom(n,a);let p=h.getNext();for(;p&&u.length<i;)d(p,n)!==0&&u.push(p),p=h.getNext();return u}else return[]}function YP(){return{visibleWrites:Pi.empty(),allWrites:[],lastWriteId:-1}}function Wh(t,e,r,n){return XS(t.writeTree,t.treePath,e,r,n)}function A_(t,e){return $P(t.writeTree,t.treePath,e)}function w2(t,e,r,n){return GP(t.writeTree,t.treePath,e,r,n)}function zh(t,e){return KP(t.writeTree,cr(t.treePath,e))}function QP(t,e,r,n,i,s){return qP(t.writeTree,t.treePath,e,r,n,i,s)}function I_(t,e,r){return XP(t.writeTree,t.treePath,e,r)}function KS(t,e){return qS(cr(t.treePath,e),t.writeTree)}function qS(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(){this.changeMap=new Map}trackChildChange(e){const r=e.type,n=e.childName;ke(r==="child_added"||r==="child_changed"||r==="child_removed","Only child changes supported for tracking"),ke(n!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const s=i.type;if(r==="child_added"&&s==="child_removed")this.changeMap.set(n,zu(n,e.snapshotNode,i.snapshotNode));else if(r==="child_removed"&&s==="child_added")this.changeMap.delete(n);else if(r==="child_removed"&&s==="child_changed")this.changeMap.set(n,Wu(n,i.oldSnap));else if(r==="child_changed"&&s==="child_added")this.changeMap.set(n,Ml(n,e.snapshotNode));else if(r==="child_changed"&&s==="child_changed")this.changeMap.set(n,zu(n,e.snapshotNode,i.oldSnap));else throw Zl("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{getCompleteChild(e){return null}getChildAfterChild(e,r,n){return null}}const YS=new ZP;class F_{constructor(e,r,n=null){this.writes_=e,this.viewCache_=r,this.optCompleteServerCache_=n}getCompleteChild(e){const r=this.viewCache_.eventCache;if(r.isCompleteForChild(e))return r.getNode().getImmediateChild(e);{const n=this.optCompleteServerCache_!=null?new pa(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return I_(this.writes_,e,n)}}getChildAfterChild(e,r,n){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:fo(this.viewCache_),s=QP(this.writes_,i,r,1,n,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(t){return{filter:t}}function tD(t,e){ke(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),ke(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function rD(t,e,r,n,i){const s=new JP;let a,o;if(r.type===Ai.OVERWRITE){const c=r;c.source.fromUser?a=O1(t,e,c.path,c.snap,n,i,s):(ke(c.source.fromServer,"Unknown source."),o=c.source.tagged||e.serverCache.isFiltered()&&!ft(c.path),a=Hh(t,e,c.path,c.snap,n,i,o,s))}else if(r.type===Ai.MERGE){const c=r;c.source.fromUser?a=iD(t,e,c.path,c.children,n,i,s):(ke(c.source.fromServer,"Unknown source."),o=c.source.tagged||e.serverCache.isFiltered(),a=L1(t,e,c.path,c.children,n,i,o,s))}else if(r.type===Ai.ACK_USER_WRITE){const c=r;c.revert?a=oD(t,e,c.path,n,i,s):a=sD(t,e,c.path,c.affectedTree,n,i,s)}else if(r.type===Ai.LISTEN_COMPLETE)a=aD(t,e,r.path,n,s);else throw Zl("Unknown operation type: "+r.type);const l=s.getChanges();return nD(e,a,l),{viewCache:a,changes:l}}function nD(t,e,r){const n=e.eventCache;if(n.isFullyInitialized()){const i=n.getNode().isLeafNode()||n.getNode().isEmpty(),s=jh(t);(r.length>0||!t.eventCache.isFullyInitialized()||i&&!n.getNode().equals(s)||!n.getNode().getPriority().equals(s.getPriority()))&&r.push(WS(jh(e)))}}function QS(t,e,r,n,i,s){const a=e.eventCache;if(zh(n,r)!=null)return e;{let o,l;if(ft(r))if(ke(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=fo(e),u=c instanceof Xe?c:Xe.EMPTY_NODE,d=A_(n,u);o=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{const c=Wh(n,fo(e));o=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=pt(r);if(c===".priority"){ke(da(r)===1,"Can't have a priority with additional path components");const u=a.getNode();l=e.serverCache.getNode();const d=w2(n,r,u,l);d!=null?o=t.filter.updatePriority(u,d):o=a.getNode()}else{const u=Wt(r);let d;if(a.isCompleteForChild(c)){l=e.serverCache.getNode();const h=w2(n,r,a.getNode(),l);h!=null?d=a.getNode().getImmediateChild(c).updateChild(u,h):d=a.getNode().getImmediateChild(c)}else d=I_(n,c,e.serverCache);d!=null?o=t.filter.updateChild(a.getNode(),c,d,u,i,s):o=a.getNode()}}return nu(e,o,a.isFullyInitialized()||ft(r),t.filter.filtersNodes())}}function Hh(t,e,r,n,i,s,a,o){const l=e.serverCache;let c;const u=a?t.filter:t.filter.getIndexedFilter();if(ft(r))c=u.updateFullNode(l.getNode(),n,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(r,n);c=u.updateFullNode(l.getNode(),p,null)}else{const p=pt(r);if(!l.isCompleteForPath(r)&&da(r)>1)return e;const g=Wt(r),_=l.getNode().getImmediateChild(p).updateChild(g,n);p===".priority"?c=u.updatePriority(l.getNode(),_):c=u.updateChild(l.getNode(),p,_,g,YS,null)}const d=HS(e,c,l.isFullyInitialized()||ft(r),u.filtersNodes()),h=new F_(i,d,s);return QS(t,d,r,i,h,o)}function O1(t,e,r,n,i,s,a){const o=e.eventCache;let l,c;const u=new F_(i,e,s);if(ft(r))c=t.filter.updateFullNode(e.eventCache.getNode(),n,a),l=nu(e,c,!0,t.filter.filtersNodes());else{const d=pt(r);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),n),l=nu(e,c,o.isFullyInitialized(),o.isFiltered());else{const h=Wt(r),p=o.getNode().getImmediateChild(d);let g;if(ft(h))g=n;else{const x=u.getCompleteChild(d);x!=null?x_(h)===".priority"&&x.getChild(bS(h)).isEmpty()?g=x:g=x.updateChild(h,n):g=Xe.EMPTY_NODE}if(p.equals(g))l=e;else{const x=t.filter.updateChild(o.getNode(),d,g,h,u,a);l=nu(e,x,o.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function E2(t,e){return t.eventCache.isCompleteForChild(e)}function iD(t,e,r,n,i,s,a){let o=e;return n.foreach((l,c)=>{const u=cr(r,l);E2(e,pt(u))&&(o=O1(t,o,u,c,i,s,a))}),n.foreach((l,c)=>{const u=cr(r,l);E2(e,pt(u))||(o=O1(t,o,u,c,i,s,a))}),o}function T2(t,e,r){return r.foreach((n,i)=>{e=e.updateChild(n,i)}),e}function L1(t,e,r,n,i,s,a,o){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ft(r)?c=n:c=new jt(null).setTree(r,n);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){const p=e.serverCache.getNode().getImmediateChild(d),g=T2(t,p,h);l=Hh(t,l,new Vt(d),g,i,s,a,o)}}),c.children.inorderTraversal((d,h)=>{const p=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!p){const g=e.serverCache.getNode().getImmediateChild(d),x=T2(t,g,h);l=Hh(t,l,new Vt(d),x,i,s,a,o)}}),l}function sD(t,e,r,n,i,s,a){if(zh(i,r)!=null)return e;const o=e.serverCache.isFiltered(),l=e.serverCache;if(n.value!=null){if(ft(r)&&l.isFullyInitialized()||l.isCompleteForPath(r))return Hh(t,e,r,l.getNode().getChild(r),i,s,o,a);if(ft(r)){let c=new jt(null);return l.getNode().forEachChild(vl,(u,d)=>{c=c.set(new Vt(u),d)}),L1(t,e,r,c,i,s,o,a)}else return e}else{let c=new jt(null);return n.foreach((u,d)=>{const h=cr(r,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),L1(t,e,r,c,i,s,o,a)}}function aD(t,e,r,n,i){const s=e.serverCache,a=HS(e,s.getNode(),s.isFullyInitialized()||ft(r),s.isFiltered());return QS(t,a,r,n,YS,i)}function oD(t,e,r,n,i,s){let a;if(zh(n,r)!=null)return e;{const o=new F_(n,e,i),l=e.eventCache.getNode();let c;if(ft(r)||pt(r)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Wh(n,fo(e));else{const d=e.serverCache.getNode();ke(d instanceof Xe,"serverChildren would be complete if leaf node"),u=A_(n,d)}u=u,c=t.filter.updateFullNode(l,u,s)}else{const u=pt(r);let d=I_(n,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,Wt(r),o,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,Xe.EMPTY_NODE,Wt(r),o,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=Wh(n,fo(e)),a.isLeafNode()&&(c=t.filter.updateFullNode(c,a,s)))}return a=e.serverCache.isFullyInitialized()||zh(n,kt())!=null,nu(e,c,a,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,r){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new E_(n.getIndex()),s=CP(n);this.processor_=eD(s);const a=r.serverCache,o=r.eventCache,l=i.updateFullNode(Xe.EMPTY_NODE,a.getNode(),null),c=s.updateFullNode(Xe.EMPTY_NODE,o.getNode(),null),u=new pa(l,a.isFullyInitialized(),i.filtersNodes()),d=new pa(c,o.isFullyInitialized(),s.filtersNodes());this.viewCache_=Dd(d,u),this.eventGenerator_=new DP(this.query_)}get query(){return this.query_}}function cD(t){return t.viewCache_.serverCache.getNode()}function uD(t){return jh(t.viewCache_)}function fD(t,e){const r=fo(t.viewCache_);return r&&(t.query._queryParams.loadsAllData()||!ft(e)&&!r.getImmediateChild(pt(e)).isEmpty())?r.getChild(e):null}function k2(t){return t.eventRegistrations_.length===0}function hD(t,e){t.eventRegistrations_.push(e)}function S2(t,e,r){const n=[];if(r){ke(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const a=s.createCancelEvent(r,i);a&&n.push(a)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const a=t.eventRegistrations_[s];if(!a.matches(e))i.push(a);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return n}function C2(t,e,r,n){e.type===Ai.MERGE&&e.source.queryId!==null&&(ke(fo(t.viewCache_),"We should always have a full cache before handling merges"),ke(jh(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=rD(t.processor_,i,e,r,n);return tD(t.processor_,s.viewCache),ke(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,JS(t,s.changes,s.viewCache.eventCache.getNode(),null)}function dD(t,e){const r=t.viewCache_.eventCache,n=[];return r.getNode().isLeafNode()||r.getNode().forEachChild(ur,(s,a)=>{n.push(Ml(s,a))}),r.isFullyInitialized()&&n.push(WS(r.getNode())),JS(t,n,r.getNode(),e)}function JS(t,e,r,n){const i=n?[n]:t.eventRegistrations_;return bP(t.eventGenerator_,e,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $h;class ZS{constructor(){this.views=new Map}}function pD(t){ke(!$h,"__referenceConstructor has already been defined"),$h=t}function mD(){return ke($h,"Reference.ts has not been loaded"),$h}function gD(t){return t.views.size===0}function N_(t,e,r,n){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return ke(s!=null,"SyncTree gave us an op for an invalid query."),C2(s,e,r,n)}else{let s=[];for(const a of t.views.values())s=s.concat(C2(a,e,r,n));return s}}function e4(t,e,r,n,i){const s=e._queryIdentifier,a=t.views.get(s);if(!a){let o=Wh(r,i?n:null),l=!1;o?l=!0:n instanceof Xe?(o=A_(r,n),l=!1):(o=Xe.EMPTY_NODE,l=!1);const c=Dd(new pa(o,l,!1),new pa(n,i,!1));return new lD(e,c)}return a}function _D(t,e,r,n,i,s){const a=e4(t,e,n,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),hD(a,r),dD(a,r)}function vD(t,e,r,n){const i=e._queryIdentifier,s=[];let a=[];const o=ma(t);if(i==="default")for(const[l,c]of t.views.entries())a=a.concat(S2(c,r,n)),k2(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=t.views.get(i);l&&(a=a.concat(S2(l,r,n)),k2(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return o&&!ma(t)&&s.push(new(mD())(e._repo,e._path)),{removed:s,events:a}}function t4(t){const e=[];for(const r of t.views.values())r.query._queryParams.loadsAllData()||e.push(r);return e}function ca(t,e){let r=null;for(const n of t.views.values())r=r||fD(n,e);return r}function r4(t,e){if(e._queryParams.loadsAllData())return Od(t);{const n=e._queryIdentifier;return t.views.get(n)}}function n4(t,e){return r4(t,e)!=null}function ma(t){return Od(t)!=null}function Od(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gh;function xD(t){ke(!Gh,"__referenceConstructor has already been defined"),Gh=t}function yD(){return ke(Gh,"Reference.ts has not been loaded"),Gh}let wD=1;class A2{constructor(e){this.listenProvider_=e,this.syncPointTree_=new jt(null),this.pendingWriteTree_=YP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function i4(t,e,r,n,i){return BP(t.pendingWriteTree_,e,r,n,i),i?rc(t,new uo(k_(),e,r)):[]}function ED(t,e,r,n){VP(t.pendingWriteTree_,e,r,n);const i=jt.fromObject(r);return rc(t,new Bl(k_(),e,i))}function Ks(t,e,r=!1){const n=UP(t.pendingWriteTree_,e);if(jP(t.pendingWriteTree_,e)){let s=new jt(null);return n.snap!=null?s=s.set(kt(),!0):Yr(n.children,a=>{s=s.set(new Vt(a),!0)}),rc(t,new Uh(n.path,s,r))}else return[]}function Af(t,e,r){return rc(t,new uo(S_(),e,r))}function TD(t,e,r){const n=jt.fromObject(r);return rc(t,new Bl(S_(),e,n))}function kD(t,e){return rc(t,new $u(S_(),e))}function SD(t,e,r){const n=P_(t,r);if(n){const i=D_(n),s=i.path,a=i.queryId,o=Cn(s,e),l=new $u(C_(a),o);return b_(t,s,l)}else return[]}function s4(t,e,r,n,i=!1){const s=e._path,a=t.syncPointTree_.get(s);let o=[];if(a&&(e._queryIdentifier==="default"||n4(a,e))){const l=vD(a,e,r,n);gD(a)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=l.removed;if(o=l.events,!i){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,p)=>ma(p));if(u&&!d){const h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){const p=FD(h);for(let g=0;g<p.length;++g){const x=p[g],_=x.query,m=c4(t,x);t.listenProvider_.startListening(su(_),Gu(t,_),m.hashFn,m.onComplete)}}}!d&&c.length>0&&!n&&(u?t.listenProvider_.stopListening(su(e),null):c.forEach(h=>{const p=t.queryToTagMap.get(Ld(h));t.listenProvider_.stopListening(su(h),p)}))}ND(t,c)}return o}function a4(t,e,r,n){const i=P_(t,n);if(i!=null){const s=D_(i),a=s.path,o=s.queryId,l=Cn(a,e),c=new uo(C_(o),l,r);return b_(t,a,c)}else return[]}function CD(t,e,r,n){const i=P_(t,n);if(i){const s=D_(i),a=s.path,o=s.queryId,l=Cn(a,e),c=jt.fromObject(r),u=new Bl(C_(o),l,c);return b_(t,a,u)}else return[]}function AD(t,e,r,n=!1){const i=e._path;let s=null,a=!1;t.syncPointTree_.foreachOnPath(i,(h,p)=>{const g=Cn(h,i);s=s||ca(p,g),a=a||ma(p)});let o=t.syncPointTree_.get(i);o?(a=a||ma(o),s=s||ca(o,kt())):(o=new ZS,t.syncPointTree_=t.syncPointTree_.set(i,o));let l;s!=null?l=!0:(l=!1,s=Xe.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((p,g)=>{const x=ca(g,kt());x&&(s=s.updateImmediateChild(p,x))}));const c=n4(o,e);if(!c&&!e._queryParams.loadsAllData()){const h=Ld(e);ke(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const p=RD();t.queryToTagMap.set(h,p),t.tagToQueryMap.set(p,h)}const u=bd(t.pendingWriteTree_,i);let d=_D(o,e,r,u,s,l);if(!c&&!a&&!n){const h=r4(o,e);d=d.concat(PD(t,e,h))}return d}function R_(t,e,r){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(a,o)=>{const l=Cn(a,e),c=ca(o,l);if(c)return c});return XS(i,e,s,r,!0)}function ID(t,e){const r=e._path;let n=null;t.syncPointTree_.foreachOnPath(r,(c,u)=>{const d=Cn(c,r);n=n||ca(u,d)});let i=t.syncPointTree_.get(r);i?n=n||ca(i,kt()):(i=new ZS,t.syncPointTree_=t.syncPointTree_.set(r,i));const s=n!=null,a=s?new pa(n,!0,!1):null,o=bd(t.pendingWriteTree_,e._path),l=e4(i,e,o,s?a.getNode():Xe.EMPTY_NODE,s);return uD(l)}function rc(t,e){return o4(e,t.syncPointTree_,null,bd(t.pendingWriteTree_,kt()))}function o4(t,e,r,n){if(ft(t.path))return l4(t,e,r,n);{const i=e.get(kt());r==null&&i!=null&&(r=ca(i,kt()));let s=[];const a=pt(t.path),o=t.operationForChild(a),l=e.children.get(a);if(l&&o){const c=r?r.getImmediateChild(a):null,u=KS(n,a);s=s.concat(o4(o,l,c,u))}return i&&(s=s.concat(N_(i,t,n,r))),s}}function l4(t,e,r,n){const i=e.get(kt());r==null&&i!=null&&(r=ca(i,kt()));let s=[];return e.children.inorderTraversal((a,o)=>{const l=r?r.getImmediateChild(a):null,c=KS(n,a),u=t.operationForChild(a);u&&(s=s.concat(l4(u,o,l,c)))}),i&&(s=s.concat(N_(i,t,n,r))),s}function c4(t,e){const r=e.query,n=Gu(t,r);return{hashFn:()=>(cD(e)||Xe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return n?SD(t,r._path,n):kD(t,r._path);{const s=k6(i,r);return s4(t,r,null,s)}}}}function Gu(t,e){const r=Ld(e);return t.queryToTagMap.get(r)}function Ld(t){return t._path.toString()+"$"+t._queryIdentifier}function P_(t,e){return t.tagToQueryMap.get(e)}function D_(t){const e=t.indexOf("$");return ke(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Vt(t.substr(0,e))}}function b_(t,e,r){const n=t.syncPointTree_.get(e);ke(n,"Missing sync point for query tag that we're tracking");const i=bd(t.pendingWriteTree_,e);return N_(n,r,i,null)}function FD(t){return t.fold((e,r,n)=>{if(r&&ma(r))return[Od(r)];{let i=[];return r&&(i=t4(r)),Yr(n,(s,a)=>{i=i.concat(a)}),i}})}function su(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(yD())(t._repo,t._path):t}function ND(t,e){for(let r=0;r<e.length;++r){const n=e[r];if(!n._queryParams.loadsAllData()){const i=Ld(n),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function RD(){return wD++}function PD(t,e,r){const n=e._path,i=Gu(t,e),s=c4(t,r),a=t.listenProvider_.startListening(su(e),i,s.hashFn,s.onComplete),o=t.syncPointTree_.subtree(n);if(i)ke(!ma(o.value),"If we're adding a query, it shouldn't be shadowed");else{const l=o.fold((c,u,d)=>{if(!ft(c)&&u&&ma(u))return[Od(u).query];{let h=[];return u&&(h=h.concat(t4(u).map(p=>p.query))),Yr(d,(p,g)=>{h=h.concat(g)}),h}});for(let c=0;c<l.length;++c){const u=l[c];t.listenProvider_.stopListening(su(u),Gu(t,u))}}return a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e){this.node_=e}getImmediateChild(e){const r=this.node_.getImmediateChild(e);return new O_(r)}node(){return this.node_}}class L_{constructor(e,r){this.syncTree_=e,this.path_=r}getImmediateChild(e){const r=cr(this.path_,e);return new L_(this.syncTree_,r)}node(){return R_(this.syncTree_,this.path_)}}const DD=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},I2=function(t,e,r){if(!t||typeof t!="object")return t;if(ke(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return bD(t[".sv"],e,r);if(typeof t[".sv"]=="object")return OD(t[".sv"],e);ke(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},bD=function(t,e,r){switch(t){case"timestamp":return r.timestamp;default:ke(!1,"Unexpected server value: "+t)}},OD=function(t,e,r){t.hasOwnProperty("increment")||ke(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const n=t.increment;typeof n!="number"&&ke(!1,"Unexpected increment value: "+n);const i=e.node();if(ke(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;const a=i.getValue();return typeof a!="number"?n:a+n},u4=function(t,e,r,n){return M_(e,new L_(r,t),n)},f4=function(t,e,r){return M_(t,new O_(e),r)};function M_(t,e,r){const n=t.getPriority().val(),i=I2(n,e.getImmediateChild(".priority"),r);let s;if(t.isLeafNode()){const a=t,o=I2(a.getValue(),e,r);return o!==a.getValue()||i!==a.getPriority().val()?new br(o,Ar(i)):t}else{const a=t;return s=a,i!==a.getPriority().val()&&(s=s.updatePriority(new br(i))),a.forEachChild(ur,(o,l)=>{const c=M_(l,e.getImmediateChild(o),r);c!==l&&(s=s.updateImmediateChild(o,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e="",r=null,n={children:{},childCount:0}){this.name=e,this.parent=r,this.node=n}}function V_(t,e){let r=e instanceof Vt?e:new Vt(e),n=t,i=pt(r);for(;i!==null;){const s=bl(n.node.children,i)||{children:{},childCount:0};n=new B_(i,n,s),r=Wt(r),i=pt(r)}return n}function nc(t){return t.node.value}function h4(t,e){t.node.value=e,M1(t)}function d4(t){return t.node.childCount>0}function LD(t){return nc(t)===void 0&&!d4(t)}function Md(t,e){Yr(t.node.children,(r,n)=>{e(new B_(r,t,n))})}function p4(t,e,r,n){r&&e(t),Md(t,i=>{p4(i,e,!0)})}function MD(t,e,r){let n=t.parent;for(;n!==null;){if(e(n))return!0;n=n.parent}return!1}function If(t){return new Vt(t.parent===null?t.name:If(t.parent)+"/"+t.name)}function M1(t){t.parent!==null&&BD(t.parent,t.name,t)}function BD(t,e,r){const n=LD(r),i=rs(t.node.children,e);n&&i?(delete t.node.children[e],t.node.childCount--,M1(t)):!n&&!i&&(t.node.children[e]=r.node,t.node.childCount++,M1(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=/[\[\].#$\/\u0000-\u001F\u007F]/,UD=/[\[\].#$\u0000-\u001F\u007F]/,tm=10*1024*1024,U_=function(t){return typeof t=="string"&&t.length!==0&&!VD.test(t)},m4=function(t){return typeof t=="string"&&t.length!==0&&!UD.test(t)},jD=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),m4(t)},WD=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!p_(t)||t&&typeof t=="object"&&rs(t,".sv")},zD=function(t,e,r,n){Bd(Nd(t,"value"),e,r)},Bd=function(t,e,r){const n=r instanceof Vt?new iP(r,t):r;if(e===void 0)throw new Error(t+"contains undefined "+Ua(n));if(typeof e=="function")throw new Error(t+"contains a function "+Ua(n)+" with contents = "+e.toString());if(p_(e))throw new Error(t+"contains "+e.toString()+" "+Ua(n));if(typeof e=="string"&&e.length>tm/3&&Rd(e)>tm)throw new Error(t+"contains a string greater than "+tm+" utf8 bytes "+Ua(n)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Yr(e,(a,o)=>{if(a===".value")i=!0;else if(a!==".priority"&&a!==".sv"&&(s=!0,!U_(a)))throw new Error(t+" contains an invalid key ("+a+") "+Ua(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);sP(n,a),Bd(t,o,n),aP(n)}),i&&s)throw new Error(t+' contains ".value" child '+Ua(n)+" in addition to actual children.")}},HD=function(t,e){let r,n;for(r=0;r<e.length;r++){n=e[r];const s=ju(n);for(let a=0;a<s.length;a++)if(!(s[a]===".priority"&&a===s.length-1)){if(!U_(s[a]))throw new Error(t+"contains an invalid key ("+s[a]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(nP);let i=null;for(r=0;r<e.length;r++){if(n=e[r],i!==null&&ui(i,n))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+n.toString());i=n}},$D=function(t,e,r,n){const i=Nd(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Yr(e,(a,o)=>{const l=new Vt(a);if(Bd(i,o,cr(r,l)),x_(l)===".priority"&&!WD(o))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),HD(i,s)},g4=function(t,e,r,n){if(!m4(r))throw new Error(Nd(t,e)+'was an invalid path = "'+r+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},GD=function(t,e,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),g4(t,e,r)},_4=function(t,e){if(pt(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},XD=function(t,e){const r=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!U_(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||r.length!==0&&!jD(r))throw new Error(Nd(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function j_(t,e){let r=null;for(let n=0;n<e.length;n++){const i=e[n],s=i.getPath();r!==null&&!OS(s,r.path)&&(t.eventLists_.push(r),r=null),r===null&&(r={events:[],path:s}),r.events.push(i)}r&&t.eventLists_.push(r)}function mi(t,e,r){j_(t,r),qD(t,n=>ui(n,e)||ui(e,n))}function qD(t,e){t.recursionDepth_++;let r=!0;for(let n=0;n<t.eventLists_.length;n++){const i=t.eventLists_[n];if(i){const s=i.path;e(s)?(YD(t.eventLists_[n]),t.eventLists_[n]=null):r=!1}}r&&(t.eventLists_=[]),t.recursionDepth_--}function YD(t){for(let e=0;e<t.events.length;e++){const r=t.events[e];if(r!==null){t.events[e]=null;const n=r.getEventRunner();tu&&$r("event: "+r.toString()),tc(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD="repo_interrupt",JD=25;class ZD{constructor(e,r,n,i){this.repoInfo_=e,this.forceRestClient_=r,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new KD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Vh(),this.transactionQueueTree_=new B_,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function e8(t,e,r){if(t.stats_=__(t.repoInfo_),t.forceRestClient_||I6())t.server_=new Bh(t.repoInfo_,(n,i,s,a)=>{F2(t,n,i,s,a)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>N2(t,!0),0);else{if(typeof r<"u"&&r!==null){if(typeof r!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ir(r)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}t.persistentConnection_=new ys(t.repoInfo_,e,(n,i,s,a)=>{F2(t,n,i,s,a)},n=>{N2(t,n)},n=>{r8(t,n)},t.authTokenProvider_,t.appCheckProvider_,r),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(n=>{t.server_.refreshAuthToken(n)}),t.appCheckProvider_.addTokenChangeListener(n=>{t.server_.refreshAppCheckToken(n.token)}),t.statsReporter_=D6(t.repoInfo_,()=>new PP(t.stats_,t.server_)),t.infoData_=new AP,t.infoSyncTree_=new A2({startListening:(n,i,s,a)=>{let o=[];const l=t.infoData_.getNode(n._path);return l.isEmpty()||(o=Af(t.infoSyncTree_,n._path,l),setTimeout(()=>{a("ok")},0)),o},stopListening:()=>{}}),W_(t,"connected",!1),t.serverSyncTree_=new A2({startListening:(n,i,s,a)=>(t.server_.listen(n,s,i,(o,l)=>{const c=a(o,l);mi(t.eventQueue_,n._path,c)}),[]),stopListening:(n,i)=>{t.server_.unlisten(n,i)}})}function t8(t){const r=t.infoData_.getNode(new Vt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+r}function Vd(t){return DD({timestamp:t8(t)})}function F2(t,e,r,n,i){t.dataUpdateCount++;const s=new Vt(e);r=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,r):r;let a=[];if(i)if(n){const l=bh(r,c=>Ar(c));a=CD(t.serverSyncTree_,s,l,i)}else{const l=Ar(r);a=a4(t.serverSyncTree_,s,l,i)}else if(n){const l=bh(r,c=>Ar(c));a=TD(t.serverSyncTree_,s,l)}else{const l=Ar(r);a=Af(t.serverSyncTree_,s,l)}let o=s;a.length>0&&(o=Ul(t,s)),mi(t.eventQueue_,o,a)}function N2(t,e){W_(t,"connected",e),e===!1&&a8(t)}function r8(t,e){Yr(e,(r,n)=>{W_(t,r,n)})}function W_(t,e,r){const n=new Vt("/.info/"+e),i=Ar(r);t.infoData_.updateSnapshot(n,i);const s=Af(t.infoSyncTree_,n,i);mi(t.eventQueue_,n,s)}function z_(t){return t.nextWriteId_++}function n8(t,e,r){const n=ID(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(i=>{const s=Ar(i).withIndex(e._queryParams.getIndex());AD(t.serverSyncTree_,e,r,!0);let a;if(e._queryParams.loadsAllData())a=Af(t.serverSyncTree_,e._path,s);else{const o=Gu(t.serverSyncTree_,e);a=a4(t.serverSyncTree_,e._path,s,o)}return mi(t.eventQueue_,e._path,a),s4(t.serverSyncTree_,e,r,null,!0),s},i=>(Ff(t,"get for query "+Ir(e)+" failed: "+i),Promise.reject(new Error(i))))}function i8(t,e,r,n,i){Ff(t,"set",{path:e.toString(),value:r,priority:n});const s=Vd(t),a=Ar(r,n),o=R_(t.serverSyncTree_,e),l=f4(a,o,s),c=z_(t),u=i4(t.serverSyncTree_,e,l,c,!0);j_(t.eventQueue_,u),t.server_.put(e.toString(),a.val(!0),(h,p)=>{const g=h==="ok";g||In("set at "+e+" failed: "+h);const x=Ks(t.serverSyncTree_,c,!g);mi(t.eventQueue_,e,x),B1(t,i,h,p)});const d=$_(t,e);Ul(t,d),mi(t.eventQueue_,d,[])}function s8(t,e,r,n){Ff(t,"update",{path:e.toString(),value:r});let i=!0;const s=Vd(t),a={};if(Yr(r,(o,l)=>{i=!1,a[o]=u4(cr(e,o),Ar(l),t.serverSyncTree_,s)}),i)$r("update() called with empty data.  Don't do anything."),B1(t,n,"ok",void 0);else{const o=z_(t),l=ED(t.serverSyncTree_,e,a,o);j_(t.eventQueue_,l),t.server_.merge(e.toString(),r,(c,u)=>{const d=c==="ok";d||In("update at "+e+" failed: "+c);const h=Ks(t.serverSyncTree_,o,!d),p=h.length>0?Ul(t,e):e;mi(t.eventQueue_,p,h),B1(t,n,c,u)}),Yr(r,c=>{const u=$_(t,cr(e,c));Ul(t,u)}),mi(t.eventQueue_,e,[])}}function a8(t){Ff(t,"onDisconnectEvents");const e=Vd(t),r=Vh();R1(t.onDisconnect_,kt(),(i,s)=>{const a=u4(i,s,t.serverSyncTree_,e);zS(r,i,a)});let n=[];R1(r,kt(),(i,s)=>{n=n.concat(Af(t.serverSyncTree_,i,s));const a=$_(t,i);Ul(t,a)}),t.onDisconnect_=Vh(),mi(t.eventQueue_,kt(),n)}function o8(t){t.persistentConnection_&&t.persistentConnection_.interrupt(QD)}function Ff(t,...e){let r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),$r(r,...e)}function B1(t,e,r,n){e&&tc(()=>{if(r==="ok")e(null);else{const i=(r||"error").toUpperCase();let s=i;n&&(s+=": "+n);const a=new Error(s);a.code=i,e(a)}})}function v4(t,e,r){return R_(t.serverSyncTree_,e,r)||Xe.EMPTY_NODE}function H_(t,e=t.transactionQueueTree_){if(e||Ud(t,e),nc(e)){const r=y4(t,e);ke(r.length>0,"Sending zero length transaction queue"),r.every(i=>i.status===0)&&l8(t,If(e),r)}else d4(e)&&Md(e,r=>{H_(t,r)})}function l8(t,e,r){const n=r.map(c=>c.currentWriteId),i=v4(t,e,n);let s=i;const a=i.hash();for(let c=0;c<r.length;c++){const u=r[c];ke(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=Cn(e,u.path);s=s.updateChild(d,u.currentOutputSnapshotRaw)}const o=s.val(!0),l=e;t.server_.put(l.toString(),o,c=>{Ff(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let h=0;h<r.length;h++)r[h].status=2,u=u.concat(Ks(t.serverSyncTree_,r[h].currentWriteId)),r[h].onComplete&&d.push(()=>r[h].onComplete(null,!0,r[h].currentOutputSnapshotResolved)),r[h].unwatcher();Ud(t,V_(t.transactionQueueTree_,e)),H_(t,t.transactionQueueTree_),mi(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)tc(d[h])}else{if(c==="datastale")for(let d=0;d<r.length;d++)r[d].status===3?r[d].status=4:r[d].status=0;else{In("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<r.length;d++)r[d].status=4,r[d].abortReason=c}Ul(t,e)}},a)}function Ul(t,e){const r=x4(t,e),n=If(r),i=y4(t,r);return c8(t,i,n),n}function c8(t,e,r){if(e.length===0)return;const n=[];let i=[];const a=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const l=e[o],c=Cn(r,l.path);let u=!1,d;if(ke(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,i=i.concat(Ks(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=JD)u=!0,d="maxretry",i=i.concat(Ks(t.serverSyncTree_,l.currentWriteId,!0));else{const h=v4(t,l.path,a);l.currentInputSnapshot=h;const p=e[o].update(h.val());if(p!==void 0){Bd("transaction failed: Data returned ",p,l.path);let g=Ar(p);typeof p=="object"&&p!=null&&rs(p,".priority")||(g=g.updatePriority(h.getPriority()));const _=l.currentWriteId,m=Vd(t),w=f4(g,h,m);l.currentOutputSnapshotRaw=g,l.currentOutputSnapshotResolved=w,l.currentWriteId=z_(t),a.splice(a.indexOf(_),1),i=i.concat(i4(t.serverSyncTree_,l.path,w,l.currentWriteId,l.applyLocally)),i=i.concat(Ks(t.serverSyncTree_,_,!0))}else u=!0,d="nodata",i=i.concat(Ks(t.serverSyncTree_,l.currentWriteId,!0))}mi(t.eventQueue_,r,i),i=[],u&&(e[o].status=2,function(h){setTimeout(h,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(d==="nodata"?n.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):n.push(()=>e[o].onComplete(new Error(d),!1,null))))}Ud(t,t.transactionQueueTree_);for(let o=0;o<n.length;o++)tc(n[o]);H_(t,t.transactionQueueTree_)}function x4(t,e){let r,n=t.transactionQueueTree_;for(r=pt(e);r!==null&&nc(n)===void 0;)n=V_(n,r),e=Wt(e),r=pt(e);return n}function y4(t,e){const r=[];return w4(t,e,r),r.sort((n,i)=>n.order-i.order),r}function w4(t,e,r){const n=nc(e);if(n)for(let i=0;i<n.length;i++)r.push(n[i]);Md(e,i=>{w4(t,i,r)})}function Ud(t,e){const r=nc(e);if(r){let n=0;for(let i=0;i<r.length;i++)r[i].status!==2&&(r[n]=r[i],n++);r.length=n,h4(e,r.length>0?r:void 0)}Md(e,n=>{Ud(t,n)})}function $_(t,e){const r=If(x4(t,e)),n=V_(t.transactionQueueTree_,e);return MD(n,i=>{rm(t,i)}),rm(t,n),p4(n,i=>{rm(t,i)}),r}function rm(t,e){const r=nc(e);if(r){const n=[];let i=[],s=-1;for(let a=0;a<r.length;a++)r[a].status===3||(r[a].status===1?(ke(s===a-1,"All SENT items should be at beginning of queue."),s=a,r[a].status=3,r[a].abortReason="set"):(ke(r[a].status===0,"Unexpected transaction status in abort"),r[a].unwatcher(),i=i.concat(Ks(t.serverSyncTree_,r[a].currentWriteId,!0)),r[a].onComplete&&n.push(r[a].onComplete.bind(null,new Error("set"),!1,null))));s===-1?h4(e,void 0):r.length=s+1,mi(t.eventQueue_,If(e),i);for(let a=0;a<n.length;a++)tc(n[a])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u8(t){let e="";const r=t.split("/");for(let n=0;n<r.length;n++)if(r[n].length>0){let i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function f8(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const r of t.split("&")){if(r.length===0)continue;const n=r.split("=");n.length===2?e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):In(`Invalid query segment '${r}' in query '${t}'`)}return e}const R2=function(t,e){const r=h8(t),n=r.namespace;r.domain==="firebase.com"&&Fs(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&r.domain!=="localhost"&&Fs("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||x6();const i=r.scheme==="ws"||r.scheme==="wss";return{repoInfo:new SS(r.host,r.secure,n,i,e,"",n!==r.subdomain),path:new Vt(r.pathString)}},h8=function(t){let e="",r="",n="",i="",s="",a=!0,o="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(o=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(i=u8(t.substring(u,d)));const h=f8(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(a=o==="https"||o==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")r="localhost";else if(p.split(".").length<=2)r=p;else{const g=e.indexOf(".");n=e.substring(0,g).toLowerCase(),r=e.substring(g+1),s=n}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:r,subdomain:n,secure:a,scheme:o,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e,r,n,i){this.eventType=e,this.eventRegistration=r,this.snapshot=n,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ir(this.snapshot.exportVal())}}class p8{constructor(e,r,n){this.eventRegistration=e,this.error=r,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e,r){this.snapshotCallback=e,this.cancelCallback=r}onValue(e,r){this.snapshotCallback.call(null,e,r)}onCancel(e){return ke(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e,r,n,i){this._repo=e,this._path=r,this._queryParams=n,this._orderByCalled=i}get key(){return ft(this._path)?null:x_(this._path)}get ref(){return new bs(this._repo,this._path)}get _queryIdentifier(){const e=_2(this._queryParams),r=m_(e);return r==="{}"?"default":r}get _queryObject(){return _2(this._queryParams)}isEqual(e){if(e=So(e),!(e instanceof G_))return!1;const r=this._repo===e._repo,n=OS(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return r&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+rP(this._path)}}class bs extends G_{constructor(e,r){super(e,r,new T_,!1)}get parent(){const e=bS(this._path);return e===null?null:new bs(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Xu{constructor(e,r,n){this._node=e,this.ref=r,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const r=new Vt(e),n=Xh(this.ref,e);return new Xu(this._node.getChild(r),n,ur)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,i)=>e(new Xu(i,Xh(this.ref,n),ur)))}hasChild(e){const r=new Vt(e);return!this._node.getChild(r).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ho(t,e){return t=So(t),t._checkNotDeleted("ref"),e!==void 0?Xh(t._root,e):t._root}function Xh(t,e){return t=So(t),pt(t._path)===null?GD("child","path",e):g4("child","path",e),new bs(t._repo,cr(t._path,e))}function g8(t){return _4("remove",t._path),E4(t,null)}function E4(t,e){t=So(t),_4("set",t._path),zD("set",e,t._path);const r=new Tf;return i8(t._repo,t._path,e,null,r.wrapCallback(()=>{})),r.promise}function nm(t,e){$D("update",e,t._path);const r=new Tf;return s8(t._repo,t._path,e,r.wrapCallback(()=>{})),r.promise}function _8(t){t=So(t);const e=new m8(()=>{}),r=new X_(e);return n8(t._repo,t,r).then(n=>new Xu(n,new bs(t._repo,t._path),t._queryParams.getIndex()))}class X_{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,r){const n=r._queryParams.getIndex();return new d8("value",this,new Xu(e.snapshotNode,new bs(r._repo,r._path),n))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,r){return this.callbackContext.hasCancelCallback?new p8(this,e,r):null}matches(e){return e instanceof X_?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}pD(bs);xD(bs);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8="FIREBASE_DATABASE_EMULATOR_HOST",V1={};let x8=!1;function y8(t,e,r,n){t.repoInfo_=new SS(`${e}:${r}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),n&&(t.authTokenProvider_=n)}function w8(t,e,r,n,i){let s=n||t.options.databaseURL;s===void 0&&(t.options.projectId||Fs("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),$r("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let a=R2(s,i),o=a.repoInfo,l;typeof process<"u"&&Zy&&(l=Zy[v8]),l?(s=`http://${l}?ns=${o.namespace}`,a=R2(s,i),o=a.repoInfo):a.repoInfo.secure;const c=new N6(t.name,t.options,e);XD("Invalid Firebase Database URL",a),ft(a.path)||Fs("Database URL must point to the root of a Firebase Database (not including a child path).");const u=T8(o,t,c,new F6(t.name,r));return new k8(u,t)}function E8(t,e){const r=V1[e];(!r||r[t.key]!==t)&&Fs(`Database ${e}(${t.repoInfo_}) has already been deleted.`),o8(t),delete r[t.key]}function T8(t,e,r,n){let i=V1[e.name];i||(i={},V1[e.name]=i);let s=i[t.toURLString()];return s&&Fs("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ZD(t,x8,r,n),i[t.toURLString()]=s,s}class k8{constructor(e,r){this._repoInternal=e,this.app=r,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(e8(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new bs(this._repo,kt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(E8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Fs("Cannot call "+e+" on a deleted database.")}}function S8(t=d_(),e){const r=aS(t,"database").getImmediate({identifier:e});if(!r._instanceStarted){const n=Qk("database");n&&C8(r,...n)}return r}function C8(t,e,r,n={}){t=So(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Fs("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)n.mockUserToken&&Fs('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new th(th.OWNER);else if(n.mockUserToken){const a=typeof n.mockUserToken=="string"?n.mockUserToken:Zk(n.mockUserToken,t.app.options.projectId);s=new th(a)}y8(i,e,r,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A8(t){d6(oS),Bu(new Ol("database",(e,{instanceIdentifier:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return w8(n,i,s,r)},"PUBLIC").setMultipleInstances(!0)),oa(e2,t2,t),oa(e2,t2,"esm2017")}ys.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};ys.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};A8();var P2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ya,T4;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,T){function k(){}k.prototype=T.prototype,E.D=T.prototype,E.prototype=new k,E.prototype.constructor=E,E.C=function(C,A,b){for(var N=Array(arguments.length-2),we=2;we<arguments.length;we++)N[we-2]=arguments[we];return T.prototype[A].apply(C,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,T,k){k||(k=0);var C=Array(16);if(typeof T=="string")for(var A=0;16>A;++A)C[A]=T.charCodeAt(k++)|T.charCodeAt(k++)<<8|T.charCodeAt(k++)<<16|T.charCodeAt(k++)<<24;else for(A=0;16>A;++A)C[A]=T[k++]|T[k++]<<8|T[k++]<<16|T[k++]<<24;T=E.g[0],k=E.g[1],A=E.g[2];var b=E.g[3],N=T+(b^k&(A^b))+C[0]+3614090360&4294967295;T=k+(N<<7&4294967295|N>>>25),N=b+(A^T&(k^A))+C[1]+3905402710&4294967295,b=T+(N<<12&4294967295|N>>>20),N=A+(k^b&(T^k))+C[2]+606105819&4294967295,A=b+(N<<17&4294967295|N>>>15),N=k+(T^A&(b^T))+C[3]+3250441966&4294967295,k=A+(N<<22&4294967295|N>>>10),N=T+(b^k&(A^b))+C[4]+4118548399&4294967295,T=k+(N<<7&4294967295|N>>>25),N=b+(A^T&(k^A))+C[5]+1200080426&4294967295,b=T+(N<<12&4294967295|N>>>20),N=A+(k^b&(T^k))+C[6]+2821735955&4294967295,A=b+(N<<17&4294967295|N>>>15),N=k+(T^A&(b^T))+C[7]+4249261313&4294967295,k=A+(N<<22&4294967295|N>>>10),N=T+(b^k&(A^b))+C[8]+1770035416&4294967295,T=k+(N<<7&4294967295|N>>>25),N=b+(A^T&(k^A))+C[9]+2336552879&4294967295,b=T+(N<<12&4294967295|N>>>20),N=A+(k^b&(T^k))+C[10]+4294925233&4294967295,A=b+(N<<17&4294967295|N>>>15),N=k+(T^A&(b^T))+C[11]+2304563134&4294967295,k=A+(N<<22&4294967295|N>>>10),N=T+(b^k&(A^b))+C[12]+1804603682&4294967295,T=k+(N<<7&4294967295|N>>>25),N=b+(A^T&(k^A))+C[13]+4254626195&4294967295,b=T+(N<<12&4294967295|N>>>20),N=A+(k^b&(T^k))+C[14]+2792965006&4294967295,A=b+(N<<17&4294967295|N>>>15),N=k+(T^A&(b^T))+C[15]+1236535329&4294967295,k=A+(N<<22&4294967295|N>>>10),N=T+(A^b&(k^A))+C[1]+4129170786&4294967295,T=k+(N<<5&4294967295|N>>>27),N=b+(k^A&(T^k))+C[6]+3225465664&4294967295,b=T+(N<<9&4294967295|N>>>23),N=A+(T^k&(b^T))+C[11]+643717713&4294967295,A=b+(N<<14&4294967295|N>>>18),N=k+(b^T&(A^b))+C[0]+3921069994&4294967295,k=A+(N<<20&4294967295|N>>>12),N=T+(A^b&(k^A))+C[5]+3593408605&4294967295,T=k+(N<<5&4294967295|N>>>27),N=b+(k^A&(T^k))+C[10]+38016083&4294967295,b=T+(N<<9&4294967295|N>>>23),N=A+(T^k&(b^T))+C[15]+3634488961&4294967295,A=b+(N<<14&4294967295|N>>>18),N=k+(b^T&(A^b))+C[4]+3889429448&4294967295,k=A+(N<<20&4294967295|N>>>12),N=T+(A^b&(k^A))+C[9]+568446438&4294967295,T=k+(N<<5&4294967295|N>>>27),N=b+(k^A&(T^k))+C[14]+3275163606&4294967295,b=T+(N<<9&4294967295|N>>>23),N=A+(T^k&(b^T))+C[3]+4107603335&4294967295,A=b+(N<<14&4294967295|N>>>18),N=k+(b^T&(A^b))+C[8]+1163531501&4294967295,k=A+(N<<20&4294967295|N>>>12),N=T+(A^b&(k^A))+C[13]+2850285829&4294967295,T=k+(N<<5&4294967295|N>>>27),N=b+(k^A&(T^k))+C[2]+4243563512&4294967295,b=T+(N<<9&4294967295|N>>>23),N=A+(T^k&(b^T))+C[7]+1735328473&4294967295,A=b+(N<<14&4294967295|N>>>18),N=k+(b^T&(A^b))+C[12]+2368359562&4294967295,k=A+(N<<20&4294967295|N>>>12),N=T+(k^A^b)+C[5]+4294588738&4294967295,T=k+(N<<4&4294967295|N>>>28),N=b+(T^k^A)+C[8]+2272392833&4294967295,b=T+(N<<11&4294967295|N>>>21),N=A+(b^T^k)+C[11]+1839030562&4294967295,A=b+(N<<16&4294967295|N>>>16),N=k+(A^b^T)+C[14]+4259657740&4294967295,k=A+(N<<23&4294967295|N>>>9),N=T+(k^A^b)+C[1]+2763975236&4294967295,T=k+(N<<4&4294967295|N>>>28),N=b+(T^k^A)+C[4]+1272893353&4294967295,b=T+(N<<11&4294967295|N>>>21),N=A+(b^T^k)+C[7]+4139469664&4294967295,A=b+(N<<16&4294967295|N>>>16),N=k+(A^b^T)+C[10]+3200236656&4294967295,k=A+(N<<23&4294967295|N>>>9),N=T+(k^A^b)+C[13]+681279174&4294967295,T=k+(N<<4&4294967295|N>>>28),N=b+(T^k^A)+C[0]+3936430074&4294967295,b=T+(N<<11&4294967295|N>>>21),N=A+(b^T^k)+C[3]+3572445317&4294967295,A=b+(N<<16&4294967295|N>>>16),N=k+(A^b^T)+C[6]+76029189&4294967295,k=A+(N<<23&4294967295|N>>>9),N=T+(k^A^b)+C[9]+3654602809&4294967295,T=k+(N<<4&4294967295|N>>>28),N=b+(T^k^A)+C[12]+3873151461&4294967295,b=T+(N<<11&4294967295|N>>>21),N=A+(b^T^k)+C[15]+530742520&4294967295,A=b+(N<<16&4294967295|N>>>16),N=k+(A^b^T)+C[2]+3299628645&4294967295,k=A+(N<<23&4294967295|N>>>9),N=T+(A^(k|~b))+C[0]+4096336452&4294967295,T=k+(N<<6&4294967295|N>>>26),N=b+(k^(T|~A))+C[7]+1126891415&4294967295,b=T+(N<<10&4294967295|N>>>22),N=A+(T^(b|~k))+C[14]+2878612391&4294967295,A=b+(N<<15&4294967295|N>>>17),N=k+(b^(A|~T))+C[5]+4237533241&4294967295,k=A+(N<<21&4294967295|N>>>11),N=T+(A^(k|~b))+C[12]+1700485571&4294967295,T=k+(N<<6&4294967295|N>>>26),N=b+(k^(T|~A))+C[3]+2399980690&4294967295,b=T+(N<<10&4294967295|N>>>22),N=A+(T^(b|~k))+C[10]+4293915773&4294967295,A=b+(N<<15&4294967295|N>>>17),N=k+(b^(A|~T))+C[1]+2240044497&4294967295,k=A+(N<<21&4294967295|N>>>11),N=T+(A^(k|~b))+C[8]+1873313359&4294967295,T=k+(N<<6&4294967295|N>>>26),N=b+(k^(T|~A))+C[15]+4264355552&4294967295,b=T+(N<<10&4294967295|N>>>22),N=A+(T^(b|~k))+C[6]+2734768916&4294967295,A=b+(N<<15&4294967295|N>>>17),N=k+(b^(A|~T))+C[13]+1309151649&4294967295,k=A+(N<<21&4294967295|N>>>11),N=T+(A^(k|~b))+C[4]+4149444226&4294967295,T=k+(N<<6&4294967295|N>>>26),N=b+(k^(T|~A))+C[11]+3174756917&4294967295,b=T+(N<<10&4294967295|N>>>22),N=A+(T^(b|~k))+C[2]+718787259&4294967295,A=b+(N<<15&4294967295|N>>>17),N=k+(b^(A|~T))+C[9]+3951481745&4294967295,E.g[0]=E.g[0]+T&4294967295,E.g[1]=E.g[1]+(A+(N<<21&4294967295|N>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+b&4294967295}n.prototype.u=function(E,T){T===void 0&&(T=E.length);for(var k=T-this.blockSize,C=this.B,A=this.h,b=0;b<T;){if(A==0)for(;b<=k;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<T;)if(C[A++]=E.charCodeAt(b++),A==this.blockSize){i(this,C),A=0;break}}else for(;b<T;)if(C[A++]=E[b++],A==this.blockSize){i(this,C),A=0;break}}this.h=A,this.o+=T},n.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var T=1;T<E.length-8;++T)E[T]=0;var k=8*this.o;for(T=E.length-8;T<E.length;++T)E[T]=k&255,k/=256;for(this.u(E),E=Array(16),T=k=0;4>T;++T)for(var C=0;32>C;C+=8)E[k++]=this.g[T]>>>C&255;return E};function s(E,T){var k=o;return Object.prototype.hasOwnProperty.call(k,E)?k[E]:k[E]=T(E)}function a(E,T){this.h=T;for(var k=[],C=!0,A=E.length-1;0<=A;A--){var b=E[A]|0;C&&b==T||(k[A]=b,C=!1)}this.g=k}var o={};function l(E){return-128<=E&&128>E?s(E,function(T){return new a([T|0],0>T?-1:0)}):new a([E|0],0>E?-1:0)}function c(E){if(isNaN(E)||!isFinite(E))return d;if(0>E)return _(c(-E));for(var T=[],k=1,C=0;E>=k;C++)T[C]=E/k|0,k*=4294967296;return new a(T,0)}function u(E,T){if(E.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(E.charAt(0)=="-")return _(u(E.substring(1),T));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=c(Math.pow(T,8)),C=d,A=0;A<E.length;A+=8){var b=Math.min(8,E.length-A),N=parseInt(E.substring(A,A+b),T);8>b?(b=c(Math.pow(T,b)),C=C.j(b).add(c(N))):(C=C.j(k),C=C.add(c(N)))}return C}var d=l(0),h=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(x(this))return-_(this).m();for(var E=0,T=1,k=0;k<this.g.length;k++){var C=this.i(k);E+=(0<=C?C:4294967296+C)*T,T*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(x(this))return"-"+_(this).toString(E);for(var T=c(Math.pow(E,6)),k=this,C="";;){var A=R(k,T).g;k=m(k,A.j(T));var b=((0<k.g.length?k.g[0]:k.h)>>>0).toString(E);if(k=A,g(k))return b+C;for(;6>b.length;)b="0"+b;C=b+C}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var T=0;T<E.g.length;T++)if(E.g[T]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=m(this,E),x(E)?-1:g(E)?0:1};function _(E){for(var T=E.g.length,k=[],C=0;C<T;C++)k[C]=~E.g[C];return new a(k,~E.h).add(h)}t.abs=function(){return x(this)?_(this):this},t.add=function(E){for(var T=Math.max(this.g.length,E.g.length),k=[],C=0,A=0;A<=T;A++){var b=C+(this.i(A)&65535)+(E.i(A)&65535),N=(b>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);C=N>>>16,b&=65535,N&=65535,k[A]=N<<16|b}return new a(k,k[k.length-1]&-2147483648?-1:0)};function m(E,T){return E.add(_(T))}t.j=function(E){if(g(this)||g(E))return d;if(x(this))return x(E)?_(this).j(_(E)):_(_(this).j(E));if(x(E))return _(this.j(_(E)));if(0>this.l(p)&&0>E.l(p))return c(this.m()*E.m());for(var T=this.g.length+E.g.length,k=[],C=0;C<2*T;C++)k[C]=0;for(C=0;C<this.g.length;C++)for(var A=0;A<E.g.length;A++){var b=this.i(C)>>>16,N=this.i(C)&65535,we=E.i(A)>>>16,he=E.i(A)&65535;k[2*C+2*A]+=N*he,w(k,2*C+2*A),k[2*C+2*A+1]+=b*he,w(k,2*C+2*A+1),k[2*C+2*A+1]+=N*we,w(k,2*C+2*A+1),k[2*C+2*A+2]+=b*we,w(k,2*C+2*A+2)}for(C=0;C<T;C++)k[C]=k[2*C+1]<<16|k[2*C];for(C=T;C<2*T;C++)k[C]=0;return new a(k,0)};function w(E,T){for(;(E[T]&65535)!=E[T];)E[T+1]+=E[T]>>>16,E[T]&=65535,T++}function v(E,T){this.g=E,this.h=T}function R(E,T){if(g(T))throw Error("division by zero");if(g(E))return new v(d,d);if(x(E))return T=R(_(E),T),new v(_(T.g),_(T.h));if(x(T))return T=R(E,_(T)),new v(_(T.g),T.h);if(30<E.g.length){if(x(E)||x(T))throw Error("slowDivide_ only works with positive integers.");for(var k=h,C=T;0>=C.l(E);)k=U(k),C=U(C);var A=H(k,1),b=H(C,1);for(C=H(C,2),k=H(k,2);!g(C);){var N=b.add(C);0>=N.l(E)&&(A=A.add(k),b=N),C=H(C,1),k=H(k,1)}return T=m(E,A.j(T)),new v(A,T)}for(A=d;0<=E.l(T);){for(k=Math.max(1,Math.floor(E.m()/T.m())),C=Math.ceil(Math.log(k)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),b=c(k),N=b.j(T);x(N)||0<N.l(E);)k-=C,b=c(k),N=b.j(T);g(b)&&(b=h),A=A.add(b),E=m(E,N)}return new v(A,E)}t.A=function(E){return R(this,E).h},t.and=function(E){for(var T=Math.max(this.g.length,E.g.length),k=[],C=0;C<T;C++)k[C]=this.i(C)&E.i(C);return new a(k,this.h&E.h)},t.or=function(E){for(var T=Math.max(this.g.length,E.g.length),k=[],C=0;C<T;C++)k[C]=this.i(C)|E.i(C);return new a(k,this.h|E.h)},t.xor=function(E){for(var T=Math.max(this.g.length,E.g.length),k=[],C=0;C<T;C++)k[C]=this.i(C)^E.i(C);return new a(k,this.h^E.h)};function U(E){for(var T=E.g.length+1,k=[],C=0;C<T;C++)k[C]=E.i(C)<<1|E.i(C-1)>>>31;return new a(k,E.h)}function H(E,T){var k=T>>5;T%=32;for(var C=E.g.length-k,A=[],b=0;b<C;b++)A[b]=0<T?E.i(b+k)>>>T|E.i(b+k+1)<<32-T:E.i(b+k);return new a(A,E.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,T4=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Ya=a}).apply(typeof P2<"u"?P2:typeof self<"u"?self:typeof window<"u"?window:{});var T0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var k4,Uc,S4,nh,U1,C4,A4,I4;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,S){return f==Array.prototype||f==Object.prototype||(f[y]=S.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof T0=="object"&&T0];for(var y=0;y<f.length;++y){var S=f[y];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var n=r(this);function i(f,y){if(y)e:{var S=n;f=f.split(".");for(var D=0;D<f.length-1;D++){var q=f[D];if(!(q in S))break e;S=S[q]}f=f[f.length-1],D=S[f],y=y(D),y!=D&&y!=null&&e(S,f,{configurable:!0,writable:!0,value:y})}}function s(f,y){f instanceof String&&(f+="");var S=0,D=!1,q={next:function(){if(!D&&S<f.length){var ie=S++;return{value:y(ie,f[ie]),done:!1}}return D=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(f){return f||function(){return s(this,function(y,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function c(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function u(f,y,S){return f.call.apply(f.bind,arguments)}function d(f,y,S){if(!f)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,D),f.apply(y,q)}}return function(){return f.apply(y,arguments)}}function h(f,y,S){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,h.apply(null,arguments)}function p(f,y){var S=Array.prototype.slice.call(arguments,1);return function(){var D=S.slice();return D.push.apply(D,arguments),f.apply(this,D)}}function g(f,y){function S(){}S.prototype=y.prototype,f.aa=y.prototype,f.prototype=new S,f.prototype.constructor=f,f.Qb=function(D,q,ie){for(var Ie=Array(arguments.length-2),Ut=2;Ut<arguments.length;Ut++)Ie[Ut-2]=arguments[Ut];return y.prototype[q].apply(D,Ie)}}function x(f){const y=f.length;if(0<y){const S=Array(y);for(let D=0;D<y;D++)S[D]=f[D];return S}return[]}function _(f,y){for(let S=1;S<arguments.length;S++){const D=arguments[S];if(l(D)){const q=f.length||0,ie=D.length||0;f.length=q+ie;for(let Ie=0;Ie<ie;Ie++)f[q+Ie]=D[Ie]}else f.push(D)}}class m{constructor(y,S){this.i=y,this.j=S,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function w(f){return/^[\s\xa0]*$/.test(f)}function v(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function R(f){return R[" "](f),f}R[" "]=function(){};var U=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function H(f,y,S){for(const D in f)y.call(S,f[D],D,f)}function E(f,y){for(const S in f)y.call(void 0,f[S],S,f)}function T(f){const y={};for(const S in f)y[S]=f[S];return y}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(f,y){let S,D;for(let q=1;q<arguments.length;q++){D=arguments[q];for(S in D)f[S]=D[S];for(let ie=0;ie<k.length;ie++)S=k[ie],Object.prototype.hasOwnProperty.call(D,S)&&(f[S]=D[S])}}function A(f){var y=1;f=f.split(":");const S=[];for(;0<y&&f.length;)S.push(f.shift()),y--;return f.length&&S.push(f.join(":")),S}function b(f){o.setTimeout(()=>{throw f},0)}function N(){var f=ye;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class we{constructor(){this.h=this.g=null}add(y,S){const D=he.get();D.set(y,S),this.h?this.h.next=D:this.g=D,this.h=D}}var he=new m(()=>new Re,f=>f.reset());class Re{constructor(){this.next=this.g=this.h=null}set(y,S){this.h=y,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let de,re=!1,ye=new we,X=()=>{const f=o.Promise.resolve(void 0);de=()=>{f.then(Ce)}};var Ce=()=>{for(var f;f=N();){try{f.h.call(f.g)}catch(S){b(S)}var y=he;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}re=!1};function ce(){this.s=this.s,this.C=this.C}ce.prototype.s=!1,ce.prototype.ma=function(){this.s||(this.s=!0,this.N())},ce.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function fe(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}fe.prototype.h=function(){this.defaultPrevented=!0};var le=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const S=()=>{};o.addEventListener("test",S,y),o.removeEventListener("test",S,y)}catch{}return f}();function De(f,y){if(fe.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var S=this.type=f.type,D=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(U){e:{try{R(y.nodeName);var q=!0;break e}catch{}q=!1}q||(y=null)}}else S=="mouseover"?y=f.fromElement:S=="mouseout"&&(y=f.toElement);this.relatedTarget=y,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:K[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&De.aa.h.call(this)}}g(De,fe);var K={2:"touch",3:"pen",4:"mouse"};De.prototype.h=function(){De.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var se="closure_listenable_"+(1e6*Math.random()|0),F=0;function G(f,y,S,D,q){this.listener=f,this.proxy=null,this.src=y,this.type=S,this.capture=!!D,this.ha=q,this.key=++F,this.da=this.fa=!1}function W(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function z(f){this.src=f,this.g={},this.h=0}z.prototype.add=function(f,y,S,D,q){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var Ie=O(f,y,D,q);return-1<Ie?(y=f[Ie],S||(y.fa=!1)):(y=new G(y,this.src,ie,!!D,q),y.fa=S,f.push(y)),y};function Q(f,y){var S=y.type;if(S in f.g){var D=f.g[S],q=Array.prototype.indexOf.call(D,y,void 0),ie;(ie=0<=q)&&Array.prototype.splice.call(D,q,1),ie&&(W(y),f.g[S].length==0&&(delete f.g[S],f.h--))}}function O(f,y,S,D){for(var q=0;q<f.length;++q){var ie=f[q];if(!ie.da&&ie.listener==y&&ie.capture==!!S&&ie.ha==D)return q}return-1}var ae="closure_lm_"+(1e6*Math.random()|0),Ae={};function ge(f,y,S,D,q){if(Array.isArray(y)){for(var ie=0;ie<y.length;ie++)ge(f,y[ie],S,D,q);return null}return S=Se(S),f&&f[se]?f.K(y,S,c(D)?!!D.capture:!1,q):Pe(f,y,S,!1,D,q)}function Pe(f,y,S,D,q,ie){if(!y)throw Error("Invalid event type");var Ie=c(q)?!!q.capture:!!q,Ut=Le(f);if(Ut||(f[ae]=Ut=new z(f)),S=Ut.add(y,S,D,Ie,ie),S.proxy)return S;if(D=Oe(),S.proxy=D,D.src=f,D.listener=S,f.addEventListener)le||(q=Ie),q===void 0&&(q=!1),f.addEventListener(y.toString(),D,q);else if(f.attachEvent)f.attachEvent(St(y.toString()),D);else if(f.addListener&&f.removeListener)f.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Oe(){function f(S){return y.call(f.src,f.listener,S)}const y=Zt;return f}function Ge(f,y,S,D,q){if(Array.isArray(y))for(var ie=0;ie<y.length;ie++)Ge(f,y[ie],S,D,q);else D=c(D)?!!D.capture:!!D,S=Se(S),f&&f[se]?(f=f.i,y=String(y).toString(),y in f.g&&(ie=f.g[y],S=O(ie,S,D,q),-1<S&&(W(ie[S]),Array.prototype.splice.call(ie,S,1),ie.length==0&&(delete f.g[y],f.h--)))):f&&(f=Le(f))&&(y=f.g[y.toString()],f=-1,y&&(f=O(y,S,D,q)),(S=-1<f?y[f]:null)&&ot(S))}function ot(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[se])Q(y.i,f);else{var S=f.type,D=f.proxy;y.removeEventListener?y.removeEventListener(S,D,f.capture):y.detachEvent?y.detachEvent(St(S),D):y.addListener&&y.removeListener&&y.removeListener(D),(S=Le(y))?(Q(S,f),S.h==0&&(S.src=null,y[ae]=null)):W(f)}}}function St(f){return f in Ae?Ae[f]:Ae[f]="on"+f}function Zt(f,y){if(f.da)f=!0;else{y=new De(y,this);var S=f.listener,D=f.ha||f.src;f.fa&&ot(f),f=S.call(D,y)}return f}function Le(f){return f=f[ae],f instanceof z?f:null}var at="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(f){return typeof f=="function"?f:(f[at]||(f[at]=function(y){return f.handleEvent(y)}),f[at])}function Nt(){ce.call(this),this.i=new z(this),this.M=this,this.F=null}g(Nt,ce),Nt.prototype[se]=!0,Nt.prototype.removeEventListener=function(f,y,S,D){Ge(this,f,y,S,D)};function Ct(f,y){var S,D=f.F;if(D)for(S=[];D;D=D.F)S.push(D);if(f=f.M,D=y.type||y,typeof y=="string")y=new fe(y,f);else if(y instanceof fe)y.target=y.target||f;else{var q=y;y=new fe(D,f),C(y,q)}if(q=!0,S)for(var ie=S.length-1;0<=ie;ie--){var Ie=y.g=S[ie];q=Dt(Ie,D,!0,y)&&q}if(Ie=y.g=f,q=Dt(Ie,D,!0,y)&&q,q=Dt(Ie,D,!1,y)&&q,S)for(ie=0;ie<S.length;ie++)Ie=y.g=S[ie],q=Dt(Ie,D,!1,y)&&q}Nt.prototype.N=function(){if(Nt.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var S=f.g[y],D=0;D<S.length;D++)W(S[D]);delete f.g[y],f.h--}}this.F=null},Nt.prototype.K=function(f,y,S,D){return this.i.add(String(f),y,!1,S,D)},Nt.prototype.L=function(f,y,S,D){return this.i.add(String(f),y,!0,S,D)};function Dt(f,y,S,D){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var q=!0,ie=0;ie<y.length;++ie){var Ie=y[ie];if(Ie&&!Ie.da&&Ie.capture==S){var Ut=Ie.listener,Wr=Ie.ha||Ie.src;Ie.fa&&Q(f.i,Ie),q=Ut.call(Wr,D)!==!1&&q}}return q&&!D.defaultPrevented}function Pn(f,y,S){if(typeof f=="function")S&&(f=h(f,S));else if(f&&typeof f.handleEvent=="function")f=h(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(f,y||0)}function Ur(f){f.g=Pn(()=>{f.g=null,f.i&&(f.i=!1,Ur(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class Me extends ce{constructor(y,S){super(),this.m=y,this.l=S,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Ur(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rt(f){ce.call(this),this.h=f,this.g={}}g(rt,ce);var xr=[];function Kt(f){H(f.g,function(y,S){this.g.hasOwnProperty(S)&&ot(y)},f),f.g={}}rt.prototype.N=function(){rt.aa.N.call(this),Kt(this)},rt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dr=o.JSON.stringify,is=o.JSON.parse,bo=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Oo(){}Oo.prototype.h=null;function fc(f){return f.h||(f.h=f.i())}function hc(){}var Ia={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function dc(){fe.call(this,"d")}g(dc,fe);function Ls(){fe.call(this,"c")}g(Ls,fe);var ss={},Wf=null;function Lo(){return Wf=Wf||new Nt}ss.La="serverreachability";function zf(f){fe.call(this,ss.La,f)}g(zf,fe);function Fa(f){const y=Lo();Ct(y,new zf(y))}ss.STAT_EVENT="statevent";function Hf(f,y){fe.call(this,ss.STAT_EVENT,f),this.stat=y}g(Hf,fe);function jr(f){const y=Lo();Ct(y,new Hf(y,f))}ss.Ma="timingevent";function $f(f,y){fe.call(this,ss.Ma,f),this.size=y}g($f,fe);function as(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},y)}function Na(){this.g=!0}Na.prototype.xa=function(){this.g=!1};function fp(f,y,S,D,q,ie){f.info(function(){if(f.g)if(ie)for(var Ie="",Ut=ie.split("&"),Wr=0;Wr<Ut.length;Wr++){var Tt=Ut[Wr].split("=");if(1<Tt.length){var Zr=Tt[0];Tt=Tt[1];var en=Zr.split("_");Ie=2<=en.length&&en[1]=="type"?Ie+(Zr+"="+Tt+"&"):Ie+(Zr+"=redacted&")}}else Ie=null;else Ie=ie;return"XMLHTTP REQ ("+D+") [attempt "+q+"]: "+y+`
`+S+`
`+Ie})}function hp(f,y,S,D,q,ie,Ie){f.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+q+"]: "+y+`
`+S+`
`+ie+" "+Ie})}function I(f,y,S,D){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+L(f,S)+(D?" "+D:"")})}function V(f,y){f.info(function(){return"TIMEOUT: "+y})}Na.prototype.info=function(){};function L(f,y){if(!f.g)return y;if(!y)return null;try{var S=JSON.parse(y);if(S){for(f=0;f<S.length;f++)if(Array.isArray(S[f])){var D=S[f];if(!(2>D.length)){var q=D[1];if(Array.isArray(q)&&!(1>q.length)){var ie=q[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var Ie=1;Ie<q.length;Ie++)q[Ie]=""}}}}return Dr(S)}catch{return y}}var M={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},B={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},j;function J(){}g(J,Oo),J.prototype.g=function(){return new XMLHttpRequest},J.prototype.i=function(){return{}},j=new J;function ne(f,y,S,D){this.j=f,this.i=y,this.l=S,this.R=D||1,this.U=new rt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var te={},Z={};function me(f,y,S){f.L=1,f.v=Kf(ls(y)),f.m=S,f.P=!0,Te(f,null)}function Te(f,y){f.F=Date.now(),Ee(f),f.A=ls(f.v);var S=f.A,D=f.R;Array.isArray(D)||(D=[String(D)]),sx(S.i,"t",D),f.C=0,S=f.j.J,f.h=new Y,f.g=Tx(f.j,S?y:null,!f.m),0<f.O&&(f.M=new Me(h(f.Y,f,f.g),f.O)),y=f.U,S=f.g,D=f.ca;var q="readystatechange";Array.isArray(q)||(q&&(xr[0]=q.toString()),q=xr);for(var ie=0;ie<q.length;ie++){var Ie=ge(S,q[ie],D||y.handleEvent,!1,y.h||y);if(!Ie)break;y.g[Ie.key]=Ie}y=f.H?T(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),Fa(),fp(f.i,f.u,f.A,f.l,f.R,f.m)}ne.prototype.ca=function(f){f=f.target;const y=this.M;y&&cs(f)==3?y.j():this.Y(f)},ne.prototype.Y=function(f){try{if(f==this.g)e:{const en=cs(this.g);var y=this.g.Ba();const Uo=this.g.Z();if(!(3>en)&&(en!=3||this.g&&(this.h.h||this.g.oa()||hx(this.g)))){this.J||en!=4||y==7||(y==8||0>=Uo?Fa(3):Fa(2)),Mt(this);var S=this.g.Z();this.X=S;t:if(be(this)){var D=hx(this.g);f="";var q=D.length,ie=cs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qt(this),bt(this);var Ie="";break t}this.h.i=new o.TextDecoder}for(y=0;y<q;y++)this.h.h=!0,f+=this.h.i.decode(D[y],{stream:!(ie&&y==q-1)});D.length=0,this.h.g+=f,this.C=0,Ie=this.h.g}else Ie=this.g.oa();if(this.o=S==200,hp(this.i,this.u,this.A,this.l,this.R,en,S),this.o){if(this.T&&!this.K){t:{if(this.g){var Ut,Wr=this.g;if((Ut=Wr.g?Wr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ut)){var Tt=Ut;break t}}Tt=null}if(S=Tt)I(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,os(this,S);else{this.o=!1,this.s=3,jr(12),qt(this),bt(this);break e}}if(this.P){S=!0;let xi;for(;!this.J&&this.C<Ie.length;)if(xi=_e(this,Ie),xi==Z){en==4&&(this.s=4,jr(14),S=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(xi==te){this.s=4,jr(15),I(this.i,this.l,Ie,"[Invalid Chunk]"),S=!1;break}else I(this.i,this.l,xi,null),os(this,xi);if(be(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),en!=4||Ie.length!=0||this.h.h||(this.s=1,jr(16),S=!1),this.o=this.o&&S,!S)I(this.i,this.l,Ie,"[Invalid Chunked Response]"),qt(this),bt(this);else if(0<Ie.length&&!this.W){this.W=!0;var Zr=this.j;Zr.g==this&&Zr.ba&&!Zr.M&&(Zr.j.info("Great, no buffering proxy detected. Bytes received: "+Ie.length),_p(Zr),Zr.M=!0,jr(11))}}else I(this.i,this.l,Ie,null),os(this,Ie);en==4&&qt(this),this.o&&!this.J&&(en==4?xx(this.j,this):(this.o=!1,Ee(this)))}else XI(this.g),S==400&&0<Ie.indexOf("Unknown SID")?(this.s=3,jr(12)):(this.s=0,jr(13)),qt(this),bt(this)}}}catch{}finally{}};function be(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function _e(f,y){var S=f.C,D=y.indexOf(`
`,S);return D==-1?Z:(S=Number(y.substring(S,D)),isNaN(S)?te:(D+=1,D+S>y.length?Z:(y=y.slice(D,D+S),f.C=D+S,y)))}ne.prototype.cancel=function(){this.J=!0,qt(this)};function Ee(f){f.S=Date.now()+f.I,qe(f,f.I)}function qe(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=as(h(f.ba,f),y)}function Mt(f){f.B&&(o.clearTimeout(f.B),f.B=null)}ne.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(V(this.i,this.A),this.L!=2&&(Fa(),jr(17)),qt(this),this.s=2,bt(this)):qe(this,this.S-f)};function bt(f){f.j.G==0||f.J||xx(f.j,f)}function qt(f){Mt(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,Kt(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function os(f,y){try{var S=f.j;if(S.G!=0&&(S.g==f||jn(S.h,f))){if(!f.K&&jn(S.h,f)&&S.G==3){try{var D=S.Da.g.parse(y)}catch{D=null}if(Array.isArray(D)&&D.length==3){var q=D;if(q[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<f.F)e0(S),Jf(S);else break e;gp(S),jr(18)}}else S.za=q[1],0<S.za-S.T&&37500>q[2]&&S.F&&S.v==0&&!S.C&&(S.C=as(h(S.Za,S),6e3));if(1>=Mo(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else Da(S,11)}else if((f.K||S.g==f)&&e0(S),!w(y))for(q=S.Da.g.parse(y),y=0;y<q.length;y++){let Tt=q[y];if(S.T=Tt[0],Tt=Tt[1],S.G==2)if(Tt[0]=="c"){S.K=Tt[1],S.ia=Tt[2];const Zr=Tt[3];Zr!=null&&(S.la=Zr,S.j.info("VER="+S.la));const en=Tt[4];en!=null&&(S.Aa=en,S.j.info("SVER="+S.Aa));const Uo=Tt[5];Uo!=null&&typeof Uo=="number"&&0<Uo&&(D=1.5*Uo,S.L=D,S.j.info("backChannelRequestTimeoutMs_="+D)),D=S;const xi=f.g;if(xi){const r0=xi.g?xi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(r0){var ie=D.h;ie.g||r0.indexOf("spdy")==-1&&r0.indexOf("quic")==-1&&r0.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(dp(ie,ie.h),ie.h=null))}if(D.D){const vp=xi.g?xi.g.getResponseHeader("X-HTTP-Session-Id"):null;vp&&(D.ya=vp,Ht(D.I,D.D,vp))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-f.F,S.j.info("Handshake RTT: "+S.R+"ms")),D=S;var Ie=f;if(D.qa=Ex(D,D.J?D.ia:null,D.W),Ie.K){Qv(D.h,Ie);var Ut=Ie,Wr=D.L;Wr&&(Ut.I=Wr),Ut.B&&(Mt(Ut),Ee(Ut)),D.g=Ie}else _x(D);0<S.i.length&&Zf(S)}else Tt[0]!="stop"&&Tt[0]!="close"||Da(S,7);else S.G==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?Da(S,7):mp(S):Tt[0]!="noop"&&S.l&&S.l.ta(Tt),S.v=0)}}Fa(4)}catch{}}var Ra=class{constructor(f,y){this.g=f,this.map=y}};function Ms(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bi(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Mo(f){return f.h?1:f.g?f.g.size:0}function jn(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function dp(f,y){f.g?f.g.add(y):f.h=y}function Qv(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}Ms.prototype.cancel=function(){if(this.i=Jv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Jv(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const S of f.g.values())y=y.concat(S.D);return y}return x(f.i)}function PI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var y=[],S=f.length,D=0;D<S;D++)y.push(f[D]);return y}y=[],S=0;for(D in f)y[S++]=f[D];return y}function DI(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var y=[];f=f.length;for(var S=0;S<f;S++)y.push(S);return y}y=[],S=0;for(const D in f)y[S++]=D;return y}}}function Zv(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var S=DI(f),D=PI(f),q=D.length,ie=0;ie<q;ie++)y.call(void 0,D[ie],S&&S[ie],f)}var ex=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function bI(f,y){if(f){f=f.split("&");for(var S=0;S<f.length;S++){var D=f[S].indexOf("="),q=null;if(0<=D){var ie=f[S].substring(0,D);q=f[S].substring(D+1)}else ie=f[S];y(ie,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function Pa(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Pa){this.h=f.h,Gf(this,f.j),this.o=f.o,this.g=f.g,Xf(this,f.s),this.l=f.l;var y=f.i,S=new gc;S.i=y.i,y.g&&(S.g=new Map(y.g),S.h=y.h),tx(this,S),this.m=f.m}else f&&(y=String(f).match(ex))?(this.h=!1,Gf(this,y[1]||"",!0),this.o=pc(y[2]||""),this.g=pc(y[3]||"",!0),Xf(this,y[4]),this.l=pc(y[5]||"",!0),tx(this,y[6]||"",!0),this.m=pc(y[7]||"")):(this.h=!1,this.i=new gc(null,this.h))}Pa.prototype.toString=function(){var f=[],y=this.j;y&&f.push(mc(y,rx,!0),":");var S=this.g;return(S||y=="file")&&(f.push("//"),(y=this.o)&&f.push(mc(y,rx,!0),"@"),f.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&f.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&f.push("/"),f.push(mc(S,S.charAt(0)=="/"?MI:LI,!0))),(S=this.i.toString())&&f.push("?",S),(S=this.m)&&f.push("#",mc(S,VI)),f.join("")};function ls(f){return new Pa(f)}function Gf(f,y,S){f.j=S?pc(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function Xf(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function tx(f,y,S){y instanceof gc?(f.i=y,UI(f.i,f.h)):(S||(y=mc(y,BI)),f.i=new gc(y,f.h))}function Ht(f,y,S){f.i.set(y,S)}function Kf(f){return Ht(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function pc(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function mc(f,y,S){return typeof f=="string"?(f=encodeURI(f).replace(y,OI),S&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function OI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var rx=/[#\/\?@]/g,LI=/[#\?:]/g,MI=/[#\?]/g,BI=/[#\?@]/g,VI=/#/g;function gc(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function Bs(f){f.g||(f.g=new Map,f.h=0,f.i&&bI(f.i,function(y,S){f.add(decodeURIComponent(y.replace(/\+/g," ")),S)}))}t=gc.prototype,t.add=function(f,y){Bs(this),this.i=null,f=Bo(this,f);var S=this.g.get(f);return S||this.g.set(f,S=[]),S.push(y),this.h+=1,this};function nx(f,y){Bs(f),y=Bo(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function ix(f,y){return Bs(f),y=Bo(f,y),f.g.has(y)}t.forEach=function(f,y){Bs(this),this.g.forEach(function(S,D){S.forEach(function(q){f.call(y,q,D,this)},this)},this)},t.na=function(){Bs(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),S=[];for(let D=0;D<y.length;D++){const q=f[D];for(let ie=0;ie<q.length;ie++)S.push(y[D])}return S},t.V=function(f){Bs(this);let y=[];if(typeof f=="string")ix(this,f)&&(y=y.concat(this.g.get(Bo(this,f))));else{f=Array.from(this.g.values());for(let S=0;S<f.length;S++)y=y.concat(f[S])}return y},t.set=function(f,y){return Bs(this),this.i=null,f=Bo(this,f),ix(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function sx(f,y,S){nx(f,y),0<S.length&&(f.i=null,f.g.set(Bo(f,y),x(S)),f.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var S=0;S<y.length;S++){var D=y[S];const ie=encodeURIComponent(String(D)),Ie=this.V(D);for(D=0;D<Ie.length;D++){var q=ie;Ie[D]!==""&&(q+="="+encodeURIComponent(String(Ie[D]))),f.push(q)}}return this.i=f.join("&")};function Bo(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function UI(f,y){y&&!f.j&&(Bs(f),f.i=null,f.g.forEach(function(S,D){var q=D.toLowerCase();D!=q&&(nx(this,D),sx(this,q,S))},f)),f.j=y}function jI(f,y){const S=new Na;if(o.Image){const D=new Image;D.onload=p(Vs,S,"TestLoadImage: loaded",!0,y,D),D.onerror=p(Vs,S,"TestLoadImage: error",!1,y,D),D.onabort=p(Vs,S,"TestLoadImage: abort",!1,y,D),D.ontimeout=p(Vs,S,"TestLoadImage: timeout",!1,y,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=f}else y(!1)}function WI(f,y){const S=new Na,D=new AbortController,q=setTimeout(()=>{D.abort(),Vs(S,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:D.signal}).then(ie=>{clearTimeout(q),ie.ok?Vs(S,"TestPingServer: ok",!0,y):Vs(S,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(q),Vs(S,"TestPingServer: error",!1,y)})}function Vs(f,y,S,D,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),D(S)}catch{}}function zI(){this.g=new bo}function HI(f,y,S){const D=S||"";try{Zv(f,function(q,ie){let Ie=q;c(q)&&(Ie=Dr(q)),y.push(D+ie+"="+encodeURIComponent(Ie))})}catch(q){throw y.push(D+"type="+encodeURIComponent("_badmap")),q}}function qf(f){this.l=f.Ub||null,this.j=f.eb||!1}g(qf,Oo),qf.prototype.g=function(){return new Yf(this.l,this.j)},qf.prototype.i=function(f){return function(){return f}}({});function Yf(f,y){Nt.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Yf,Nt),t=Yf.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,vc(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_c(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,vc(this)),this.g&&(this.readyState=3,vc(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ax(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function ax(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?_c(this):vc(this),this.readyState==3&&ax(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,_c(this))},t.Qa=function(f){this.g&&(this.response=f,_c(this))},t.ga=function(){this.g&&_c(this)};function _c(f){f.readyState=4,f.l=null,f.j=null,f.v=null,vc(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var S=y.next();!S.done;)S=S.value,f.push(S[0]+": "+S[1]),S=y.next();return f.join(`\r
`)};function vc(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Yf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function ox(f){let y="";return H(f,function(S,D){y+=D,y+=":",y+=S,y+=`\r
`}),y}function pp(f,y,S){e:{for(D in S){var D=!1;break e}D=!0}D||(S=ox(S),typeof f=="string"?S!=null&&encodeURIComponent(String(S)):Ht(f,y,S))}function sr(f){Nt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(sr,Nt);var $I=/^https?$/i,GI=["POST","PUT"];t=sr.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,S,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():j.g(),this.v=this.o?fc(this.o):fc(j),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(ie){lx(this,ie);return}if(f=S||"",S=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var q in D)S.set(q,D[q]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const ie of D.keys())S.set(ie,D.get(ie));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(S.keys()).find(ie=>ie.toLowerCase()=="content-type"),q=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(GI,y,void 0))||D||q||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,Ie]of S)this.g.setRequestHeader(ie,Ie);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{fx(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){lx(this,ie)}};function lx(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,cx(f),Qf(f)}function cx(f){f.A||(f.A=!0,Ct(f,"complete"),Ct(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ct(this,"complete"),Ct(this,"abort"),Qf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qf(this,!0)),sr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ux(this):this.bb())},t.bb=function(){ux(this)};function ux(f){if(f.h&&typeof a<"u"&&(!f.v[1]||cs(f)!=4||f.Z()!=2)){if(f.u&&cs(f)==4)Pn(f.Ea,0,f);else if(Ct(f,"readystatechange"),cs(f)==4){f.h=!1;try{const Ie=f.Z();e:switch(Ie){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var S;if(!(S=y)){var D;if(D=Ie===0){var q=String(f.D).match(ex)[1]||null;!q&&o.self&&o.self.location&&(q=o.self.location.protocol.slice(0,-1)),D=!$I.test(q?q.toLowerCase():"")}S=D}if(S)Ct(f,"complete"),Ct(f,"success");else{f.m=6;try{var ie=2<cs(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",cx(f)}}finally{Qf(f)}}}}function Qf(f,y){if(f.g){fx(f);const S=f.g,D=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Ct(f,"ready");try{S.onreadystatechange=D}catch{}}}function fx(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function cs(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<cs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),is(y)}};function hx(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function XI(f){const y={};f=(f.g&&2<=cs(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<f.length;D++){if(w(f[D]))continue;var S=A(f[D]);const q=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ie=y[q]||[];y[q]=ie,ie.push(S)}E(y,function(D){return D.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xc(f,y,S){return S&&S.internalChannelParams&&S.internalChannelParams[f]||y}function dx(f){this.Aa=0,this.i=[],this.j=new Na,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xc("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xc("baseRetryDelayMs",5e3,f),this.cb=xc("retryDelaySeedMs",1e4,f),this.Wa=xc("forwardChannelMaxRetries",2,f),this.wa=xc("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Ms(f&&f.concurrentRequestLimit),this.Da=new zI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=dx.prototype,t.la=8,t.G=1,t.connect=function(f,y,S,D){jr(0),this.W=f,this.H=y||{},S&&D!==void 0&&(this.H.OSID=S,this.H.OAID=D),this.F=this.X,this.I=Ex(this,null,this.W),Zf(this)};function mp(f){if(px(f),f.G==3){var y=f.U++,S=ls(f.I);if(Ht(S,"SID",f.K),Ht(S,"RID",y),Ht(S,"TYPE","terminate"),yc(f,S),y=new ne(f,f.j,y),y.L=2,y.v=Kf(ls(S)),S=!1,o.navigator&&o.navigator.sendBeacon)try{S=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!S&&o.Image&&(new Image().src=y.v,S=!0),S||(y.g=Tx(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Ee(y)}wx(f)}function Jf(f){f.g&&(_p(f),f.g.cancel(),f.g=null)}function px(f){Jf(f),f.u&&(o.clearTimeout(f.u),f.u=null),e0(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Zf(f){if(!Bi(f.h)&&!f.s){f.s=!0;var y=f.Ga;de||X(),re||(de(),re=!0),ye.add(y,f),f.B=0}}function KI(f,y){return Mo(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=as(h(f.Ga,f,y),yx(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const q=new ne(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=T(ie),C(ie,this.S)):ie=this.S),this.m!==null||this.O||(q.H=ie,ie=null),this.P)e:{for(var y=0,S=0;S<this.i.length;S++){t:{var D=this.i[S];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(y+=D,4096<y){y=S;break e}if(y===4096||S===this.i.length-1){y=S+1;break e}}y=1e3}else y=1e3;y=gx(this,q,y),S=ls(this.I),Ht(S,"RID",f),Ht(S,"CVER",22),this.D&&Ht(S,"X-HTTP-Session-Id",this.D),yc(this,S),ie&&(this.O?y="headers="+encodeURIComponent(String(ox(ie)))+"&"+y:this.m&&pp(S,this.m,ie)),dp(this.h,q),this.Ua&&Ht(S,"TYPE","init"),this.P?(Ht(S,"$req",y),Ht(S,"SID","null"),q.T=!0,me(q,S,null)):me(q,S,y),this.G=2}}else this.G==3&&(f?mx(this,f):this.i.length==0||Bi(this.h)||mx(this))};function mx(f,y){var S;y?S=y.l:S=f.U++;const D=ls(f.I);Ht(D,"SID",f.K),Ht(D,"RID",S),Ht(D,"AID",f.T),yc(f,D),f.m&&f.o&&pp(D,f.m,f.o),S=new ne(f,f.j,S,f.B+1),f.m===null&&(S.H=f.o),y&&(f.i=y.D.concat(f.i)),y=gx(f,S,1e3),S.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),dp(f.h,S),me(S,D,y)}function yc(f,y){f.H&&H(f.H,function(S,D){Ht(y,D,S)}),f.l&&Zv({},function(S,D){Ht(y,D,S)})}function gx(f,y,S){S=Math.min(f.i.length,S);var D=f.l?h(f.l.Na,f.l,f):null;e:{var q=f.i;let ie=-1;for(;;){const Ie=["count="+S];ie==-1?0<S?(ie=q[0].g,Ie.push("ofs="+ie)):ie=0:Ie.push("ofs="+ie);let Ut=!0;for(let Wr=0;Wr<S;Wr++){let Tt=q[Wr].g;const Zr=q[Wr].map;if(Tt-=ie,0>Tt)ie=Math.max(0,q[Wr].g-100),Ut=!1;else try{HI(Zr,Ie,"req"+Tt+"_")}catch{D&&D(Zr)}}if(Ut){D=Ie.join("&");break e}}}return f=f.i.splice(0,S),y.D=f,D}function _x(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;de||X(),re||(de(),re=!0),ye.add(y,f),f.v=0}}function gp(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=as(h(f.Fa,f),yx(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,vx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=as(h(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,jr(10),Jf(this),vx(this))};function _p(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function vx(f){f.g=new ne(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=ls(f.qa);Ht(y,"RID","rpc"),Ht(y,"SID",f.K),Ht(y,"AID",f.T),Ht(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Ht(y,"TO",f.ja),Ht(y,"TYPE","xmlhttp"),yc(f,y),f.m&&f.o&&pp(y,f.m,f.o),f.L&&(f.g.I=f.L);var S=f.g;f=f.ia,S.L=1,S.v=Kf(ls(y)),S.m=null,S.P=!0,Te(S,f)}t.Za=function(){this.C!=null&&(this.C=null,Jf(this),gp(this),jr(19))};function e0(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function xx(f,y){var S=null;if(f.g==y){e0(f),_p(f),f.g=null;var D=2}else if(jn(f.h,y))S=y.D,Qv(f.h,y),D=1;else return;if(f.G!=0){if(y.o)if(D==1){S=y.m?y.m.length:0,y=Date.now()-y.F;var q=f.B;D=Lo(),Ct(D,new $f(D,S)),Zf(f)}else _x(f);else if(q=y.s,q==3||q==0&&0<y.X||!(D==1&&KI(f,y)||D==2&&gp(f)))switch(S&&0<S.length&&(y=f.h,y.i=y.i.concat(S)),q){case 1:Da(f,5);break;case 4:Da(f,10);break;case 3:Da(f,6);break;default:Da(f,2)}}}function yx(f,y){let S=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(S*=2),S*y}function Da(f,y){if(f.j.info("Error code "+y),y==2){var S=h(f.fb,f),D=f.Xa;const q=!D;D=new Pa(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Gf(D,"https"),Kf(D),q?jI(D.toString(),S):WI(D.toString(),S)}else jr(2);f.G=0,f.l&&f.l.sa(y),wx(f),px(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),jr(2)):(this.j.info("Failed to ping google.com"),jr(1))};function wx(f){if(f.G=0,f.ka=[],f.l){const y=Jv(f.h);(y.length!=0||f.i.length!=0)&&(_(f.ka,y),_(f.ka,f.i),f.h.i.length=0,x(f.i),f.i.length=0),f.l.ra()}}function Ex(f,y,S){var D=S instanceof Pa?ls(S):new Pa(S);if(D.g!="")y&&(D.g=y+"."+D.g),Xf(D,D.s);else{var q=o.location;D=q.protocol,y=y?y+"."+q.hostname:q.hostname,q=+q.port;var ie=new Pa(null);D&&Gf(ie,D),y&&(ie.g=y),q&&Xf(ie,q),S&&(ie.l=S),D=ie}return S=f.D,y=f.ya,S&&y&&Ht(D,S,y),Ht(D,"VER",f.la),yc(f,D),D}function Tx(f,y,S){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new sr(new qf({eb:S})):new sr(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function kx(){}t=kx.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function t0(){}t0.prototype.g=function(f,y){return new Wn(f,y)};function Wn(f,y){Nt.call(this),this.g=new dx(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!w(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!w(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new Vo(this)}g(Wn,Nt),Wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Wn.prototype.close=function(){mp(this.g)},Wn.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var S={};S.__data__=f,f=S}else this.u&&(S={},S.__data__=Dr(f),f=S);y.i.push(new Ra(y.Ya++,f)),y.G==3&&Zf(y)},Wn.prototype.N=function(){this.g.l=null,delete this.j,mp(this.g),delete this.g,Wn.aa.N.call(this)};function Sx(f){dc.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const S in y){f=S;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}g(Sx,dc);function Cx(){Ls.call(this),this.status=1}g(Cx,Ls);function Vo(f){this.g=f}g(Vo,kx),Vo.prototype.ua=function(){Ct(this.g,"a")},Vo.prototype.ta=function(f){Ct(this.g,new Sx(f))},Vo.prototype.sa=function(f){Ct(this.g,new Cx)},Vo.prototype.ra=function(){Ct(this.g,"b")},t0.prototype.createWebChannel=t0.prototype.g,Wn.prototype.send=Wn.prototype.o,Wn.prototype.open=Wn.prototype.m,Wn.prototype.close=Wn.prototype.close,I4=function(){return new t0},A4=function(){return Lo()},C4=ss,U1={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},M.NO_ERROR=0,M.TIMEOUT=8,M.HTTP_ERROR=6,nh=M,B.COMPLETE="complete",S4=B,hc.EventType=Ia,Ia.OPEN="a",Ia.CLOSE="b",Ia.ERROR="c",Ia.MESSAGE="d",Nt.prototype.listen=Nt.prototype.K,Uc=hc,sr.prototype.listenOnce=sr.prototype.L,sr.prototype.getLastError=sr.prototype.Ka,sr.prototype.getLastErrorCode=sr.prototype.Ba,sr.prototype.getStatus=sr.prototype.Z,sr.prototype.getResponseJson=sr.prototype.Oa,sr.prototype.getResponseText=sr.prototype.oa,sr.prototype.send=sr.prototype.ea,sr.prototype.setWithCredentials=sr.prototype.Ha,k4=sr}).apply(typeof T0<"u"?T0:typeof self<"u"?self:typeof window<"u"?window:{});const D2="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ic="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=new f_("@firebase/firestore");function Dc(){return ho.logLevel}function je(t,...e){if(ho.logLevel<=vt.DEBUG){const r=e.map(K_);ho.debug(`Firestore (${ic}): ${t}`,...r)}}function Ns(t,...e){if(ho.logLevel<=vt.ERROR){const r=e.map(K_);ho.error(`Firestore (${ic}): ${t}`,...r)}}function jl(t,...e){if(ho.logLevel<=vt.WARN){const r=e.map(K_);ho.warn(`Firestore (${ic}): ${t}`,...r)}}function K_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t="Unexpected state"){const e=`FIRESTORE (${ic}) INTERNAL ASSERTION FAILED: `+t;throw Ns(e),new Error(e)}function fr(t,e){t||tt()}function xt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends ec{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ln.UNAUTHENTICATED))}shutdown(){}}class F8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class N8{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){fr(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Qa;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Qa,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Qa)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(fr(typeof n.accessToken=="string"),new F4(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fr(e===null||typeof e=="string"),new ln(e)}}class R8{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class P8{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new R8(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(ln.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class D8{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b8{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){fr(this.o===void 0);const n=s=>{s.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,je("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(fr(typeof r.token=="string"),this.R=r.token,new D8(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=O8(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function It(t,e){return t<e?-1:t>e?1:0}function Wl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Un.fromMillis(Date.now())}static fromDate(e){return Un.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Un(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new Un(0,0))}static max(){return new Qe(new Un(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,r,n){r===void 0?r=0:r>e.length&&tt(),n===void 0?n=e.length-r:n>e.length-r&&tt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ku.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ku?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class lr extends Ku{construct(e,r,n){return new lr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(Ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new lr(r)}static emptyPath(){return new lr([])}}const M8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends Ku{construct(e,r,n){return new kn(e,r,n)}static isValidIdentifier(e){return M8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new kn(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new $e(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new $e(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new $e(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new $e(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kn(r)}static emptyPath(){return new kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.path=e}static fromPath(e){return new Ke(lr.fromString(e))}static fromName(e){return new Ke(lr.fromString(e).popFirst(5))}static empty(){return new Ke(lr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&lr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return lr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ke(new lr(e.slice()))}}function B8(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Qe.fromTimestamp(n===1e9?new Un(r+1,0):new Un(r,n));return new ga(i,Ke.empty(),e)}function V8(t){return new ga(t.readTime,t.key,-1)}class ga{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ga(Qe.min(),Ke.empty(),-1)}static max(){return new ga(Qe.max(),Ke.empty(),-1)}}function U8(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ke.comparator(t.documentKey,e.documentKey),r!==0?r:It(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class W8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q_(t){if(t.code!==Ne.FAILED_PRECONDITION||t.message!==j8)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&tt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new pe((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof pe?r:pe.resolve(r)}catch(r){return pe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):pe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):pe.reject(r)}static resolve(e){return new pe((r,n)=>{r(e)})}static reject(e){return new pe((r,n)=>{n(e)})}static waitFor(e){return new pe((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=pe.resolve(!1);for(const n of e)r=r.next(i=>i?pe.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new pe((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(e,r){return new pe((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function z8(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Nf(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Y_.oe=-1;function jd(t){return t==null}function j1(t){return t===0&&1/t==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Wd(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function H8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,r){this.comparator=e,this.root=r||Hr.EMPTY}insert(e,r){return new _r(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Hr.BLACK,null,null))}remove(e){return new _r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new k0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new k0(this.root,e,this.comparator,!1)}getReverseIterator(){return new k0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new k0(this.root,e,this.comparator,!0)}}class k0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Hr.RED,this.left=i??Hr.EMPTY,this.right=s??Hr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Hr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Hr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Hr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw tt();const e=this.left.check();if(e!==this.right.check())throw tt();return e+(this.isRed()?0:1)}}Hr.EMPTY=null,Hr.RED=!0,Hr.BLACK=!1;Hr.EMPTY=new class{constructor(){this.size=0}get key(){throw tt()}get value(){throw tt()}get color(){throw tt()}get left(){throw tt()}get right(){throw tt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Hr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.comparator=e,this.data=new _r(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new O2(this.data.getIterator())}getIteratorFrom(e){return new O2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Kr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Kr(this.comparator);return r.data=e,r}}class O2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this.fields=e,e.sort(kn.comparator)}static empty(){return new qs([])}unionWith(e){let r=new Kr(kn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new qs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Wl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new N4("Invalid base64 string: "+s):s}}(e);return new Qr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new Qr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qr.EMPTY_BYTE_STRING=new Qr("");const $8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _a(t){if(fr(!!t),typeof t=="string"){let e=0;const r=$8.exec(t);if(fr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:dr(t.seconds),nanos:dr(t.nanos)}}function dr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function po(t){return typeof t=="string"?Qr.fromBase64String(t):Qr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function J_(t){const e=t.mapValue.fields.__previous_value__;return Q_(e)?J_(e):e}function qu(t){const e=_a(t.mapValue.fields.__local_write_time__.timestampValue);return new Un(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Yu{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Yu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Yu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0={mapValue:{}};function mo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Q_(t)?4:K8(t)?9007199254740991:X8(t)?10:11:tt()}function Zi(t,e){if(t===e)return!0;const r=mo(t);if(r!==mo(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qu(t).isEqual(qu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=_a(i.timestampValue),o=_a(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return po(i.bytesValue).isEqual(po(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return dr(i.geoPointValue.latitude)===dr(s.geoPointValue.latitude)&&dr(i.geoPointValue.longitude)===dr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return dr(i.integerValue)===dr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=dr(i.doubleValue),o=dr(s.doubleValue);return a===o?j1(a)===j1(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Wl(t.arrayValue.values||[],e.arrayValue.values||[],Zi);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(b2(a)!==b2(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Zi(a[l],o[l])))return!1;return!0}(t,e);default:return tt()}}function Qu(t,e){return(t.values||[]).find(r=>Zi(r,e))!==void 0}function zl(t,e){if(t===e)return 0;const r=mo(t),n=mo(e);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=dr(s.integerValue||s.doubleValue),l=dr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return L2(t.timestampValue,e.timestampValue);case 4:return L2(qu(t),qu(e));case 5:return It(t.stringValue,e.stringValue);case 6:return function(s,a){const o=po(s),l=po(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=It(o[c],l[c]);if(u!==0)return u}return It(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=It(dr(s.latitude),dr(a.latitude));return o!==0?o:It(dr(s.longitude),dr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return M2(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,u;const d=s.fields||{},h=a.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,g=(l=h.value)===null||l===void 0?void 0:l.arrayValue,x=It(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return x!==0?x:M2(p,g)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===S0.mapValue&&a===S0.mapValue)return 0;if(s===S0.mapValue)return 1;if(a===S0.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const h=It(l[d],u[d]);if(h!==0)return h;const p=zl(o[l[d]],c[u[d]]);if(p!==0)return p}return It(l.length,u.length)}(t.mapValue,e.mapValue);default:throw tt()}}function L2(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return It(t,e);const r=_a(t),n=_a(e),i=It(r.seconds,n.seconds);return i!==0?i:It(r.nanos,n.nanos)}function M2(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=zl(r[i],n[i]);if(s)return s}return It(r.length,n.length)}function Hl(t){return W1(t)}function W1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=_a(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return po(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ke.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=W1(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${W1(r.fields[a])}`;return i+"}"}(t.mapValue):tt()}function z1(t){return!!t&&"integerValue"in t}function Z_(t){return!!t&&"arrayValue"in t}function B2(t){return!!t&&"nullValue"in t}function V2(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function im(t){return!!t&&"mapValue"in t}function X8(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function au(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Wd(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=au(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=au(t.arrayValue.values[r]);return e}return Object.assign({},t)}function K8(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.value=e}static empty(){return new Xi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!im(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=au(r)}setAll(e){let r=kn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=au(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());im(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Zi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];im(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Wd(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Xi(au(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new hn(e,0,Qe.min(),Qe.min(),Qe.min(),Xi.empty(),0)}static newFoundDocument(e,r,n,i){return new hn(e,1,r,Qe.min(),n,i,0)}static newNoDocument(e,r){return new hn(e,2,r,Qe.min(),Qe.min(),Xi.empty(),0)}static newUnknownDocument(e,r){return new hn(e,3,r,Qe.min(),Qe.min(),Xi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,r){this.position=e,this.inclusive=r}}function U2(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Ke.comparator(Ke.fromName(a.referenceValue),r.key):n=zl(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function j2(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Zi(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,r="asc"){this.field=e,this.dir=r}}function q8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{}class Fr extends R4{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Q8(e,r,n):r==="array-contains"?new eb(e,n):r==="in"?new tb(e,n):r==="not-in"?new rb(e,n):r==="array-contains-any"?new nb(e,n):new Fr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new J8(e,n):new Z8(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(zl(r,this.value)):r!==null&&mo(this.value)===mo(r)&&this.matchesComparison(zl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return tt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class es extends R4{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new es(e,r)}matches(e){return P4(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function P4(t){return t.op==="and"}function D4(t){return Y8(t)&&P4(t)}function Y8(t){for(const e of t.filters)if(e instanceof es)return!1;return!0}function H1(t){if(t instanceof Fr)return t.field.canonicalString()+t.op.toString()+Hl(t.value);if(D4(t))return t.filters.map(e=>H1(e)).join(",");{const e=t.filters.map(r=>H1(r)).join(",");return`${t.op}(${e})`}}function b4(t,e){return t instanceof Fr?function(n,i){return i instanceof Fr&&n.op===i.op&&n.field.isEqual(i.field)&&Zi(n.value,i.value)}(t,e):t instanceof es?function(n,i){return i instanceof es&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&b4(a,i.filters[o]),!0):!1}(t,e):void tt()}function O4(t){return t instanceof Fr?function(r){return`${r.field.canonicalString()} ${r.op} ${Hl(r.value)}`}(t):t instanceof es?function(r){return r.op.toString()+" {"+r.getFilters().map(O4).join(" ,")+"}"}(t):"Filter"}class Q8 extends Fr{constructor(e,r,n){super(e,r,n),this.key=Ke.fromName(n.referenceValue)}matches(e){const r=Ke.comparator(e.key,this.key);return this.matchesComparison(r)}}class J8 extends Fr{constructor(e,r){super(e,"in",r),this.keys=L4("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Z8 extends Fr{constructor(e,r){super(e,"not-in",r),this.keys=L4("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function L4(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Ke.fromName(n.referenceValue))}class eb extends Fr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Z_(r)&&Qu(r.arrayValue,this.value)}}class tb extends Fr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Qu(this.value.arrayValue,r)}}class rb extends Fr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Qu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Qu(this.value.arrayValue,r)}}class nb extends Fr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Z_(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Qu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function W2(t,e=null,r=[],n=[],i=null,s=null,a=null){return new ib(t,e,r,n,i,s,a)}function ev(t){const e=xt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>H1(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),jd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Hl(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Hl(n)).join(",")),e.ue=r}return e.ue}function tv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!q8(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!b4(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!j2(t.startAt,e.startAt)&&j2(t.endAt,e.endAt)}function $1(t){return Ke.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function sb(t,e,r,n,i,s,a,o){return new zd(t,e,r,n,i,s,a,o)}function M4(t){return new zd(t)}function z2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ab(t){return t.collectionGroup!==null}function ou(t){const e=xt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Kr(kn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new qh(s,n))}),r.has(kn.keyField().canonicalString())||e.ce.push(new qh(kn.keyField(),n))}return e.ce}function Ji(t){const e=xt(t);return e.le||(e.le=ob(e,ou(t))),e.le}function ob(t,e){if(t.limitType==="F")return W2(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new qh(i.field,s)});const r=t.endAt?new Kh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Kh(t.startAt.position,t.startAt.inclusive):null;return W2(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function G1(t,e,r){return new zd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Hd(t,e){return tv(Ji(t),Ji(e))&&t.limitType===e.limitType}function B4(t){return`${ev(Ji(t))}|lt:${t.limitType}`}function Xo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>O4(i)).join(", ")}]`),jd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Hl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Hl(i)).join(",")),`Target(${n})`}(Ji(t))}; limitType=${t.limitType})`}function $d(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Ke.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of ou(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=U2(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,ou(n),i)||n.endAt&&!function(a,o,l){const c=U2(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,ou(n),i))}(t,e)}function lb(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function V4(t){return(e,r)=>{let n=!1;for(const i of ou(t)){const s=cb(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function cb(t,e,r){const n=t.field.isKeyField()?Ke.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?zl(l,c):tt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return tt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Wd(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return H8(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub=new _r(Ke.comparator);function va(){return ub}const U4=new _r(Ke.comparator);function jc(...t){let e=U4;for(const r of t)e=e.insert(r.key,r);return e}function fb(t){let e=U4;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Xa(){return lu()}function j4(){return lu()}function lu(){return new sc(t=>t.toString(),(t,e)=>t.isEqual(e))}const hb=new Kr(Ke.comparator);function yt(...t){let e=hb;for(const r of t)e=e.add(r);return e}const db=new Kr(It);function pb(){return db}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mb(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:j1(e)?"-0":e}}function gb(t){return{integerValue:""+t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(){this._=void 0}}function _b(t,e,r){return t instanceof X1?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Q_(s)&&(s=J_(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Yh?W4(t,e):t instanceof Qh?z4(t,e):function(i,s){const a=xb(i,s),o=H2(a)+H2(i.Pe);return z1(a)&&z1(i.Pe)?gb(o):mb(i.serializer,o)}(t,e)}function vb(t,e,r){return t instanceof Yh?W4(t,e):t instanceof Qh?z4(t,e):r}function xb(t,e){return t instanceof K1?function(n){return z1(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class X1 extends Gd{}class Yh extends Gd{constructor(e){super(),this.elements=e}}function W4(t,e){const r=H4(e);for(const n of t.elements)r.some(i=>Zi(i,n))||r.push(n);return{arrayValue:{values:r}}}class Qh extends Gd{constructor(e){super(),this.elements=e}}function z4(t,e){let r=H4(e);for(const n of t.elements)r=r.filter(i=>!Zi(i,n));return{arrayValue:{values:r}}}class K1 extends Gd{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function H2(t){return dr(t.integerValue||t.doubleValue)}function H4(t){return Z_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function yb(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Yh&&i instanceof Yh||n instanceof Qh&&i instanceof Qh?Wl(n.elements,i.elements,Zi):n instanceof K1&&i instanceof K1?Zi(n.Pe,i.Pe):n instanceof X1&&i instanceof X1}(t.transform,e.transform)}class Ja{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ja}static exists(e){return new Ja(void 0,e)}static updateTime(e){return new Ja(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ih(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class rv{}function $4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Eb(t.key,Ja.none()):new nv(t.key,t.data,Ja.none());{const r=t.data,n=Xi.empty();let i=new Kr(kn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new Xd(t.key,n,new qs(i.toArray()),Ja.none())}}function wb(t,e,r){t instanceof nv?function(i,s,a){const o=i.value.clone(),l=G2(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Xd?function(i,s,a){if(!ih(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=G2(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(G4(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function cu(t,e,r,n){return t instanceof nv?function(s,a,o,l){if(!ih(s.precondition,a))return o;const c=s.value.clone(),u=X2(s.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof Xd?function(s,a,o,l){if(!ih(s.precondition,a))return o;const c=X2(s.fieldTransforms,l,a),u=a.data;return u.setAll(G4(s)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(s,a,o){return ih(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function $2(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Wl(n,i,(s,a)=>yb(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class nv extends rv{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xd extends rv{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function G4(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function G2(t,e,r){const n=new Map;fr(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,vb(a,o,r[i]))}return n}function X2(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,_b(s,a,e))}return n}class Eb extends rv{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&wb(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=cu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=cu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=j4();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=$4(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Qe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),yt())}isEqual(e){return this.batchId===e.batchId&&Wl(this.mutations,e.mutations,(r,n)=>$2(r,n))&&Wl(this.baseMutations,e.baseMutations,(r,n)=>$2(r,n))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wr,_t;function X4(t){if(t===void 0)return Ns("GRPC error has no .code"),Ne.UNKNOWN;switch(t){case wr.OK:return Ne.OK;case wr.CANCELLED:return Ne.CANCELLED;case wr.UNKNOWN:return Ne.UNKNOWN;case wr.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case wr.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case wr.INTERNAL:return Ne.INTERNAL;case wr.UNAVAILABLE:return Ne.UNAVAILABLE;case wr.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case wr.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case wr.NOT_FOUND:return Ne.NOT_FOUND;case wr.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case wr.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case wr.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case wr.ABORTED:return Ne.ABORTED;case wr.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case wr.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case wr.DATA_LOSS:return Ne.DATA_LOSS;default:return tt()}}(_t=wr||(wr={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=new Ya([4294967295,4294967295],0);function K2(t){const e=Cb().encode(t),r=new T4;return r.update(e),new Uint8Array(r.digest())}function q2(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ya([r,n],0),new Ya([i,s],0)]}class iv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Wc(`Invalid padding: ${r}`);if(n<0)throw new Wc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Wc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Wc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Ya.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Ya.fromNumber(n)));return i.compare(Ab)===1&&(i=new Ya([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=K2(e),[n,i]=q2(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new iv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=K2(e),[n,i]=q2(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Wc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Rf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Kd(Qe.min(),i,new _r(It),va(),yt())}}class Rf{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Rf(n,r,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class K4{constructor(e,r){this.targetId=e,this.me=r}}class q4{constructor(e,r,n=Qr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class Y2{constructor(){this.fe=0,this.ge=J2(),this.pe=Qr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=yt(),r=yt(),n=yt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:tt()}}),new Rf(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=J2()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,fr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Ib{constructor(e){this.Le=e,this.Be=new Map,this.ke=va(),this.qe=Q2(),this.Qe=new _r(It)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:tt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if($1(s))if(n===0){const a=new Ke(s.path);this.Ue(r,a,hn.newNoDocument(a,Qe.min()))}else fr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=po(n).toUint8Array()}catch(l){if(l instanceof N4)return jl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new iv(a,i,s)}catch(l){return jl(l instanceof Wc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&$1(o.target)){const l=new Ke(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,hn.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=yt();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new Kd(e,r,this.Qe,this.ke,n);return this.ke=va(),this.qe=Q2(),this.Qe=new _r(It),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new Y2,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Kr(It),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||je("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Y2),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function Q2(){return new _r(Ke.comparator)}function J2(){return new _r(Ke.comparator)}const Fb={asc:"ASCENDING",desc:"DESCENDING"},Nb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rb={and:"AND",or:"OR"};class Pb{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function q1(t,e){return t.useProto3Json||jd(e)?e:{value:e}}function Db(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xl(t){return fr(!!t),Qe.fromTimestamp(function(r){const n=_a(r);return new Un(n.seconds,n.nanos)}(t))}function Ob(t,e){return Y1(t,e).canonicalString()}function Y1(t,e){const r=function(i){return new lr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Y4(t){const e=lr.fromString(t);return fr(tC(e)),e}function sm(t,e){const r=Y4(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ke(J4(r))}function Q4(t,e){return Ob(t.databaseId,e)}function Lb(t){const e=Y4(t);return e.length===4?lr.emptyPath():J4(e)}function Z2(t){return new lr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function J4(t){return fr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Mb(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:tt()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(fr(u===void 0||typeof u=="string"),Qr.fromBase64String(u||"")):(fr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Qr.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?Ne.UNKNOWN:X4(c.code);return new $e(u,c.message||"")}(a);r=new q4(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=sm(t,n.document.name),s=xl(n.document.updateTime),a=n.document.createTime?xl(n.document.createTime):Qe.min(),o=new Xi({mapValue:{fields:n.document.fields}}),l=hn.newFoundDocument(i,s,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new sh(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=sm(t,n.document),s=n.readTime?xl(n.readTime):Qe.min(),a=hn.newNoDocument(i,s),o=n.removedTargetIds||[];r=new sh([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=sm(t,n.document),s=n.removedTargetIds||[];r=new sh([],s,i,null)}else{if(!("filter"in e))return tt();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new Sb(i,s),o=n.targetId;r=new K4(o,a)}}return r}function Bb(t,e){return{documents:[Q4(t,e.path)]}}function Vb(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Q4(t,i);const s=function(c){if(c.length!==0)return eC(es.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:Ko(h.field),direction:Wb(h.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=q1(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function Ub(t){let e=Lb(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){fr(n===1);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];r.where&&(s=function(d){const h=Z4(d);return h instanceof es&&D4(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(d){return d.map(h=>function(g){return new qh(qo(g.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(d){let h;return h=typeof d=="object"?d.value:d,jd(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(d){const h=!!d.before,p=d.values||[];return new Kh(p,h)}(r.startAt));let c=null;return r.endAt&&(c=function(d){const h=!d.before,p=d.values||[];return new Kh(p,h)}(r.endAt)),sb(e,i,a,s,o,"F",l,c)}function jb(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Z4(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=qo(r.unaryFilter.field);return Fr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=qo(r.unaryFilter.field);return Fr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=qo(r.unaryFilter.field);return Fr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qo(r.unaryFilter.field);return Fr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return tt()}}(t):t.fieldFilter!==void 0?function(r){return Fr.create(qo(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return tt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return es.create(r.compositeFilter.filters.map(n=>Z4(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return tt()}}(r.compositeFilter.op))}(t):tt()}function Wb(t){return Fb[t]}function zb(t){return Nb[t]}function Hb(t){return Rb[t]}function Ko(t){return{fieldPath:t.canonicalString()}}function qo(t){return kn.fromServerFormat(t.fieldPath)}function eC(t){return t instanceof Fr?function(r){if(r.op==="=="){if(V2(r.value))return{unaryFilter:{field:Ko(r.field),op:"IS_NAN"}};if(B2(r.value))return{unaryFilter:{field:Ko(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(V2(r.value))return{unaryFilter:{field:Ko(r.field),op:"IS_NOT_NAN"}};if(B2(r.value))return{unaryFilter:{field:Ko(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(r.field),op:zb(r.op),value:r.value}}}(t):t instanceof es?function(r){const n=r.getFilters().map(i=>eC(i));return n.length===1?n[0]:{compositeFilter:{op:Hb(r.op),filters:n}}}(t):tt()}function tC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,r,n,i,s=Qe.min(),a=Qe.min(),o=Qr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ys(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ys(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e){this.ct=e}}function Gb(t){const e=Ub({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?G1(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(){this.un=new Kb}addToCollectionParentIndex(e,r){return this.un.add(r),pe.resolve()}getCollectionParents(e,r){return pe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return pe.resolve()}deleteFieldIndex(e,r){return pe.resolve()}deleteAllFieldIndexes(e){return pe.resolve()}createTargetIndexes(e,r){return pe.resolve()}getDocumentsMatchingTarget(e,r){return pe.resolve(null)}getIndexType(e,r){return pe.resolve(0)}getFieldIndexes(e,r){return pe.resolve([])}getNextCollectionGroupToUpdate(e){return pe.resolve(null)}getMinOffset(e,r){return pe.resolve(ga.min())}getMinOffsetFromCollectionGroup(e,r){return pe.resolve(ga.min())}updateCollectionGroup(e,r,n){return pe.resolve()}updateIndexEntries(e,r){return pe.resolve()}}class Kb{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Kr(lr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Kr(lr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new $l(0)}static kn(){return new $l(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(){this.changes=new sc(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?pe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&cu(n.mutation,i,qs.empty(),Un.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,yt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=yt()){const i=Xa();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=jc();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Xa();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,yt()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=va();const a=lu(),o=function(){return lu()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Xd)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),cu(u.mutation,c,u.mutation.getFieldMask(),Un.now())):a.set(c.key,qs.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var d;return o.set(c,new Yb(u,(d=a.get(c))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(e,r){const n=lu();let i=new _r((a,o)=>a-o),s=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||qs.empty();u=o.applyToLocalView(c,u),n.set(l,u);const d=(i.get(o.batchId)||yt()).add(l);i=i.insert(o.batchId,d)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,d=j4();u.forEach(h=>{if(!s.has(h)){const p=$4(r.get(h),n.get(h));p!==null&&d.set(h,p),s=s.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,d))}return pe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Ke.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):ab(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):pe.resolve(Xa());let o=-1,l=s;return a.next(c=>pe.forEach(c,(u,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),s.get(u)?pe.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,yt())).next(u=>({batchId:o,changes:fb(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ke(r)).next(n=>{let i=jc();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=jc();return this.indexManager.getCollectionParents(e,s).next(o=>pe.forEach(o,l=>{const c=function(d,h){return new zd(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(u=>{u.forEach((d,h)=>{a=a.insert(d,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,hn.newInvalidDocument(u)))});let o=jc();return a.forEach((l,c)=>{const u=s.get(l);u!==void 0&&cu(u.mutation,c,qs.empty(),Un.now()),$d(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return pe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:xl(i.createTime)}}(r)),pe.resolve()}getNamedQuery(e,r){return pe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:Gb(i.bundledQuery),readTime:xl(i.readTime)}}(r)),pe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(){this.overlays=new _r(Ke.comparator),this.Ir=new Map}getOverlay(e,r){return pe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Xa();return pe.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),pe.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),pe.resolve()}getOverlaysForCollection(e,r,n){const i=Xa(),s=r.length+1,a=new Ke(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return pe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new _r((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=s.get(c.largestBatchId);u===null&&(u=Xa(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Xa(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return pe.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new kb(r,n));let s=this.Ir.get(r);s===void 0&&(s=yt(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5{constructor(){this.sessionToken=Qr.EMPTY_BYTE_STRING}getSessionToken(e){return pe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,pe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(){this.Tr=new Kr(Or.Er),this.dr=new Kr(Or.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Or(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Or(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Ke(new lr([])),n=new Or(r,e),i=new Or(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Ke(new lr([])),n=new Or(r,e),i=new Or(r,e+1);let s=yt();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Or(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Or{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Ke.comparator(e.key,r.key)||It(e.wr,r.wr)}static Ar(e,r){return It(e.wr,r.wr)||Ke.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Kr(Or.Er)}checkEmpty(e){return pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Tb(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Or(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return pe.resolve(a)}lookupMutationBatch(e,r){return pe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return pe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return pe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Or(r,0),i=new Or(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),pe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Kr(It);return r.forEach(i=>{const s=new Or(i,0),a=new Or(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),pe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Ke.isDocumentKey(s)||(s=s.child(""));const a=new Or(new Ke(s),0);let o=new Kr(It);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),pe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){fr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return pe.forEach(r.mutations,i=>{const s=new Or(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Or(r,0),i=this.br.firstAfterOrEqual(n);return pe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,pe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e){this.Mr=e,this.docs=function(){return new _r(Ke.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return pe.resolve(n?n.document.mutableCopy():hn.newInvalidDocument(r))}getEntries(e,r){let n=va();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():hn.newInvalidDocument(i))}),pe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=va();const a=r.path,o=new Ke(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||U8(V8(u),n)<=0||(i.has(u.key)||$d(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return pe.resolve(s)}getAllFromCollectionGroup(e,r,n,i){tt()}Or(e,r){return pe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new n5(this)}getSize(e){return pe.resolve(this.size)}}class n5 extends qb{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),pe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{constructor(e){this.persistence=e,this.Nr=new sc(r=>ev(r),tv),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new sv,this.targetCount=0,this.kr=$l.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),pe.resolve()}getLastRemoteSnapshotVersion(e){return pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return pe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),pe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),pe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new $l(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,pe.resolve()}updateTargetData(e,r){return this.Kn(r),pe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,pe.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),pe.waitFor(s).next(()=>i)}getTargetCount(e){return pe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return pe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),pe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),pe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),pe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return pe.resolve(n)}containsKey(e,r){return pe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Y_(0),this.Kr=!1,this.Kr=!0,this.$r=new e5,this.referenceDelegate=e(this),this.Ur=new i5(this),this.indexManager=new Xb,this.remoteDocumentCache=function(i){return new r5(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new $b(r),this.Gr=new Jb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Zb,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new t5(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){je("MemoryPersistence","Starting transaction:",e);const i=new a5(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return pe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class a5 extends W8{constructor(e){super(),this.currentSequenceNumber=e}}class av{constructor(e){this.persistence=e,this.Jr=new sv,this.Yr=null}static Zr(e){return new av(e)}get Xr(){if(this.Yr)return this.Yr;throw tt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),pe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),pe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),pe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return pe.forEach(this.Xr,n=>{const i=Ke.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Qe.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return pe.or([()=>pe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=yt(),i=yt();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new ov(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return GN()?8:z8(eS())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new o5;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Dc()<=vt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Xo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),pe.resolve()):(Dc()<=vt.DEBUG&&je("QueryEngine","Query:",Xo(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Dc()<=vt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Xo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ji(r))):pe.resolve())}Yi(e,r){if(z2(r))return pe.resolve(null);let n=Ji(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=G1(r,null,"F"),n=Ji(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=yt(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,G1(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return z2(r)||i.isEqual(Qe.min())?pe.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?pe.resolve(null):(Dc()<=vt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Xo(r)),this.rs(e,a,r,B8(i,-1)).next(o=>o))})}ts(e,r){let n=new Kr(V4(e));return r.forEach((i,s)=>{$d(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Dc()<=vt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Xo(r)),this.Ji.getDocumentsMatchingQuery(e,r,ga.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new _r(It),this._s=new sc(s=>ev(s),tv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Qb(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function u5(t,e,r,n){return new c5(t,e,r,n)}async function rC(t,e){const r=xt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=yt();for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function nC(t){const e=xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function f5(t,e){const r=xt(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((u,d)=>{const h=i.get(d);if(!h)return;o.push(r.Ur.removeMatchingKeys(s,u.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(s,u.addedDocuments,d)));let p=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Qr.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(d,p),function(x,_,m){return x.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(h,p,u)&&o.push(r.Ur.updateTargetData(s,p))});let l=va(),c=yt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(h5(s,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Qe.min())){const u=r.Ur.getLastRemoteSnapshotVersion(s).next(d=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return pe.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function h5(t,e,r){let n=yt(),i=yt();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=va();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Qe.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):je("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function d5(t,e){const r=xt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,pe.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Ys(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Q1(t,e,r){const n=xt(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Nf(a))throw a;je("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function ew(t,e,r){const n=xt(t);let i=Qe.min(),s=yt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const d=xt(l),h=d._s.get(u);return h!==void 0?pe.resolve(d.os.get(h)):d.Ur.getTargetData(c,u)}(n,a,Ji(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Qe.min(),r?s:yt())).next(o=>(p5(n,lb(e),o),{documents:o,Ts:s})))}function p5(t,e,r){let n=t.us.get(e)||Qe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class tw{constructor(){this.activeTargetIds=pb()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class m5{constructor(){this.so=new tw,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new tw,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){je("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){je("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let C0=null;function am(){return C0===null?C0=function(){return 268435456+Math.round(2147483648*Math.random())}():C0++,"0x"+C0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nn="WebChannelConnection";class x5 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=am(),l=this.xo(r,n.toUriEncodedString());je("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(u=>(je("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw jl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",i),u})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ic}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=_5[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=am();return new Promise((a,o)=>{const l=new k4;l.setWithCredentials(!0),l.listenOnce(S4.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case nh.NO_ERROR:const u=l.getResponseJson();je(nn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),a(u);break;case nh.TIMEOUT:je(nn,`RPC '${e}' ${s} timed out`),o(new $e(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case nh.HTTP_ERROR:const d=l.getStatus();if(je(nn,`RPC '${e}' ${s} failed with status:`,d,"response text:",l.getResponseText()),d>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const g=function(_){const m=_.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(m)>=0?m:Ne.UNKNOWN}(p.status);o(new $e(g,p.message))}else o(new $e(Ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new $e(Ne.UNAVAILABLE,"Connection failed."));break;default:tt()}}finally{je(nn,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);je(nn,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=am(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=I4(),o=A4(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=s.join("");je(nn,`Creating RPC '${e}' stream ${i}: ${u}`,l);const d=a.createWebChannel(u,l);let h=!1,p=!1;const g=new v5({Io:_=>{p?je(nn,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(h||(je(nn,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),je(nn,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},To:()=>d.close()}),x=(_,m,w)=>{_.listen(m,v=>{try{w(v)}catch(R){setTimeout(()=>{throw R},0)}})};return x(d,Uc.EventType.OPEN,()=>{p||(je(nn,`RPC '${e}' stream ${i} transport opened.`),g.yo())}),x(d,Uc.EventType.CLOSE,()=>{p||(p=!0,je(nn,`RPC '${e}' stream ${i} transport closed`),g.So())}),x(d,Uc.EventType.ERROR,_=>{p||(p=!0,jl(nn,`RPC '${e}' stream ${i} transport errored:`,_),g.So(new $e(Ne.UNAVAILABLE,"The operation could not be completed")))}),x(d,Uc.EventType.MESSAGE,_=>{var m;if(!p){const w=_.data[0];fr(!!w);const v=w,R=v.error||((m=v[0])===null||m===void 0?void 0:m.error);if(R){je(nn,`RPC '${e}' stream ${i} received error:`,R);const U=R.status;let H=function(k){const C=wr[k];if(C!==void 0)return X4(C)}(U),E=R.message;H===void 0&&(H=Ne.INTERNAL,E="Unknown error status: "+U+" with message "+R.message),p=!0,g.So(new $e(H,E)),d.close()}else je(nn,`RPC '${e}' stream ${i} received:`,w),g.bo(w)}}),x(o,C4.STAT_EVENT,_=>{_.stat===U1.PROXY?je(nn,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===U1.NOPROXY&&je(nn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function om(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(t){return new Pb(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new sC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Ne.RESOURCE_EXHAUSTED?(Ns(r.toString()),Ns("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new $e(Ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return je("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(je("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class w5 extends y5{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=Mb(this.serializer,e),n=function(s){if(!("targetChange"in s))return Qe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Qe.min():a.readTime?xl(a.readTime):Qe.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Z2(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=$1(l)?{documents:Bb(s,l)}:{query:Vb(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=bb(s,a.resumeToken);const c=q1(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Qe.min())>0){o.readTime=Db(s,a.snapshotVersion.toTimestamp());const c=q1(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=jb(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Z2(this.serializer),r.removeTarget=e,this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5 extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new $e(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Y1(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $e(Ne.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Y1(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $e(Ne.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class T5{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ns(r),this.D_=!1):je("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{Df(this)&&(je("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=xt(l);c.L_.add(4),await Pf(c),c.q_.set("Unknown"),c.L_.delete(4),await qd(c)}(this))})}),this.q_=new T5(n,i)}}async function qd(t){if(Df(t))for(const e of t.B_)await e(!0)}async function Pf(t){for(const e of t.B_)await e(!1)}function aC(t,e){const r=xt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),fv(r)?uv(r):ac(r).r_()&&cv(r,e))}function lv(t,e){const r=xt(t),n=ac(r);r.N_.delete(e),n.r_()&&oC(r,e),r.N_.size===0&&(n.r_()?n.o_():Df(r)&&r.q_.set("Unknown"))}function cv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}ac(t).A_(e)}function oC(t,e){t.Q_.xe(e),ac(t).R_(e)}function uv(t){t.Q_=new Ib({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ac(t).start(),t.q_.v_()}function fv(t){return Df(t)&&!ac(t).n_()&&t.N_.size>0}function Df(t){return xt(t).L_.size===0}function lC(t){t.Q_=void 0}async function S5(t){t.q_.set("Online")}async function C5(t){t.N_.forEach((e,r)=>{cv(t,e)})}async function A5(t,e){lC(t),fv(t)?(t.q_.M_(e),uv(t)):t.q_.set("Unknown")}async function I5(t,e,r){if(t.q_.set("Online"),e instanceof q4&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){je("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await nw(t,n)}else if(e instanceof sh?t.Q_.Ke(e):e instanceof K4?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Qe.min()))try{const n=await nC(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.N_.get(c);u&&s.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=s.N_.get(l);if(!u)return;s.N_.set(l,u.withResumeToken(Qr.EMPTY_BYTE_STRING,u.snapshotVersion)),oC(s,l);const d=new Ys(u.target,l,c,u.sequenceNumber);cv(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){je("RemoteStore","Failed to raise snapshot:",n),await nw(t,n)}}async function nw(t,e,r){if(!Nf(e))throw e;t.L_.add(1),await Pf(t),t.q_.set("Offline"),r||(r=()=>nC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await qd(t)})}async function iw(t,e){const r=xt(t);r.asyncQueue.verifyOperationInProgress(),je("RemoteStore","RemoteStore received new credentials");const n=Df(r);r.L_.add(3),await Pf(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await qd(r)}async function F5(t,e){const r=xt(t);e?(r.L_.delete(2),await qd(r)):e||(r.L_.add(2),await Pf(r),r.q_.set("Unknown"))}function ac(t){return t.K_||(t.K_=function(r,n,i){const s=xt(r);return s.w_(),new w5(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:S5.bind(null,t),Ro:C5.bind(null,t),mo:A5.bind(null,t),d_:I5.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),fv(t)?uv(t):t.q_.set("Unknown")):(await t.K_.stop(),lC(t))})),t.K_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Qa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new hv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cC(t,e){if(Ns("AsyncQueue",`${e}: ${t}`),Nf(t))return new $e(Ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ke.comparator(r.key,n.key):(r,n)=>Ke.comparator(r.key,n.key),this.keyedMap=jc(),this.sortedSet=new _r(this.comparator)}static emptySet(e){return new yl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof yl)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new yl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(){this.W_=new _r(Ke.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):tt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Gl{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Gl(e,r,yl.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class R5{constructor(){this.queries=aw(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=xt(r),s=i.queries;i.queries=aw(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new $e(Ne.ABORTED,"Firestore shutting down"))}}function aw(){return new sc(t=>B4(t),Hd)}async function P5(t,e){const r=xt(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new N5,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=cC(a,`Initialization of query '${Xo(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&dv(r)}async function D5(t,e){const r=xt(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function b5(t,e){const r=xt(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&dv(r)}function O5(t,e,r){const n=xt(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function dv(t){t.Y_.forEach(e=>{e.next()})}var J1,ow;(ow=J1||(J1={})).ea="default",ow.Cache="cache";class L5{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Gl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Gl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==J1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.key=e}}class fC{constructor(e){this.key=e}}class M5{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=yt(),this.mutatedKeys=yt(),this.Aa=V4(e),this.Ra=new yl(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new sw,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,d)=>{const h=i.get(u),p=$d(this.query,d)?d:null,g=!!h&&this.mutatedKeys.has(h.key),x=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;h&&p?h.data.isEqual(p.data)?g!==x&&(n.track({type:3,doc:p}),_=!0):this.ga(h,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!h&&p?(n.track({type:0,doc:p}),_=!0):h&&!p&&(n.track({type:1,doc:h}),_=!0,(l||c)&&(o=!0)),_&&(p?(a=a.add(p),s=x?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,d)=>function(p,g){const x=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tt()}};return x(p)-x(g)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new Gl(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new sw,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=yt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new fC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new uC(n))}),r}ba(e){this.Ta=e.Ts,this.da=yt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Gl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class B5{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class V5{constructor(e){this.key=e,this.va=!1}}class U5{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new sc(o=>B4(o),Hd),this.Ma=new Map,this.xa=new Set,this.Oa=new _r(Ke.comparator),this.Na=new Map,this.La=new sv,this.Ba={},this.ka=new Map,this.qa=$l.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function j5(t,e,r=!0){const n=gC(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await hC(n,e,r,!0),i}async function W5(t,e){const r=gC(t);await hC(r,e,!0,!1)}async function hC(t,e,r,n){const i=await d5(t.localStore,Ji(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await z5(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&aC(t.remoteStore,i),o}async function z5(t,e,r,n,i){t.Ka=(d,h,p)=>async function(x,_,m,w){let v=_.view.ma(m);v.ns&&(v=await ew(x.localStore,_.query,!1).then(({documents:E})=>_.view.ma(E,v)));const R=w&&w.targetChanges.get(_.targetId),U=w&&w.targetMismatches.get(_.targetId)!=null,H=_.view.applyChanges(v,x.isPrimaryClient,R,U);return cw(x,_.targetId,H.wa),H.snapshot}(t,d,h,p);const s=await ew(t.localStore,e,!0),a=new M5(e,s.Ts),o=a.ma(s.documents),l=Rf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);cw(t,r,c.wa);const u=new B5(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function H5(t,e,r){const n=xt(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!Hd(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Q1(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&lv(n.remoteStore,i.targetId),Z1(n,i.targetId)}).catch(q_)):(Z1(n,i.targetId),await Q1(n.localStore,i.targetId,!0))}async function $5(t,e){const r=xt(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),lv(r.remoteStore,n.targetId))}async function dC(t,e){const r=xt(t);try{const n=await f5(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(fr(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?fr(a.va):i.removedDocuments.size>0&&(fr(a.va),a.va=!1))}),await mC(r,n,e)}catch(n){await q_(n)}}function lw(t,e,r){const n=xt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=xt(a);l.onlineState=o;let c=!1;l.queries.forEach((u,d)=>{for(const h of d.j_)h.Z_(o)&&(c=!0)}),c&&dv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function G5(t,e,r){const n=xt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new _r(Ke.comparator);a=a.insert(s,hn.newNoDocument(s,Qe.min()));const o=yt().add(s),l=new Kd(Qe.min(),new Map,new _r(It),a,o);await dC(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),pv(n)}else await Q1(n.localStore,e,!1).then(()=>Z1(n,e,r)).catch(q_)}function Z1(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||pC(t,n)})}function pC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(lv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),pv(t))}function cw(t,e,r){for(const n of r)n instanceof uC?(t.La.addReference(n.key,e),X5(t,n)):n instanceof fC?(je("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||pC(t,n.key)):tt()}function X5(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(je("SyncEngine","New document in limbo: "+r),t.xa.add(n),pv(t))}function pv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Ke(lr.fromString(e)),n=t.qa.next();t.Na.set(n,new V5(r)),t.Oa=t.Oa.insert(r,n),aC(t.remoteStore,new Ys(Ji(M4(r.path)),n,"TargetPurposeLimboResolution",Y_.oe))}}async function mC(t,e,r){const n=xt(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const d=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){i.push(c);const d=ov.Wi(l.targetId,c);s.push(d)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const u=xt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>pe.forEach(c,h=>pe.forEach(h.$i,p=>u.persistence.referenceDelegate.addReference(d,h.targetId,p)).next(()=>pe.forEach(h.Ui,p=>u.persistence.referenceDelegate.removeReference(d,h.targetId,p)))))}catch(d){if(!Nf(d))throw d;je("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const h=d.targetId;if(!d.fromCache){const p=u.os.get(h),g=p.snapshotVersion,x=p.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(h,x)}}}(n.localStore,s))}async function K5(t,e){const r=xt(t);if(!r.currentUser.isEqual(e)){je("SyncEngine","User change. New user:",e.toKey());const n=await rC(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new $e(Ne.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await mC(r,n.hs)}}function q5(t,e){const r=xt(t),n=r.Na.get(e);if(n&&n.va)return yt().add(n.key);{let i=yt();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function gC(t){const e=xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=dC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=q5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=G5.bind(null,e),e.Ca.d_=b5.bind(null,e.eventManager),e.Ca.$a=O5.bind(null,e.eventManager),e}class Jh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=iC(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return u5(this.persistence,new l5,e.initialUser,this.serializer)}Ga(e){return new s5(av.Zr,this.serializer)}Wa(e){return new m5}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jh.provider={build:()=>new Jh};class eg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>lw(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=K5.bind(null,this.syncEngine),await F5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new R5}()}createDatastore(e){const r=iC(e.databaseInfo.databaseId),n=function(s){return new x5(s)}(e.databaseInfo);return function(s,a,o,l){return new E5(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new k5(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>lw(this.syncEngine,r,0),function(){return rw.D()?new rw:new g5}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,u){const d=new U5(i,s,a,o,l,c);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=xt(i);je("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Pf(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}eg.provider={build:()=>new eg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ns("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ln.UNAUTHENTICATED,this.clientId=L8.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{je("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(je("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=cC(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function lm(t,e){t.asyncQueue.verifyOperationInProgress(),je("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await rC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function uw(t,e){t.asyncQueue.verifyOperationInProgress();const r=await J5(t);je("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>iw(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>iw(e.remoteStore,i)),t._onlineComponents=e}async function J5(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je("FirestoreClient","Using user provided OfflineComponentProvider");try{await lm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ne.FAILED_PRECONDITION||i.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;jl("Error using user provided cache. Falling back to memory cache: "+r),await lm(t,new Jh)}}else je("FirestoreClient","Using default OfflineComponentProvider"),await lm(t,new Jh);return t._offlineComponents}async function Z5(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je("FirestoreClient","Using user provided OnlineComponentProvider"),await uw(t,t._uninitializedComponentsProvider._online)):(je("FirestoreClient","Using default OnlineComponentProvider"),await uw(t,new eg))),t._onlineComponents}async function eO(t){const e=await Z5(t),r=e.eventManager;return r.onListen=j5.bind(null,e.syncEngine),r.onUnlisten=H5.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=W5.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=$5.bind(null,e.syncEngine),r}function tO(t,e,r={}){const n=new Qa;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new Y5({next:h=>{u.Za(),a.enqueueAndForget(()=>D5(s,d)),h.fromCache&&l.source==="server"?c.reject(new $e(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new L5(o,u,{includeMetadataChanges:!0,_a:!0});return P5(s,d)}(await eO(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _C(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw=new Map;function rO(t,e,r,n){if(e===!0&&n===!0)throw new $e(Ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function hw(t){if(Ke.isDocumentKey(t))throw new $e(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function nO(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":tt()}function tg(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=nO(t);throw new $e(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $e(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_C((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new $e(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new $e(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new $e(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mv{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dw(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new I8;switch(n.type){case"firstParty":return new P8(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=fw.get(r);n&&(je("ComponentProvider","Removing Datastore"),fw.delete(r),n.terminate())}(this),Promise.resolve()}}function iO(t,e,r,n={}){var i;const s=(t=tg(t,mv))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&jl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=ln.MOCK_USER;else{o=Zk(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new $e(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ln(c)}t._authCredentials=new F8(new F4(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yd(this.firestore,e,this._query)}}class oc{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new oc(this.firestore,e,this._key)}}class wl extends Yd{constructor(e,r,n){super(e,r,M4(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new oc(this.firestore,null,new Ke(e))}withConverter(e){return new wl(this.firestore,e,this._path)}}function pw(t,e,...r){if(t=So(t),t instanceof mv){const n=lr.fromString(e,...r);return hw(n),new wl(t,null,n)}{if(!(t instanceof oc||t instanceof wl))throw new $e(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(lr.fromString(e,...r));return hw(n),new wl(t.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new sC(this,"async_queue_retry"),this.Vu=()=>{const n=om();n&&je("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=om();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=om();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Qa;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Nf(e))throw e;je("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ns("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=hv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&tt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class vC extends mv{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new mw,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mw(e),this._firestoreClient=void 0,await e}}}function sO(t,e){const r=typeof t=="object"?t:d_(),n=typeof t=="string"?t:"(default)",i=aS(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Qk("firestore");s&&iO(i,...s)}return i}function aO(t){if(t._terminated)throw new $e(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||oO(t),t._firestoreClient}function oO(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,u){return new G8(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,_C(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new Q5(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zh(Qr.fromBase64String(e))}catch(r){throw new $e(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Zh(Qr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}const uO=new RegExp("[~\\*/\\[\\]]");function fO(t,e,r){if(e.search(uO)>=0)throw gw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t);try{return new xC(...e.split("."))._internalPath}catch{throw gw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t)}}function gw(t,e,r,n,i){let s=`Function ${e}() called with invalid data`;s+=". ";let a="";return new $e(Ne.INVALID_ARGUMENT,s+t+a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new oc(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(wC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class hO extends yC{data(){return super.data()}}function wC(t,e){return typeof e=="string"?fO(t,e):e instanceof xC?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pO{convertValue(e,r="none"){switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(po(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw tt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Wd(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>dr(a.doubleValue));return new cO(s)}convertGeoPoint(e){return new lO(dr(e.latitude),dr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=J_(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(qu(e));default:return null}}convertTimestamp(e){const r=_a(e);return new Un(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=lr.fromString(e);fr(tC(n));const i=new Yu(n.get(1),n.get(3)),s=new Ke(n.popFirst(5));return i.isEqual(r)||Ns(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mO extends yC{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(wC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ah extends mO{data(e={}){return super.data(e)}}class gO{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new A0(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ah(this._firestore,this._userDataWriter,n.key,n,new A0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new ah(i._firestore,i._userDataWriter,o.doc.key,o.doc,new A0(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new ah(i._firestore,i._userDataWriter,o.doc.key,o.doc,new A0(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:_O(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function _O(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tt()}}class vO extends pO{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zh(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new oc(this.firestore,null,r)}}function _w(t){t=tg(t,Yd);const e=tg(t.firestore,vC),r=aO(e),n=new vO(e);return dO(t._query),tO(r,t._query).then(i=>new gO(e,n,t,i))}(function(e,r=!0){(function(i){ic=i})(oS),Bu(new Ol("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new vC(new N8(n.getProvider("auth-internal")),new b8(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new $e(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yu(c.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),oa(D2,"4.7.3",e),oa(D2,"4.7.3","esm2017")})();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ed={};ed.version="0.20.1";var li=1200,xO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_v=function(t){xO.indexOf(t)!=-1&&(gv[0]=t)};function yO(){_v(1252)}var Ii=function(t){li=t,_v(t)};function vv(){Ii(1200),yO()}function vw(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function EC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function wO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t[2*r]+(t[2*r+1]<<8));return e.join("")}function TC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var zc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?EC(t.slice(2)):e==254&&r==255?TC(t.slice(2)):e==65279?t.slice(1):t},I0=function(e){return String.fromCharCode(e)},xw=function(e){return String.fromCharCode(e)},EO=null,mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function td(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=mn.charAt(s)+mn.charAt(a)+mn.charAt(o)+mn.charAt(l);return e}function TO(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),r>255&&(r=95),s=r>>2,n=t.charCodeAt(c++),n>255&&(n=95),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),i>255&&(i=95),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=mn.charAt(s)+mn.charAt(a)+mn.charAt(o)+mn.charAt(l);return e}function kO(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t[c++],s=r>>2,n=t[c++],a=(r&3)<<4|n>>4,i=t[c++],o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=mn.charAt(s)+mn.charAt(a)+mn.charAt(o)+mn.charAt(l);return e}function Qn(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=mn.indexOf(t.charAt(c++)),a=mn.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=mn.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=mn.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var st=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ns=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),Ju=function(){if(typeof Buffer>"u")return!1;var t=ns([65,0]);if(!t)return!1;var e=t.toString("utf16le");return e.length==1}();function xa(t){return st?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function yw(t){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Tn=function(e){return st?ns(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Qd(t){if(typeof ArrayBuffer>"u")return Tn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ts(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function SO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function xv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return xv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var mr=st?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ns(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)i=t[e].length,t[e]instanceof Uint8Array?n.set(t[e],r):typeof t[e]=="string"?n.set(new Uint8Array(Tn(t[e])),r):n.set(new Uint8Array(t[e]),r);return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function CO(t){for(var e=[],r=0,n=t.length+250,i=xa(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=xa(65535),n=65530)}return e.push(i.slice(0,r)),mr(e)}var Fn=/\u0000/g,Hc=/[\u0001-\u0006]/g;function El(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Fi(t,e){var r=""+t;return r.length>=e?r:gt("0",e-r.length)+r}function yv(t,e){var r=""+t;return r.length>=e?r:gt(" ",e-r.length)+r}function rd(t,e){var r=""+t;return r.length>=e?r:r+gt(" ",e-r.length)}function AO(t,e){var r=""+Math.round(t);return r.length>=e?r:gt("0",e-r.length)+r}function IO(t,e){var r=""+t;return r.length>=e?r:gt("0",e-r.length)+r}var ww=Math.pow(2,32);function $o(t,e){if(t>ww||t<-ww)return AO(t,e);var r=Math.round(t);return IO(r,e)}function nd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Ew=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function FO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Tw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},NO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function id(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,u=0,d=Math.floor(i);c<e&&(d=Math.floor(i),o=d*a+s,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function RO(t){var e=t.toPrecision(16);if(e.indexOf("e")>-1){var r=e.slice(0,e.indexOf("e"));return r=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+gt("0",r.length-15),r+e.slice(e.indexOf("e"))}var n=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+gt("0",e.length-15);return Number(n)}function ds(t,e,r){if(t>2958465||t<0)return null;t=RO(t);var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=OO(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}function wv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function PO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function DO(t){var e=t<0?12:11,r=wv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function bO(t){var e=wv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Zu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=DO(t):e===10?r=t.toFixed(10).substr(0,12):r=bO(t),wv(PO(r.toUpperCase()))}function go(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Zu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Jn(14,nr(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function OO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function LO(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return cm[r.m-1][1];case 5:return cm[r.m-1][0];default:return cm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Ew[r.q][0];default:return Ew[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Fi(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Fi(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+(n==0?Math.round(r.S+r.u):r.S);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Fi(l,c):"";return u}function _s(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var kC=/%/g;function MO(t,e,r){var n=e.replace(kC,""),i=e.length-n.length;return ws(t,n,r*Math.pow(10,2*i))+gt("%",i)}function BO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ws(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function SC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+SC(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var CC=/# (\?+)( ?)\/( ?)(\d+)/;function VO(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?gt(" ",t[1].length+1+t[4].length):yv(a,t[1].length)+t[2]+"/"+t[3]+Fi(o,t[4].length))}function UO(t,e,r){return r+(e===0?"":""+e)+gt(" ",t[1].length+2+t[4].length)}var AC=/^#*0*\.([0#]+)/,IC=/\).*[0#]/,FC=/\(###\) ###\\?-####/;function En(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function kw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Sw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function jO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function WO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ri(t,e,r){if(t.charCodeAt(0)===40&&!e.match(IC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ri("n",n,r):"("+ri("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return BO(t,e,r);if(e.indexOf("%")!==-1)return MO(t,e,r);if(e.indexOf("E")!==-1)return SC(e,r);if(e.charCodeAt(0)===36)return"$"+ri(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+$o(l,e.length);if(e.match(/^[#?]+$/))return i=$o(r,0),i==="0"&&(i=""),i.length>e.length?i:En(e.substr(0,e.length-i.length))+i;if(s=e.match(CC))return VO(s,l,c);if(e.match(/^#+0+$/))return c+$o(l,e.length-e.indexOf("0"));if(s=e.match(AC))return i=kw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+En(s[1])).replace(/\.$/,"."+En(s[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+gt("0",En(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+kw(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+_s($o(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ri(t,e,-r):_s(""+(Math.floor(r)+jO(r,s[1].length)))+"."+Fi(Sw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ri(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=El(ri(t,e.replace(/[\\-]/g,""),r)),a=0,El(El(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(FC))return i=ri(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=id(l,Math.pow(10,a)-1,!1),i=""+c,u=ws("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=rd(o[2],a),u.length<s[4].length&&(u=En(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=id(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yv(o[1],a)+s[2]+"/"+s[3]+rd(o[2],a):gt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=$o(r,0),e.length<=i.length?i:En(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,h=e.length-i.length-d;return En(e.substr(0,d)+i+e.substr(e.length-h))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Sw(r,s[1].length),r<0?"-"+ri(t,e,-r):_s(WO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Fi(0,3-g.length):"")+g})+"."+Fi(a,s[1].length);switch(e){case"###,##0.00":return ri(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=_s($o(l,0));return p!=="0"?c+p:"";case"###,###.00":return ri(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ri(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function zO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ws(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function HO(t,e,r){var n=e.replace(kC,""),i=e.length-n.length;return ws(t,n,r*Math.pow(10,2*i))+gt("%",i)}function NC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+NC(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ji(t,e,r){if(t.charCodeAt(0)===40&&!e.match(IC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ji("n",n,r):"("+ji("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zO(t,e,r);if(e.indexOf("%")!==-1)return HO(t,e,r);if(e.indexOf("E")!==-1)return NC(e,r);if(e.charCodeAt(0)===36)return"$"+ji(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Fi(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:En(e.substr(0,e.length-i.length))+i;if(s=e.match(CC))return UO(s,l,c);if(e.match(/^#+0+$/))return c+Fi(l,e.length-e.indexOf("0"));if(s=e.match(AC))return i=(""+r).replace(/^([^\.]+)$/,"$1."+En(s[1])).replace(/\.$/,"."+En(s[1])),i=i.replace(/\.(\d*)$/,function(g,x){return"."+x+gt("0",En(s[1]).length-x.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+_s(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ji(t,e,-r):_s(""+r)+"."+gt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return ji(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=El(ji(t,e.replace(/[\\-]/g,""),r)),a=0,El(El(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(e.match(FC))return i=ji(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=id(l,Math.pow(10,a)-1,!1),i=""+c,u=ws("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=rd(o[2],a),u.length<s[4].length&&(u=En(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=id(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?yv(o[1],a)+s[2]+"/"+s[3]+rd(o[2],a):gt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:En(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=e.indexOf(".")-a,h=e.length-i.length-d;return En(e.substr(0,d)+i+e.substr(e.length-h))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ji(t,e,-r):_s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Fi(0,3-g.length):"")+g})+"."+Fi(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=_s(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return ji(t,e.slice(0,e.lastIndexOf(".")),r)+En(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ws(t,e,r){return(r|0)===r?ji(t,e,r):ri(t,e,r)}function $O(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var RC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function gi(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":nd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(RC))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function GO(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,d,h="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!nd(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=ds(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=ds(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=ds(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?t.charAt(a+2):o),x.t="T",h="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",a+=5,h="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",a+=5,h="h"):(x.t="t",++a),c==null&&x.t==="T")return"";i[i.length]=x,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(RC)){if(c==null&&(c=ds(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",gi(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,m=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",_<1&&(_=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(m=Math.max(m,w[0].length-1),_=4),_<3&&(_=3);case"d":case"y":case"e":l=i[a].t;break;case"M":l=i[a].t,_<2&&(_=2);break;case"m":l==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}var v;switch(_){case 0:break;case 1:case 2:case 3:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H),c.H>=24&&(c.H=0,++c.D,v=ds(c.D),v.u=c.u,v.S=c.S,v.M=c.M,v.H=c.H,c=v);break;case 4:switch(m){case 1:c.u=Math.round(c.u*10)/10;break;case 2:c.u=Math.round(c.u*100)/100;break;case 3:c.u=Math.round(c.u*1e3)/1e3;break}c.u>=1&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H),c.H>=24&&(c.H=0,++c.D,v=ds(c.D),v.u=c.u,v.S=c.S,v.M=c.M,v.H=c.H,c=v);break}var R="",U;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=LO(i[a].t.charCodeAt(0),i[a].v,c,m),i[a].t="t";break;case"n":case"?":for(U=a+1;i[U]!=null&&((o=i[U].t)==="?"||o==="D"||(o===" "||o==="t")&&i[U+1]!=null&&(i[U+1].t==="?"||i[U+1].t==="t"&&i[U+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[U].v==="/"||i[U].v===" "&&i[U+1]!=null&&i[U+1].t=="?"));)i[a].v+=i[U].v,i[U]={v:"",t:";"},++U;R+=i[a].v,a=U-1;break;case"G":i[a].t="t",i[a].v=go(e,r);break}var H="",E,T;if(R.length>0){R.charCodeAt(0)==40?(E=e<0&&R.charCodeAt(0)===45?-e:e,T=ws("n",R,E)):(E=e<0&&n>1?-e:e,T=ws("n",R,E),E<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),U=T.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var C=i.length;if(k===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(U>=i[a].v.length-1?(U-=i[a].v.length,i[a].v=T.substr(U+1,i[a].v.length)):U<0?i[a].v="":(i[a].v=T.substr(0,U+1),U=-1),i[a].t="t",C=a);U>=0&&C<i.length&&(i[C].v=T.substr(0,U+1)+i[C].v)}else if(k!==i.length&&T.indexOf("E")===-1){for(U=T.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,H=i[a].v.substr(u+1);u>=0;--u)U>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(H=T.charAt(U--)+H);i[a].v=H,i[a].t="t",C=a}for(U>=0&&C<i.length&&(i[C].v=T.substr(0,U+1)+i[C].v),U=T.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(u=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,H=i[a].v.substr(0,u);u<i[a].v.length;++u)U<T.length&&(H+=T.charAt(U++));i[a].v=H,i[a].t="t",C=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(E=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=ws(i[a].t,i[a].v,E),i[a].t="t");var A="";for(a=0;a!==i.length;++a)i[a]!=null&&(A+=i[a].v);return A}var Cw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Aw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function XO(t,e){var r=$O(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Cw),o=r[1].match(Cw);return Aw(e,a)?[n,r[0]]:Aw(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Jn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Tw[t]]||ze[Tw[t]]),n==null&&(n=NO[t]||"General");break}if(nd(n,0))return go(e,r);e instanceof Date&&(e=nr(e,r.date1904));var i=XO(n,e);if(nd(i[1]))return go(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return GO(i[1],e,r,i[0])}function PC(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function Jd(t){for(var e=0;e!=392;++e)t[e]!==void 0&&PC(t[e],e)}function lc(){ze=FO()}var KO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},sd=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qO(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(sd,"(\\d+)"),sd.lastIndex=0,new RegExp("^"+e+"$")}function YO(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(sd)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),sd.lastIndex=0,l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var QO={"d.m":"d\\.m"};function ua(t,e){return PC(QO[t]||t,e)}var Iw=function(){var t={};t.version="1.2.0";function e(){for(var E=0,T=new Array(256),k=0;k!=256;++k)E=k,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,T[k]=E;return typeof Int32Array<"u"?new Int32Array(T):T}var r=e();function n(E){var T=0,k=0,C=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)A[C]=E[C];for(C=0;C!=256;++C)for(k=E[C],T=256+C;T<4096;T+=256)k=A[T]=k>>>8^E[k&255];var b=[];for(C=1;C!=16;++C)b[C-1]=typeof Int32Array<"u"&&typeof A.subarray=="function"?A.subarray(C*256,C*256+256):A.slice(C*256,C*256+256);return b}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],p=i[8],g=i[9],x=i[10],_=i[11],m=i[12],w=i[13],v=i[14];function R(E,T){for(var k=T^-1,C=0,A=E.length;C<A;)k=k>>>8^r[(k^E.charCodeAt(C++))&255];return~k}function U(E,T){for(var k=T^-1,C=E.length-15,A=0;A<C;)k=v[E[A++]^k&255]^w[E[A++]^k>>8&255]^m[E[A++]^k>>16&255]^_[E[A++]^k>>>24]^x[E[A++]]^g[E[A++]]^p[E[A++]]^h[E[A++]]^d[E[A++]]^u[E[A++]]^c[E[A++]]^l[E[A++]]^o[E[A++]]^a[E[A++]]^s[E[A++]]^r[E[A++]];for(C+=15;A<C;)k=k>>>8^r[(k^E[A++])&255];return~k}function H(E,T){for(var k=T^-1,C=0,A=E.length,b=0,N=0;C<A;)b=E.charCodeAt(C++),b<128?k=k>>>8^r[(k^b)&255]:b<2048?(k=k>>>8^r[(k^(192|b>>6&31))&255],k=k>>>8^r[(k^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,N=E.charCodeAt(C++)&1023,k=k>>>8^r[(k^(240|b>>8&7))&255],k=k>>>8^r[(k^(128|b>>2&63))&255],k=k>>>8^r[(k^(128|N>>6&15|(b&3)<<4))&255],k=k>>>8^r[(k^(128|N&63))&255]):(k=k>>>8^r[(k^(224|b>>12&15))&255],k=k>>>8^r[(k^(128|b>>6&63))&255],k=k>>>8^r[(k^(128|b&63))&255]);return~k}return t.table=r,t.bstr=R,t.buf=U,t.str=H,t}(),He=function(){var e={};e.version="1.2.2";function r(I,V){for(var L=I.split("/"),M=V.split("/"),B=0,j=0,J=Math.min(L.length,M.length);B<J;++B){if(j=L[B].length-M[B].length)return j;if(L[B]!=M[B])return L[B]<M[B]?-1:1}return L.length-M.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function s(I,V){typeof V=="string"&&(V=new Date(V));var L=V.getHours();L=L<<6|V.getMinutes(),L=L<<5|V.getSeconds()>>>1,I.write_shift(2,L);var M=V.getFullYear()-1980;M=M<<4|V.getMonth()+1,M=M<<5|V.getDate(),I.write_shift(2,M)}function a(I){var V=I.read_shift(2)&65535,L=I.read_shift(2)&65535,M=new Date,B=L&31;L>>>=5;var j=L&15;L>>>=4,M.setMilliseconds(0),M.setFullYear(L+1980),M.setMonth(j-1),M.setDate(B);var J=V&31;V>>>=5;var ne=V&63;return V>>>=6,M.setHours(V),M.setMinutes(ne),M.setSeconds(J<<1),M}function o(I){Cr(I,0);for(var V={},L=0;I.l<=I.length-4;){var M=I.read_shift(2),B=I.read_shift(2),j=I.l+B,J={};switch(M){case 21589:L=I.read_shift(1),L&1&&(J.mtime=I.read_shift(4)),B>5&&(L&2&&(J.atime=I.read_shift(4)),L&4&&(J.ctime=I.read_shift(4))),J.mtime&&(J.mt=new Date(J.mtime*1e3));break;case 1:{var ne=I.read_shift(4),Y=I.read_shift(4);J.usz=Y*Math.pow(2,32)+ne,ne=I.read_shift(4),Y=I.read_shift(4),J.csz=Y*Math.pow(2,32)+ne}break}I.l=j,V[M]=J}return V}var l;function c(){return l||(l=JO)}function u(I,V){if(I[0]==80&&I[1]==75)return hc(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return Hf(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var L=3,M=512,B=0,j=0,J=0,ne=0,Y=0,te=[],Z=I.slice(0,512);Cr(Z,0);var me=d(Z);switch(L=me[0],L){case 3:M=512;break;case 4:M=4096;break;case 0:if(me[1]==0)return hc(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}M!==512&&(Z=I.slice(0,M),Cr(Z,28));var Te=I.slice(0,M);h(Z,L);var be=Z.read_shift(4,"i");if(L===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);Z.l+=4,J=Z.read_shift(4,"i"),Z.l+=4,Z.chk("00100000","Mini Stream Cutoff Size: "),ne=Z.read_shift(4,"i"),B=Z.read_shift(4,"i"),Y=Z.read_shift(4,"i"),j=Z.read_shift(4,"i");for(var _e=-1,Ee=0;Ee<109&&(_e=Z.read_shift(4,"i"),!(_e<0));++Ee)te[Ee]=_e;var qe=p(I,M);_(Y,j,qe,M,te);var Mt=w(qe,J,te,M);J<Mt.length&&(Mt[J].name="!Directory"),B>0&&ne!==N&&(Mt[ne].name="!MiniFAT"),Mt[te[0]].name="!FAT",Mt.fat_addrs=te,Mt.ssz=M;var bt={},qt=[],os=[],Ra=[];v(J,Mt,qe,qt,B,bt,os,ne),g(os,Ra,qt),qt.shift();var Ms={FileIndex:os,FullPaths:Ra};return V&&V.raw&&(Ms.raw={header:Te,sectors:qe}),Ms}function d(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(we,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function h(I,V){var L=9;switch(I.l+=2,L=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,V){for(var L=Math.ceil(I.length/V)-1,M=[],B=1;B<L;++B)M[B-1]=I.slice(B*V,(B+1)*V);return M[L-1]=I.slice(L*V),M}function g(I,V,L){for(var M=0,B=0,j=0,J=0,ne=0,Y=L.length,te=[],Z=[];M<Y;++M)te[M]=Z[M]=M,V[M]=L[M];for(;ne<Z.length;++ne)M=Z[ne],B=I[M].L,j=I[M].R,J=I[M].C,te[M]===M&&(B!==-1&&te[B]!==B&&(te[M]=te[B]),j!==-1&&te[j]!==j&&(te[M]=te[j])),J!==-1&&(te[J]=M),B!==-1&&M!=te[M]&&(te[B]=te[M],Z.lastIndexOf(B)<ne&&Z.push(B)),j!==-1&&M!=te[M]&&(te[j]=te[M],Z.lastIndexOf(j)<ne&&Z.push(j));for(M=1;M<Y;++M)te[M]===M&&(j!==-1&&te[j]!==j?te[M]=te[j]:B!==-1&&te[B]!==B&&(te[M]=te[B]));for(M=1;M<Y;++M)if(I[M].type!==0){if(ne=M,ne!=te[ne])do ne=te[ne],V[M]=V[ne]+"/"+V[M];while(ne!==0&&te[ne]!==-1&&ne!=te[ne]);te[M]=-1}for(V[0]+="/",M=1;M<Y;++M)I[M].type!==2&&(V[M]+="/")}function x(I,V,L){for(var M=I.start,B=I.size,j=[],J=M;L&&B>0&&J>=0;)j.push(V.slice(J*b,J*b+b)),B-=b,J=Wa(L,J*4);return j.length===0?ee(0):mr(j).slice(0,I.size)}function _(I,V,L,M,B){var j=N;if(I===N){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var J=L[I],ne=(M>>>2)-1;if(!J)return;for(var Y=0;Y<ne&&(j=Wa(J,Y*4))!==N;++Y)B.push(j);V>=1&&_(Wa(J,M-4),V-1,L,M,B)}}function m(I,V,L,M,B){var j=[],J=[];B||(B=[]);var ne=M-1,Y=0,te=0;for(Y=V;Y>=0;){B[Y]=!0,j[j.length]=Y,J.push(I[Y]);var Z=L[Math.floor(Y*4/M)];if(te=Y*4&ne,M<4+te)throw new Error("FAT boundary crossed: "+Y+" 4 "+M);if(!I[Z])break;Y=Wa(I[Z],te)}return{nodes:j,data:Vw([J])}}function w(I,V,L,M){var B=I.length,j=[],J=[],ne=[],Y=[],te=M-1,Z=0,me=0,Te=0,be=0;for(Z=0;Z<B;++Z)if(ne=[],Te=Z+V,Te>=B&&(Te-=B),!J[Te]){Y=[];var _e=[];for(me=Te;me>=0;){_e[me]=!0,J[me]=!0,ne[ne.length]=me,Y.push(I[me]);var Ee=L[Math.floor(me*4/M)];if(be=me*4&te,M<4+be)throw new Error("FAT boundary crossed: "+me+" 4 "+M);if(!I[Ee]||(me=Wa(I[Ee],be),_e[me]))break}j[Te]={nodes:ne,data:Vw([Y])}}return j}function v(I,V,L,M,B,j,J,ne){for(var Y=0,te=M.length?2:0,Z=V[I].data,me=0,Te=0,be;me<Z.length;me+=128){var _e=Z.slice(me,me+128);Cr(_e,64),Te=_e.read_shift(2),be=Cv(_e,0,Te-te),M.push(be);var Ee={name:be,type:_e.read_shift(1),color:_e.read_shift(1),L:_e.read_shift(4,"i"),R:_e.read_shift(4,"i"),C:_e.read_shift(4,"i"),clsid:_e.read_shift(16),state:_e.read_shift(4,"i"),start:0,size:0},qe=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);qe!==0&&(Ee.ct=R(_e,_e.l-8));var Mt=_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2)+_e.read_shift(2);Mt!==0&&(Ee.mt=R(_e,_e.l-8)),Ee.start=_e.read_shift(4,"i"),Ee.size=_e.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=N,Ee.name=""),Ee.type===5?(Y=Ee.start,B>0&&Y!==N&&(V[Y].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",V[Ee.start]===void 0&&(V[Ee.start]=m(L,Ee.start,V.fat_addrs,V.ssz)),V[Ee.start].name=Ee.name,Ee.content=V[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:Y!==N&&Ee.start!==N&&V[Y]&&(Ee.content=x(Ee,V[Y].data,(V[ne]||{}).data))),Ee.content&&Cr(Ee.content,0),j[be]=Ee,J.push(Ee)}}function R(I,V){return new Date((Gn(I,V+4)/1e7*Math.pow(2,32)+Gn(I,V)/1e7-11644473600)*1e3)}function U(I,V){return c(),u(l.readFileSync(I),V)}function H(I,V){var L=V&&V.type;switch(L||st&&Buffer.isBuffer(I)&&(L="buffer"),L||"base64"){case"file":return U(I,V);case"base64":return u(Tn(Qn(I)),V);case"binary":return u(Tn(I),V)}return u(I,V)}function E(I,V){var L=V||{},M=L.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=M+"/",I.FileIndex[0]={name:M,type:5}),L.CLSID&&(I.FileIndex[0].clsid=L.CLSID),T(I)}function T(I){var V="Sh33tJ5";if(!He.find(I,"/"+V)){var L=ee(4);L[0]=55,L[1]=L[3]=50,L[2]=54,I.FileIndex.push({name:V,type:2,content:L,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),k(I)}}function k(I,V){E(I);for(var L=!1,M=!1,B=I.FullPaths.length-1;B>=0;--B){var j=I.FileIndex[B];switch(j.type){case 0:M?L=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:M=!0,isNaN(j.R*j.L*j.C)&&(L=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!V)){var J=new Date(1987,1,19),ne=0,Y=Object.create?Object.create(null):{},te=[];for(B=0;B<I.FullPaths.length;++B)Y[I.FullPaths[B]]=!0,I.FileIndex[B].type!==0&&te.push([I.FullPaths[B],I.FileIndex[B]]);for(B=0;B<te.length;++B){var Z=n(te[B][0]);for(M=Y[Z];!M;){for(;n(Z)&&!Y[n(Z)];)Z=n(Z);te.push([Z,{name:i(Z).replace("/",""),type:1,clsid:Re,ct:J,mt:J,content:null}]),Y[Z]=!0,Z=n(te[B][0]),M=Y[Z]}}for(te.sort(function(be,_e){return r(be[0],_e[0])}),I.FullPaths=[],I.FileIndex=[],B=0;B<te.length;++B)I.FullPaths[B]=te[B][0],I.FileIndex[B]=te[B][1];for(B=0;B<te.length;++B){var me=I.FileIndex[B],Te=I.FullPaths[B];if(me.name=i(Te).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||Re,B===0)me.C=te.length>1?1:-1,me.size=0,me.type=5;else if(Te.slice(-1)=="/"){for(ne=B+1;ne<te.length&&n(I.FullPaths[ne])!=Te;++ne);for(me.C=ne>=te.length?-1:ne,ne=B+1;ne<te.length&&n(I.FullPaths[ne])!=n(Te);++ne);me.R=ne>=te.length?-1:ne,me.type=1}else n(I.FullPaths[B+1]||"")==n(Te)&&(me.R=B+1),me.type=2}}}function C(I,V){var L=V||{};if(L.fileType=="mad")return jr(I,L);switch(k(I),L.fileType){case"zip":return dc(I,L)}var M=function(be){for(var _e=0,Ee=0,qe=0;qe<be.FileIndex.length;++qe){var Mt=be.FileIndex[qe];if(Mt.content){var bt=Mt.content.length;bt>0&&(bt<4096?_e+=bt+63>>6:Ee+=bt+511>>9)}}for(var qt=be.FullPaths.length+3>>2,os=_e+7>>3,Ra=_e+127>>7,Ms=os+Ee+qt+Ra,Bi=Ms+127>>7,Mo=Bi<=109?0:Math.ceil((Bi-109)/127);Ms+Bi+Mo+127>>7>Bi;)Mo=++Bi<=109?0:Math.ceil((Bi-109)/127);var jn=[1,Mo,Bi,Ra,qt,Ee,_e,0];return be.FileIndex[0].size=_e<<6,jn[7]=(be.FileIndex[0].start=jn[0]+jn[1]+jn[2]+jn[3]+jn[4]+jn[5])+(jn[6]+7>>3),jn}(I),B=ee(M[7]<<9),j=0,J=0;{for(j=0;j<8;++j)B.write_shift(1,he[j]);for(j=0;j<8;++j)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),j=0;j<3;++j)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,M[2]),B.write_shift(4,M[0]+M[1]+M[2]+M[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,M[3]?M[0]+M[1]+M[2]-1:N),B.write_shift(4,M[3]),B.write_shift(-4,M[1]?M[0]-1:N),B.write_shift(4,M[1]),j=0;j<109;++j)B.write_shift(-4,j<M[2]?M[1]+j:-1)}if(M[1])for(J=0;J<M[1];++J){for(;j<236+J*127;++j)B.write_shift(-4,j<M[2]?M[1]+j:-1);B.write_shift(-4,J===M[1]-1?N:J+1)}var ne=function(be){for(J+=be;j<J-1;++j)B.write_shift(-4,j+1);be&&(++j,B.write_shift(-4,N))};for(J=j=0,J+=M[1];j<J;++j)B.write_shift(-4,de.DIFSECT);for(J+=M[2];j<J;++j)B.write_shift(-4,de.FATSECT);ne(M[3]),ne(M[4]);for(var Y=0,te=0,Z=I.FileIndex[0];Y<I.FileIndex.length;++Y)Z=I.FileIndex[Y],Z.content&&(te=Z.content.length,!(te<4096)&&(Z.start=J,ne(te+511>>9)));for(ne(M[6]+7>>3);B.l&511;)B.write_shift(-4,de.ENDOFCHAIN);for(J=j=0,Y=0;Y<I.FileIndex.length;++Y)Z=I.FileIndex[Y],Z.content&&(te=Z.content.length,!(!te||te>=4096)&&(Z.start=J,ne(te+63>>6)));for(;B.l&511;)B.write_shift(-4,de.ENDOFCHAIN);for(j=0;j<M[4]<<2;++j){var me=I.FullPaths[j];if(!me||me.length===0){for(Y=0;Y<17;++Y)B.write_shift(4,0);for(Y=0;Y<3;++Y)B.write_shift(4,-1);for(Y=0;Y<12;++Y)B.write_shift(4,0);continue}Z=I.FileIndex[j],j===0&&(Z.start=Z.size?Z.start-1:N);var Te=j===0&&L.root||Z.name;if(Te.length>32&&(console.error("Name "+Te+" will be truncated to "+Te.slice(0,32)),Te=Te.slice(0,32)),te=2*(Te.length+1),B.write_shift(64,Te,"utf16le"),B.write_shift(2,te),B.write_shift(1,Z.type),B.write_shift(1,Z.color),B.write_shift(-4,Z.L),B.write_shift(-4,Z.R),B.write_shift(-4,Z.C),Z.clsid)B.write_shift(16,Z.clsid,"hex");else for(Y=0;Y<4;++Y)B.write_shift(4,0);B.write_shift(4,Z.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,Z.start),B.write_shift(4,Z.size),B.write_shift(4,0)}for(j=1;j<I.FileIndex.length;++j)if(Z=I.FileIndex[j],Z.size>=4096)if(B.l=Z.start+1<<9,st&&Buffer.isBuffer(Z.content))Z.content.copy(B,B.l,0,Z.size),B.l+=Z.size+511&-512;else{for(Y=0;Y<Z.size;++Y)B.write_shift(1,Z.content[Y]);for(;Y&511;++Y)B.write_shift(1,0)}for(j=1;j<I.FileIndex.length;++j)if(Z=I.FileIndex[j],Z.size>0&&Z.size<4096)if(st&&Buffer.isBuffer(Z.content))Z.content.copy(B,B.l,0,Z.size),B.l+=Z.size+63&-64;else{for(Y=0;Y<Z.size;++Y)B.write_shift(1,Z.content[Y]);for(;Y&63;++Y)B.write_shift(1,0)}if(st)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function A(I,V){var L=I.FullPaths.map(function(Y){return Y.toUpperCase()}),M=L.map(function(Y){var te=Y.split("/");return te[te.length-(Y.slice(-1)=="/"?2:1)]}),B=!1;V.charCodeAt(0)===47?(B=!0,V=L[0].slice(0,-1)+V):B=V.indexOf("/")!==-1;var j=V.toUpperCase(),J=B===!0?L.indexOf(j):M.indexOf(j);if(J!==-1)return I.FileIndex[J];var ne=!j.match(Hc);for(j=j.replace(Fn,""),ne&&(j=j.replace(Hc,"!")),J=0;J<L.length;++J)if((ne?L[J].replace(Hc,"!"):L[J]).replace(Fn,"")==j||(ne?M[J].replace(Hc,"!"):M[J]).replace(Fn,"")==j)return I.FileIndex[J];return null}var b=64,N=-2,we="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Re="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:we,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(I,V,L){c();var M=C(I,L);l.writeFileSync(V,M)}function ye(I){for(var V=new Array(I.length),L=0;L<I.length;++L)V[L]=String.fromCharCode(I[L]);return V.join("")}function X(I,V){var L=C(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,L),L;case"binary":return typeof L=="string"?L:ye(L);case"base64":return td(typeof L=="string"?L:ye(L));case"buffer":if(st)return Buffer.isBuffer(L)?L:ns(L);case"array":return typeof L=="string"?Tn(L):L}return L}var Ce;function ce(I){try{var V=I.InflateRaw,L=new V;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)Ce=I;else throw new Error("zlib does not expose bytesRead")}catch(M){console.error("cannot use native zlib: "+(M.message||M))}}function fe(I,V){if(!Ce)return Oo(I,V);var L=Ce.InflateRaw,M=new L,B=M._processChunk(I.slice(I.l),M._finishFlushFlag);return I.l+=M.bytesRead,B}function le(I){return Ce?Ce.deflateRawSync(I):Ur(I)}var De=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function F(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var G=typeof Uint8Array<"u",W=G?new Uint8Array(256):[],z=0;z<256;++z)W[z]=F(z);function Q(I,V){var L=W[I&255];return V<=8?L>>>8-V:(L=L<<8|W[I>>8&255],V<=16?L>>>16-V:(L=L<<8|W[I>>16&255],L>>>24-V))}function O(I,V){var L=V&7,M=V>>>3;return(I[M]|(L<=6?0:I[M+1]<<8))>>>L&3}function ae(I,V){var L=V&7,M=V>>>3;return(I[M]|(L<=5?0:I[M+1]<<8))>>>L&7}function Ae(I,V){var L=V&7,M=V>>>3;return(I[M]|(L<=4?0:I[M+1]<<8))>>>L&15}function ge(I,V){var L=V&7,M=V>>>3;return(I[M]|(L<=3?0:I[M+1]<<8))>>>L&31}function Pe(I,V){var L=V&7,M=V>>>3;return(I[M]|(L<=1?0:I[M+1]<<8))>>>L&127}function Oe(I,V,L){var M=V&7,B=V>>>3,j=(1<<L)-1,J=I[B]>>>M;return L<8-M||(J|=I[B+1]<<8-M,L<16-M)||(J|=I[B+2]<<16-M,L<24-M)||(J|=I[B+3]<<24-M),J&j}function Ge(I,V,L){var M=V&7,B=V>>>3;return M<=5?I[B]|=(L&7)<<M:(I[B]|=L<<M&255,I[B+1]=(L&7)>>8-M),V+3}function ot(I,V,L){var M=V&7,B=V>>>3;return L=(L&1)<<M,I[B]|=L,V+1}function St(I,V,L){var M=V&7,B=V>>>3;return L<<=M,I[B]|=L&255,L>>>=8,I[B+1]=L,V+8}function Zt(I,V,L){var M=V&7,B=V>>>3;return L<<=M,I[B]|=L&255,L>>>=8,I[B+1]=L&255,I[B+2]=L>>>8,V+16}function Le(I,V){var L=I.length,M=2*L>V?2*L:V+5,B=0;if(L>=V)return I;if(st){var j=yw(M);if(I.copy)I.copy(j);else for(;B<I.length;++B)j[B]=I[B];return j}else if(G){var J=new Uint8Array(M);if(J.set)J.set(I);else for(;B<L;++B)J[B]=I[B];return J}return I.length=M,I}function at(I){for(var V=new Array(I),L=0;L<I;++L)V[L]=0;return V}function Se(I,V,L){var M=1,B=0,j=0,J=0,ne=0,Y=I.length,te=G?new Uint16Array(32):at(32);for(j=0;j<32;++j)te[j]=0;for(j=Y;j<L;++j)I[j]=0;Y=I.length;var Z=G?new Uint16Array(Y):at(Y);for(j=0;j<Y;++j)te[B=I[j]]++,M<B&&(M=B),Z[j]=0;for(te[0]=0,j=1;j<=M;++j)te[j+16]=ne=ne+te[j-1]<<1;for(j=0;j<Y;++j)ne=I[j],ne!=0&&(Z[j]=te[ne+16]++);var me=0;for(j=0;j<Y;++j)if(me=I[j],me!=0)for(ne=Q(Z[j],M)>>M-me,J=(1<<M+4-me)-1;J>=0;--J)V[ne|J<<me]=me&15|j<<4;return M}var Nt=G?new Uint16Array(512):at(512),Ct=G?new Uint16Array(32):at(32);if(!G){for(var Dt=0;Dt<512;++Dt)Nt[Dt]=0;for(Dt=0;Dt<32;++Dt)Ct[Dt]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);Se(I,Ct,32);var L=[];for(V=0;V<=143;V++)L.push(8);for(;V<=255;V++)L.push(9);for(;V<=279;V++)L.push(7);for(;V<=287;V++)L.push(8);Se(L,Nt,288)})();var Pn=function(){for(var V=G?new Uint8Array(32768):[],L=0,M=0;L<se.length-1;++L)for(;M<se[L+1];++M)V[M]=L;for(;M<32768;++M)V[M]=29;var B=G?new Uint8Array(259):[];for(L=0,M=0;L<K.length-1;++L)for(;M<K[L+1];++M)B[M]=L;function j(ne,Y){for(var te=0;te<ne.length;){var Z=Math.min(65535,ne.length-te),me=te+Z==ne.length;for(Y.write_shift(1,+me),Y.write_shift(2,Z),Y.write_shift(2,~Z&65535);Z-- >0;)Y[Y.l++]=ne[te++]}return Y.l}function J(ne,Y){for(var te=0,Z=0,me=G?new Uint16Array(32768):[];Z<ne.length;){var Te=Math.min(65535,ne.length-Z);if(Te<10){for(te=Ge(Y,te,+(Z+Te==ne.length)),te&7&&(te+=8-(te&7)),Y.l=te/8|0,Y.write_shift(2,Te),Y.write_shift(2,~Te&65535);Te-- >0;)Y[Y.l++]=ne[Z++];te=Y.l*8;continue}te=Ge(Y,te,+(Z+Te==ne.length)+2);for(var be=0;Te-- >0;){var _e=ne[Z];be=(be<<5^_e)&32767;var Ee=-1,qe=0;if((Ee=me[be])&&(Ee|=Z&-32768,Ee>Z&&(Ee-=32768),Ee<Z))for(;ne[Ee+qe]==ne[Z+qe]&&qe<250;)++qe;if(qe>2){_e=B[qe],_e<=22?te=St(Y,te,W[_e+1]>>1)-1:(St(Y,te,3),te+=5,St(Y,te,W[_e-23]>>5),te+=3);var Mt=_e<8?0:_e-4>>2;Mt>0&&(Zt(Y,te,qe-K[_e]),te+=Mt),_e=V[Z-Ee],te=St(Y,te,W[_e]>>3),te-=3;var bt=_e<4?0:_e-2>>1;bt>0&&(Zt(Y,te,Z-Ee-se[_e]),te+=bt);for(var qt=0;qt<qe;++qt)me[be]=Z&32767,be=(be<<5^ne[Z])&32767,++Z;Te-=qe-1}else _e<=143?_e=_e+48:te=ot(Y,te,1),te=St(Y,te,W[_e]),me[be]=Z&32767,++Z}te=St(Y,te,0)-1}return Y.l=(te+7)/8|0,Y.l}return function(Y,te){return Y.length<8?j(Y,te):J(Y,te)}}();function Ur(I){var V=ee(50+Math.floor(I.length*1.1)),L=Pn(I,V);return V.slice(0,L)}var Me=G?new Uint16Array(32768):at(32768),rt=G?new Uint16Array(32768):at(32768),xr=G?new Uint16Array(128):at(128),Kt=1,Dr=1;function is(I,V){var L=ge(I,V)+257;V+=5;var M=ge(I,V)+1;V+=5;var B=Ae(I,V)+4;V+=4;for(var j=0,J=G?new Uint8Array(19):at(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Y=1,te=G?new Uint8Array(8):at(8),Z=G?new Uint8Array(8):at(8),me=J.length,Te=0;Te<B;++Te)J[De[Te]]=j=ae(I,V),Y<j&&(Y=j),te[j]++,V+=3;var be=0;for(te[0]=0,Te=1;Te<=Y;++Te)Z[Te]=be=be+te[Te-1]<<1;for(Te=0;Te<me;++Te)(be=J[Te])!=0&&(ne[Te]=Z[be]++);var _e=0;for(Te=0;Te<me;++Te)if(_e=J[Te],_e!=0){be=W[ne[Te]]>>8-_e;for(var Ee=(1<<7-_e)-1;Ee>=0;--Ee)xr[be|Ee<<_e]=_e&7|Te<<3}var qe=[];for(Y=1;qe.length<L+M;)switch(be=xr[Pe(I,V)],V+=be&7,be>>>=3){case 16:for(j=3+O(I,V),V+=2,be=qe[qe.length-1];j-- >0;)qe.push(be);break;case 17:for(j=3+ae(I,V),V+=3;j-- >0;)qe.push(0);break;case 18:for(j=11+Pe(I,V),V+=7;j-- >0;)qe.push(0);break;default:qe.push(be),Y<be&&(Y=be);break}var Mt=qe.slice(0,L),bt=qe.slice(L);for(Te=L;Te<286;++Te)Mt[Te]=0;for(Te=M;Te<30;++Te)bt[Te]=0;return Kt=Se(Mt,Me,286),Dr=Se(bt,rt,30),V}function bo(I,V){if(I[0]==3&&!(I[1]&3))return[xa(V),2];for(var L=0,M=0,B=yw(V||1<<18),j=0,J=B.length>>>0,ne=0,Y=0;!(M&1);){if(M=ae(I,L),L+=3,M>>>1)M>>1==1?(ne=9,Y=5):(L=is(I,L),ne=Kt,Y=Dr);else{L&7&&(L+=8-(L&7));var te=I[L>>>3]|I[(L>>>3)+1]<<8;if(L+=32,te>0)for(!V&&J<j+te&&(B=Le(B,j+te),J=B.length);te-- >0;)B[j++]=I[L>>>3],L+=8;continue}for(;;){!V&&J<j+32767&&(B=Le(B,j+32767),J=B.length);var Z=Oe(I,L,ne),me=M>>>1==1?Nt[Z]:Me[Z];if(L+=me&15,me>>>=4,!(me>>>8&255))B[j++]=me;else{if(me==256)break;me-=257;var Te=me<8?0:me-4>>2;Te>5&&(Te=0);var be=j+K[me];Te>0&&(be+=Oe(I,L,Te),L+=Te),Z=Oe(I,L,Y),me=M>>>1==1?Ct[Z]:rt[Z],L+=me&15,me>>>=4;var _e=me<4?0:me-2>>1,Ee=se[me];for(_e>0&&(Ee+=Oe(I,L,_e),L+=_e),!V&&J<be&&(B=Le(B,be+100),J=B.length);j<be;)B[j]=B[j-Ee],++j}}}return V?[B,L+7>>>3]:[B.slice(0,j),L+7>>>3]}function Oo(I,V){var L=I.slice(I.l||0),M=bo(L,V);return I.l+=M[1],M[0]}function fc(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function hc(I,V){var L=I;Cr(L,0);var M=[],B=[],j={FileIndex:M,FullPaths:B};E(j,{root:V.root});for(var J=L.length-4;(L[J]!=80||L[J+1]!=75||L[J+2]!=5||L[J+3]!=6)&&J>=0;)--J;L.l=J+4,L.l+=4;var ne=L.read_shift(2);L.l+=6;var Y=L.read_shift(4);for(L.l=Y,J=0;J<ne;++J){L.l+=20;var te=L.read_shift(4),Z=L.read_shift(4),me=L.read_shift(2),Te=L.read_shift(2),be=L.read_shift(2);L.l+=8;var _e=L.read_shift(4),Ee=o(L.slice(L.l+me,L.l+me+Te));L.l+=me+Te+be;var qe=L.l;L.l=_e+4,Ee&&Ee[1]&&((Ee[1]||{}).usz&&(Z=Ee[1].usz),(Ee[1]||{}).csz&&(te=Ee[1].csz)),Ia(L,te,Z,j,Ee),L.l=qe}return j}function Ia(I,V,L,M,B){I.l+=2;var j=I.read_shift(2),J=I.read_shift(2),ne=a(I);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var Y=I.read_shift(4),te=I.read_shift(4),Z=I.read_shift(4),me=I.read_shift(2),Te=I.read_shift(2),be="",_e=0;_e<me;++_e)be+=String.fromCharCode(I[I.l++]);if(Te){var Ee=o(I.slice(I.l,I.l+Te));(Ee[21589]||{}).mt&&(ne=Ee[21589].mt),(Ee[1]||{}).usz&&(Z=Ee[1].usz),(Ee[1]||{}).csz&&(te=Ee[1].csz),B&&((B[21589]||{}).mt&&(ne=B[21589].mt),(B[1]||{}).usz&&(Z=Ee[1].usz),(B[1]||{}).csz&&(te=Ee[1].csz))}I.l+=Te;var qe=I.slice(I.l,I.l+te);switch(J){case 8:qe=fe(I,Z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+J)}var Mt=!1;j&8&&(Y=I.read_shift(4),Y==134695760&&(Y=I.read_shift(4),Mt=!0),te=I.read_shift(4),Z=I.read_shift(4)),te!=V&&fc(Mt,"Bad compressed size: "+V+" != "+te),Z!=L&&fc(Mt,"Bad uncompressed size: "+L+" != "+Z),as(M,be,qe,{unsafe:!0,mt:ne})}function dc(I,V){var L=V||{},M=[],B=[],j=ee(1),J=L.compression?8:0,ne=0,Y=0,te=0,Z=0,me=0,Te=I.FullPaths[0],be=Te,_e=I.FileIndex[0],Ee=[],qe=0;for(Y=1;Y<I.FullPaths.length;++Y)if(be=I.FullPaths[Y].slice(Te.length),_e=I.FileIndex[Y],!(!_e.size||!_e.content||be=="Sh33tJ5")){var Mt=Z,bt=ee(be.length);for(te=0;te<be.length;++te)bt.write_shift(1,be.charCodeAt(te)&127);bt=bt.slice(0,bt.l),Ee[me]=typeof _e.content=="string"?Iw.bstr(_e.content,0):Iw.buf(_e.content,0);var qt=typeof _e.content=="string"?Tn(_e.content):_e.content;J==8&&(qt=le(qt)),j=ee(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,ne),j.write_shift(2,J),_e.mt?s(j,_e.mt):j.write_shift(4,0),j.write_shift(-4,Ee[me]),j.write_shift(4,qt.length),j.write_shift(4,_e.content.length),j.write_shift(2,bt.length),j.write_shift(2,0),Z+=j.length,M.push(j),Z+=bt.length,M.push(bt),Z+=qt.length,M.push(qt),j=ee(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,ne),j.write_shift(2,J),j.write_shift(4,0),j.write_shift(-4,Ee[me]),j.write_shift(4,qt.length),j.write_shift(4,_e.content.length),j.write_shift(2,bt.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,Mt),qe+=j.l,B.push(j),qe+=bt.length,B.push(bt),++me}return j=ee(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,me),j.write_shift(2,me),j.write_shift(4,qe),j.write_shift(4,Z),j.write_shift(2,0),mr([mr(M),mr(B),j])}var Ls={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ss(I,V){if(I.ctype)return I.ctype;var L=I.name||"",M=L.match(/\.([^\.]+)$/);return M&&Ls[M[1]]||V&&(M=(L=V).match(/[\.\\]([^\.\\])+$/),M&&Ls[M[1]])?Ls[M[1]]:"application/octet-stream"}function Wf(I){for(var V=td(I),L=[],M=0;M<V.length;M+=76)L.push(V.slice(M,M+76));return L.join(`\r
`)+`\r
`}function Lo(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var Z=te.charCodeAt(0).toString(16).toUpperCase();return"="+(Z.length==1?"0"+Z:Z)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],M=V.split(`\r
`),B=0;B<M.length;++B){var j=M[B];if(j.length==0){L.push("");continue}for(var J=0;J<j.length;){var ne=76,Y=j.slice(J,J+ne);Y.charAt(ne-1)=="="?ne--:Y.charAt(ne-2)=="="?ne-=2:Y.charAt(ne-3)=="="&&(ne-=3),Y=j.slice(J,J+ne),J+=ne,J<j.length&&(Y+="="),L.push(Y)}}return L.join(`\r
`)}function zf(I){for(var V=[],L=0;L<I.length;++L){for(var M=I[L];L<=I.length&&M.charAt(M.length-1)=="=";)M=M.slice(0,M.length-1)+I[++L];V.push(M)}for(var B=0;B<V.length;++B)V[B]=V[B].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return Tn(V.join(`\r
`))}function Fa(I,V,L){for(var M="",B="",j="",J,ne=0;ne<10;++ne){var Y=V[ne];if(!Y||Y.match(/^\s*$/))break;var te=Y.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":M=te[2].trim();break;case"content-type":j=te[2].trim();break;case"content-transfer-encoding":B=te[2].trim();break}}switch(++ne,B.toLowerCase()){case"base64":J=Tn(Qn(V.slice(ne).join("")));break;case"quoted-printable":J=zf(V.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var Z=as(I,M.slice(L.length),J,{unsafe:!0});j&&(Z.ctype=j)}function Hf(I,V){if(ye(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=V&&V.root||"",M=(st&&Buffer.isBuffer(I)?I.toString("binary"):ye(I)).split(`\r
`),B=0,j="";for(B=0;B<M.length;++B)if(j=M[B],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),L||(L=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),j.slice(0,L.length)!=L););var J=(M[1]||"").match(/boundary="(.*?)"/);if(!J)throw new Error("MAD cannot find boundary");var ne="--"+(J[1]||""),Y=[],te=[],Z={FileIndex:Y,FullPaths:te};E(Z);var me,Te=0;for(B=0;B<M.length;++B){var be=M[B];be!==ne&&be!==ne+"--"||(Te++&&Fa(Z,M.slice(me,B),L),me=B)}return Z}function jr(I,V){var L=V||{},M=L.boundary||"SheetJS";M="------="+M;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+M.slice(2)+'"',"","",""],j=I.FullPaths[0],J=j,ne=I.FileIndex[0],Y=1;Y<I.FullPaths.length;++Y)if(J=I.FullPaths[Y].slice(j.length),ne=I.FileIndex[Y],!(!ne.size||!ne.content||J=="Sh33tJ5")){J=J.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var te=ne.content,Z=st&&Buffer.isBuffer(te)?te.toString("binary"):ye(te),me=0,Te=Math.min(1024,Z.length),be=0,_e=0;_e<=Te;++_e)(be=Z.charCodeAt(_e))>=32&&be<128&&++me;var Ee=me>=Te*4/5;B.push(M),B.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+J),B.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),B.push("Content-Type: "+ss(ne,J)),B.push(""),B.push(Ee?Lo(Z):Wf(Z))}return B.push(M+`--\r
`),B.join(`\r
`)}function $f(I){var V={};return E(V,I),V}function as(I,V,L,M){var B=M&&M.unsafe;B||E(I);var j=!B&&He.find(I,V);if(!j){var J=I.FullPaths[0];V.slice(0,J.length)==J?J=V:(J.slice(-1)!="/"&&(J+="/"),J=(J+V).replace("//","/")),j={name:i(V),type:2},I.FileIndex.push(j),I.FullPaths.push(J),B||He.utils.cfb_gc(I)}return j.content=L,j.size=L?L.length:0,M&&(M.CLSID&&(j.clsid=M.CLSID),M.mt&&(j.mt=M.mt),M.ct&&(j.ct=M.ct)),j}function Na(I,V){E(I);var L=He.find(I,V);if(L){for(var M=0;M<I.FileIndex.length;++M)if(I.FileIndex[M]==L)return I.FileIndex.splice(M,1),I.FullPaths.splice(M,1),!0}return!1}function fp(I,V,L){E(I);var M=He.find(I,V);if(M){for(var B=0;B<I.FileIndex.length;++B)if(I.FileIndex[B]==M)return I.FileIndex[B].name=i(L),I.FullPaths[B]=L,!0}return!1}function hp(I){k(I,!0)}return e.find=A,e.read=H,e.parse=u,e.write=X,e.writeFile=re,e.utils={cfb_new:$f,cfb_add:as,cfb_del:Na,cfb_mov:fp,cfb_gc:hp,ReadShift:uu,CheckField:eA,prep_blob:Cr,bconcat:mr,use_zlib:ce,_deflateRaw:Ur,_inflateRaw:Oo,consts:de},e}(),JO;function Fw(t){return typeof t=="string"?Qd(t):Array.isArray(t)?SO(t):t}function bf(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Qd(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?qi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([Fw(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var o="data:application/octet-stream;base64,"+kO(new Uint8Array(Fw(n)));return chrome.downloads.download({url:o,filename:t,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=ts(e)),l.write(e),l.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function ZO(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Xt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Nw(t,e){for(var r=[],n=Xt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Zd(t){for(var e=[],r=Xt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function ep(t){for(var e=[],r=Xt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function e9(t){for(var e=[],r=Xt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var DC=Date.UTC(1899,11,30,0,0,0),t9=Date.UTC(1899,11,31,0,0,0),r9=Date.UTC(1904,0,1,0,0,0);function nr(t,e){var r=t.getTime(),n=(r-DC)/(24*60*60*1e3);return e?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Es(t){if(t>=60&&t<61)return t;var e=new Date;return e.setTime((t>60?t:t+1)*24*60*60*1e3+DC),e}function n9(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var i9=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,s9=/^(\d+)-(\d+)-(\d+)$/,bC=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Jt(t,e){if(t instanceof Date)return t;var r=t.match(i9);if(r)return new Date((e?r9:t9)+((parseInt(r[1],10)*60+parseInt(r[2],10))*60+(r[3]?parseInt(r[3].slice(1),10):0))*1e3+(r[4]?parseInt((r[4]+"000").slice(1,4),10):0));if(r=t.match(s9),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],0,0,0,0));if(r=t.match(bC),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt(r[7].slice(1),10)||0));var n=new Date(t);return n}function _o(t,e){if(st&&Buffer.isBuffer(t)){if(e&&Ju){if(t[0]==255&&t[1]==254)return qi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return qi(TC(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return qi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return qi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}var n=[],i=0;try{for(i=0;i<t.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,t.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,t.slice(i)))}catch{try{for(;i<t.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,t.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,t.slice(i)))}catch{for(;i!=t.length;++i)n.push(String.fromCharCode(t[i]))}}return n.join("")}function Bt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Bt(t[r]));return e}function gt(t,e){for(var r="";r.length<e;)r+=t;return r}function qn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var a9=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,o9=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,l9=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,c9=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function u9(t){return t[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],+t[4],parseFloat(t[3])*1e3)):new Date(Date.UTC(1899,11,31,t[7]=="p"?12:0,+t[1],+t[2],parseFloat(t[3])*1e3)):t[5]?new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],+t[5],t[6]?parseFloat(t[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),0,0,0))}function f9(t){return t[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[4],parseFloat(t[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+t[1],+t[2],parseFloat(t[3])*1e3)):t[5]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[5],t[6]?parseFloat(t[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+t[1],+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1],0,0,0))}var h9=["january","february","march","april","may","june","july","august","september","october","november","december"];function ef(t){if(l9.test(t))return t.indexOf("Z")==-1?tp(new Date(t)):new Date(t);var e=t.toLowerCase(),r=e.replace(/\s+/g," ").trim(),n=r.match(a9);if(n)return u9(n);if(n=r.match(o9),n)return f9(n);if(n=r.match(bC),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt(n[7].slice(1),10)||0));var i=new Date(c9&&t.indexOf("UTC")==-1?t+" UTC":t),s=new Date(NaN),a=i.getYear();i.getMonth();var o=i.getDate();if(isNaN(o))return s;if(e.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(e=e.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),e.length>3&&h9.indexOf(e)==-1)return s}else if(e.replace(/[ap]m?/,"").match(/[a-z]/))return s;return a<0||a>8099||t.match(/[^-0-9:,\/\\\ ]/)?s:i}var d9=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function vo(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function tp(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))}function OC(t){return t?t.content&&t.type?_o(t.content,!0):t.data?zc(t.data):t.asNodeBuffer&&st?zc(t.asNodeBuffer().toString("binary")):t.asBinary?zc(t.asBinary()):t._data&&t._data.getContent?zc(_o(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function LC(t){if(!t)return null;if(t.data)return vw(t.data);if(t.asNodeBuffer&&st)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?vw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function p9(t){return t&&t.name.slice(-4)===".bin"?LC(t):OC(t)}function ni(t,e){for(var r=t.FullPaths||Xt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Ev(t,e){var r=ni(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Er(t,e,r){if(!r)return p9(Ev(t,e));if(!e)return null;try{return Er(t,e)}catch{return null}}function Sn(t,e,r){if(!r)return OC(Ev(t,e));if(!e)return null;try{return Sn(t,e)}catch{return null}}function m9(t,e,r){return LC(Ev(t,e))}function Rw(t){for(var e=t.FullPaths||Xt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return st?n=ns(r):n=CO(r),He.utils.cfb_add(t,e,n)}He.utils.cfb_add(t,e,r)}else t.file(e,r)}function Tv(){return He.utils.cfb_new()}function MC(t,e){switch(e.type){case"base64":return He.read(t,{type:"base64"});case"binary":return He.read(t,{type:"binary"});case"buffer":case"array":return He.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ul(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var vr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,g9=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_9=/<[^>]*>/g,Jr=vr.match(Pw)?Pw:_9,v9=/<\w*:/,x9=/<(\/?)\w+:/;function Ve(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(g9),o=0,l="",c=0,u="",d="",h=1;if(a)for(c=0;c!=a.length;++c){for(d=a[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(u=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(i=d.charCodeAt(s+1))==34||i==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function _i(t){return t.replace(x9,"<$1")}var BC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kv=Zd(BC),mt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return BC[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}return function(i,s){var a=r(i);return s?a.replace(/\r\n/g,`
`):a}}(),Sv=/[&<>'"]/g,y9=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Ze(t){var e=t+"";return e.replace(Sv,function(r){return kv[r]}).replace(y9,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Dw(t){return Ze(t).replace(/ /g,"_x0020_")}var VC=/[\u0000-\u001f]/g;function ad(t){var e=t+"";return e.replace(Sv,function(r){return kv[r]}).replace(/\n/g,"<br/>").replace(VC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function w9(t){var e=t+"";return e.replace(Sv,function(r){return kv[r]}).replace(VC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var bw=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function E9(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ft(t){switch(t){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function um(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Ow(t){var e=xa(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Lw(t){return ns(t,"binary").toString("utf8")}var F0="foo bar baz",Rt=st&&(Lw(F0)==um(F0)&&Lw||Ow(F0)==um(F0)&&Ow)||um,qi=st?function(t){return ns(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},tf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),UC=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),T9=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),k9=/<\/?(?:vt:)?variant>/g,S9=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mw(t,e){var r=Ve(t),n=t.match(T9(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(k9,"").match(S9);a&&i.push({v:Rt(a[2]),t:a[1]})}),i}var jC=/(^\s|\s$|\n)/;function Gr(t,e){return"<"+t+(e.match(jC)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function rf(t){return Xt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function xe(t,e,r){return"<"+t+(r!=null?rf(r):"")+(e!=null?(e.match(jC)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function rg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function C9(t,e){switch(typeof t){case"string":var r=xe("vt:lpwstr",Ze(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xe((t|0)==t?"vt:i4":"vt:r8",Ze(String(t)));case"boolean":return xe("vt:bool",t?"true":"false")}if(t instanceof Date)return xe("vt:filetime",rg(t));throw new Error("Unable to serialize "+t)}function rp(t){if(st&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Rt(ts(xv(t)));throw new Error("Bad input format: expected Buffer or string")}var Tr=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/](?:[^>=]|="[^"]*?")*)?>/mg,Nr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Io=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function A9(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function I9(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Bw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Vw=st?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ns(e)})):Bw(t)}:Bw,Uw=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(vs(t,i)));return n.join("").replace(Fn,"")},Cv=st?function(t,e,r){return!Buffer.isBuffer(t)||!Ju?Uw(t,e,r):t.toString("utf16le",e,r).replace(Fn,"")}:Uw,jw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},WC=st?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):jw(t,e,r)}:jw,Ww=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Yo(t,i)));return n.join("")},Of=st?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Ww(e,r,n)}:Ww,zC=function(t,e){var r=Gn(t,e);return r>0?Of(t,e+4,e+4+r-1):""},HC=zC,$C=function(t,e){var r=Gn(t,e);return r>0?Of(t,e+4,e+4+r-1):""},GC=$C,XC=function(t,e){var r=2*Gn(t,e);return r>0?Of(t,e+4,e+4+r-1):""},KC=XC,qC=function(e,r){var n=Gn(e,r);return n>0?Cv(e,r+4,r+4+n):""},YC=qC,QC=function(t,e){var r=Gn(t,e);return r>0?Of(t,e+4,e+4+r):""},JC=QC,ZC=function(t,e){return A9(t,e)},od=ZC,Av=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};st&&(HC=function(e,r){if(!Buffer.isBuffer(e))return zC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},GC=function(e,r){if(!Buffer.isBuffer(e))return $C(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},KC=function(e,r){if(!Buffer.isBuffer(e)||!Ju)return XC(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},YC=function(e,r){if(!Buffer.isBuffer(e)||!Ju)return qC(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},JC=function(e,r){if(!Buffer.isBuffer(e))return QC(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},od=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):ZC(e,r)},Av=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Yo=function(t,e){return t[e]},vs=function(t,e){return t[e+1]*256+t[e]},F9=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Gn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Wa=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},N9=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function uu(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,st&&Buffer.isBuffer(this)&&Ju)r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(vs(this,c)),c+=2;t*=2;break;case"utf8":r=Of(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Cv(this,this.l,this.l+t);break;case"wstr":return uu.call(this,t,"dbcs");case"lpstr-ansi":r=HC(this,this.l),t=4+Gn(this,this.l);break;case"lpstr-cp":r=GC(this,this.l),t=4+Gn(this,this.l);break;case"lpwstr":r=KC(this,this.l),t=4+2*Gn(this,this.l);break;case"lpp4":t=4+Gn(this,this.l),r=YC(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Gn(this,this.l),r=JC(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Yo(this,this.l+t++))!==0;)s.push(I0(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=vs(this,this.l+t))!==0;)s.push(I0(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Yo(this,c),this.l=c+1,o=uu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(I0(vs(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Yo(this,c),this.l=c+1,o=uu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(I0(Yo(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=Yo(this,this.l),this.l++,n;case 2:return n=(e==="i"?F9:vs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Wa:N9)(this,this.l),this.l+=4,n):(i=Gn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=od(this,this.l):i=od([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=WC(this,this.l,t);break}}return this.l+=t,r}var R9=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},P9=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},D9=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function b9(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)D9(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"||r=="cpstr"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,R9(this,e,this.l);break;case 8:if(n=8,r==="f"){I9(this,e,this.l);break}case 16:break;case-4:n=4,P9(this,e,this.l);break}return this.l+=n,this}function eA(t,e){var r=WC(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Cr(t,e){t.l=e,t.read_shift=uu,t.chk=eA,t.write_shift=b9}function xn(t,e){t.l+=e}function ee(t){var e=xa(t);return Cr(e,0),e}function Os(t,e,r){if(t){var n,i,s;Cr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=hf[o]||hf[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var u=c.f&&c.f(t,s,r);if(t.l=l,e(u,c,o))return}}}function gn(){var t=[],e=st?256:2048,r=function(c){var u=ee(c);return Cr(u,0),u},n=r(e),i=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n)),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),mr(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function oe(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=hf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Av(r)&&t.push(r)}}function fu(t,e,r){var n=Bt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zw(t,e,r){var n=Bt(t);return n.s=fu(n.s,e.s,r),n.e=fu(n.e,e.s,r),n}function hu(t,e){if(t.cRel&&t.c<0)for(t=Bt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Bt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=it(t);return!t.cRel&&t.cRel!=null&&(r=M9(r)),!t.rRel&&t.rRel!=null&&(r=O9(r)),r}function fm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+et(t.s.c)+":"+(t.e.cRel?"":"$")+et(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ht(t.s.r)+":"+(t.e.rRel?"":"$")+ht(t.e.r):hu(t.s,e.biff)+":"+hu(t.e,e.biff)}function Iv(t){return parseInt(L9(t),10)-1}function ht(t){return""+(t+1)}function O9(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function L9(t){return t.replace(/\$(\d+)$/,"$1")}function Fv(t){for(var e=B9(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function et(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function M9(t){return t.replace(/^([A-Z])/,"$$$1")}function B9(t){return t.replace(/^\$([A-Z])/,"$1")}function V9(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pt(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function it(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Vr(t){var e=t.indexOf(":");return e==-1?{s:Pt(t),e:Pt(t)}:{s:Pt(t.slice(0,e)),e:Pt(t.slice(e+1))}}function Je(t,e){return typeof e>"u"||typeof e=="number"?Je(t.s,t.e):(typeof t!="string"&&(t=it(t)),typeof e!="string"&&(e=it(e)),t==e?t:t+":"+e)}function nf(t){var e=Vr(t);return"$"+et(e.s.c)+"$"+ht(e.s.r)+":$"+et(e.e.c)+"$"+ht(e.e.r)}function sf(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t.replace(/'/g,"''")+"'":t}function Et(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Hw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Jn(t.z,r?nr(e):e)}catch{}try{return t.w=Jn((t.XF||{}).numFmtId||(r?14:0),r?nr(e):e)}catch{return""+e}}function Rs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?bi[t.v]||t.v:e==null?Hw(t,t.v):Hw(t,e))}function Ca(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function U9(t){var e={},r=t||{};return r.dense&&(e["!data"]=[]),e}function tA(t,e,r){var n=r||{},i=t?t["!data"]!=null:n.dense,s=t||{};i&&!s["!data"]&&(s["!data"]=[]);var a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Pt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Et(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var d=[],h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");var p=a+h,g=""+(p+1);i&&(s["!data"][p]||(s["!data"][p]=[]),d=s["!data"][p]);for(var x=0;x!=e[h].length;++x)if(!(typeof e[h][x]>"u")){var _={v:e[h][x]},m=o+x;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),e[h][x]&&typeof e[h][x]=="object"&&!Array.isArray(e[h][x])&&!(e[h][x]instanceof Date))_=e[h][x];else if(Array.isArray(_.v)&&(_.f=e[h][x][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||ze[14],n.UTC||(_.v=tp(_.v)),n.cellDates?(_.t="d",_.w=Jn(_.z,nr(_.v,n.date1904))):(_.t="n",_.v=nr(_.v,n.date1904),_.w=Jn(_.z,_.v))):_.t="s";if(i)d[m]&&d[m].z&&(_.z=d[m].z),d[m]=_;else{var w=et(m)+g;s[w]&&s[w].z&&(_.z=s[w].z),s[w]=_}}}return c.s.c<1e7&&(s["!ref"]=Je(c)),s}function cc(t,e){return tA(null,t,e)}function j9(t){return t.read_shift(4,"i")}function Di(t,e){return e||(e=ee(4)),e.write_shift(4,t),e}function _n(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Pr(t,e){var r=!1;return e==null&&(r=!0,e=ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function W9(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function z9(t,e){return e||(e=ee(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Nv(t,e){var r=t.l,n=t.read_shift(1),i=_n(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(W9(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function H9(t,e){var r=!1;return e==null&&(r=!0,e=ee(15+4*t.t.length)),e.write_shift(1,0),Pr(t.t,e),r?e.slice(0,e.l):e}var $9=Nv;function G9(t,e){var r=!1;return e==null&&(r=!0,e=ee(23+4*t.t.length)),e.write_shift(1,1),Pr(t.t,e),e.write_shift(4,1),z9({},e),r?e.slice(0,e.l):e}function vi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Fo(t,e){return e==null&&(e=ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function No(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ro(t,e){return e==null&&(e=ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var X9=_n,rA=Pr;function np(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function af(t,e){var r=!1;return e==null&&(r=!0,e=ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var K9=_n,ng=np,Rv=af;function ip(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?od([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Wa(e,0)>>2;return r?i/100:i}function nA(t,e){e==null&&(e=ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function iA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function q9(t,e){return e||(e=ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Po=iA,uc=q9;function pn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function xo(t,e){return(e||ee(8)).write_shift(8,t,"f")}function Y9(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Za[i];c&&(e.rgb=lf(c));break;case 2:e.rgb=lf([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function ld(t,e){if(e||(e=ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Q9(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function J9(t,e){e||(e=ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function sA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Z9(t){return sA(t,1)}function eL(t){return sA(t,2)}var Pv=2,bn=3,N0=11,$w=12,cd=19,R0=64,tL=65,rL=71,nL=4108,iL=4126,Lr=80,aA=81,sL=[Lr,aA],ig={1:{n:"CodePage",t:Pv},2:{n:"Category",t:Lr},3:{n:"PresentationFormat",t:Lr},4:{n:"ByteCount",t:bn},5:{n:"LineCount",t:bn},6:{n:"ParagraphCount",t:bn},7:{n:"SlideCount",t:bn},8:{n:"NoteCount",t:bn},9:{n:"HiddenCount",t:bn},10:{n:"MultimediaClipCount",t:bn},11:{n:"ScaleCrop",t:N0},12:{n:"HeadingPairs",t:nL},13:{n:"TitlesOfParts",t:iL},14:{n:"Manager",t:Lr},15:{n:"Company",t:Lr},16:{n:"LinksUpToDate",t:N0},17:{n:"CharacterCount",t:bn},19:{n:"SharedDoc",t:N0},22:{n:"HyperlinksChanged",t:N0},23:{n:"AppVersion",t:bn,p:"version"},24:{n:"DigSig",t:tL},26:{n:"ContentType",t:Lr},27:{n:"ContentStatus",t:Lr},28:{n:"Language",t:Lr},29:{n:"Version",t:Lr},255:{},2147483648:{n:"Locale",t:cd},2147483651:{n:"Behavior",t:cd},1919054434:{}},sg={1:{n:"CodePage",t:Pv},2:{n:"Title",t:Lr},3:{n:"Subject",t:Lr},4:{n:"Author",t:Lr},5:{n:"Keywords",t:Lr},6:{n:"Comments",t:Lr},7:{n:"Template",t:Lr},8:{n:"LastAuthor",t:Lr},9:{n:"RevNumber",t:Lr},10:{n:"EditTime",t:R0},11:{n:"LastPrinted",t:R0},12:{n:"CreatedDate",t:R0},13:{n:"ModifiedDate",t:R0},14:{n:"PageCount",t:bn},15:{n:"WordCount",t:bn},16:{n:"CharCount",t:bn},17:{n:"Thumbnail",t:rL},18:{n:"Application",t:Lr},19:{n:"DocSecurity",t:bn},255:{},2147483648:{n:"Locale",t:cd},2147483651:{n:"Behavior",t:cd},1919054434:{}},Gw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},aL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function oL(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var lL=oL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Za=Bt(lL),bi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},bv=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],ag={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},P0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ov(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function cL(t){var e=Ov();if(!t||!t.match)return e;var r={};if((t.match(Jr)||[]).forEach(function(n){var i=Ve(n);switch(i[0].replace(v9,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension.toLowerCase()]=i.ContentType;break;case"<Override":e[ag[i.ContentType]]!==void 0&&e[ag[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Nr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function oA(t,e,r){var n=e9(ag),i=[],s;i[i.length]=vr,i[i.length]=xe("Types",null,{xmlns:Nr.CT,"xmlns:xsd":Nr.xsd,"xmlns:xsi":Nr.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return xe("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){t[c]&&t[c].length>0&&(s=t[c][0],i[i.length]=xe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:P0[c][e.bookType]||P0[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(u){i[i.length]=xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:P0[c][e.bookType]||P0[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(u){i[i.length]=xe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[c][0]})})};return a("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function of(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function du(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Jr)||[]).forEach(function(i){var s=Ve(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=mt(s.Target),a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:ul(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Tl(t){var e=[vr,xe("Relationships",null,{xmlns:Nr.RELS})];return Xt(t["!id"]).forEach(function(r){e[e.length]=xe("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function At(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var uL="application/vnd.oasis.opendocument.spreadsheet";function fL(t,e){for(var r=rp(t),n,i;n=Tr.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ve(n[0],!1),i.path=="/"&&i.type!==uL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function hL(t){var e=[vr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Xw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function dL(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function pL(t){var e=[vr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Xw(t[r][0],t[r][1])),e.push(dL("",t[r][0]));return e.push(Xw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function lA(t,e){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ed.version+"</meta:generator></office:meta></office:document-meta>"}var hi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],mL=function(){for(var t=new Array(hi.length),e=0;e<hi.length;++e){var r=hi[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function cA(t){var e={};t=Rt(t);for(var r=0;r<hi.length;++r){var n=hi[r],i=t.match(mL[r]);i!=null&&i.length>0&&(e[n[1]]=mt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Jt(e[n[1]]))}return e}function hm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Ze(e),n[n.length]=r?xe(t,e,r):Gr(t,e))}function uA(t,e){var r=e||{},n=[vr,xe("cp:coreProperties",null,{"xmlns:cp":Nr.CORE_PROPS,"xmlns:dc":Nr.dc,"xmlns:dcterms":Nr.dcterms,"xmlns:dcmitype":Nr.dcmitype,"xmlns:xsi":Nr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&hm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:rg(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&hm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:rg(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=hi.length;++s){var a=hi[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&hm(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var eo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],fA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hA(t,e,r,n){var i=[];if(typeof t=="string")i=Mw(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(u){return{v:u}}));var a=typeof e=="string"?Mw(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function gL(t,e,r){var n={};return e||(e={}),t=Rt(t),eo.forEach(function(i){var s=(t.match(tf(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=mt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&hA(n.HeadingPairs,n.TitlesOfParts,e,r),e}function dA(t){var e=[],r=xe;return t||(t={}),t.Application="SheetJS",e[e.length]=vr,e[e.length]=xe("Properties",null,{xmlns:Nr.EXT_PROPS,"xmlns:vt":Nr.vt}),eo.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ze(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Ze(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var _L=/<[^>]+>[^<]*/g;function vL(t,e){var r={},n="",i=t.match(_L);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ve(a);switch(_i(o[0])){case"<?xml":break;case"<Properties":break;case"<property":n=mt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=mt(u);break;case"bool":r[n]=Ft(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Jt(u);break;case"cy":case"error":r[n]=mt(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function pA(t){var e=[vr,xe("Properties",null,{xmlns:Nr.CUST_PROPS,"xmlns:vt":Nr.vt})];if(!t)return e.join("");var r=1;return Xt(t).forEach(function(i){++r,e[e.length]=xe("property",C9(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ze(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var og={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dm;function xL(t,e,r){dm||(dm=Zd(og)),e=dm[e]||e,t[e]=r}function yL(t,e){var r=[];return Xt(og).map(function(n){for(var i=0;i<hi.length;++i)if(hi[i][1]==n)return hi[i];for(i=0;i<eo.length;++i)if(eo[i][1]==n)return eo[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Gr(og[n[1]]||n[1],i))}}),xe("DocumentProperties",r.join(""),{xmlns:$n.o})}function wL(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Xt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<hi.length;++a)if(s==hi[a][1])return;for(a=0;a<eo.length;++a)if(s==eo[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(xe(Dw(s),o,{"dt:dt":l}))}}),e&&Xt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(xe(Dw(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+$n.o+'">'+i.join("")+"</"+n+">"}function Lv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function EL(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function mA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function gA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function _A(t,e,r){return e===31?gA(t):mA(t,e,r)}function lg(t,e,r){return _A(t,e,r===!1?0:4)}function TL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return _A(t,e,0)}function kL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Fn,""),t.l-i&2&&(t.l+=2)}return r}function SL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Fn,"");return r}function CL(t){var e=t.l,r=ud(t,aA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=ud(t,bn);return[r,n]}function AL(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(CL(t));return r}function Kw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Fn,"").replace(Hc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function vA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function IL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function ud(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==$w&&n!==e&&sL.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===$w?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return mA(t,n,4).replace(Fn,"");case 31:return gA(t);case 64:return Lv(t);case 65:return vA(t);case 71:return IL(t);case 80:return lg(t,n,!s.raw).replace(Fn,"");case 81:return TL(t,n).replace(Fn,"");case 4108:return AL(t);case 4126:case 4127:return n==4127?kL(t):SL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function qw(t,e){var r=ee(4),n=ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=EL(e);break;case 31:case 80:for(n=ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return mr([r,n])}function Yw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=t.read_shift(4),d=t.read_shift(4);s[a]=[u,d+r]}s.sort(function(w,v){return w[1]-v[1]});var h={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){if(s[a][0]==0&&s.length>a+1&&s[a][1]==s[a+1][1])continue;var g=e[s[a][0]];if(h[g.n]=ud(t,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ii(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(s[a][0]===1){if(o=h.CodePage=ud(t,Pv),Ii(o),l!==-1){var x=t.l;t.l=s[l][1],c=Kw(t,o),t.l=x}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=Kw(t,o)}else{var _=c[s[a][0]],m;switch(t[t.l]){case 65:t.l+=4,m=vA(t);break;case 30:t.l+=4,m=lg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,m=lg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,m=t.read_shift(4,"i");break;case 19:t.l+=4,m=t.read_shift(4);break;case 5:t.l+=4,m=t.read_shift(8,"f");break;case 11:t.l+=4,m=hr(t,4);break;case 64:t.l+=4,m=Jt(Lv(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[_]=m}}return t.l=r+n,h}var xA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function FL(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Qw(t,e,r){var n=ee(8),i=[],s=[],a=8,o=0,l=ee(8),c=ee(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!e){c=ee(8),c.write_shift(4,0),i.unshift(c);var u=[ee(4)];for(u[0].write_shift(4,t.length),o=0;o<t.length;++o){var d=t[o][0];for(l=ee(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=mr(u),s.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(xA.indexOf(t[o][0])>-1||fA.indexOf(t[o][0])>-1)&&t[o][1]!=null){var h=t[o][1],p=0;if(e){p=+e[t[o][0]];var g=r[p];if(g.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}l=qw(g.t,h)}else{var _=FL(h);_==-1&&(_=31,h=String(h)),l=qw(_,h)}s.push(l),c=ee(8),c.write_shift(4,e?p:2+o),i.push(c),a+=8+l.length}var m=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,m),m+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),mr([n].concat(i).concat(s))}function Jw(t,e,r){var n=t.content;if(!n)return{};Cr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==He.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var d=Yw(n,e),h={SystemIdentifier:c};for(var p in d)h[p]=d[p];if(h.FMTID=s,i===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Yw(n,null)}catch{}for(p in g)h[p]=g[p];return h.FMTID=[s,a],h}function Zw(t,e,r,n,i,s){var a=ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,He.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var l=Qw(t,r,n);if(o.push(l),i){var c=Qw(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return mr(o)}function js(t,e){return t.read_shift(e),null}function NL(t,e){e||(e=ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function RL(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function hr(t,e){return t.read_shift(e)===1}function cn(t,e){return e||(e=ee(2)),e.write_shift(2,+!!t),e}function ar(t){return t.read_shift(2,"u")}function si(t,e){return e||(e=ee(2)),e.write_shift(2,t),e}function yA(t,e){return RL(t,e,ar)}function wA(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function EA(t,e,r){return r||(r=ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Xl(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=li;if(r&&r.biff>=8&&(li=1200),!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return li=s,o}function PL(t){var e=li;li=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,l,c={};s&&(o=t.read_shift(2)),i&&(l=t.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=r===0?"":t.read_shift(r,u);return s&&(t.l+=4*o),i&&(t.l+=l),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),li=e,c}function DL(t){var e=t.t||"",r=ee(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ee(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return mr(i)}function yo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Lf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):yo(t,n,r)}function Do(t,e,r){if(r.biff>5)return Lf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function TA(t,e,r){return r||(r=ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function bL(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function OL(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Fn,"");return n&&(t.l+=24),i}function LL(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Fn,"");return r+a}function ML(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return OL(t);case"0303000000000000c000000000000046":return LL(t);default:throw new Error("Unsupported Moniker "+r)}}function D0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Fn,""):"";return r}function eE(t,e){e||(e=ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function BL(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",u,d;i&16&&(s=D0(t,r-t.l)),i&128&&(a=D0(t,r-t.l)),(i&257)===257&&(o=D0(t,r-t.l)),(i&257)===1&&(l=ML(t,r-t.l)),i&8&&(c=D0(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(d=Lv(t)),t.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),d&&(p.time=d),s&&(p.Tooltip=s),p}function VL(t){var e=ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),eE(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&eE(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function kA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function SA(t,e){var r=kA(t);return r[3]=0,r}function Mi(t,e,r){var n=t.read_shift(2),i=t.read_shift(2),s={r:n,c:i,ixfe:0};if(r&&r.biff==2||e==7){var a=t.read_shift(1);s.ixfe=a&63,t.l+=2}else s.ixfe=t.read_shift(2);return s}function wo(t,e,r,n){return n||(n=ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function UL(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function jL(t,e,r){return e===0?"":Do(t,e,r)}function WL(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function CA(t){var e=t.read_shift(2),r=ip(t);return[e,r]}function zL(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Xl(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function sp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function AA(t,e){return e||(e=ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function IA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var HL=IA;function FA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function $L(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function GL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function sn(t){t.l+=2,t.l+=t.read_shift(2)}var XL={0:sn,4:sn,5:sn,6:sn,7:GL,8:sn,9:sn,10:sn,11:sn,12:sn,13:$L,14:sn,15:sn,16:sn,17:sn,18:sn,19:sn,20:sn,21:FA};function KL(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n[i]=XL[i](t,r-t.l)}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function b0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Mv(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function qL(t,e){return e===0||t.read_shift(2),1200}function YL(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Do(t,0,r);return t.read_shift(e+n-t.l),i}function QL(t,e){var r=!e||e.biff==8,n=ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function JL(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ZL(t,e,r){var n="";if(r.biff==4)return n=Xl(t,0,r),n.length===0&&(n="Sheet1"),{name:n};var i=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}return n=Xl(t,0,r),n.length===0&&(n="Sheet1"),{pos:i,hs:s,dt:a,name:n}}function eM(t,e){var r=!e||e.biff>=8?2:1,n=ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function tM(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(PL(t));return s.Count=n,s.Unique=i,s}function rM(t,e){var r=ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=DL(t[i]);var s=mr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function nM(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function iM(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function sM(t){var e=UL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function aM(t){return t.read_shift(2),t.read_shift(4)}function tE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function oM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function lM(){var t=ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function cM(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function uM(t){var e=ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function fM(){}function hM(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Xl(t,0,r),n}function dM(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ee(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function pM(t,e,r){var n=Mi(t,e,r);return n.isst=t.read_shift(4),n}function mM(t,e,r,n){var i=ee(10);return wo(t,e,n,i),i.write_shift(4,r),i}function gM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Mi(t,e,r),s=Lf(t,n-t.l,r);return i.val=s,i}function _M(t,e,r,n,i){var s=!i||i.biff==8,a=ee(8+ +s+(1+s)*r.length);return wo(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function vM(t,e,r){var n=t.read_shift(2),i=Do(t,0,r);return[n,i]}function xM(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var yM=Do;function wM(t){var e=ee(1+t.length);return e.write_shift(1,t.length),e.write_shift(t.length,t,"sbcs"),e}function EM(t){var e=ee(3+t.length);return e.l+=2,e.write_shift(1,t.length),e.write_shift(t.length,t,"sbcs"),e}function rE(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function TM(t,e){var r=e.biff==8||!e.biff?4:2,n=ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function kM(t){var e=t.read_shift(2),r=t.read_shift(2),n=CA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function SM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(CA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function CM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function AM(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=aL[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function IM(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=AM(t,e,n.fStyle,r),n}function nE(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function FM(t){var e={};return e.ifnt=t.read_shift(1),t.l++,e.flags=t.read_shift(1),e.numFmtId=e.flags&63,e.flags>>=6,e.fStyle=0,e.data={},e}function NM(t){var e=ee(4);return e.l+=2,e.write_shift(1,t.numFmtId),e.l++,e}function NA(t){var e=ee(12);return e.l++,e.write_shift(1,t.numFmtId),e.l+=10,e}var RM=NA;function PM(t){var e={};return e.ifnt=t.read_shift(1),e.numFmtId=t.read_shift(1),e.flags=t.read_shift(2),e.fStyle=e.flags>>2&1,e.data={},e}function DM(t){var e={};return e.ifnt=t.read_shift(1),e.numFmtId=t.read_shift(1),e.flags=t.read_shift(2),e.fStyle=e.flags>>2&1,e.data={},e}function bM(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function OM(t){var e=ee(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function LM(t,e,r){var n=Mi(t,6,r),i=wA(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function pm(t,e,r,n,i,s){var a=ee(8);return wo(t,e,n,a),EA(r,s,a),a}function MM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Mi(t,6,r),i=pn(t);return n.val=i,n}function BM(t,e,r,n){var i=ee(14);return wo(t,e,n,i),xo(r,i),i}var iE=jL;function VM(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=yo(t,s),o=[];n>t.l;)o.push(Lf(t));return[s,i,a,o]}function sE(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=zL(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}function aE(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=yo(t,a,r);i&32&&(c=bv[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var d=n==t.l||o===0||!(u>0)?[]:lj(t,u,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function RA(t,e,r){if(r.biff<8||!(r.biff>8)&&e==t[t.l]+(t[t.l+1]==3?1:0)+1)return oE(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(WL(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function oE(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Xl(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function UM(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=yo(t,n,r),a=yo(t,i,r);return[s,a]}function jM(t,e,r){var n=IA(t);t.l++;var i=t.read_shift(1);return e-=8,[cj(t,e,r),i,n]}function lE(t,e,r){var n=HL(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,aj(t,e,r)]}function WM(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function zM(t,e,r){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=Do(t,0,r);return[{r:n,c:i},o,a,s]}function HM(t,e,r){if(r&&r.biff<8){var n=t.read_shift(2),i=t.read_shift(2);if(n==65535||n==-1)return;var s=t.read_shift(2),a=t.read_shift(Math.min(s,2048),"cpstr");return[{r:n,c:i},a]}return zM(t,e,r)}function mm(t,e,r,n){var i=ee(6+(n||t.length));return i.write_shift(2,e),i.write_shift(2,r),i.write_shift(2,n||t.length),i.write_shift(t.length,t,"sbcs"),i}function $M(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(sp(t));return r}function GM(t){var e=ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)AA(t[r],e);return e}function XM(t,e,r){if(r&&r.biff<8)return qM(t,e,r);var n=FA(t),i=KL(t,e-22,n[1]);return{cmo:n,ft:i}}var KM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function qM(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((KM[n]||xn)(t,e,r)),{cmo:[i,n,s],ft:a}}function YM(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=bL(t,6,r);var o=t.read_shift(2);t.read_shift(2),ar(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],d=yo(t,t.lens[c+1]-t.lens[c]-1);if(i+=d,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function QM(t,e){var r=sp(t);t.l+=16;var n=BL(t,e-24);return[r,n]}function JM(t){var e=ee(24),r=Pt(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return mr([e,VL(t[1])])}function ZM(t,e){t.read_shift(2);var r=sp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Fn,""),[r,n]}function e7(t){var e=t[1].Tooltip,r=ee(10+2*(e.length+1));r.write_shift(2,2048);var n=Pt(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function t7(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Gw[r]||r,r=t.read_shift(2),e[1]=Gw[r]||r,e}function r7(t){return t||(t=ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function n7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(SA(t));return r}function i7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(SA(t));return r}function s7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function PA(t,e,r){if(!r.cellStyles)return xn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function a7(t,e){var r=ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function o7(t,e){var r={};return e<32||(t.l+=16,r.header=pn(t),r.footer=pn(t),t.l+=2),r}function l7(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function c7(t){for(var e=ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var u7=Mi,f7=yA,h7=Lf;function d7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function Mf(t,e,r,n,i){return t||(t=ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(1,n||0),t.write_shift(1,i||0),t.write_shift(1,0),t}function p7(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Mi(t,7,r),i=Do(t,e-7,r);return n.t="str",n.val=i,n}function m7(t,e,r){var n=Mi(t,7,r),i=pn(t);return n.t="n",n.val=i,n}function g7(t,e,r,n,i){var s=ee(15);return Mf(s,t,e,n||0,i||0),s.write_shift(8,r,"f"),s}function _7(t,e,r){var n=Mi(t,7,r),i=t.read_shift(2);return n.t="n",n.val=i,n}function v7(t,e,r,n,i){var s=ee(9);return Mf(s,t,e,n||0,i||0),s.write_shift(2,r),s}function x7(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function y7(t,e,r){var n=t.l+7,i=Mi(t,6,r);t.l=n;var s=wA(t);return i.val=s,i.t=s===!0||s===!1?"b":"e",i}function w7(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function E7(t,e,r){var n=t.l+e,i=Mi(t,6,r),s=t.read_shift(2),a=yo(t,s,r);return t.l=n,i.t="str",i.val=a,i}function T7(t){var e=t.read_shift(4),r=t.read_shift(1),n=t.read_shift(r,"sbcs");return n.length===0&&(n="Sheet1"),{flags:e,name:n}}var k7=[2,3,48,49,131,139,140,245],cg=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Zd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=xa(1);switch(l.type){case"base64":u=Tn(Qn(o));break;case"binary":u=Tn(o);break;case"buffer":case"array":u=o;break}Cr(u,0);var d=u.read_shift(1),h=!!(d&136),p=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,_=521;d==2&&(x=u.read_shift(2)),u.l+=3,d!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(_=u.read_shift(2));var m=u.read_shift(2);l.codepage,d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&t[u[u.l]],u.l+=1,u.l+=2),g&&(u.l+=36);for(var w=[],v={},R=Math.min(u.length,d==2?521:_-10-(p?264:0)),U=g?32:11;u.l<R&&u[u.l]!=13;)switch(v={},v.name=ts(u.slice(u.l,u.l+U)).replace(/[\u0000\r\n].*$/g,""),u.l+=U,v.type=String.fromCharCode(u.read_shift(1)),d!=2&&!g&&(v.offset=u.read_shift(4)),v.len=u.read_shift(1),d==2&&(v.offset=u.read_shift(2)),v.dec=u.read_shift(1),v.name.length&&w.push(v),d!=2&&(u.l+=g?13:14),v.type){case"B":(!p||v.len!=8)&&l.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+v.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var H=0,E=0;for(c[0]=[],E=0;E!=w.length;++E)c[0][E]=w[E].name;for(;x-- >0;){if(u[u.l]===42){u.l+=m;continue}for(++u.l,c[++H]=[],E=0,E=0;E!=w.length;++E){var T=u.slice(u.l,u.l+w[E].len);u.l+=w[E].len,Cr(T,0);var k=ts(T);switch(w[E].type){case"C":k.trim().length&&(c[H][E]=k.replace(/\s+$/,""));break;case"D":k.length===8?(c[H][E]=new Date(Date.UTC(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8),0,0,0,0)),l&&l.UTC||(c[H][E]=vo(c[H][E]))):c[H][E]=k;break;case"F":c[H][E]=parseFloat(k.trim());break;case"+":case"I":c[H][E]=g?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":c[H][E]=!0;break;case"N":case"F":c[H][E]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[H][E]="##MEMO##"+(g?parseInt(k.trim(),10):T.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(c[H][E]=+k||0);break;case"@":c[H][E]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":{var C=T.read_shift(4),A=T.read_shift(4);if(C==0&&A==0)break;c[H][E]=new Date((C-2440588)*864e5+A),l&&l.UTC||(c[H][E]=vo(c[H][E]))}break;case"Y":c[H][E]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[H][E]=-T.read_shift(-8,"f");break;case"B":if(p&&w[E].len==8){c[H][E]=T.read_shift(8,"f");break}case"G":case"P":T.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=cc(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function i(o,l){try{var c=Ca(n(o,l),l);return c.bookType="dbf",c}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){if(!o["!ref"])throw new Error("Cannot export empty sheet to DBF");var c=l||{},u=li;if(+c.codepage>=0&&Ii(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var d=gn(),h=pg(o,{header:1,raw:!0,cellDates:!0}),p=h[0],g=h.slice(1),x=o["!cols"]||[],_=0,m=0,w=0,v=1;for(_=0;_<p.length;++_){if(((x[_]||{}).DBF||{}).name){p[_]=x[_].DBF.name,++w;continue}if(p[_]!=null){if(++w,typeof p[_]=="number"&&(p[_]=p[_].toString(10)),typeof p[_]!="string")throw new Error("DBF Invalid column name "+p[_]+" |"+typeof p[_]+"|");if(p.indexOf(p[_])!==_){for(m=0;m<1024;++m)if(p.indexOf(p[_]+"_"+m)==-1){p[_]+="_"+m;break}}}}var R=Et(o["!ref"]),U=[],H=[],E=[];for(_=0;_<=R.e.c-R.s.c;++_){var T="",k="",C=0,A=[];for(m=0;m<g.length;++m)g[m][_]!=null&&A.push(g[m][_]);if(A.length==0||p[_]==null){U[_]="?";continue}for(m=0;m<A.length;++m){switch(typeof A[m]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=A[m]instanceof Date?"D":"C";break;default:k="C"}C=Math.max(C,String(A[m]).length),T=T&&T!=k?"C":k}C>250&&(C=250),k=((x[_]||{}).DBF||{}).type,k=="C"&&x[_].DBF.len>C&&(C=x[_].DBF.len),T=="B"&&k=="N"&&(T="N",E[_]=x[_].DBF.dec,C=x[_].DBF.len),H[_]=T=="C"||k=="N"?C:s[T]||0,v+=H[_],U[_]=T}var b=d.next(32);for(b.write_shift(4,318902576),b.write_shift(4,g.length),b.write_shift(2,296+32*w),b.write_shift(2,v),_=0;_<4;++_)b.write_shift(4,0);var N=+e[li]||3;for(b.write_shift(4,0|N<<8),t[N]!=+c.codepage&&(c.codepage&&console.error("DBF Unsupported codepage "+li+", using 1252"),li=1252),_=0,m=0;_<p.length;++_)if(p[_]!=null){var we=d.next(32),he=(p[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);we.write_shift(1,he,"sbcs"),we.write_shift(1,U[_]=="?"?"C":U[_],"sbcs"),we.write_shift(4,m),we.write_shift(1,H[_]||s[U[_]]||0),we.write_shift(1,E[_]||0),we.write_shift(1,2),we.write_shift(4,0),we.write_shift(1,0),we.write_shift(4,0),we.write_shift(4,0),m+=H[_]||s[U[_]]||0}var Re=d.next(264);for(Re.write_shift(4,13),_=0;_<65;++_)Re.write_shift(4,0);for(_=0;_<g.length;++_){var de=d.next(v);for(de.write_shift(1,0),m=0;m<p.length;++m)if(p[m]!=null)switch(U[m]){case"L":de.write_shift(1,g[_][m]==null?63:g[_][m]?84:70);break;case"B":de.write_shift(8,g[_][m]||0,"f");break;case"N":var re="0";for(typeof g[_][m]=="number"&&(re=g[_][m].toFixed(E[m]||0)),re.length>H[m]&&(re=re.slice(0,H[m])),w=0;w<H[m]-re.length;++w)de.write_shift(1,32);de.write_shift(1,re,"sbcs");break;case"D":g[_][m]?(de.write_shift(4,("0000"+g[_][m].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(g[_][m].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+g[_][m].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ye=de.l,X=String(g[_][m]!=null?g[_][m]:"").slice(0,H[m]);for(de.write_shift(1,X,"cpstr"),ye+=H[m]-de.l,w=0;w<ye;++w)de.write_shift(1,32);break}}return li=u,d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),DA=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Xt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{e=new RegExp("\x1BN("+Xt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var r=function(p,g){var x=t[g];return typeof x=="number"?xw(x):x},n=function(p,g,x){var _=g.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return _==59?p:xw(_)};t["|"]=254;var i=function(p){return p.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(p,g){switch(g.type){case"base64":return a(Qn(p),g);case"binary":return a(p,g);case"buffer":return a(st&&Buffer.isBuffer(p)?p.toString("binary"):ts(p),g);case"array":return a(_o(p),g)}throw new Error("Unrecognized type "+g.type)}function a(p,g){var x=p.split(/[\n\r]+/),_=-1,m=-1,w=0,v=0,R=[],U=[],H=null,E={},T=[],k=[],C=[],A=0,b,N={Workbook:{WBProps:{},Names:[]}};for(+g.codepage>=0&&Ii(+g.codepage);w!==x.length;++w){A=0;var we=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),he=we.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),Re=he[0],de;if(we.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":for(v=1;v<he.length;++v)switch(he[v].charAt(0)){case"V":{var re=parseInt(he[v].slice(1),10);re>=1&&re<=4&&(N.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(he[1].charAt(0)){case"P":U.push(we.slice(3).replace(/;;/g,";"));break}break;case"NN":{var ye={Sheet:0};for(v=1;v<he.length;++v)switch(he[v].charAt(0)){case"N":ye.Name=he[v].slice(1);break;case"E":ye.Ref=(g&&g.sheet||"Sheet1")+"!"+ro(he[v].slice(1));break}N.Workbook.Names.push(ye)}break;case"C":var X=!1,Ce=!1,ce=!1,fe=!1,le=-1,De=-1,K="",se="z",F="";for(v=1;v<he.length;++v)switch(he[v].charAt(0)){case"A":F=he[v].slice(1);break;case"X":m=parseInt(he[v].slice(1),10)-1,Ce=!0;break;case"Y":for(_=parseInt(he[v].slice(1),10)-1,Ce||(m=0),b=R.length;b<=_;++b)R[b]=[];break;case"K":de=he[v].slice(1),de.charAt(0)==='"'?(de=de.slice(1,de.length-1),se="s"):de==="TRUE"||de==="FALSE"?(de=de==="TRUE",se="b"):isNaN(qn(de))||(de=qn(de),se="n",H!==null&&gi(H)&&g.cellDates&&(de=Es(N.Workbook.WBProps.date1904?de+1462:de),se=typeof de=="number"?"n":"d")),X=!0;break;case"E":fe=!0,K=ro(he[v].slice(1),{r:_,c:m});break;case"S":ce=!0;break;case"G":break;case"R":le=parseInt(he[v].slice(1),10)-1;break;case"C":De=parseInt(he[v].slice(1),10)-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+we)}if(X&&(R[_][m]?(R[_][m].t=se,R[_][m].v=de):R[_][m]={t:se,v:de},H&&(R[_][m].z=H),g.cellText!==!1&&H&&(R[_][m].w=Jn(R[_][m].z,R[_][m].v,{date1904:N.Workbook.WBProps.date1904})),H=null),ce){if(fe)throw new Error("SYLK shared formula cannot have own formula");var G=le>-1&&R[le][De];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");K=XA(G[1],{r:_-le,c:m-De})}K&&(R[_][m]?R[_][m].f=K:R[_][m]={t:"n",f:K}),F&&(R[_][m]||(R[_][m]={t:"z"}),R[_][m].c=[{a:"SheetJSYLK",t:F}]);break;case"F":var W=0;for(v=1;v<he.length;++v)switch(he[v].charAt(0)){case"X":m=parseInt(he[v].slice(1),10)-1,++W;break;case"Y":for(_=parseInt(he[v].slice(1),10)-1,b=R.length;b<=_;++b)R[b]=[];break;case"M":A=parseInt(he[v].slice(1),10)/20;break;case"F":break;case"G":break;case"P":H=U[parseInt(he[v].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(C=he[v].slice(1).split(" "),b=parseInt(C[0],10);b<=parseInt(C[1],10);++b)A=parseInt(C[2],10),k[b-1]=A===0?{hidden:!0}:{wch:A};break;case"C":m=parseInt(he[v].slice(1),10)-1,k[m]||(k[m]={});break;case"R":_=parseInt(he[v].slice(1),10)-1,T[_]||(T[_]={}),A>0?(T[_].hpt=A,T[_].hpx=ql(A)):A===0&&(T[_].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+we)}W<1&&(H=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+we)}}return T.length>0&&(E["!rows"]=T),k.length>0&&(E["!cols"]=k),k.forEach(function(z){ya(z)}),g&&g.sheetRows&&(R=R.slice(0,g.sheetRows)),[R,E,N]}function o(p,g){var x=s(p,g),_=x[0],m=x[1],w=x[2],v=Bt(g);v.date1904=(((w||{}).Workbook||{}).WBProps||{}).date1904;var R=cc(_,v);Xt(m).forEach(function(H){R[H]=m[H]});var U=Ca(R,g);return Xt(w).forEach(function(H){U[H]=w[H]}),U.bookType="sylk",U}function l(p,g,x,_,m,w){var v="C;Y"+(x+1)+";X"+(_+1)+";K";switch(p.t){case"n":v+=p.v||0,p.f&&!p.F&&(v+=";E"+op(p.f,{r:x,c:_}));break;case"b":v+=p.v?"TRUE":"FALSE";break;case"e":v+=p.w||p.v;break;case"d":v+=nr(Jt(p.v,w),w);break;case"s":v+='"'+(p.v==null?"":String(p.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(p,g,x){var _="C;Y"+(g+1)+";X"+(x+1)+";A";return _+=i(p.map(function(m){return m.t}).join("")),_}function u(p,g){g.forEach(function(x,_){var m="F;W"+(_+1)+" "+(_+1)+" ";x.hidden?m+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=cf(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=uf(x.wpx)),typeof x.wch=="number"&&(m+=Math.round(x.wch))),m.charAt(m.length-1)!=" "&&p.push(m)})}function d(p,g){g.forEach(function(x,_){var m="F;";x.hidden?m+="M0;":x.hpt?m+="M"+20*x.hpt+";":x.hpx&&(m+="M"+20*ff(x.hpx)+";"),m.length>2&&p.push(m+"R"+(_+1))})}function h(p,g,x){g||(g={}),g._formats=["General"];var _=["ID;PSheetJS;N;E"],m=[],w=Et(p["!ref"]||"A1"),v,R=p["!data"]!=null,U=`\r
`,H=(((x||{}).Workbook||{}).WBProps||{}).date1904,E="General";_.push("P;PGeneral");var T=w.s.r,k=w.s.c,C=[];if(p["!ref"]){for(T=w.s.r;T<=w.e.r;++T)if(!(R&&!p["!data"][T])){for(C=[],k=w.s.c;k<=w.e.c;++k)v=R?p["!data"][T][k]:p[et(k)+ht(T)],!(!v||!v.c)&&C.push(c(v.c,T,k));C.length&&m.push(C.join(U))}}if(p["!ref"]){for(T=w.s.r;T<=w.e.r;++T)if(!(R&&!p["!data"][T])){for(C=[],k=w.s.c;k<=w.e.c;++k)if(v=R?p["!data"][T][k]:p[et(k)+ht(T)],!(!v||v.v==null&&(!v.f||v.F))){if((v.z||(v.t=="d"?ze[14]:"General"))!=E){var A=g._formats.indexOf(v.z);A==-1&&(g._formats.push(v.z),A=g._formats.length-1,_.push("P;P"+v.z.replace(/;/g,";;"))),C.push("F;P"+A+";Y"+(T+1)+";X"+(k+1))}C.push(l(v,p,T,k,g,H))}m.push(C.join(U))}}return _.push("F;P0;DG0G8;M255"),p["!cols"]&&u(_,p["!cols"]),p["!rows"]&&d(_,p["!rows"]),p["!ref"]&&_.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" ")),_.push("O;L;D;B"+(H?";V4":"")+";K47;G100 0.001"),delete g._formats,_.join(U)+U+m.join(U)+U+"E"+U}return{to_workbook:o,from_sheet:h}}(),bA=function(){function t(o,l){switch(l.type){case"base64":return e(Qn(o),l);case"binary":return e(o,l);case"buffer":return e(st&&Buffer.isBuffer(o)?o.toString("binary"):ts(o),l);case"array":return e(_o(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var c=o.split(`
`),u=-1,d=-1,h=0,p=[];h!==c.length;++h){if(c[h].trim()==="BOT"){p[++u]=[],d=0;continue}if(!(u<0)){var g=c[h].trim().split(","),x=g[0],_=g[1];++h;for(var m=c[h]||"";(m.match(/["]/g)||[]).length&1&&h<c.length-1;)m+=`
`+c[++h];switch(m=m.trim(),+x){case-1:if(m==="BOT"){p[++u]=[],d=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?p[u][d]=!0:m==="FALSE"?p[u][d]=!1:isNaN(qn(_))?isNaN(ef(_).getDate())?p[u][d]=_:(p[u][d]=Jt(_),l&&l.UTC||(p[u][d]=vo(p[u][d]))):p[u][d]=qn(_),++d;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),p[u][d++]=m!==""?m:null;break}if(m==="EOD")break}}return l&&l.sheetRows&&(p=p.slice(0,l.sheetRows)),p}function r(o,l){return cc(t(o,l),l)}function n(o,l){var c=Ca(r(o,l),l);return c.bookType="dif",c}function i(o,l){return"0,"+String(o)+`\r
`+l}function s(o){return`1,0\r
"`+o.replace(/"/g,'""')+'"'}function a(o){if(!o["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var l=Et(o["!ref"]),c=o["!data"]!=null,u=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(l.e.r-l.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(l.e.c-l.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],d=l.s.r;d<=l.e.r;++d){for(var h=c?o["!data"][d]:[],p=`-1,0\r
BOT\r
`,g=l.s.c;g<=l.e.c;++g){var x=c?h&&h[g]:o[it({r:d,c:g})];if(x==null){p+=`1,0\r
""\r
`;continue}switch(x.t){case"n":x.w!=null?p+="0,"+x.w+`\r
V`:x.v!=null?p+=i(x.v,"V"):x.f!=null&&!x.F?p+=s("="+x.f):p+=`1,0\r
""`;break;case"b":p+=x.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":p+=s(isNaN(+x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Jn(x.z||ze[14],nr(Jt(x.v)))),p+=i(x.w,"V");break;default:p+=`1,0\r
""`}p+=`\r
`}u.push(p)}return u.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:a}}(),OA=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),g=-1,x=-1,_=0,m=[];_!==p.length;++_){var w=p[_].trim().split(":");if(w[0]==="cell"){var v=Pt(w[1]);if(m.length<=v.r)for(g=m.length;g<=v.r;++g)m[g]||(m[g]=[]);switch(g=v.r,x=v.c,w[2]){case"t":m[g][x]=t(w[3]);break;case"v":m[g][x]=+w[3];break;case"vtf":var R=w[w.length-1];case"vtc":switch(w[3]){case"nl":m[g][x]=!!+w[4];break;default:m[g][x]=+w[4];break}w[2]=="vtf"&&(m[g][x]=[m[g][x],R])}}}return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}function n(d,h){return cc(r(d,h),h)}function i(d,h){return Ca(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],g,x="",_=Vr(d["!ref"]),m=d["!data"]!=null,w=_.s.r;w<=_.e.r;++w)for(var v=_.s.c;v<=_.e.c;++v)if(x=it({r:w,c:v}),g=m?(d["!data"][w]||[])[v]:d[x],!(!g||g.v==null||g.t==="z")){switch(p=["cell",x,"t"],g.t){case"s":case"str":p.push(e(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=e(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var R=nr(Jt(g.v));p[2]="vtc",p[3]="nd",p[4]=""+R,p[5]=g.w||Jn(g.z||ze[14],R);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[s,a,o,a,c(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Kl=function(){function t(u,d,h,p,g){g.raw?d[h][p]=u:u===""||(u==="TRUE"?d[h][p]=!0:u==="FALSE"?d[h][p]=!1:isNaN(qn(u))?isNaN(ef(u).getDate())?d[h][p]=u:d[h][p]=Jt(u):d[h][p]=qn(u))}function e(u,d){var h=d||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var _=10,m=0,w=0;w<=x;++w)m=g[w].indexOf(" "),m==-1?m=g[w].length:m++,_=Math.max(_,m);for(w=0;w<=x;++w){p[w]=[];var v=0;for(t(g[w].slice(0,_).trim(),p,w,v,h),v=1;v<=(g[w].length-_)/10+1;++v)t(g[w].slice(_+(v-1)*10,_+v*10).trim(),p,w,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var d={},h=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?h=!h:!h&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p]);if(!g.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p])}return g.sort(function(x,_){return x[0]-_[0]||n[x[1]]-n[_[1]]}),r[g.pop()[1]]||44}function s(u,d){var h=d||{},p="",g={};h.dense&&(g["!data"]=[]);var x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):h&&h.FS?p=h.FS:p=i(u.slice(0,1024));var _=0,m=0,w=0,v=0,R=0,U=p.charCodeAt(0),H=!1,E=0,T=u.charCodeAt(0),k=h.dateNF!=null?qO(h.dateNF):null;function C(){var A=u.slice(v,R);A.slice(-1)=="\r"&&(A=A.slice(0,-1));var b={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),h.cellText!==!1&&(b.w=A),A.length===0)b.t="z";else if(h.raw)b.t="s",b.v=A;else if(A.trim().length===0)b.t="s",b.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(b.t="s",b.v=A.slice(2,-1).replace(/""/g,'"')):GV(A)?(b.t="s",b.f=A.slice(1),b.v=A):(b.t="s",b.v=A);else if(A=="TRUE")b.t="b",b.v=!0;else if(A=="FALSE")b.t="b",b.v=!1;else if(!isNaN(w=qn(A)))b.t="n",b.v=w;else if(!isNaN((w=ef(A)).getDate())||k&&A.match(k)){if(b.z=h.dateNF||ze[14],k&&A.match(k)){var N=YO(A,h.dateNF,A.match(k)||[]);w=Jt(N),h&&h.UTC===!1&&(w=vo(w))}else h&&h.UTC===!1?w=vo(w):h.cellText!==!1&&h.dateNF&&(b.w=Jn(b.z,w));h.cellDates?(b.t="d",b.v=w):(b.t="n",b.v=nr(w)),h.cellNF||delete b.z}else b.t="s",b.v=A;if(b.t=="z"||(h.dense?(g["!data"][_]||(g["!data"][_]=[]),g["!data"][_][m]=b):g[it({c:m,r:_})]=b),v=R+1,T=u.charCodeAt(v),x.e.c<m&&(x.e.c=m),x.e.r<_&&(x.e.r=_),E==U)++m;else if(m=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;R<u.length;++R)switch(E=u.charCodeAt(R)){case 34:T===34&&(H=!H);break;case 13:if(H)break;u.charCodeAt(R+1)==10&&++R;case U:case 10:if(!H&&C())break e;break}return R-v>0&&C(),g["!ref"]=Je(x),g}function a(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):cc(e(u,d),d)}function o(u,d){var h="",p=d.type=="string"?[0,0,0,0]:Kv(u,d);switch(d.type){case"base64":h=Qn(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):(d.codepage,h=st&&Buffer.isBuffer(u)?u.toString("binary"):ts(u));break;case"array":h=_o(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Rt(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=Rt(h):d.type=="binary",h.slice(0,19)=="socialcalc:version:"?OA.to_sheet(d.type=="string"?h:Rt(h),d):a(h,d)}function l(u,d){return Ca(o(u,d),d)}function c(u){var d=[];if(!u["!ref"])return"";for(var h=Et(u["!ref"]),p,g=u["!data"]!=null,x=h.s.r;x<=h.e.r;++x){for(var _=[],m=h.s.c;m<=h.e.c;++m){var w=it({r:x,c:m});if(p=g?(u["!data"][x]||[])[m]:u[w],!p||p.v==null){_.push("          ");continue}for(var v=(p.w||(Rs(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";_.push(v+(m===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function S7(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=DA.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Kl.to_workbook(t,e)}}var to=function(){function t(F,G,W){if(F){Cr(F,F.l||0);for(var z=W.Enum||fe;F.l<F.length;){var Q=F.read_shift(2),O=z[Q]||z[65535],ae=F.read_shift(2),Ae=F.l+ae,ge=O.f&&O.f(F,ae,W);if(F.l=Ae,G(ge,O,Q))return}}}function e(F,G){switch(G.type){case"base64":return n(Tn(Qn(F)),G);case"binary":return n(Tn(F),G);case"buffer":case"array":return n(F,G)}throw"Unsupported type "+G.type}var r=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(F,G){if(!F)return F;var W=G||{},z={},Q="Sheet1",O="",ae=0,Ae={},ge=[],Pe=[],Oe=[];W.dense&&(Oe=z["!data"]=[]);var Ge={s:{r:0,c:0},e:{r:0,c:0}},ot=W.sheetRows||0,St={};if(F[4]==81&&F[5]==80&&F[6]==87)return se(F,G);if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)W.Enum=fe,t(F,function(Se,Nt,Ct){switch(Ct){case 0:W.vers=Se,Se>=4096&&(W.qpro=!0);break;case 255:W.vers=Se,W.works=!0;break;case 6:Ge=Se;break;case 204:Se&&(O=Se);break;case 222:O=Se;break;case 15:case 51:(!W.qpro&&!W.works||Ct==51)&&Se[1].v.charCodeAt(0)<48&&(Se[1].v=Se[1].v.slice(1)),(W.works||W.works2)&&(Se[1].v=Se[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=W.dateNF||r[(Se[2]&15)-1]||ze[14],W.cellDates&&(Se[1].v=Es(Se[1].v),Se[1].t=typeof Se[1].v=="number"?"n":"d")),W.qpro&&Se[3]>ae&&(z["!ref"]=Je(Ge),Ae[Q]=z,ge.push(Q),z={},W.dense&&(Oe=z["!data"]=[]),Ge={s:{r:0,c:0},e:{r:0,c:0}},ae=Se[3],Q=O||"Sheet"+(ae+1),O="");var Dt=W.dense?(Oe[Se[0].r]||[])[Se[0].c]:z[it(Se[0])];if(Dt){Dt.t=Se[1].t,Dt.v=Se[1].v,Se[1].z!=null&&(Dt.z=Se[1].z),Se[1].f!=null&&(Dt.f=Se[1].f),St=Dt;break}W.dense?(Oe[Se[0].r]||(Oe[Se[0].r]=[]),Oe[Se[0].r][Se[0].c]=Se[1]):z[it(Se[0])]=Se[1],St=Se[1];break;case 21509:W.works2=!0;break;case 21506:Se==5281&&(St.z="hh:mm:ss",W.cellDates&&St.t=="n"&&(St.v=Es(St.v),St.t=typeof St.v=="number"?"n":"d"));break}},W);else if(F[2]==26||F[2]==14)W.Enum=le,F[2]==14&&(W.qpro=!0,F.l=0),t(F,function(Se,Nt,Ct){switch(Ct){case 204:Q=Se;break;case 22:Se[1].v.charCodeAt(0)<48&&(Se[1].v=Se[1].v.slice(1)),Se[1].v=Se[1].v.replace(/\x0F./g,function(Dt){return String.fromCharCode(Dt.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>ae&&(z["!ref"]=Je(Ge),Ae[Q]=z,ge.push(Q),z={},W.dense&&(Oe=z["!data"]=[]),Ge={s:{r:0,c:0},e:{r:0,c:0}},ae=Se[3],Q="Sheet"+(ae+1)),ot>0&&Se[0].r>=ot)break;W.dense?(Oe[Se[0].r]||(Oe[Se[0].r]=[]),Oe[Se[0].r][Se[0].c]=Se[1]):z[it(Se[0])]=Se[1],Ge.e.c<Se[0].c&&(Ge.e.c=Se[0].c),Ge.e.r<Se[0].r&&(Ge.e.r=Se[0].r);break;case 27:Se[14e3]&&(Pe[Se[14e3][0]]=Se[14e3][1]);break;case 1537:Pe[Se[0]]=Se[1],Se[0]==ae&&(Q=Se[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(z["!ref"]=Je(Ge),Ae[O||Q]=z,ge.push(O||Q),!Pe.length)return{SheetNames:ge,Sheets:Ae};for(var Zt={},Le=[],at=0;at<Pe.length;++at)Ae[ge[at]]?(Le.push(Pe[at]||ge[at]),Zt[Pe[at]]=Ae[Pe[at]]||Ae[ge[at]]):(Le.push(Pe[at]),Zt[Pe[at]]={"!ref":"A1"});return{SheetNames:Le,Sheets:Zt}}function i(F,G){var W=G||{};if(+W.codepage>=0&&Ii(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var z=gn();if(!F["!ref"])throw new Error("Cannot export empty sheet to WK1");var Q=Et(F["!ref"]),O=F["!data"]!=null,ae=[];ue(z,0,a(1030)),ue(z,6,c(Q));for(var Ae=Math.min(Q.e.r,8191),ge=Q.s.c;ge<=Q.e.c;++ge)ae[ge]=et(ge);for(var Pe=Q.s.r;Pe<=Ae;++Pe){var Oe=ht(Pe);for(ge=Q.s.c;ge<=Q.e.c;++ge){var Ge=O?(F["!data"][Pe]||[])[ge]:F[ae[ge]+Oe];if(!(!Ge||Ge.t=="z"))switch(Ge.t){case"n":(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?ue(z,13,_(Pe,ge,Ge)):ue(z,14,w(Pe,ge,Ge));break;case"d":var ot=nr(Ge.v);(ot|0)==ot&&ot>=-32768&&ot<=32767?ue(z,13,_(Pe,ge,{v:ot,z:Ge.z||ze[14]})):ue(z,14,w(Pe,ge,{v:ot,z:Ge.z||ze[14]}));break;default:var St=Rs(Ge);ue(z,15,p(Pe,ge,St.slice(0,239)))}}}return ue(z,1),z.end()}function s(F,G){var W=G||{};if(+W.codepage>=0&&Ii(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var z=gn();ue(z,0,o(F));for(var Q=0,O=0;Q<F.SheetNames.length;++Q)(F.Sheets[F.SheetNames[Q]]||{})["!ref"]&&ue(z,27,ce(F.SheetNames[Q],O++));var ae=0;for(Q=0;Q<F.SheetNames.length;++Q){var Ae=F.Sheets[F.SheetNames[Q]];if(!(!Ae||!Ae["!ref"])){for(var ge=Et(Ae["!ref"]),Pe=Ae["!data"]!=null,Oe=[],Ge=Math.min(ge.e.r,8191),ot=ge.s.r;ot<=Ge;++ot)for(var St=ht(ot),Zt=ge.s.c;Zt<=ge.e.c;++Zt){ot===ge.s.r&&(Oe[Zt]=et(Zt));var Le=Oe[Zt]+St,at=Pe?(Ae["!data"][ot]||[])[Zt]:Ae[Le];if(!(!at||at.t=="z"))if(at.t=="n")ue(z,23,N(ot,Zt,ae,at.v));else{var Se=Rs(at);ue(z,22,C(ot,Zt,ae,Se.slice(0,239)))}}++ae}}return ue(z,1),z.end()}function a(F){var G=ee(2);return G.write_shift(2,F),G}function o(F){var G=ee(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var W=0,z=0,Q=0,O=0;O<F.SheetNames.length;++O){var ae=F.SheetNames[O],Ae=F.Sheets[ae];if(!(!Ae||!Ae["!ref"])){++Q;var ge=Vr(Ae["!ref"]);W<ge.e.r&&(W=ge.e.r),z<ge.e.c&&(z=ge.e.c)}}return W>8191&&(W=8191),G.write_shift(2,W),G.write_shift(1,Q),G.write_shift(1,z),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(F,G,W){var z={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&W.qpro?(z.s.c=F.read_shift(1),F.l++,z.s.r=F.read_shift(2),z.e.c=F.read_shift(1),F.l++,z.e.r=F.read_shift(2),z):(z.s.c=F.read_shift(2),z.s.r=F.read_shift(2),G==12&&W.qpro&&(F.l+=2),z.e.c=F.read_shift(2),z.e.r=F.read_shift(2),G==12&&W.qpro&&(F.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(F){var G=ee(8);return G.write_shift(2,F.s.c),G.write_shift(2,F.s.r),G.write_shift(2,F.e.c),G.write_shift(2,F.e.r),G}function u(F,G,W){var z=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(z[0].c=F.read_shift(1),z[3]=F.read_shift(1),z[0].r=F.read_shift(2),F.l+=2):W.works?(z[0].c=F.read_shift(2),z[0].r=F.read_shift(2),z[2]=F.read_shift(2)):(z[2]=F.read_shift(1),z[0].c=F.read_shift(2),z[0].r=F.read_shift(2)),z}function d(F){return F.z&&gi(F.z)?240|(r.indexOf(F.z)+1||2):255}function h(F,G,W){var z=F.l+G,Q=u(F,G,W);if(Q[1].t="s",(W.vers&65534)==20768){F.l++;var O=F.read_shift(1);return Q[1].v=F.read_shift(O,"utf8"),Q}return W.qpro&&F.l++,Q[1].v=F.read_shift(z-F.l,"cstr"),Q}function p(F,G,W){var z=ee(7+W.length);z.write_shift(1,255),z.write_shift(2,G),z.write_shift(2,F),z.write_shift(1,39);for(var Q=0;Q<z.length;++Q){var O=W.charCodeAt(Q);z.write_shift(1,O>=128?95:O)}return z.write_shift(1,0),z}function g(F,G,W){var z=F.l+G,Q=u(F,G,W);if(Q[1].t="s",W.vers==20768){var O=F.read_shift(1);return Q[1].v=F.read_shift(O,"utf8"),Q}return Q[1].v=F.read_shift(z-F.l,"cstr"),Q}function x(F,G,W){var z=u(F,G,W);return z[1].v=F.read_shift(2,"i"),z}function _(F,G,W){var z=ee(7);return z.write_shift(1,d(W)),z.write_shift(2,G),z.write_shift(2,F),z.write_shift(2,W.v,"i"),z}function m(F,G,W){var z=u(F,G,W);return z[1].v=F.read_shift(8,"f"),z}function w(F,G,W){var z=ee(13);return z.write_shift(1,d(W)),z.write_shift(2,G),z.write_shift(2,F),z.write_shift(8,W.v,"f"),z}function v(F,G,W){var z=F.l+G,Q=u(F,G,W);if(Q[1].v=F.read_shift(8,"f"),W.qpro)F.l=z;else{var O=F.read_shift(2);E(F.slice(F.l,F.l+O),Q),F.l+=O}return Q}function R(F,G,W){var z=G&32768;return G&=-32769,G=(z?F:0)+(G>=8192?G-16384:G),(z?"":"$")+(W?et(G):ht(G))}var U={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},H=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(F,G){Cr(F,0);for(var W=[],z=0,Q="",O="",ae="",Ae="";F.l<F.length;){var ge=F[F.l++];switch(ge){case 0:W.push(F.read_shift(8,"f"));break;case 1:O=R(G[0].c,F.read_shift(2),!0),Q=R(G[0].r,F.read_shift(2),!1),W.push(O+Q);break;case 2:{var Pe=R(G[0].c,F.read_shift(2),!0),Oe=R(G[0].r,F.read_shift(2),!1);O=R(G[0].c,F.read_shift(2),!0),Q=R(G[0].r,F.read_shift(2),!1),W.push(Pe+Oe+":"+O+Q)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(F.read_shift(2));break;case 6:{for(var Ge="";ge=F[F.l++];)Ge+=String.fromCharCode(ge);W.push('"'+Ge.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:Ae=W.pop(),ae=W.pop(),W.push(["AND","OR"][ge-20]+"("+ae+","+Ae+")");break;default:if(ge<32&&H[ge])Ae=W.pop(),ae=W.pop(),W.push(ae+H[ge]+Ae);else if(U[ge]){if(z=U[ge][1],z==69&&(z=F[F.l++]),z>W.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+W.join("|")+"|");return}var ot=W.slice(-z);W.length-=z,W.push(U[ge][0]+"("+ot.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}W.length==1?G[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function T(F){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=F.read_shift(2),G[3]=F[F.l++],G[0].c=F[F.l++],G}function k(F,G){var W=T(F);return W[1].t="s",W[1].v=F.read_shift(G-4,"cstr"),W}function C(F,G,W,z){var Q=ee(6+z.length);Q.write_shift(2,F),Q.write_shift(1,W),Q.write_shift(1,G),Q.write_shift(1,39);for(var O=0;O<z.length;++O){var ae=z.charCodeAt(O);Q.write_shift(1,ae>=128?95:ae)}return Q.write_shift(1,0),Q}function A(F,G){var W=T(F);W[1].v=F.read_shift(2);var z=W[1].v>>1;if(W[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return W[1].v=z,W}function b(F,G){var W=T(F),z=F.read_shift(4),Q=F.read_shift(4),O=F.read_shift(2);if(O==65535)return z===0&&Q===3221225472?(W[1].t="e",W[1].v=15):z===0&&Q===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var ae=O&32768;return O=(O&32767)-16446,W[1].v=(1-ae*2)*(Q*Math.pow(2,O+32)+z*Math.pow(2,O)),W}function N(F,G,W,z){var Q=ee(14);if(Q.write_shift(2,F),Q.write_shift(1,W),Q.write_shift(1,G),z==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var O=0,ae=0,Ae=0,ge=0;return z<0&&(O=1,z=-z),ae=Math.log2(z)|0,z/=Math.pow(2,ae-31),ge=z>>>0,ge&2147483648||(z/=2,++ae,ge=z>>>0),z-=ge,ge|=2147483648,ge>>>=0,z*=Math.pow(2,32),Ae=z>>>0,Q.write_shift(4,Ae),Q.write_shift(4,ge),ae+=16383+(O?32768:0),Q.write_shift(2,ae),Q}function we(F,G){var W=b(F);return F.l+=G-14,W}function he(F,G){var W=T(F),z=F.read_shift(4);return W[1].v=z>>6,W}function Re(F,G){var W=T(F),z=F.read_shift(8,"f");return W[1].v=z,W}function de(F,G){var W=Re(F);return F.l+=G-12,W}function re(F,G){return F[F.l+G-1]==0?F.read_shift(G,"cstr"):""}function ye(F,G){var W=F[F.l++];W>G-1&&(W=G-1);for(var z="";z.length<W;)z+=String.fromCharCode(F[F.l++]);return z}function X(F,G,W){if(!(!W.qpro||G<21)){var z=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var Q=F.read_shift(G-21,"cstr");return[z,Q]}}function Ce(F,G){for(var W={},z=F.l+G;F.l<z;){var Q=F.read_shift(2);if(Q==14e3){for(W[Q]=[0,""],W[Q][0]=F.read_shift(2);F[F.l];)W[Q][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return W}function ce(F,G){var W=ee(5+F.length);W.write_shift(2,14e3),W.write_shift(2,G);for(var z=0;z<F.length;++z){var Q=F.charCodeAt(z);W[W.l++]=Q>127?95:Q}return W[W.l++]=0,W}var fe={0:{n:"BOF",f:ar},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:ye},255:{n:"BOF",f:ar},21506:{n:"WKSNF",f:ar},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:we},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ce},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:he},38:{n:"??"},39:{n:"NUMBER27",f:Re},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},De={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function K(F){var G=F.read_shift(2),W=F.read_shift(1);if(W!=0)throw"unsupported QPW string type "+W.toString(16);return F.read_shift(G,"sbcs-cont")}function se(F,G){Cr(F,0);var W=G||{},z={};W.dense&&(z["!data"]=[]);var Q=[],O="",ae={s:{r:-1,c:-1},e:{r:-1,c:-1}},Ae=0,ge=0,Pe=0,Oe=0,Ge={SheetNames:[],Sheets:{}},ot=[];e:for(;F.l<F.length;){var St=F.read_shift(2),Zt=F.read_shift(2),Le=F.slice(F.l,F.l+Zt);switch(Cr(Le,0),St){case 1:if(Le.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var at=Le.read_shift(4),Se=(Le.length-Le.l)/at|0,Nt=0;Nt<at;++Nt){var Ct=Le.l+Se,Dt={};Le.l+=2,Dt.numFmtId=Le.read_shift(2),De[Dt.numFmtId]&&(Dt.z=De[Dt.numFmtId]),Le.l=Ct,ot.push(Dt)}break;case 1025:break;case 1026:break;case 1031:for(Le.l+=12;Le.l<Le.length;)Ae=Le.read_shift(2),ge=Le.read_shift(1),Q.push(Le.read_shift(Ae,"cstr"));break;case 1032:break;case 1537:{var Pn=Le.read_shift(2);z={},W.dense&&(z["!data"]=[]),ae.s.c=Le.read_shift(2),ae.e.c=Le.read_shift(2),ae.s.r=Le.read_shift(4),ae.e.r=Le.read_shift(4),Le.l+=4,Le.l+2<Le.length&&(Ae=Le.read_shift(2),ge=Le.read_shift(1),O=Ae==0?"":Le.read_shift(Ae,"cstr")),O||(O=et(Pn))}break;case 1538:{if(ae.s.c>255||ae.s.r>999999)break;ae.e.c<ae.s.c&&(ae.e.c=ae.s.c),ae.e.r<ae.s.r&&(ae.e.r=ae.s.r),z["!ref"]=Je(ae),jf(Ge,z,O)}break;case 2561:Pe=Le.read_shift(2),ae.e.c<Pe&&(ae.e.c=Pe),ae.s.c>Pe&&(ae.s.c=Pe),Oe=Le.read_shift(4),ae.s.r>Oe&&(ae.s.r=Oe),Oe=Le.read_shift(4),ae.e.r<Oe&&(ae.e.r=Oe);break;case 3073:{Oe=Le.read_shift(4),Ae=Le.read_shift(4),ae.s.r>Oe&&(ae.s.r=Oe),ae.e.r<Oe+Ae-1&&(ae.e.r=Oe+Ae-1);for(var Ur=et(Pe);Le.l<Le.length;){var Me={t:"z"},rt=Le.read_shift(1),xr=-1;rt&128&&(xr=Le.read_shift(2));var Kt=rt&64?Le.read_shift(2)-1:0;switch(rt&31){case 0:break;case 1:break;case 2:Me={t:"n",v:Le.read_shift(2)};break;case 3:Me={t:"n",v:Le.read_shift(2,"i")};break;case 4:Me={t:"n",v:ip(Le)};break;case 5:Me={t:"n",v:Le.read_shift(8,"f")};break;case 7:Me={t:"s",v:Q[ge=Le.read_shift(4)-1]};break;case 8:Me={t:"n",v:Le.read_shift(8,"f")},Le.l+=2,Le.l+=4,isNaN(Me.v)&&(Me={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(rt&31)}xr!=-1&&(ot[xr-1]||{}).z&&(Me.z=ot[xr-1].z);var Dr=0;if(rt&32)switch(rt&31){case 2:Dr=Le.read_shift(2);break;case 3:Dr=Le.read_shift(2,"i");break;case 7:Dr=Le.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(rt&31)}if(!(!W.sheetStubs&&Me.t=="z")){var is=Bt(Me);Me.t=="n"&&Me.z&&gi(Me.z)&&W.cellDates&&(is.v=Es(Me.v),is.t=typeof is.v=="number"?"n":"d"),z["!data"]!=null?(z["!data"][Oe]||(z["!data"][Oe]=[]),z["!data"][Oe][Pe]=is):z[Ur+ht(Oe)]=is}for(++Oe,--Ae;Kt-- >0&&Ae>=0;){if(rt&32)switch(rt&31){case 2:Me={t:"n",v:Me.v+Dr&65535};break;case 3:Me={t:"n",v:Me.v+Dr&65535},Me.v>32767&&(Me.v-=65536);break;case 7:Me={t:"s",v:Q[ge=ge+Dr>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(rt&31)}else switch(rt&31){case 1:Me={t:"z"};break;case 2:Me={t:"n",v:Le.read_shift(2)};break;case 7:Me={t:"s",v:Q[ge=Le.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(rt&31)}!W.sheetStubs&&Me.t=="z"||(z["!data"]!=null?(z["!data"][Oe]||(z["!data"][Oe]=[]),z["!data"][Oe][Pe]=Me):z[Ur+ht(Oe)]=Me),++Oe,--Ae}}}break;case 3074:{Pe=Le.read_shift(2),Oe=Le.read_shift(4);var bo=K(Le);z["!data"]!=null?(z["!data"][Oe]||(z["!data"][Oe]=[]),z["!data"][Oe][Pe]={t:"s",v:bo}):z[et(Pe)+ht(Oe)]={t:"s",v:bo}}break}F.l+=Zt}return Ge}return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:e}}();function C7(t){var e={},r=t.match(Jr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ve(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=gv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var A7=function(){var t=tf("t"),e=tf("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:mt(a[1])},l=s.match(e);return l&&(o.s=C7(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),I7=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),F7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,N7=/<(?:\w+:)?r\b[^>]*>/,R7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bv(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=mt(Rt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=Rt(t),r&&(n.h=ad(n.t))):t.match(N7)&&(n.r=Rt(t),n.t=mt(Rt((t.replace(R7,"").match(F7)||[]).join("").replace(Jr,"")),!0),r&&(n.h=I7(A7(n.r)))),n):{t:""}}var P7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,D7=/<(?:\w+:)?(?:si|sstItem)>/g,b7=/<\/(?:\w+:)?(?:si|sstItem)>/;function O7(t,e){var r=[],n="";if(!t)return r;var i=t.match(P7);if(i){n=i[2].replace(D7,"").split(b7);for(var s=0;s!=n.length;++s){var a=Bv(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Ve(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var L7=/^\s|\s$|[\t\n\r]/;function M7(t,e){if(!e.bookSST)return"";var r=[vr];r[r.length]=xe("sst",null,{xmlns:Io[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(L7)&&(s+=' xml:space="preserve"'),s+=">"+Ze(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function B7(t){return[t.read_shift(4),t.read_shift(4)]}function V7(t,e){var r=[],n=!1;return Os(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function U7(t,e){return e||(e=ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var j7=H9;function W7(t){var e=gn();oe(e,159,U7(t));for(var r=0;r<t.length;++r)oe(e,19,j7(t[r]));return oe(e,160),e.end()}function LA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ts(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function z7(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ts(t,4),e.U=Ts(t,4),e.W=Ts(t,4),e}function H7(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function $7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(H7(t));return e}function G7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function X7(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ts(t,4),e.U=Ts(t,4),e.W=Ts(t,4),e}function K7(t){var e=X7(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function MA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function BA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function q7(t){var e=Ts(t);switch(e.Minor){case 2:return[e.Minor,Y7(t)];case 3:return[e.Minor,Q7()];case 4:return[e.Minor,J7(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Y7(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=MA(t,r),i=BA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function Q7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function J7(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Jr,function(s){var a=Ve(s);switch(_i(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function Z7(t,e){var r={},n=r.EncryptionVersionInfo=Ts(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=MA(t,i),e-=i,r.EncryptionVerifier=BA(t,e),r}function eB(t){var e={},r=e.EncryptionVersionInfo=Ts(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Vv(t){var e=0,r,n=LA(t),i=n.length+1,s,a,o,l,c;for(r=xa(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var VA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],d=0;d!=7;++d)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=LA(a),l=s(o),c=o.length,u=xa(16),d=0;d!=16;++d)u[d]=0;var h,p,g;for((c&1)===1&&(h=l>>8,u[c]=i(t[0],h),--c,h=l&255,p=o[o.length-1],u[c]=i(p,h));c>0;)--c,h=l>>8,u[c]=i(o[c],h),--c,h=l&255,u[c]=i(o[c],h);for(c=15,g=15-o.length;g>0;)h=l>>8,u[c]=i(t[g],h),--c,--g,h=l&255,u[c]=i(o[c],h),--c,--g;return u}}(),tB=function(t,e,r,n,i){i||(i=e),n||(n=VA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},rB=function(t){var e=0,r=VA(t);return function(n){var i=tB("",n,e,r);return e=i[1],i[0]}};function nB(t,e,r,n){var i={key:ar(t),verificationBytes:ar(t)};return r.password&&(i.verifier=Vv(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=rB(r.password)),i}function iB(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=eB(t):n.Data=Z7(t,e),n}function sB(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?iB(t,e-2,n):nB(t,r.biff>=8?e:e-2,r,n),n}function aB(t,e){switch(e.type){case"base64":return O0(Qn(t),e);case"binary":return O0(t,e);case"buffer":return O0(st&&Buffer.isBuffer(t)?t.toString("binary"):ts(t),e);case"array":return O0(_o(t),e)}throw new Error("Unrecognized type "+e.type)}function O0(t,e){var r=e||{},n={},i=r.dense;i&&(n["!data"]=[]);var s=t.match(/\\trowd[\s\S]*?\\row\b/g);if(!s)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:s.length-1}},o=[];return s.forEach(function(l,c){i&&(o=n["!data"][c]=[]);for(var u=/\\[\w\-]+\b/g,d=0,h,p=-1,g=[];(h=u.exec(l))!=null;){var x=l.slice(d,u.lastIndex-h[0].length);switch(x.charCodeAt(0)==32&&(x=x.slice(1)),x.length&&g.push(x),h[0]){case"\\cell":if(++p,g.length){var _={v:g.join(""),t:"s"};_.v=="TRUE"||_.v=="FALSE"?(_.v=_.v=="TRUE",_.t="b"):isNaN(qn(_.v))||(_.t="n",r.cellText!==!1&&(_.w=_.v),_.v=qn(_.v)),i?o[p]=_:n[it({r:c,c:p})]=_}g=[];break;case"\\par":g.push(`
`);break}d=u.lastIndex}p>a.e.c&&(a.e.c=p)}),n["!ref"]=Je(a),n}function oB(t,e){var r=Ca(aB(t,e),e);return r.bookType="rtf",r}function lB(t,e){var r=["{\\rtf1\\ansi"];if(!t["!ref"])return r[0]+"}";for(var n=Et(t["!ref"]),i,s=t["!data"]!=null,a=[],o=n.s.r;o<=n.e.r;++o){r.push("\\trowd\\trautofit1");for(var l=n.s.c;l<=n.e.c;++l)r.push("\\cellx"+(l+1));for(r.push("\\pard\\intbl"),s&&(a=t["!data"][o]||[]),l=n.s.c;l<=n.e.c;++l){var c=it({r:o,c:l});if(i=s?a[l]:t[c],!i||i.v==null&&(!i.f||i.F)){r.push(" \\cell");continue}r.push(" "+(i.w||(Rs(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function cB(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function lf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function uB(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function fB(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function fd(t,e){if(e===0)return t;var r=uB(cB(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),lf(fB(r))}var UA=6,hB=15,dB=1,dn=UA;function cf(t){return Math.floor((t+Math.round(128/dn)/256)*dn)}function uf(t){return Math.floor((t-5)/dn*100+.5)/100}function hd(t){return Math.round((t*dn+5)/dn*256)/256}function gm(t){return hd(uf(cf(t)))}function Uv(t){var e=Math.abs(t-gm(t)),r=dn;if(e>.005)for(dn=dB;dn<hB;++dn)Math.abs(t-gm(t))<=e&&(e=Math.abs(t-gm(t)),r=dn);dn=r}function ya(t){t.width?(t.wpx=cf(t.width),t.wch=uf(t.wpx),t.MDW=dn):t.wpx?(t.wch=uf(t.wpx),t.width=hd(t.wch),t.MDW=dn):typeof t.wch=="number"&&(t.width=hd(t.wch),t.wpx=cf(t.width),t.MDW=dn),t.customWidth&&delete t.customWidth}var pB=96,jA=pB;function ff(t){return t*96/jA}function ql(t){return t*jA/96}var mB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gB(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Jr)||[]).forEach(function(a){var o=Ve(a);switch(_i(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Ft(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Ft(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function _B(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Jr)||[]).forEach(function(a){var o=Ve(a);switch(_i(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function vB(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Jr)||[]).forEach(function(a){var o=Ve(a);switch(_i(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Rt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Ft(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Ft(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Ft(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Ft(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Ft(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Ft(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Ft(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=gv[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Ft(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Za[i.color.index];i.color.index==81&&(l=Za[1]),l||(l=Za[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=fd(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function xB(t,e,r){e.NumberFmt=[];for(var n=Xt(ze),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ze[n[i]];var s=t[0].match(Jr);if(s)for(i=0;i<s.length;++i){var a=Ve(s[i]);switch(_i(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=mt(Rt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}ua(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function yB(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=xe("numFmt",null,{numFmtId:n,formatCode:Ze(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=xe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var L0=["numFmtId","fillId","fontId","borderId","xfId"],M0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function wB(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Jr)||[]).forEach(function(s){var a=Ve(s),o=0;switch(_i(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":case"<xf>":for(n=a,delete n[0],o=0;o<L0.length;++o)n[L0[o]]&&(n[L0[o]]=parseInt(n[L0[o]],10));for(o=0;o<M0.length;++o)n[M0[o]]&&(n[M0[o]]=Ft(n[M0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":case"<alignment>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Ft(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":case"<protection>":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function EB(t){var e=[];return e[e.length]=xe("cellXfs",null),t.forEach(function(r){e[e.length]=xe("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=xe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var TB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(e))&&xB(d,u,c),(d=o.match(i))&&vB(d,u,l,c),(d=o.match(n))&&_B(d,u,l,c),(d=o.match(s))&&gB(d,u,l,c),(d=o.match(r))&&wB(d,u,c),u}}();function kB(t,e){var r=[vr,xe("styleSheet",null,{xmlns:Io[0],"xmlns:vt":Nr.vt})],n;return t.SSF&&(n=yB(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=EB(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SB(t,e){var r=t.read_shift(2),n=_n(t);return[r,n]}function CB(t,e,r){r||(r=ee(6+4*e.length)),r.write_shift(2,t),Pr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function AB(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Q9(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Y9(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_n(t),n}function IB(t,e){e||(e=ee(25+4*32)),e.write_shift(2,t.sz*20),J9(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ld(t.color,e);var n=0;return n=2,e.write_shift(1,n),Pr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var FB=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],_m,NB=xn;function cE(t,e){e||(e=ee(4*3+8*7+16*1)),_m||(_m=Zd(FB));var r=_m[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ld({auto:1},e),ld({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function RB(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function WA(t,e,r){r||(r=ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function bc(t,e){return e||(e=ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var PB=xn;function DB(t,e){return e||(e=ee(51)),e.write_shift(1,0),bc(null,e),bc(null,e),bc(null,e),bc(null,e),bc(null,e),e.length>e.l?e.slice(0,e.l):e}function bB(t,e){return e||(e=ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),af(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function OB(t,e,r){var n=ee(2052);return n.write_shift(4,t),af(e,n),af(r,n),n.length>n.l?n.slice(0,n.l):n}function LB(t,e,r){var n={};n.NumberFmt=[];for(var i in ze)n.NumberFmt[i]=ze[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Os(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ua(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=fd(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function MB(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(oe(t,615,Di(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&oe(t,44,CB(i,e[i]))}),oe(t,616))}}function BB(t){var e=1;oe(t,611,Di(e)),oe(t,43,IB({sz:12,color:{theme:1},name:"Calibri",family:2})),oe(t,612)}function VB(t){var e=2;oe(t,603,Di(e)),oe(t,45,cE({patternType:"none"})),oe(t,45,cE({patternType:"gray125"})),oe(t,604)}function UB(t){var e=1;oe(t,613,Di(e)),oe(t,46,DB()),oe(t,614)}function jB(t){var e=1;oe(t,626,Di(e)),oe(t,47,WA({numFmtId:0},65535)),oe(t,627)}function WB(t,e){oe(t,617,Di(e.length)),e.forEach(function(r){oe(t,47,WA(r,0))}),oe(t,618)}function zB(t){var e=1;oe(t,619,Di(e)),oe(t,48,bB({xfId:0,name:"Normal"})),oe(t,620)}function HB(t){var e=0;oe(t,505,Di(e)),oe(t,506)}function $B(t){var e=0;oe(t,508,OB(e,"TableStyleMedium9","PivotStyleMedium4")),oe(t,509)}function GB(t,e){var r=gn();return oe(r,278),MB(r,t.SSF),BB(r),VB(r),UB(r),jB(r),WB(r,e.cellXfs),zB(r),HB(r),$B(r),oe(r,279),r.end()}var XB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function KB(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Jr)||[]).forEach(function(i){var s=Ve(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[XB.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function qB(){}function YB(){}var QB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function eV(t,e,r){e.themeElements={};var n;[["clrScheme",QB,KB],["fontScheme",JB,qB],["fmtScheme",ZB,YB]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var tV=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function zA(t,e){(!t||t.length===0)&&(t=jv());var r,n={};if(!(r=t.match(tV)))throw new Error("themeElements not found in theme");return eV(r[0],n,e),n.raw=t,n}function jv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[vr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rV(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=MC(s,{type:"array"})}catch{return}var o=Sn(a,"theme/theme/theme1.xml",!0);if(o)return zA(o,r)}}function nV(t){return t.read_shift(4)}function iV(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=sV(t,4);break;case 2:e.xclrValue=kA(t);break;case 3:e.xclrValue=nV(t);break;case 4:t.l+=4;break}return t.l+=8,e}function sV(t,e){return xn(t,e)}function aV(t,e){return xn(t,e)}function oV(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=iV(t);break;case 6:n[1]=aV(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function lV(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(oV(t,r-t.l));return{ixfe:n,ext:s}}function cV(t,e){e.forEach(function(r){switch(r[0]){}})}function uV(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:_n(t)}}function fV(t){var e=ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Pr(t.name,e),e.slice(0,e.l)}function hV(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function dV(t){var e=ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function pV(t,e){var r=ee(8+2*e.length);return r.write_shift(4,t),Pr(e,r),r.slice(0,r.l)}function mV(t){return t.l+=4,t.read_shift(4)!=0}function gV(t,e){var r=ee(8);return r.write_shift(4,t),r.write_shift(4,1),r}function _V(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Os(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function vV(){var t=gn();return oe(t,332),oe(t,334,Di(1)),oe(t,335,fV({name:"XLDAPR",version:12e4,flags:3496657072})),oe(t,336),oe(t,339,pV(1,"XLDAPR")),oe(t,52),oe(t,35,Di(514)),oe(t,4096,Di(0)),oe(t,4097,si(1)),oe(t,36),oe(t,53),oe(t,340),oe(t,337,gV(1)),oe(t,51,dV([[1,0]])),oe(t,338),oe(t,333),t.end()}function xV(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Jr,function(o){var l=Ve(o);switch(_i(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&(r!=null&&r.WTF))throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function yV(){var t=[vr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function wV(t){var e=[];if(!t)return e;var r=1;return(t.match(Jr)||[]).forEach(function(n){var i=Ve(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function EV(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=it(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function TV(t,e,r){var n=[];return Os(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function kV(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Os(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function SV(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var CV=/<(?:\w+:)?shape(?:[^\w][^>]*)?>([\s\S]*?)<\/(?:\w+:)?shape>/g;function AV(t,e,r){var n=0;(t.match(CV)||[]).forEach(function(i){var s="",a=!0,o=-1,l=-1,c=-1;switch(i.replace(Jr,function(d,h){var p=Ve(d);switch(_i(p[0])){case"<ClientData":p.ObjectType&&(s=p.ObjectType);break;case"<Visible":case"<Visible/>":a=!1;break;case"<Row":case"<Row>":o=h+d.length;break;case"</Row>":l=+i.slice(o,h).trim();break;case"<Column":case"<Column>":o=h+d.length;break;case"</Column>":c=+i.slice(o,h).trim();break}return""}),s){case"Note":var u=_f(e,l>=0&&c>=0?it({r:l,c}):r[n].ref);u.c&&(u.c.hidden=a),++n;break}})}function HA(t,e,r){var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),s=[xe("xml",null,{"xmlns:v":$n.v,"xmlns:o":$n.o,"xmlns:x":$n.x,"xmlns:mv":$n.mv}).replace(/\/>/,">"),xe("o:shapelayout",xe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"})],a=65536*t,o=e||[];return o.length>0&&s.push(xe("v:shapetype",[xe("v:stroke",null,{joinstyle:"miter"}),xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:i})),o.forEach(function(l){++a,s.push(IV(l,a))}),s.push("</xml>"),s.join("")}function IV(t,e,r){var n=Pt(t[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var s=i.type=="gradient"?xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=xe("v:fill",s,i),o={on:"t",obscured:"t"};return["<v:shape"+rf({id:"_x0000_s"+e,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(t[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,xe("v:shadow",null,o),xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Gr("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),Gr("x:AutoFill","False"),Gr("x:Row",String(n.r)),Gr("x:Column",String(n.c)),t[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function uE(t,e,r,n){var i=t["!data"]!=null,s;e.forEach(function(a){var o=Pt(a.ref);if(!(o.r<0||o.c<0)){if(i?(t["!data"][o.r]||(t["!data"][o.r]=[]),s=t["!data"][o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t["!data"][o.r][o.c]=s:t[a.ref]=s;var l=Et(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Je(l);t["!ref"]=c}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}s.c.push(u)}})}function FV(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ve(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Pt(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var d=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Bv(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function NV(t){var e=[vr,xe("comments",null,{xmlns:Io[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Ze(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[],a=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(c){c.a&&(i=r.indexOf(Ze(c.a))),c.T&&++a,s.push(c.t==null?"":Ze(c.t))}),a===0)n[1].forEach(function(c){e.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(Ze(c.a))+'"><text>'),e.push(Gr("t",c.t==null?"":Ze(c.t))),e.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=r.indexOf("tc="+n[1][0].ID)),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>');for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;e.push(Gr("t",Ze(o))),e.push("</text></comment>")}}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function RV(t,e){var r=[],n=!1,i={},s=0;return t.replace(Jr,function(o,l){var c=Ve(o);switch(_i(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function $A(t,e,r){var n=[vr,xe("ThreadedComments",null,{xmlns:Nr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(xe("threadedComment",Gr("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function PV(t,e){var r=[],n=!1;return t.replace(Jr,function(s){var a=Ve(s);switch(_i(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function GA(t){var e=[vr,xe("personList",null,{xmlns:Nr.TCMNT,"xmlns:x":Io[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function DV(t){var e={};e.iauthor=t.read_shift(4);var r=Po(t);return e.rfx=r.s,e.ref=it(r.s),t.l+=16,e}function bV(t,e){return e==null&&(e=ee(36)),e.write_shift(4,t[1].iauthor),uc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var OV=_n;function fE(t){return Pr(t.slice(0,54))}function LV(t,e){var r=[],n=[],i={},s=!1;return Os(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function MV(t){var e=gn(),r=[];return oe(e,628),oe(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),oe(e,632,fE(i.a)),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),oe(e,632,fE("tc="+i.ID))))})}),oe(e,631),oe(e,633),t.forEach(function(n){n[1].forEach(function(i){var s=-1;i.ID&&(s=r.indexOf("tc="+i.ID)),s==-1&&n[1][0].T&&n[1][0].ID&&(s=r.indexOf("tc="+n[1][0].ID)),s==-1&&(s=r.indexOf(i.a)),i.iauthor=s;var a={s:Pt(n[0]),e:Pt(n[0])};oe(e,635,bV([a,i])),i.t&&i.t.length>0&&oe(e,637,G9(i)),oe(e,636),delete i.iauthor})}),oe(e,634),oe(e,629),e.end()}var BV="application/vnd.ms-office.vbaProject";function VV(t){var e=He.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");He.utils.cfb_add(e,i,t.FileIndex[n].content)}}),He.write(e)}function UV(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&He.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var jV=["xlsb","xlsm","xlam","biff8","xla"];function WV(){return{"!type":"dialog"}}function zV(){return{"!type":"dialog"}}function HV(){return{"!type":"macro"}}function $V(){return{"!type":"macro"}}var ro=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,i+(o?"":"$")+et(u)+(l?"":"$")+ht(c)}return function(i,s){return e=s,i.replace(t,r)}}(),ap=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{ap=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var op=function(){return function(e,r){return e.replace(ap,function(n,i,s,a,o,l){var c=Fv(a)-(s?0:r.c),u=Iv(l)-(o?0:r.r),d=o=="$"?u+1:u==0?"":"["+u+"]",h=s=="$"?c+1:c==0?"":"["+c+"]";return i+"R"+d+"C"+h})}}();function XA(t,e){return t.replace(ap,function(r,n,i,s,a,o){return n+(i=="$"?i+s:et(Fv(s)+e.c))+(a=="$"?a+o:ht(Iv(o)+e.r))})}function hE(t,e,r){var n=Vr(e),i=n.s,s=Pt(r),a={r:s.r-i.r,c:s.c-i.c};return XA(t,a)}function GV(t){return t.length!=1}function dE(t){return t.replace(/_xlfn\./g,"")}function yr(t){t.l+=1}function wa(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function KA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return qA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=wa(t),o=wa(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function qA(t){var e=wa(t),r=wa(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function XV(t,e,r){if(r.biff<8)return qA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=wa(t),a=wa(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function YA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return KV(t);var n=t.read_shift(r&&r.biff==12?4:2),i=wa(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function KV(t){var e=wa(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function qV(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YV(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return QV(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function QV(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function JV(t,e,r){var n=(t[t.l++]&96)>>5,i=KA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function ZV(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=KA(t,s,r);return[n,i,a]}function eU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function rU(t,e,r){var n=(t[t.l++]&96)>>5,i=XV(t,e-1,r);return[n,i]}function nU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function pE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function iU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function sU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function aU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function oU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function lU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function QA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function cU(t){return t.read_shift(2),QA(t)}function uU(t){return t.read_shift(2),QA(t)}function fU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=YA(t,0,r);return[n,i]}function hU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=YV(t,0,r);return[n,i]}function dU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=YA(t,0,r);return[n,i,s]}function pU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[Ij[i],eI[i],n]}function mU(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:gU(t);return[i,(s[0]===0?eI:Aj)[s[1]]]}function gU(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function _U(t,e,r){t.l+=r&&r.biff==2?3:4}function vU(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function xU(t){return t.l++,bi[t.read_shift(1)]}function yU(t){return t.l++,t.read_shift(2)}function wU(t){return t.l++,t.read_shift(1)!==0}function EU(t){return t.l++,pn(t)}function TU(t,e,r){return t.l++,Xl(t,e-1,r)}function kU(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=bi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=pn(t);break;case 2:r[1]=Do(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function SU(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Po:sp)(t));return i}function CU(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=kU(t,r.biff);return a}function AU(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function IU(t,e,r){if(r.biff==5)return FU(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function FU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function NU(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function RU(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function PU(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function DU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var bU=xn,OU=xn,LU=xn;function Bf(t,e,r){return t.l+=2,[qV(t)]}function Wv(t){return t.l+=6,[]}var MU=Bf,BU=Wv,VU=Wv,UU=Bf;function JA(t){return t.l+=2,[ar(t),t.read_shift(2)&1]}var jU=Bf,WU=JA,zU=Wv,HU=Bf,$U=Bf,GU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function XU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=GU[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function KU(t){return t.l+=2,[t.read_shift(4)]}function qU(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function YU(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function QU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function JU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ZU(t){return t.l+=4,[0,0]}var mE={1:{n:"PtgExp",f:vU},2:{n:"PtgTbl",f:LU},3:{n:"PtgAdd",f:yr},4:{n:"PtgSub",f:yr},5:{n:"PtgMul",f:yr},6:{n:"PtgDiv",f:yr},7:{n:"PtgPower",f:yr},8:{n:"PtgConcat",f:yr},9:{n:"PtgLt",f:yr},10:{n:"PtgLe",f:yr},11:{n:"PtgEq",f:yr},12:{n:"PtgGe",f:yr},13:{n:"PtgGt",f:yr},14:{n:"PtgNe",f:yr},15:{n:"PtgIsect",f:yr},16:{n:"PtgUnion",f:yr},17:{n:"PtgRange",f:yr},18:{n:"PtgUplus",f:yr},19:{n:"PtgUminus",f:yr},20:{n:"PtgPercent",f:yr},21:{n:"PtgParen",f:yr},22:{n:"PtgMissArg",f:yr},23:{n:"PtgStr",f:TU},26:{n:"PtgSheet",f:qU},27:{n:"PtgEndSheet",f:YU},28:{n:"PtgErr",f:xU},29:{n:"PtgBool",f:wU},30:{n:"PtgInt",f:yU},31:{n:"PtgNum",f:EU},32:{n:"PtgArray",f:nU},33:{n:"PtgFunc",f:pU},34:{n:"PtgFuncVar",f:mU},35:{n:"PtgName",f:AU},36:{n:"PtgRef",f:fU},37:{n:"PtgArea",f:JV},38:{n:"PtgMemArea",f:NU},39:{n:"PtgMemErr",f:bU},40:{n:"PtgMemNoMem",f:OU},41:{n:"PtgMemFunc",f:RU},42:{n:"PtgRefErr",f:PU},43:{n:"PtgAreaErr",f:eU},44:{n:"PtgRefN",f:hU},45:{n:"PtgAreaN",f:rU},46:{n:"PtgMemAreaN",f:QU},47:{n:"PtgMemNoMemN",f:JU},57:{n:"PtgNameX",f:IU},58:{n:"PtgRef3d",f:dU},59:{n:"PtgArea3d",f:ZV},60:{n:"PtgRefErr3d",f:DU},61:{n:"PtgAreaErr3d",f:tU},255:{}},ej={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tj={1:{n:"PtgElfLel",f:JA},2:{n:"PtgElfRw",f:HU},3:{n:"PtgElfCol",f:MU},6:{n:"PtgElfRwV",f:$U},7:{n:"PtgElfColV",f:UU},10:{n:"PtgElfRadical",f:jU},11:{n:"PtgElfRadicalS",f:zU},13:{n:"PtgElfColS",f:BU},15:{n:"PtgElfColSV",f:VU},16:{n:"PtgElfRadicalLel",f:WU},25:{n:"PtgList",f:XU},29:{n:"PtgSxName",f:KU},255:{}},rj={0:{n:"PtgAttrNoop",f:ZU},1:{n:"PtgAttrSemi",f:lU},2:{n:"PtgAttrIf",f:aU},4:{n:"PtgAttrChoose",f:iU},8:{n:"PtgAttrGoto",f:sU},16:{n:"PtgAttrSum",f:_U},32:{n:"PtgAttrBaxcel",f:pE},33:{n:"PtgAttrBaxcel",f:pE},64:{n:"PtgAttrSpace",f:cU},65:{n:"PtgAttrSpaceSemi",f:uU},128:{n:"PtgAttrIfError",f:oU},255:{}};function Vf(t,e,r,n){if(n.biff<8)return xn(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=CU(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=SU(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(xn(t,e)),s}function Uf(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=mE[s]||mE[ej[s]],(s===24||s===25)&&(i=(s===24?tj:rj)[t[t.l+1]]),!i||!i.f?xn(t,e):a.push([i.n,i.f(t,e,r)]);return a}function nj(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var ij={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sj(t,e){var r=t.lastIndexOf("!"),n=e.lastIndexOf("!");return r==-1&&n==-1?t+":"+e:r>0&&n>0&&t.slice(0,r).toLowerCase()==e.slice(0,n).toLowerCase()?t+":"+e.slice(n+1):(console.error("Cannot hydrate range",t,e),t+":"+e)}function ZA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function gE(t,e,r){var n=ZA(t,e,r);return n=="#REF"?n:sf(n,r)}function un(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,d=0,h=0,p,g="";if(!t[0]||!t[0][0])return"";for(var x=-1,_="",m=0,w=t[0].length;m<w;++m){var v=t[0][m];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(t[0][x][1][0]){case 0:_=gt(" ",t[0][x][1][1]);break;case 1:_=gt("\r",t[0][x][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}c=c+_,x=-1}o.push(c+ij[v[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(sj(c,l));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=fu(v[1][1],a,i),o.push(hu(u,s));break;case"PtgRefN":u=r?fu(v[1][1],r,i):v[1][1],o.push(hu(u,s));break;case"PtgRef3d":d=v[1][1],u=fu(v[1][2],a,i),g=gE(n,d,i),o.push(g+"!"+hu(u,s));break;case"PtgFunc":case"PtgFuncVar":var R=v[1][0],U=v[1][1];R||(R=0),R&=127;var H=R==0?[]:o.slice(-R);o.length-=R,U==="User"&&(U=H.shift()),o.push(U+"("+H.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":p=zw(v[1][1],r?{s:r}:a,i),o.push(fm(p,i));break;case"PtgArea":p=zw(v[1][1],a,i),o.push(fm(p,i));break;case"PtgArea3d":d=v[1][1],p=v[1][2],g=gE(n,d,i),o.push(g+"!"+fm(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],T=E?E.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!i.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var k=v[1][1];h=v[1][2];var C;if(i.biff<=5)k<0&&(k=-k),n[k]&&(C=n[k][h]);else{var A="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][h]&&n[k][h].itab>0&&(A=n.SheetNames[n[k][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[k]&&n[k][h])A+=n[k][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var b=(ZA(n,k,i)||"").split(";;");b[h-1]?A=b[h-1]:A+="SH33TJSERRX"}o.push(A);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var N="(",we=")";if(x>=0){switch(_="",t[0][x][1][0]){case 2:N=gt(" ",t[0][x][1][1])+N;break;case 3:N=gt("\r",t[0][x][1][1])+N;break;case 4:we=gt(" ",t[0][x][1][1])+we;break;case 5:we=gt("\r",t[0][x][1][1])+we;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}o.push(N+o.pop()+we);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[it(u)]){var Re=n.sharedf[it(u)];o.push(un(Re,a,he,n,i))}else{var de=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(un(c[1],a,he,n,i)),de=!0;break}de||o.push(v[1])}break;case"PtgArray":o.push("{"+nj(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=m;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&x>=0&&re.indexOf(t[0][m][0])==-1){v=t[0][x];var ye=!0;switch(v[1][0]){case 4:ye=!1;case 0:_=gt(" ",v[1][1]);break;case 5:ye=!1;case 1:_=gt("\r",v[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((ye?_:"")+o.pop()+(ye?"":_)),x=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]=="TRUE"?!0:o[0]=="FALSE"?!1:o[0]}function aj(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],xn(t,e-2)];var o=Uf(t,a,r);return e!==a+i&&(s=Vf(t,e-a-i,o,r)),t.l=n,[o,s]}function oj(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],xn(t,e-2)];var o=Uf(t,a,r);return e!==a+i&&(s=Vf(t,e-a-i,o,r)),t.l=n,[o,s]}function lj(t,e,r,n){var i=t.l+e,s=Uf(t,n,r),a;return i!==t.l&&(a=Vf(t,i-t.l,s,r)),[s,a]}function cj(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Uf(t,s,r);return s==65535?[[],xn(t,e-2)]:(e!==s+2&&(i=Vf(t,n-s-2,a,r)),[a,i])}function uj(t){var e;if(vs(t,t.l+6)!==65535)return[pn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function fj(t){if(t==null){var e=ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return xo(t);return xo(0)}function vm(t,e,r){var n=t.l+e,i=Mi(t,6,r),s=uj(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=oj(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function hj(t,e,r,n,i){var s=wo(e,r,i),a=fj(t.v),o=ee(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=ee(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var d=mr([s,a,o,c]);return d}function lp(t,e,r){var n=t.read_shift(4),i=Uf(t,n,r),s=t.read_shift(4),a=s>0?Vf(t,s,i,r):null;return[i,a]}var dj=lp,cp=lp,pj=lp,mj=lp;function _E(t){if((t|0)==t&&t<Math.pow(2,16)&&t>=0){var e=ee(11);return e.write_shift(4,3),e.write_shift(1,30),e.write_shift(2,t),e.write_shift(4,0),e}var r=ee(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,t),r.write_shift(4,0),r}function gj(t){var e=ee(10);return e.write_shift(4,2),e.write_shift(1,28),e.write_shift(1,t),e.write_shift(4,0),e}function _j(t){var e=ee(10);return e.write_shift(4,2),e.write_shift(1,29),e.write_shift(1,t?1:0),e.write_shift(4,0),e}function vj(t){var e=ee(7);e.write_shift(4,3+2*t.length),e.write_shift(1,23),e.write_shift(2,t.length);var r=ee(2*t.length);r.write_shift(2*t.length,t,"utf16le");var n=ee(4);return n.write_shift(4,0),mr([e,r,n])}function xj(t){var e=Pt(t),r=ee(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,e.r),r.write_shift(2,e.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function yj(t,e){var r=t.lastIndexOf("!"),n=t.slice(0,r);t=t.slice(r+1);var i=Pt(t);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var s=ee(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+e.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,i.r),s.write_shift(2,i.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function wj(t,e){var r=t.lastIndexOf("!"),n=t.slice(0,r);t=t.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=ee(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+e.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function Ej(t){var e=t.split(":"),r=e[0],n=ee(23);n.write_shift(4,15),r=e[0];var i=Pt(r);return n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=e[1],i=Pt(r),n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function Tj(t,e){var r=t.lastIndexOf("!"),n=t.slice(0,r);t=t.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=t.split(":"),s=ee(27);s.write_shift(4,19);var a=i[0],o=Pt(a);return s.write_shift(1,58),s.write_shift(2,2+e.SheetNames.map(function(l){return l.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,o.r),s.write_shift(2,o.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),a=i[1],o=Pt(a),s.write_shift(1,58),s.write_shift(2,2+e.SheetNames.map(function(l){return l.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,o.r),s.write_shift(2,o.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function kj(t,e){var r=t.lastIndexOf("!"),n=t.slice(0,r);t=t.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=Vr(t),s=ee(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+e.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,i.s.r),s.write_shift(4,i.e.r),s.write_shift(2,i.s.c),s.write_shift(2,i.e.c),s.write_shift(4,0),s}function Sj(t,e){if(typeof t=="number")return _E(t);if(typeof t=="boolean")return _j(t);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(t))return gj(+Dv[t]);if(t.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return xj(t);if(t.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Ej(t);if(t.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return kj(t,e);if(t.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return yj(t,e);if(t.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Tj(t,e);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(t))return wj(t,e);if(/^".*"$/.test(t))return vj(t);if(/^[+-]\d+$/.test(t))return _E(parseInt(t,10));throw"Formula |"+t+"| not supported for XLSB"}var Cj=Sj,Aj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},eI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ij={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\$'([^']|'')+'/g,function(e){return e.slice(1)}),t=t.replace(/\$([^\]\. #$]+)/g,function(e,r){return r.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?e:r}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Fj(t){var e="of:="+t.replace(ap,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function xm(t){t=t.replace(/\$'([^']|'')+'/g,function(n){return n.slice(1)}),t=t.replace(/\$([^\]\. #$]+)/g,function(n,i){return i.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?n:i});var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function tI(t){return t.replace(/!/,".").replace(/:/,":.")}var pu={},kl={},mu=typeof Map<"u";function zv(t,e,r){var n=0,i=t.length;if(r){if(mu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=mu?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(mu?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function up(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(dn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=uf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=hd(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function no(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Aa(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ua(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function rI(t,e,r,n,i,s,a){try{n.cellNF&&(t.z=ze[e])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Jt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&ua(KO[e]||"General",e),t.t==="e")t.w=t.w||bi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zu(t.v);else if(t.t==="d"){var o=nr(t.v,!!a);(o|0)===o?t.w=o.toString(10):t.w=Zu(o)}else{if(t.v===void 0)return"";t.w=go(t.v,kl)}else t.t==="d"?t.w=Jn(e,nr(t.v,!!a),kl):t.w=Jn(e,t.v,kl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=fd(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=fd(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function Nj(t,e,r){if(t&&t["!ref"]){var n=Et(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Rj(t,e){var r=Et(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Je(r))}var Pj=/<(?:\w:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,Dj=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,bj=/<(?:\w:)?hyperlink [^>]*>/mg,Oj=/"(\w*:\w*)"/,Lj=/<(?:\w:)?col\b[^>]*[\/]?>/g,Mj=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Bj=/<(?:\w:)?pageMargins[^>]*\/>/g,nI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Vj=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Uj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function jj(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o={};e.dense&&(o["!data"]=[]);var l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=t.match(Dj);d?(c=t.slice(0,d.index),u=t.slice(d.index+d[0].length)):c=u=t;var h=c.match(nI);h?Hv(h[0],o,i,r):(h=c.match(Vj))&&zj(h[0],h[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(Oj);g&&!(e&&e.nodim)&&Rj(o,g[1])}var x=c.match(Uj);x&&x[1]&&rW(x[1],i);var _=[];if(e.cellStyles){var m=c.match(Lj);m&&Qj(_,m)}d&&sW(d[1],o,e,l,s,a,i);var w=u.match(Mj);w&&(o["!autofilter"]=Zj(w[0]));var v=[],R=u.match(Pj);if(R)for(p=0;p!=R.length;++p)v[p]=Et(R[p].slice(R[p].indexOf('"')+1));var U=u.match(bj);U&&Kj(o,U,n);var H=u.match(Bj);H&&(o["!margins"]=qj(Ve(H[0])));var E;if((E=u.match(/legacyDrawing r:id="(.*?)"/))&&(o["!legrel"]=E[1]),e&&e.nodim&&(l.s.c=l.s.r=0),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Je(l)),e.sheetRows>0&&o["!ref"]){var T=Et(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Je(T))}return _.length>0&&(o["!cols"]=_),v.length>0&&(o["!merges"]=v),n["!id"][o["!legrel"]]&&(o["!legdrawel"]=n["!id"][o["!legrel"]]),o}function Wj(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Je(t[r])+'"/>';return e+"</mergeCells>"}function Hv(t,e,r,n){var i=Ve(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=mt(Rt(i.codeName)))}function zj(t,e,r,n,i){Hv(t.slice(0,t.indexOf(">")),r,n,i)}function Hj(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=qi(Ze(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+xe("outlinePr",null,c)}!s&&!o||(i[i.length]=xe("sheetPr",o,a))}var $j=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Gj=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Xj(t){var e={sheet:1};return $j.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Gj.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Vv(t.password).toString(16).toUpperCase()),xe("sheetProtection",null,e)}function Kj(t,e,r){for(var n=t["!data"]!=null,i=0;i!=e.length;++i){var s=Ve(Rt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+mt(s.location))):(s.Target="#"+mt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Et(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=et(c)+ht(l);n?(t["!data"][l]||(t["!data"][l]=[]),t["!data"][l][c]||(t["!data"][l][c]={t:"z",v:void 0}),t["!data"][l][c].l=s):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=s)}}}function qj(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Yj(t){return no(t),xe("pageMargins",null,t)}function Qj(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Ve(e[n],!0);i.hidden&&(i.hidden=Ft(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Uv(i.width)),ya(i);s<=a;)t[s++]=Bt(i)}}function Jj(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=xe("col",null,up(i,n)));return r[r.length]="</cols>",r.join("")}function Zj(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function eW(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Je(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Vr(i);a.s.r==a.e.r&&(a.e.r=Vr(e["!ref"]).e.r,i=Je(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref=sf(r.SheetNames[n])+"!"+nf(i);break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),xe("autoFilter",null,{ref:i})}var tW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/g;function rW(t,e){e.Views||(e.Views=[{}]),(t.match(tW)||[]).forEach(function(r,n){var i=Ve(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),i.rightToLeft&&Ft(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function nW(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),xe("sheetViews",xe("sheetView",null,i),{})}function iW(t,e,r,n,i,s,a){if(t.c&&r["!comments"].push([e,t.c]),(t.v===void 0||t.t==="z"&&!(n||{}).sheetStubs)&&typeof t.f!="string"&&typeof t.z>"u")return"";var o="",l=t.t,c=t.v;if(t.t!=="z")switch(t.t){case"b":o=t.v?"1":"0";break;case"n":isNaN(t.v)?(t.t="e",o=bi[t.v=36]):isFinite(t.v)?o=""+t.v:(t.t="e",o=bi[t.v=7]);break;case"e":o=bi[t.v];break;case"d":if(n&&n.cellDates){var u=Jt(t.v,a);o=u.toISOString(),u.getUTCFullYear()<1900&&(o=o.slice(o.indexOf("T")+1).replace("Z",""))}else t=Bt(t),t.t="n",o=""+(t.v=nr(Jt(t.v,a),a));typeof t.z>"u"&&(t.z=ze[14]);break;default:o=t.v;break}var d=t.t=="z"||t.v==null?"":Gr("v",Ze(o)),h={r:e},p=Aa(n.cellXfs,t,n);switch(p!==0&&(h.s=p),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){d=Gr("v",""+zv(n.Strings,t.v,n.revStrings)),h.t="s";break}else h.t="str";break}if(t.t!=l&&(t.t=l,t.v=c),typeof t.f=="string"&&t.f){var g=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;d=xe("f",Ze(t.f),g)+(t.v!=null?d:"")}return t.l&&(t.l.display=Ze(o),r["!links"].push([e,t.l])),t.D&&(h.cm=1),xe("c",d,h)}var sW=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=tf("v"),a=tf("f");return function(l,c,u,d,h,p,g){for(var x=0,_="",m=[],w=[],v=0,R=0,U=0,H="",E,T,k=0,C=0,A,b,N=0,we=0,he=Array.isArray(p.CellXf),Re,de=[],re=[],ye=c["!data"]!=null,X=[],Ce={},ce=!1,fe=!!u.sheetStubs,le=!!((g||{}).WBProps||{}).date1904,De=l.split(e),K=0,se=De.length;K!=se;++K){_=De[K].trim();var F=_.length;if(F!==0){var G=0;e:for(x=0;x<F;++x)switch(_[x]){case">":if(_[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(T=Ve(_.slice(G,x),!0),k=T.r!=null?parseInt(T.r,10):k+1,C=-1,u.sheetRows&&u.sheetRows<k)continue;Ce={},ce=!1,T.ht&&(ce=!0,Ce.hpt=parseFloat(T.ht),Ce.hpx=ql(Ce.hpt)),T.hidden&&Ft(T.hidden)&&(ce=!0,Ce.hidden=!0),T.outlineLevel!=null&&(ce=!0,Ce.level=+T.outlineLevel),ce&&(X[k-1]=Ce)}break;case"<":G=x;break}if(G>=x)break;if(T=Ve(_.slice(G,x),!0),k=T.r!=null?parseInt(T.r,10):k+1,C=-1,!(u.sheetRows&&u.sheetRows<k)){u.nodim||(d.s.r>k-1&&(d.s.r=k-1),d.e.r<k-1&&(d.e.r=k-1)),u&&u.cellStyles&&(Ce={},ce=!1,T.ht&&(ce=!0,Ce.hpt=parseFloat(T.ht),Ce.hpx=ql(Ce.hpt)),T.hidden&&Ft(T.hidden)&&(ce=!0,Ce.hidden=!0),T.outlineLevel!=null&&(ce=!0,Ce.level=+T.outlineLevel),ce&&(X[k-1]=Ce)),m=_.slice(x).split(t);for(var W=0;W!=m.length&&m[W].trim().charAt(0)=="<";++W);for(m=m.slice(W),x=0;x!=m.length;++x)if(_=m[x].trim(),_.length!==0){if(w=_.match(r),v=x,R=0,U=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,w!=null&&w.length===2){for(v=0,H=w[1],R=0;R!=H.length&&!((U=H.charCodeAt(R)-64)<1||U>26);++R)v=26*v+U;--v,C=v}else++C;for(R=0;R!=_.length&&_.charCodeAt(R)!==62;++R);if(++R,T=Ve(_.slice(0,R),!0),T.r||(T.r=it({r:k-1,c:C})),H=_.slice(R),E={t:""},(w=H.match(s))!=null&&w[1]!==""&&(E.v=mt(w[1])),u.cellFormula){if((w=H.match(a))!=null){if(w[1]=="")w[0].indexOf('t="shared"')>-1&&(b=Ve(w[0]),re[b.si]&&(E.f=hE(re[b.si][1],re[b.si][2],T.r)));else if(E.f=mt(Rt(w[1]),!0),u.xlfn||(E.f=dE(E.f)),w[0].indexOf('t="array"')>-1)E.F=(H.match(i)||[])[1],E.F.indexOf(":")>-1&&de.push([Et(E.F),E.F]);else if(w[0].indexOf('t="shared"')>-1){b=Ve(w[0]);var z=mt(Rt(w[1]));u.xlfn||(z=dE(z)),re[parseInt(b.si,10)]=[b,z,T.r]}}else(w=H.match(/<f[^>]*\/>/))&&(b=Ve(w[0]),re[b.si]&&(E.f=hE(re[b.si][1],re[b.si][2],T.r)));var Q=Pt(T.r);for(R=0;R<de.length;++R)Q.r>=de[R][0].s.r&&Q.r<=de[R][0].e.r&&Q.c>=de[R][0].s.c&&Q.c<=de[R][0].e.c&&(E.F=de[R][1])}if(T.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(fe)E.t="z";else continue;else E.t=T.t||"n";switch(d.s.c>C&&(d.s.c=C),d.e.c<C&&(d.e.c=C),E.t){case"n":if(E.v==""||E.v==null){if(!fe)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!fe)continue;E.t="z"}else A=pu[parseInt(E.v,10)],E.v=A.t,E.r=A.r,u.cellHTML&&(E.h=A.h);break;case"str":E.t="s",E.v=E.v!=null?mt(Rt(E.v),!0):"",u.cellHTML&&(E.h=ad(E.v));break;case"inlineStr":w=H.match(n),E.t="s",w!=null&&(A=Bv(w[1]))?(E.v=A.t,u.cellHTML&&(E.h=A.h)):E.v="";break;case"b":E.v=Ft(E.v);break;case"d":u.cellDates?E.v=Jt(E.v,le):(E.v=nr(Jt(E.v,le),le),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=Dv[E.v];break}if(N=we=0,Re=null,he&&T.s!==void 0&&(Re=p.CellXf[T.s],Re!=null&&(Re.numFmtId!=null&&(N=Re.numFmtId),u.cellStyles&&Re.fillId!=null&&(we=Re.fillId))),rI(E,N,we,u,h,p,le),u.cellDates&&he&&E.t=="n"&&gi(ze[N])&&(E.v=Es(E.v+(le?1462:0)),E.t=typeof E.v=="number"?"n":"d"),T.cm&&u.xlmeta){var O=(u.xlmeta.Cell||[])[+T.cm-1];O&&O.type=="XLDAPR"&&(E.D=!0)}var ae;u.nodim&&(ae=Pt(T.r),d.s.r>ae.r&&(d.s.r=ae.r),d.e.r<ae.r&&(d.e.r=ae.r)),ye?(ae=Pt(T.r),c["!data"][ae.r]||(c["!data"][ae.r]=[]),c["!data"][ae.r][ae.c]=E):c[T.r]=E}}}}X.length>0&&(c["!rows"]=X)}}();function aW(t,e,r,n){var i=[],s=[],a=Et(t["!ref"]),o="",l,c="",u=[],d=0,h=0,p=t["!rows"],g=t["!data"]!=null,x={r:c},_,m=-1,w=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(h=a.s.c;h<=a.e.c;++h)u[h]=et(h);for(d=a.s.r;d<=a.e.r;++d){for(s=[],c=ht(d),h=a.s.c;h<=a.e.c;++h){l=u[h]+c;var v=g?(t["!data"][d]||[])[h]:t[l];v!==void 0&&(o=iW(v,l,t,e,r,n,w))!=null&&s.push(o)}(s.length>0||p&&p[d])&&(x={r:c},p&&p[d]&&(_=p[d],_.hidden&&(x.hidden=1),m=-1,_.hpx?m=ff(_.hpx):_.hpt&&(m=_.hpt),m>-1&&(x.ht=m,x.customHeight=1),_.level&&(x.outlineLevel=_.level)),i[i.length]=xe("row",s.join(""),x))}if(p)for(;d<p.length;++d)p&&p[d]&&(x={r:d+1},_=p[d],_.hidden&&(x.hidden=1),m=-1,_.hpx?m=ff(_.hpx):_.hpt&&(m=_.hpt),m>-1&&(x.ht=m,x.customHeight=1),_.level&&(x.outlineLevel=_.level),i[i.length]=xe("row","",x));return i.join("")}function oW(t,e,r,n){var i=[vr,xe("worksheet",null,{xmlns:Io[0],"xmlns:r":Nr.r})],s=r.SheetNames[t],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Et(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Je(u)}n||(n={}),l["!comments"]=[];var d=[];Hj(l,r,t,e,i),i[i.length]=xe("dimension",null,{ref:c}),i[i.length]=nW(l,e,t,r),e.sheetFormat&&(i[i.length]=xe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Jj(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=aW(l,e,t,r),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=Xj(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=eW(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Wj(l["!merges"]));var h=-1,p,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(g=At(n,-1,Ze(x[1].Target).replace(/#.*$/,""),nt.HLINK),p["r:id"]="rId"+g),(h=x[1].Target.indexOf("#"))>-1&&(p.location=Ze(x[1].Target.slice(h+1))),x[1].Tooltip&&(p.tooltip=Ze(x[1].Tooltip)),p.display=x[1].display,i[i.length]=xe("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Yj(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Gr("ignoredErrors",xe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(g=At(n,-1,"../drawings/drawing"+(t+1)+".xml",nt.DRAW),i[i.length]=xe("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=At(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",nt.VML),i[i.length]=xe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function lW(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function cW(t,e,r){var n=ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=ff(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:t,c:0},u=r["!data"]!=null,d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,p=-1,g=d<<10;g<d+1<<10;++g){c.c=g;var x=u?(r["!data"][c.r]||[])[c.c]:r[it(c)];x&&(h<0&&(h=g),p=g)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var _=n.l;return n.l=l,n.write_shift(4,o),n.l=_,n.length>n.l?n.slice(0,n.l):n}function uW(t,e,r,n){var i=cW(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&oe(t,0,i)}var fW=Po,hW=uc;function dW(){}function pW(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=X9(t),r}function mW(t,e,r){r==null&&(r=ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return ld({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),rA(t,r),r.slice(0,r.l)}function gW(t){var e=vi(t);return[e]}function _W(t,e,r){return r==null&&(r=ee(8)),Fo(e,r)}function vW(t){var e=No(t);return[e]}function xW(t,e,r){return r==null&&(r=ee(4)),Ro(e,r)}function yW(t){var e=vi(t),r=t.read_shift(1);return[e,r,"b"]}function wW(t,e,r){return r==null&&(r=ee(9)),Fo(e,r),r.write_shift(1,t.v?1:0),r}function EW(t){var e=No(t),r=t.read_shift(1);return[e,r,"b"]}function TW(t,e,r){return r==null&&(r=ee(5)),Ro(e,r),r.write_shift(1,t.v?1:0),r}function kW(t){var e=vi(t),r=t.read_shift(1);return[e,r,"e"]}function ym(t,e,r){return r==null&&(r=ee(9)),Fo(e,r),r.write_shift(1,t.v),r}function SW(t){var e=No(t),r=t.read_shift(1);return[e,r,"e"]}function wm(t,e,r){return r==null&&(r=ee(8)),Ro(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function CW(t){var e=vi(t),r=t.read_shift(4);return[e,r,"s"]}function AW(t,e,r){return r==null&&(r=ee(12)),Fo(e,r),r.write_shift(4,e.v),r}function IW(t){var e=No(t),r=t.read_shift(4);return[e,r,"s"]}function FW(t,e,r){return r==null&&(r=ee(8)),Ro(e,r),r.write_shift(4,e.v),r}function NW(t){var e=vi(t),r=pn(t);return[e,r,"n"]}function RW(t,e,r){return r==null&&(r=ee(16)),Fo(e,r),xo(t.v,r),r}function iI(t){var e=No(t),r=pn(t);return[e,r,"n"]}function PW(t,e,r){return r==null&&(r=ee(12)),Ro(e,r),xo(t.v,r),r}function DW(t){var e=vi(t),r=ip(t);return[e,r,"n"]}function bW(t,e,r){return r==null&&(r=ee(12)),Fo(e,r),nA(t.v,r),r}function OW(t){var e=No(t),r=ip(t);return[e,r,"n"]}function LW(t,e,r){return r==null&&(r=ee(8)),Ro(e,r),nA(t.v,r),r}function MW(t){var e=vi(t),r=Nv(t);return[e,r,"is"]}function BW(t){var e=vi(t),r=_n(t);return[e,r,"str"]}function VW(t,e,r){var n=t.v==null?"":String(t.v);return r==null&&(r=ee(12+4*t.v.length)),Fo(e,r),Pr(n,r),r.length>r.l?r.slice(0,r.l):r}function UW(t){var e=No(t),r=_n(t);return[e,r,"str"]}function jW(t,e,r){var n=t.v==null?"":String(t.v);return r==null&&(r=ee(8+4*n.length)),Ro(e,r),Pr(n,r),r.length>r.l?r.slice(0,r.l):r}function WW(t,e,r){var n=t.l+e,i=vi(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=cp(t,n-t.l,r);a[3]=un(o,null,i,r.supbooks,r)}else t.l=n;return a}function zW(t,e,r){var n=t.l+e,i=vi(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=cp(t,n-t.l,r);a[3]=un(o,null,i,r.supbooks,r)}else t.l=n;return a}function HW(t,e,r){var n=t.l+e,i=vi(t);i.r=r["!row"];var s=pn(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=cp(t,n-t.l,r);a[3]=un(o,null,i,r.supbooks,r)}else t.l=n;return a}function $W(t,e,r){var n=t.l+e,i=vi(t);i.r=r["!row"];var s=_n(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=cp(t,n-t.l,r);a[3]=un(o,null,i,r.supbooks,r)}else t.l=n;return a}var GW=Po,XW=uc;function KW(t,e){return e==null&&(e=ee(4)),e.write_shift(4,t),e}function qW(t,e){var r=t.l+e,n=Po(t),i=np(t),s=_n(t),a=_n(t),o=_n(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function YW(t,e){var r=ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));uc({s:Pt(t[0]),e:Pt(t[0])},r),Rv("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Pr(i||"",r),Pr(t[1].Tooltip||"",r),Pr("",r),r.slice(0,r.l)}function QW(){}function JW(t,e,r){var n=t.l+e,i=iA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=dj(t,n-t.l,r);a[1]=o}else t.l=n;return a}function ZW(t,e,r){var n=t.l+e,i=Po(t),s=[i];if(r.cellFormula){var a=mj(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function ez(t,e,r){r==null&&(r=ee(18));var n=up(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var sI=["left","right","top","bottom","header","footer"];function tz(t){var e={};return sI.forEach(function(r){e[r]=pn(t)}),e}function rz(t,e){return e==null&&(e=ee(6*8)),no(t),sI.forEach(function(r){xo(t[r],e)}),e}function nz(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function iz(t,e,r){r==null&&(r=ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function sz(t){var e=ee(24);return e.write_shift(4,4),e.write_shift(4,1),uc(t,e),e}function az(t,e){return e==null&&(e=ee(16*4+2)),e.write_shift(2,t.password?Vv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function oz(){}function lz(){}function cz(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l={};o.dense&&(l["!data"]=[]);var c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,g,x,_,m,w,v,R,U,H=[];o.biff=12,o["!row"]=0;var E=0,T=!1,k=[],C={},A=o.supbooks||i.supbooks||[[]];if(A.sharedf=C,A.arrayf=k,A.SheetNames=i.SheetNames||i.Sheets.map(function(ye){return ye.name}),!o.supbooks&&(o.supbooks=A,i.Names))for(var b=0;b<i.Names.length;++b)A[0][b+1]=i.Names[b];var N=[],we=[],he=!1;hf[16]={n:"BrtShortReal",f:iI};var Re,de=1462*+!!((i||{}).WBProps||{}).date1904;if(Os(t,function(X,Ce,ce){if(!h)switch(ce){case 148:c=X;break;case 0:p=X,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),R=ht(_=p.r),o["!row"]=p.r,(X.hidden||X.hpt||X.level!=null)&&(X.hpt&&(X.hpx=ql(X.hpt)),we[X.r]=X);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:X[2]},X[2]){case"n":g.v=X[1];break;case"s":v=pu[X[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!X[1];break;case"e":g.v=X[1],o.cellText!==!1&&(g.w=bi[g.v]);break;case"str":g.t="s",g.v=X[1];break;case"is":g.t="s",g.v=X[1].t;break}if((x=a.CellXf[X[0].iStyleRef])&&rI(g,x.numFmtId,null,o,s,a,de>0),m=X[0].c==-1?m+1:X[0].c,o.dense?(l["!data"][_]||(l["!data"][_]=[]),l["!data"][_][m]=g):l[et(m)+R]=g,o.cellFormula){for(T=!1,E=0;E<k.length;++E){var fe=k[E];p.r>=fe[0].s.r&&p.r<=fe[0].e.r&&m>=fe[0].s.c&&m<=fe[0].e.c&&(g.F=Je(fe[0]),T=!0)}!T&&X.length>3&&(g.f=X[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>m&&(u.s.c=m),u.e.r<p.r&&(u.e.r=p.r),u.e.c<m&&(u.e.c=m),o.cellDates&&x&&g.t=="n"&&gi(ze[x.numFmtId])){var le=ds(g.v+de);le&&(g.t="d",g.v=new Date(Date.UTC(le.y,le.m-1,le.d,le.H,le.M,le.S,le.u)))}Re&&(Re.type=="XLDAPR"&&(g.D=!0),Re=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},m=X[0].c==-1?m+1:X[0].c,o.dense?(l["!data"][_]||(l["!data"][_]=[]),l["!data"][_][m]=g):l[et(m)+R]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>m&&(u.s.c=m),u.e.r<p.r&&(u.e.r=p.r),u.e.c<m&&(u.e.c=m),Re&&(Re.type=="XLDAPR"&&(g.D=!0),Re=void 0);break;case 176:H.push(X);break;case 49:Re=((o.xlmeta||{}).Cell||[])[X-1];break;case 494:var De=n["!id"][X.relId];for(De?(X.Target=De.Target,X.loc&&(X.Target+="#"+X.loc),X.Rel=De):X.relId==""&&(X.Target="#"+X.loc),_=X.rfx.s.r;_<=X.rfx.e.r;++_)for(m=X.rfx.s.c;m<=X.rfx.e.c;++m)o.dense?(l["!data"][_]||(l["!data"][_]=[]),l["!data"][_][m]||(l["!data"][_][m]={t:"z",v:void 0}),l["!data"][_][m].l=X):(w=et(m)+ht(_),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=X);break;case 426:if(!o.cellFormula)break;k.push(X),U=o.dense?l["!data"][_][m]:l[et(m)+R],U.f=un(X[1],u,{r:p.r,c:m},A,o),U.F=Je(X[0]);break;case 427:if(!o.cellFormula)break;C[it(X[0].s)]=X[1],U=o.dense?l["!data"][_][m]:l[et(m)+R],U.f=un(X[1],u,{r:p.r,c:m},A,o);break;case 60:if(!o.cellStyles)break;for(;X.e>=X.s;)N[X.e--]={width:X.w/256,hidden:!!(X.flags&1),level:X.level},he||(he=!0,Uv(X.w/256)),ya(N[X.e+1]);break;case 551:X&&(l["!legrel"]=X);break;case 161:l["!autofilter"]={ref:Je(X)};break;case 476:l["!margins"]=X;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),X.name&&(i.Sheets[r].CodeName=X.name),(X.above||X.left)&&(l["!outline"]={above:X.above,left:X.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),X.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Ce.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Je(c||u)),o.sheetRows&&l["!ref"]){var re=Et(l["!ref"]);o.sheetRows<=+re.e.r&&(re.e.r=o.sheetRows-1,re.e.r>u.e.r&&(re.e.r=u.e.r),re.e.r<re.s.r&&(re.s.r=re.e.r),re.e.c>u.e.c&&(re.e.c=u.e.c),re.e.c<re.s.c&&(re.s.c=re.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Je(re))}return H.length>0&&(l["!merges"]=H),N.length>0&&(l["!cols"]=N),we.length>0&&(l["!rows"]=we),n["!id"][l["!legrel"]]&&(l["!legdrawel"]=n["!id"][l["!legrel"]]),l}function uz(t,e,r,n,i,s,a,o){var l={r,c:n};if(e.c&&s["!comments"].push([it(l),e.c]),e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=Bt(e),e.z=e.z||ze[14],e.v=nr(Jt(e.v,o),o),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}switch(l.s=Aa(i.cellXfs,e,i),e.l&&s["!links"].push([it(l),e.l]),e.t){case"s":case"str":return i.bookSST?(c=zv(i.Strings,e.v==null?"":String(e.v),i.revStrings),l.t="s",l.v=c,a?oe(t,18,FW(e,l)):oe(t,7,AW(e,l))):(l.t="str",a?oe(t,17,jW(e,l)):oe(t,6,VW(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?oe(t,13,LW(e,l)):oe(t,2,bW(e,l)):isNaN(e.v)?a?oe(t,14,wm({v:36},l)):oe(t,3,ym({v:36},l)):isFinite(e.v)?a?oe(t,16,PW(e,l)):oe(t,5,RW(e,l)):a?oe(t,14,wm({v:7},l)):oe(t,3,ym({v:7},l)),!0;case"b":return l.t="b",a?oe(t,15,TW(e,l)):oe(t,4,wW(e,l)),!0;case"e":return l.t="e",a?oe(t,14,wm(e,l)):oe(t,3,ym(e,l)),!0}return a?oe(t,12,xW(e,l)):oe(t,1,_W(e,l)),!0}function fz(t,e,r,n,i){var s=Et(e["!ref"]||"A1"),a,o="",l=[],c=(((i||{}).Workbook||{}).WBProps||{}).date1904;oe(t,145);var u=e["!data"]!=null,d=s.e.r;e["!rows"]&&(d=Math.max(s.e.r,e["!rows"].length-1));for(var h=s.s.r;h<=d;++h){o=ht(h),uW(t,e,s,h);var p=!1;if(h<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){h===s.s.r&&(l[g]=et(g)),a=l[g]+o;var x=u?(e["!data"][h]||[])[g]:e[a];if(!x){p=!1;continue}p=uz(t,x,h,g,n,e,p,c)}}oe(t,146)}function hz(t,e){!e||!e["!merges"]||(oe(t,177,KW(e["!merges"].length)),e["!merges"].forEach(function(r){oe(t,176,XW(r))}),oe(t,178))}function dz(t,e){!e||!e["!cols"]||(oe(t,390),e["!cols"].forEach(function(r,n){r&&oe(t,60,ez(n,r))}),oe(t,391))}function pz(t,e){!e||!e["!ref"]||(oe(t,648),oe(t,649,sz(Et(e["!ref"]))),oe(t,650))}function mz(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=At(r,-1,n[1].Target.replace(/#.*$/,""),nt.HLINK);oe(t,494,YW(n,i))}}),delete e["!links"]}function gz(t,e,r,n){if(e["!comments"].length>0){var i=At(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);oe(t,551,Rv("rId"+i)),e["!legacy"]=i}}function _z(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Je(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Vr(s);o.s.r==o.e.r&&(o.e.r=Vr(e["!ref"]).e.r,s=Je(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=sf(r.SheetNames[n])+"!"+nf(s);break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:sf(r.SheetNames[n])+"!"+nf(s)}),oe(t,161,uc(Et(s))),oe(t,162)}}function vz(t,e,r){oe(t,133),oe(t,137,iz(e,r)),oe(t,138),oe(t,134)}function xz(t,e){e["!protect"]&&oe(t,535,az(e["!protect"]))}function yz(t,e,r,n){var i=gn(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=Et(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],oe(i,129),(r.vbaraw||a["!outline"])&&oe(i,147,mW(o,a["!outline"])),oe(i,148,hW(l)),vz(i,a,r.Workbook),dz(i,a),fz(i,a,t,e,r),xz(i,a),_z(i,a,r,t),hz(i,a),mz(i,a,n),a["!margins"]&&oe(i,476,rz(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&pz(i,a),gz(i,a,t,n),oe(i,130),i.end()}function wz(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=mt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function Ez(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=wz(d);u.s.r=u.s.c=0,u.e.c=o,c=et(o),h[0].forEach(function(p,g){a["!data"]?(a["!data"][g]||(a["!data"][g]=[]),a["!data"][g][o]={t:"n",v:p,z:h[1]}):a[c+ht(g)]={t:"n",v:p,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=Je(u)),a}function Tz(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(nI);return o&&Hv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function kz(t,e){t.l+=10;var r=_n(t);return{name:r}}function Sz(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Os(t,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var $v=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Cz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Az=[],Iz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function xE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Ft(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function yE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Ft(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function aI(t){yE(t.WBProps,$v),yE(t.CalcPr,Iz),xE(t.WBView,Cz),xE(t.Sheets,Az),kl.date1904=Ft(t.WBProps.date1904)}function Fz(t){return!t.Workbook||!t.Workbook.WBProps?"false":Ft(t.Workbook.WBProps.date1904)?"true":"false"}var Nz=":][*?/\\".split("");function oI(t,e){try{if(t=="")throw new Error("Sheet name cannot be blank");if(t.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(t.charCodeAt(0)==39||t.charCodeAt(t.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(t.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");Nz.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function Rz(t,e,r){t.forEach(function(n,i){oI(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Pz(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Rz(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Nj(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r);t.SheetNames.forEach(function(n,i){var s=t.Sheets[n];if(!(!s||!s["!autofilter"])){var a;t.Workbook||(t.Workbook={}),t.Workbook.Names||(t.Workbook.Names=[]),t.Workbook.Names.forEach(function(l){l.Name=="_xlnm._FilterDatabase"&&l.Sheet==i&&(a=l)});var o=sf(n)+"!"+nf(s["!autofilter"].ref);a?a.Ref=o:t.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:o})}})}var Dz=/<\w+:workbook/;function bz(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Jr,function(l,c){var u=Ve(l);switch(_i(u[0])){case"<?xml":break;case"<workbook":l.match(Dz)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$v.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Ft(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=Rt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=mt(Rt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Rt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Ft(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=mt(Rt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Io.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return aI(r),r}function Oz(t){var e=[vr];e[e.length]=xe("workbook",null,{xmlns:Io[0],"xmlns:r":Nr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&($v.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=xe("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Ze(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=xe("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=xe("definedName",Ze(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function Lz(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ng(t),r.name=_n(t),r}function Mz(t,e){return e||(e=ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Rv(t.strRelID,e),Pr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function Bz(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?_n(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Vz(t,e){e||(e=ee(72));var r=0;return t&&(t.date1904&&(r|=1),t.filterPrivacy&&(r|=8)),e.write_shift(4,r),e.write_shift(4,0),rA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function Uz(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function jz(t,e,r){var n=t.l+e,i=t.read_shift(4);t.l+=1;var s=t.read_shift(4),a=K9(t),o=pj(t,0,r),l=np(t);i&32&&(a="_xlnm."+a),t.l=n;var c={Name:a,Ptg:o,Flags:i};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Wz(t,e){var r=ee(9),n=0,i=t.Name;bv.indexOf(i)>-1&&(n|=32,i=i.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,t.Sheet==null?4294967295:t.Sheet);var s=[r,Pr(i),Cj(t.Ref,e)];if(t.Comment)s.push(af(t.Comment));else{var a=ee(4);a.write_shift(4,4294967295),s.push(a)}return mr(s)}function zz(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],hf[16]={n:"BrtFRTArchID$",f:Uz},Os(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=un(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),aI(r),r.Names=s,r.supbooks=a,r}function Hz(t,e){oe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};oe(t,156,Mz(i))}oe(t,144)}function $z(t,e){e||(e=ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Pr("SheetJS",e),Pr(ed.version,e),Pr(ed.version,e),Pr("7262",e),e.length>e.l?e.slice(0,e.l):e}function Gz(t,e){e||(e=ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function Xz(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(oe(t,135),oe(t,158,Gz(i)),oe(t,136))}}function Kz(t,e){!e.Workbook||!e.Workbook.Names||e.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;oe(t,39,Wz(r,e))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function qz(t){var e=t.SheetNames.length,r=ee(12*e+28);r.write_shift(4,e+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<e;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function Yz(t,e){oe(t,353),oe(t,357),oe(t,362,qz(e)),oe(t,354)}function Qz(t,e){var r=gn();return oe(r,131),oe(r,128,$z()),oe(r,153,Vz(t.Workbook&&t.Workbook.WBProps||null)),Xz(r,t),Hz(r,t),Yz(r,t),(t.Workbook||{}).Names&&Kz(r,t),oe(r,132),r.end()}function Jz(t,e,r){return e.slice(-4)===".bin"?zz(t,r):bz(t,r)}function Zz(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?cz(t,n,r,i,s,a,o):jj(t,n,r,i,s,a,o)}function eH(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?Sz(t,n,r,i,s):Tz(t,n,r,i,s)}function tH(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?HV():$V()}function rH(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?WV():zV()}function nH(t,e,r,n){return e.slice(-4)===".bin"?LB(t,r,n):TB(t,r,n)}function iH(t,e,r){return e.slice(-4)===".bin"?V7(t,r):O7(t,r)}function sH(t,e,r){return e.slice(-4)===".bin"?LV(t,r):FV(t,r)}function aH(t,e,r){return e.slice(-4)===".bin"?TV(t):wV(t)}function oH(t,e,r,n){return r.slice(-4)===".bin"?kV(t,e,r,n):void 0}function lH(t,e,r){return e.slice(-4)===".bin"?_V(t,e,r):xV(t,e,r)}var lI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wi(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(lI),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(cI),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function cH(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(lI),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(cI),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var gu;function uH(t,e,r){var n=gu[t]||mt(t);return n==="General"?go(e):Jn(n,e,{date1904:!!r})}function fH(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ft(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Jt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[mt(e)]=i}function hH(t,e,r,n){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||bi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zu(t.v):t.w=go(t.v):t.w=uH(e||"General",t.v,n)}catch(a){if(r.WTF)throw a}try{var i=gu[e]||e||"General";if(r.cellNF&&(t.z=i),r.cellDates&&t.t=="n"&&gi(i)){var s=ds(t.v+(n?1462:0));s&&(t.t="d",t.v=new Date(Date.UTC(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u)))}}catch(a){if(r.WTF)throw a}}}function dH(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=mB[n.Pattern]||n.Pattern)}t[e.ID]=e}function pH(t,e,r,n,i,s,a,o,l,c,u){var d="General",h=n.StyleID,p={};c=c||{};var g=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(d=s[h].nf),s[h].Interior&&g.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ft(t);break;case"String":n.t="s",n.r=bw(mt(t)),n.v=t.indexOf("<")>-1?mt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=nr(Jt(t,u),u),n.v!==n.v&&(n.v=mt(t)),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Dv[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=bw(e||t));break}if(hH(n,d,c,u),c.cellFormula!==!1)if(n.Formula){var _=mt(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=ro(_,i),delete n.Formula,n.ArrayRange=="RC"?n.F=ro("RC:RC",i):n.ArrayRange&&(n.F=ro(n.ArrayRange,i),l.push([Et(n.F),n.F]))}else for(x=0;x<l.length;++x)i.r>=l[x][0].s.r&&i.r<=l[x][0].e.r&&i.c>=l[x][0].s.c&&i.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(g.forEach(function(m){!p.patternType&&m.patternType&&(p.patternType=m.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function mH(t){return bv.indexOf("_xlnm."+t)>-1?"_xlnm."+t:t}function gH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Em(t,e){var r=e||{};lc();var n=zc(rp(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Rt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Bt(r);return a.type="string",Kl.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Oe){i.indexOf("<"+Oe)>=0&&(s=!0)}),s)return r$(n,r);gu={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},d=[],h={},p="";r.dense&&(h["!data"]=[]);var g={},x={},_=wi('<Data ss:Type="String">'),m=0,w=0,v=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},H={},E="",T=0,k=[],C={},A={},b=0,N=[],we=[],he={},Re=[],de,re=!1,ye=[],X=[],Ce={},ce=0,fe=0,le={Sheets:[],WBProps:{date1904:!1}},De={};Tr.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=Tr.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?pH(n.slice(m,o.index),E,_,l[l.length-1][0]=="comment"?he:g,{c:w,r:v},U,Re[w],x,ye,r,le.WBProps.date1904):(E="",_=wi(o[0]),m=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(we.length>0&&(g.c=we),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h["!data"][v]||(h["!data"][v]=[]),h["!data"][v][w]=g):h[et(w)+ht(v)]=g),g.HRef&&(g.l={Target:mt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(ce=w+(parseInt(g.MergeAcross,10)|0),fe=v+(parseInt(g.MergeDown,10)|0),(ce>w||fe>v)&&k.push({s:{c:w,r:v},e:{c:ce,r:fe}})),!r.sheetStubs)g.MergeAcross?w=ce+1:++w;else if(g.MergeAcross||g.MergeDown){for(var se=w;se<=ce;++se)for(var F=v;F<=fe;++F)(se>w||F>v)&&(r.dense?(h["!data"][F]||(h["!data"][F]=[]),h["!data"][F][se]={t:"z"}):h[et(se)+ht(F)]={t:"z"});w=ce+1}else++w;else g=cH(o[0]),g.Index&&(w=+g.Index-1),w<R.s.c&&(R.s.c=w),w>R.e.c&&(R.e.c=w),o[0].slice(-2)==="/>"&&++w,we=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<R.s.r&&(R.s.r=v),v>R.e.r&&(R.e.r=v),o[0].slice(-2)==="/>"&&(x=wi(o[0]),x.Index&&(v=+x.Index-1)),w=0,++v):(x=wi(o[0]),x.Index&&(v=+x.Index-1),Ce={},(x.AutoFitHeight=="0"||x.Height)&&(Ce.hpx=parseInt(x.Height,10),Ce.hpt=ff(Ce.hpx),X[v]=Ce),x.Hidden=="1"&&(Ce.hidden=!0,X[v]=Ce));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(h["!ref"]=Je(R),r.sheetRows&&r.sheetRows<=R.e.r&&(h["!fullref"]=h["!ref"],R.e.r=r.sheetRows-1,h["!ref"]=Je(R))),k.length&&(h["!merges"]=k),Re.length>0&&(h["!cols"]=Re),X.length>0&&(h["!rows"]=X),u[p]=h}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,l.push([o[3],!1]),c=wi(o[0]),p=mt(c.Name),h={},r.dense&&(h["!data"]=[]),k=[],ye=[],X=[],De={name:p,Hidden:0},le.Sheets.push(De);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Re=[],re=!1}break;case"style":o[1]==="/"?dH(U,H,r):H=wi(o[0]);break;case"numberformat":H.nf=mt(wi(o[0]).Format||"General"),gu[H.nf]&&(H.nf=gu[H.nf]);for(var G=0;G!=392&&ze[G]!=H.nf;++G);if(G==392){for(G=57;G!=392;++G)if(ze[G]==null){ua(H.nf,G);break}}break;case"column":if(l[l.length-1][0]!=="table"||o[1]==="/")break;if(de=wi(o[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!re&&de.wpx>10){re=!0,dn=UA;for(var W=0;W<Re.length;++W)Re[W]&&ya(Re[W])}re&&ya(de),Re[de.Index-1||Re.length]=de;for(var z=0;z<+de.Span;++z)Re[Re.length]=Bt(de);break;case"namedrange":if(o[1]==="/")break;le.Names||(le.Names=[]);var Q=Ve(o[0]),O={Name:mH(Q.Name),Ref:ro(Q.RefersTo.slice(1),{r:0,c:0})};le.Sheets.length>0&&(O.Sheet=le.Sheets.length-1),le.Names.push(O);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;H.Interior=wi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?xL(C,K,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));gH(he),we.push(he)}else l.push([o[3],!1]),c=wi(o[0]),Ft(c.ShowAlways||"0")||(we.hidden=!0),he={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ae=wi(o[0]);h["!autofilter"]={ref:ro(ae.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return kE(n,r);var Ae=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":le.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":break;case"hideverticalscrollbar":break;case"hideworkbooktabs":break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":De.Hidden=1;break;case"SheetVeryHidden":De.Hidden=2;break}else b=o.index+o[0].length;break;case"header":h["!margins"]||no(h["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(h["!margins"].header=+Ve(o[0]).Margin);break;case"footer":h["!margins"]||no(h["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(h["!margins"].footer=+Ve(o[0]).Margin);break;case"pagemargins":var ge=Ve(o[0]);h["!margins"]||no(h["!margins"]={},"xlml"),isNaN(+ge.Top)||(h["!margins"].top=+ge.Top),isNaN(+ge.Left)||(h["!margins"].left=+ge.Left),isNaN(+ge.Right)||(h["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(h["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":le.Views||(le.Views=[]),le.Views[0]||(le.Views[0]={}),le.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?fH(A,K,N,n.slice(b,o.index)):(N=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=u),Pe.SheetNames=d,Pe.Workbook=le,Pe.SSF=Bt(ze),Pe.Props=C,Pe.Custprops=A,Pe.bookType="xlml",Pe}function ug(t,e){switch(Gv(e=e||{}),e.type||"base64"){case"base64":return Em(Qn(t),e);case"binary":case"buffer":case"file":return Em(t,e);case"array":return Em(ts(t),e)}}function _H(t,e){var r=[];return t.Props&&r.push(yL(t.Props,e)),t.Custprops&&r.push(wL(t.Props,t.Custprops)),r.join("")}function vH(t){return(((t||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function xH(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(xe("NumberFormat",null,{"ss:Format":Ze(ze[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(xe("Style",s.join(""),a))}),xe("Styles",r.join(""))}function uI(t){return xe("NamedRange",null,{"ss:Name":t.Name.slice(0,6)=="_xlnm."?t.Name.slice(6):t.Name,"ss:RefersTo":"="+op(t.Ref,{r:0,c:0})})}function yH(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(uI(i)))}return xe("Names",r.join(""))}function wH(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(uI(o)))}return s.join("")}function EH(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(xe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(xe("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(xe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Gr("ProtectContents","True")),t["!protect"].objects&&i.push(Gr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Gr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Gr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Gr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":xe("WorksheetOptions",i.join(""),{xmlns:$n.x})}function TH(t){return t.map(function(e){var r=E9(e.t||""),n=xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return e.a&&(i["ss:Author"]=e.a),t.hidden||(i["ss:ShowAlways"]="1"),xe("Comment",n,i)}).join("")}function kH(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Ze(op(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Pt(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Ze(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Ze(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(t.v);break;case"b":d="Boolean",h=t.v?"1":"0";break;case"e":d="Error",h=bi[t.v];break;case"d":d="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ze[14]);break;case"s":d="String",h=w9(t.v||"");break}var p=Aa(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var g=t.v!=null?h:"",x=t.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(t.c||[]).length>0&&(x+=TH(t.c)),xe("Cell",x,o)}function SH(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=ql(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function CH(t,e,r,n){if(!t["!ref"])return"";var i=Et(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,m){ya(_);var w=!!_.width,v=up(m,_),R={"ss:Index":m+1};w&&(R["ss:Width"]=cf(v.width)),_.hidden&&(R["ss:Hidden"]="1"),o.push(xe("Column",null,R))});for(var l=t["!data"]!=null,c=i.s.r;c<=i.e.r;++c){for(var u=[SH(c,(t["!rows"]||[])[c])],d=i.s.c;d<=i.e.c;++d){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>c)&&!(s[a].e.c<d)&&!(s[a].e.r<c)){(s[a].s.c!=d||s[a].s.r!=c)&&(h=!0);break}if(!h){var p={r:c,c:d},g=et(d)+ht(c),x=l?(t["!data"][c]||[])[d]:t[g];u.push(kH(x,g,t,e,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function AH(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?wH(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?CH(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(EH(s,e,t,r)),s["!autofilter"]&&n.push('<AutoFilter x:Range="'+op(nf(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function IH(t,e){e||(e={}),t.SSF||(t.SSF=Bt(ze)),t.SSF&&(lc(),Jd(t.SSF),e.revssf=ep(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Aa(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_H(t,e)),r.push(vH(t)),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(xe("Worksheet",AH(n,e,t),{"ss:Name":Ze(t.SheetNames[n])}));return r[2]=xH(t,e),r[3]=yH(t),vr+xe("Workbook",r.join(""),{xmlns:$n.ss,"xmlns:o":$n.o,"xmlns:x":$n.x,"xmlns:ss":$n.ss,"xmlns:dt":$n.dt,"xmlns:html":$n.html})}function FH(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Z9(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=eL(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var NH=[60,1084,2066,2165,2175];function RH(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=vs(r,r.l),c=fg[l],u=0;c!=null&&NH.indexOf(l)>-1;)s=vs(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=fg[l=vs(r,r.l)];var d=mr(a);Cr(d,0);var h=0;d.lens=[];for(var p=0;p<a.length;++p)d.lens.push(h),h+=a[p].length;if(d.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+n;return e.f(d,d.length,i)}function Ui(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&t.z==null&&(t.z=ze[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||bi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zu(t.v):t.w=go(t.v):t.w=Jn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&gi(ze[n]||String(n))){var i=ds(t.v+(r?1462:0));i&&(t.t="d",t.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}}function B0(t,e,r){return{v:t,ixfe:e,t:r}}function PH(t,e){var r={opts:{}},n={},i={};e.dense&&(i["!data"]=[]);var s={},a={},o=null,l=[],c="",u={},d,h="",p,g,x,_,m={},w=[],v,R,U=[],H=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},k=!1,C=function(Me){return Me<8?Za[Me]:Me<64&&H[Me-8]||Za[Me]},A=function(Me,rt,xr){var Kt=rt.XF.data;if(!(!Kt||!Kt.patternType||!xr||!xr.cellStyles)){rt.s={},rt.s.patternType=Kt.patternType;var Dr;(Dr=lf(C(Kt.icvFore)))&&(rt.s.fgColor={rgb:Dr}),(Dr=lf(C(Kt.icvBack)))&&(rt.s.bgColor={rgb:Dr})}},b=function(Me,rt,xr){if(!(!k&&ce>1)&&!(xr.sheetRows&&Me.r>=xr.sheetRows)){if(xr.cellStyles&&rt.XF&&rt.XF.data&&A(Me,rt,xr),delete rt.ixfe,delete rt.XF,d=Me,h=it(Me),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Me.r<a.s.r&&(a.s.r=Me.r),Me.c<a.s.c&&(a.s.c=Me.c),Me.r+1>a.e.r&&(a.e.r=Me.r+1),Me.c+1>a.e.c&&(a.e.c=Me.c+1),xr.cellFormula&&rt.f){for(var Kt=0;Kt<w.length;++Kt)if(!(w[Kt][0].s.c>Me.c||w[Kt][0].s.r>Me.r)&&!(w[Kt][0].e.c<Me.c||w[Kt][0].e.r<Me.r)){rt.F=Je(w[Kt][0]),(w[Kt][0].s.c!=Me.c||w[Kt][0].s.r!=Me.r)&&delete rt.f,rt.f&&(rt.f=""+un(w[Kt][1],a,Me,X,N));break}}xr.dense?(i["!data"][Me.r]||(i["!data"][Me.r]=[]),i["!data"][Me.r][Me.c]=rt):i[h]=rt}},N={enc:!1,sbcch:0,snames:[],sharedf:m,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var we,he=[],Re=[],de=[],re=[],ye=!1,X=[];X.SheetNames=N.snames,X.sharedf=N.sharedf,X.arrayf=N.arrayf,X.names=[],X.XTI=[];var Ce=0,ce=0,fe=0,le=[],De=[],K;N.codepage=1200,Ii(1200);for(var se=!1;t.l<t.length-1;){var F=t.l,G=t.read_shift(2);if(G===0&&Ce===10)break;var W=t.l===t.length?0:t.read_shift(2),z=fg[G];if(ce==0&&[9,521,1033,2057].indexOf(G)==-1)break;if(z&&z.f){if(e.bookSheets&&Ce===133&&G!==133)break;if(Ce=G,z.r===2||z.r==12){var Q=t.read_shift(2);if(W-=2,!N.enc&&Q!==G&&((Q&255)<<8|Q>>8)!==G)throw new Error("rt mismatch: "+Q+"!="+G);z.r==12&&(t.l+=10,W-=10)}var O={};if(G===10?O=z.f(t,W,N):O=RH(G,z,t,W,N),ce==0&&[9,521,1033,2057].indexOf(Ce)===-1)continue;switch(G){case 34:r.opts.Date1904=E.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=O,!e.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=O;break;case 66:var ae=Number(O);switch(ae){case 21010:ae=1200;break;case 32768:ae=1e4;break;case 32769:ae=1252;break}Ii(N.codepage=ae),se=!0;break;case 317:N.rrtabid=O;break;case 25:N.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:N.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:U.push(O);break;case 430:X.push([O]),X[X.length-1].XTI=[];break;case 35:case 547:X[X.length-1].push(O);break;case 24:case 536:K={Name:O.Name,Ref:un(O.rgce,a,null,X,N)},O.itab>0&&(K.Sheet=O.itab-1),X.names.push(K),X[0]||(X[0]=[],X[0].XTI=[]),X[X.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(De[O.itab-1]={ref:Je(O.rgce[0][0][1][2])});break;case 22:N.ExternCount=O;break;case 23:X.length==0&&(X[0]=[],X[0].XTI=[]),X[X.length-1].XTI=X[X.length-1].XTI.concat(O),X.XTI=X.XTI.concat(O);break;case 2196:if(N.biff<8)break;K!=null&&(K.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&N.WTF&&console.error("Password verifier: "+O);break;case 133:s[N.biff==4?N.snames.length:O.pos]=O,N.snames.push(O.name);break;case 10:{if(--ce?!k:k)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Je(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ae=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Je(a),a.e.r=Ae}a.e.r++,a.e.c++}he.length>0&&(i["!merges"]=he),Re.length>0&&(i["!objects"]=Re),de.length>0&&(i["!cols"]=de),re.length>0&&(i["!rows"]=re),E.Sheets.push(T)}c===""?u=i:n[c]=i,i={},e.dense&&(i["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[G]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),N.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(N.biff=5,se=!0,Ii(N.codepage=28591)),N.biff==4&&O.dt&256&&(k=!0),N.biff==8&&O.BIFFVer==0&&O.dt==16&&(N.biff=2),ce++&&!k)break;if(i={},e.dense&&(i["!data"]=[]),N.biff<8&&!se&&(se=!0,Ii(N.codepage=e.codepage||1252)),N.biff==4&&k)c=(s[N.snames.indexOf(c)+1]||{name:""}).name;else if(N.biff<5||O.BIFFVer==0&&O.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var ge={pos:t.l-W,name:c};s[ge.pos]=ge,N.snames.push(c)}else c=(s[F]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),he=[],Re=[],N.arrayf=w=[],de=[],re=[],ye=!1,T={Hidden:(s[F]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i["!data"][O.r]||[])[O.c]:i[et(O.c)+ht(O.r)])&&++O.c,v={ixfe:O.ixfe,XF:U[O.ixfe]||{},v:O.val,t:"n"},fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:O.c,r:O.r},v,e);break;case 5:case 517:v={ixfe:O.ixfe,XF:U[O.ixfe],v:O.val,t:O.t},fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:O.c,r:O.r},v,e);break;case 638:v={ixfe:O.ixfe,XF:U[O.ixfe],v:O.rknum,t:"n"},fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:O.c,r:O.r},v,e);break;case 189:for(var Pe=O.c;Pe<=O.C;++Pe){var Oe=O.rkrec[Pe-O.c][0];v={ixfe:Oe,XF:U[Oe],v:O.rkrec[Pe-O.c][1],t:"n"},fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:Pe,r:O.r},v,e)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(v=B0(O.val,O.cell.ixfe,O.tt),v.XF=U[v.ixfe],e.cellFormula){var Ge=O.formula;if(Ge&&Ge[0]&&Ge[0][0]&&Ge[0][0][0]=="PtgExp"){var ot=Ge[0][0][1][0],St=Ge[0][0][1][1],Zt=it({r:ot,c:St});m[Zt]?v.f=""+un(O.formula,a,O.cell,X,N):v.F=((e.dense?(i["!data"][ot]||[])[St]:i[Zt])||{}).F}else v.f=""+un(O.formula,a,O.cell,X,N)}fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b(O.cell,v,e),o=O}break;case 7:case 519:if(o)o.val=O,v=B0(O,o.cell.ixfe,"s"),v.XF=U[v.ixfe],e.cellFormula&&(v.f=""+un(o.formula,a,o.cell,X,N)),fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b(o.cell,v,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(O);var Le=it(O[0].s);if(p=e.dense?(i["!data"][O[0].s.r]||[])[O[0].s.c]:i[Le],e.cellFormula&&p){if(!o||!Le||!p)break;p.f=""+un(O[1],a,O[0],X,N),p.F=Je(O[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;m[it(o.cell)]=O[0],p=e.dense?(i["!data"][o.cell.r]||[])[o.cell.c]:i[it(o.cell)],(p||{}).f=""+un(O[0],a,d,X,N)}}break;case 253:v=B0(l[O.isst].t,O.ixfe,"s"),l[O.isst].h&&(v.h=l[O.isst].h),v.XF=U[v.ixfe],fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:O.c,r:O.r},v,e);break;case 513:e.sheetStubs&&(v={ixfe:O.ixfe,XF:U[O.ixfe],t:"z"},fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:O.c,r:O.r},v,e));break;case 190:if(e.sheetStubs)for(var at=O.c;at<=O.C;++at){var Se=O.ixfe[at-O.c];v={ixfe:Se,XF:U[Se],t:"z"},fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:at,r:O.r},v,e)}break;case 214:case 516:case 4:v=B0(O.val,O.ixfe,"s"),v.XF=U[v.ixfe],fe>0&&(v.z=v.XF&&v.XF.numFmtId&&le[v.XF.numFmtId]||le[v.ixfe>>8&63]),Ui(v,e,r.opts.Date1904),b({c:O.c,r:O.r},v,e);break;case 0:case 512:ce===1&&(a=O);break;case 252:l=O;break;case 1054:if(N.biff>=3&&N.biff<=4){le[fe++]=O[1];for(var Nt=0;Nt<fe+163&&ze[Nt]!=O[1];++Nt);Nt>=163&&ua(O[1],fe+163)}else ua(O[1],O[0]);break;case 30:{le[fe++]=O;for(var Ct=0;Ct<fe+163&&ze[Ct]!=O;++Ct);Ct>=163&&ua(O,fe+163)}break;case 229:he=he.concat(O);break;case 93:Re[O.cmo[0]]=N.lastobj=O;break;case 438:N.lastobj.TxO=O;break;case 127:N.lastobj.ImData=O;break;case 440:for(_=O[0].s.r;_<=O[0].e.r;++_)for(x=O[0].s.c;x<=O[0].e.c;++x)p=e.dense?(i["!data"][_]||[])[x]:i[it({c:x,r:_})],p&&(p.l=O[1]);break;case 2048:for(_=O[0].s.r;_<=O[0].e.r;++_)for(x=O[0].s.c;x<=O[0].e.c;++x)p=e.dense?(i["!data"][_]||[])[x]:i[it({c:x,r:_})],p&&p.l&&(p.l.Tooltip=O[1]);break;case 28:{if(p=e.dense?(i["!data"][O[0].r]||[])[O[0].c]:i[it(O[0])],p||(e.dense?(i["!data"][O[0].r]||(i["!data"][O[0].r]=[]),p=i["!data"][O[0].r][O[0].c]={t:"z"}):p=i[it(O[0])]={t:"z"},a.e.r=Math.max(a.e.r,O[0].r),a.s.r=Math.min(a.s.r,O[0].r),a.e.c=Math.max(a.e.c,O[0].c),a.s.c=Math.min(a.s.c,O[0].c)),p.c||(p.c=[]),N.biff<=5&&N.biff>=2)g={a:"SheetJ5",t:O[1]};else{var Dt=Re[O[2]];g={a:O[1],t:Dt.TxO.t},O[3]!=null&&!(O[3]&2)&&(p.c.hidden=!0)}p.c.push(g)}break;case 2173:cV(U[O.ixfe],O.ext);break;case 125:{if(!N.cellStyles)break;for(;O.e>=O.s;)de[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},ye||(ye=!0,Uv(O.w/256)),ya(de[O.e+1])}break;case 520:{var Pn={};O.level!=null&&(re[O.r]=Pn,Pn.level=O.level),O.hidden&&(re[O.r]=Pn,Pn.hidden=!0),O.hpt&&(re[O.r]=Pn,Pn.hpt=O.hpt,Pn.hpx=ql(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||no(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[G]]=O;break;case 161:i["!margins"]||no(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(E.Views[0].RTL=!0);break;case 146:H=O;break;case 2198:we=O;break;case 140:R=O;break;case 442:c?T.CodeName=O||T.name:E.WBProps.CodeName=O||"ThisWorkbook";break}}else z||console.error("Missing Info for XLS Record 0x"+G.toString(16)),t.l+=W}return r.SheetNames=Xt(s).sort(function(Ur,Me){return Number(Ur)-Number(Me)}).map(function(Ur){return s[Ur].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&De.forEach(function(Ur,Me){r.Sheets[r.SheetNames[Me]]["!autofilter"]=Ur}),r.Strings=l,r.SSF=Bt(ze),N.enc&&(r.Encryption=N.enc),we&&(r.Themes=we),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),X.names.length>0&&(E.Names=X.names),r.Workbook=E,r}var _u={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function DH(t,e,r){var n=He.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Jw(n,ig,_u.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=He.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=Jw(a,sg,_u.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(hA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function bH(t,e){var r=[],n=[],i=[],s=0,a,o=Nw(ig,"n"),l=Nw(sg,"n");if(t.Props)for(a=Xt(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Xt(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)xA.indexOf(i[s][0])>-1||fA.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&He.utils.cfb_add(e,"/SummaryInformation",Zw(n,_u.SI,l,sg)),(r.length||c.length)&&He.utils.cfb_add(e,"/DocumentSummaryInformation",Zw(r,_u.DSI,o,ig,c.length?c:null,_u.UDI))}function fI(t,e){e||(e={}),Gv(e),vv(),e.codepage&&_v(e.codepage);var r,n;if(t.FullPaths){if(He.find(t,"/encryption"))throw new Error("File is password-protected");r=He.find(t,"!CompObj"),n=He.find(t,"/Workbook")||He.find(t,"/Book")}else{switch(e.type){case"base64":t=Tn(Qn(t));break;case"binary":t=Tn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Cr(t,0),n={content:t}}var i,s;if(r&&FH(r),e.bookProps&&!e.bookSheets)i={};else{var a=st?"buffer":"array";if(n&&n.content)i=PH(n.content,e);else if((s=He.find(t,"PerfectOffice_MAIN"))&&s.content)i=to.to_workbook(s.content,(e.type=a,e));else if((s=He.find(t,"NativeContent_MAIN"))&&s.content)i=to.to_workbook(s.content,(e.type=a,e));else throw(s=He.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&He.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=VV(t))}var o={};return t.FullPaths&&DH(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function OH(t,e){var r=e||{},n=He.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return He.utils.cfb_add(n,i,dI(t,r)),r.biff==8&&(t.Props||t.Custprops)&&bH(t,n),r.biff==8&&t.vbaraw&&UV(n,He.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var hf={0:{f:lW},1:{f:gW},2:{f:DW},3:{f:kW},4:{f:yW},5:{f:NW},6:{f:BW},7:{f:CW},8:{f:$W},9:{f:HW},10:{f:WW},11:{f:zW},12:{f:vW},13:{f:OW},14:{f:SW},15:{f:EW},16:{f:iI},17:{f:UW},18:{f:IW},19:{f:Nv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:jz},40:{},42:{},43:{f:AB},44:{f:SB},45:{f:NB},46:{f:PB},47:{f:RB},48:{},49:{f:j9},50:{},51:{f:hV},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:PA},62:{f:MW},63:{f:EV},64:{f:oz},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:nz},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pW},148:{f:fW,p:16},151:{f:QW},152:{},153:{f:Bz},154:{},155:{},156:{f:Lz},157:{},158:{},159:{T:1,f:B7},160:{T:-1},161:{T:1,f:Po},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uV},336:{T:-1},337:{f:mV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ng},357:{},358:{},359:{},360:{T:1},361:{},362:{f:RA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:JW},427:{f:ZW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ng},551:{f:np},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OV},633:{T:1},634:{T:-1},635:{T:1,f:DV},636:{T:-1},637:{f:$9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},fg={6:{f:vm},10:{f:js},12:{f:ar},13:{f:ar},14:{f:hr},15:{f:hr},16:{f:pn},17:{f:hr},18:{f:hr},19:{f:ar},20:{f:iE},21:{f:iE},23:{f:RA},24:{f:aE},25:{f:hr},26:{},27:{},28:{f:HM},29:{},34:{f:hr},35:{f:sE},38:{f:pn},39:{f:pn},40:{f:pn},41:{f:pn},42:{f:hr},43:{f:hr},47:{f:sB},49:{f:hM},51:{f:ar},60:{},61:{f:oM},64:{f:hr},65:{f:fM},66:{f:ar},77:{},80:{},81:{},82:{},85:{f:ar},89:{},90:{},91:{},92:{f:YL},93:{f:XM},94:{},95:{f:hr},96:{},97:{},99:{f:hr},125:{f:PA},128:{f:bM},129:{f:JL},130:{f:ar},131:{f:hr},132:{f:hr},133:{f:ZL},134:{},140:{f:t7},141:{f:ar},144:{},146:{f:i7},151:{},152:{},153:{},154:{},155:{},156:{f:ar},157:{},158:{},160:{f:f7},161:{f:o7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:SM},190:{f:CM},193:{f:js},197:{},198:{},199:{},200:{},201:{},202:{f:hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ar},220:{},221:{f:hr},222:{},224:{f:IM},225:{f:qL},226:{f:js},227:{},229:{f:$M},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:tM},253:{f:pM},255:{f:nM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hr},353:{f:js},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:VM},431:{f:hr},432:{},433:{},434:{},437:{},438:{f:YM},439:{f:hr},440:{f:QM},441:{},442:{f:Lf},443:{},444:{f:ar},445:{},446:{},448:{f:js},449:{f:aM,r:2},450:{f:js},512:{f:rE},513:{f:u7},515:{f:MM},516:{f:gM},517:{f:LM},519:{f:h7},520:{f:iM},523:{},545:{f:lE},549:{f:tE},566:{},574:{f:cM},638:{f:kM},659:{},1048:{},1054:{f:vM},1084:{},1212:{f:jM},2048:{f:ZM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:b0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:js},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:s7,r:12},2173:{f:lV,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:UM,r:12},2197:{},2198:{f:rV,r:12},2199:{},2200:{},2201:{},2202:{f:WM,r:12},2203:{f:js},2204:{},2205:{},2206:{},2207:{},2211:{f:sM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ar},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:l7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:n7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:rE},1:{},2:{f:_7},3:{f:m7},4:{f:p7},5:{f:y7},7:{f:x7},8:{},9:{f:b0},11:{},22:{f:ar},30:{f:yM},31:{},32:{},33:{f:lE},36:{},37:{f:tE},50:{f:w7},62:{},52:{},67:{f:FM},68:{f:ar},69:{},86:{},126:{},127:{f:d7},135:{},136:{},137:{},143:{f:T7},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:E7},223:{},234:{},354:{},421:{},518:{f:vm},521:{f:b0},536:{f:aE},547:{f:sE},561:{},579:{f:PM},1030:{f:vm},1033:{f:b0},1091:{f:DM},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function ue(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Av(r)&&t.push(r)}}function LH(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return ue(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=t.next(4);for(u.write_shift(2,s),u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),t.push(r.slice(l,l+c)),l+=c}}}function Tm(t,e,r,n){var i=ee(9);return Mf(i,t,e),EA(r,n||"b",i),i}function MH(t,e,r){var n=ee(8+2*r.length);return Mf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function hI(t,e){e.forEach(function(r){var n=r[0].map(function(s){return s.t}).join("");if(n.length<=2048)return ue(t,28,mm(n,r[1],r[2]));ue(t,28,mm(n.slice(0,2048),r[1],r[2],n.length));for(var i=2048;i<n.length;i+=2048)ue(t,28,mm(n.slice(i,Math.min(i+2048,n.length)),-1,-1,Math.min(2048,n.length-i)))})}function BH(t,e,r,n,i,s){var a=0;e.z!=null&&(a=i._BIFF2FmtTable.indexOf(e.z),a==-1&&(i._BIFF2FmtTable.push(e.z),a=i._BIFF2FmtTable.length-1));var o=0;if(e.z!=null){for(;o<i.cellXfs.length&&i.cellXfs[o].numFmtId!=a;++o);o==i.cellXfs.length&&i.cellXfs.push({numFmtId:a})}if(e.v!=null)switch(e.t){case"d":case"n":var l=e.t=="d"?nr(Jt(e.v,s),s):e.v;i.biff==2&&l==(l|0)&&l>=0&&l<65536?ue(t,2,v7(r,n,l,o,a)):isNaN(l)?ue(t,5,Tm(r,n,36,"e")):isFinite(l)?ue(t,3,g7(r,n,l,o,a)):ue(t,5,Tm(r,n,7,"e"));return;case"b":case"e":ue(t,5,Tm(r,n,e.v,e.t));return;case"s":case"str":ue(t,4,MH(r,n,e.v==null?"":String(e.v).slice(0,255)));return}ue(t,1,Mf(null,r,n))}function VH(t,e,r,n,i){var s=e["!data"]!=null,a=Et(e["!ref"]||"A1"),o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383)}for(var c=(((i||{}).Workbook||{}).WBProps||{}).date1904,u=[],d=[],h=a.s.c;h<=a.e.c;++h)l[h]=et(h);for(var p=a.s.r;p<=a.e.r;++p)for(s&&(u=e["!data"][p]||[]),o=ht(p),h=a.s.c;h<=a.e.c;++h){var g=s?u[h]:e[l[h]+o];g&&(BH(t,g,p,h,n,c),g.c&&d.push([g.c,p,h]))}hI(t,d)}function UH(t,e){for(var r=e||{},n=gn(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);ue(n,r.biff==4?1033:r.biff==3?521:9,Mv(t,16,r)),((t.Workbook||{}).WBProps||{}).date1904&&ue(n,34,cn(!0)),r.cellXfs=[{numFmtId:0}],r._BIFF2FmtTable=["General"],r._Fonts=[];var a=gn();return VH(a,t.Sheets[t.SheetNames[i]],i,r,t),r._BIFF2FmtTable.forEach(function(o){r.biff<=3?ue(n,30,wM(o)):ue(n,1054,EM(o))}),r.cellXfs.forEach(function(o){switch(r.biff){case 2:ue(n,67,NM(o));break;case 3:ue(n,579,NA(o));break;case 4:ue(n,1091,RM(o));break}}),delete r._BIFF2FmtTable,delete r.cellXfs,delete r._Fonts,n.push(a.end()),ue(n,10),n.end()}var Ei=1,ii=[];function jH(){var t=ee(82+8*ii.length);t.write_shift(2,15),t.write_shift(2,61440),t.write_shift(4,74+8*ii.length);{t.write_shift(2,0),t.write_shift(2,61446),t.write_shift(4,16+8*ii.length);{t.write_shift(4,Ei),t.write_shift(4,ii.length+1);for(var e=0,r=0;r<ii.length;++r)e+=ii[r]&&ii[r][1]||0;t.write_shift(4,e),t.write_shift(4,ii.length)}ii.forEach(function(n){t.write_shift(4,n[0]),t.write_shift(4,n[2])})}return t.write_shift(2,51),t.write_shift(2,61451),t.write_shift(4,18),t.write_shift(2,191),t.write_shift(4,524296),t.write_shift(2,385),t.write_shift(4,134217793),t.write_shift(2,448),t.write_shift(4,134217792),t.write_shift(2,64),t.write_shift(2,61726),t.write_shift(4,16),t.write_shift(4,134217741),t.write_shift(4,134217740),t.write_shift(4,134217751),t.write_shift(4,268435703),t}function WH(t,e){var r=[],n=0,i=gn(),s=Ei,a;e.forEach(function(l,c){var u="",d=l[0].map(function(v){return v.a&&!u&&(u=v.a),v.t}).join("");++Ei;{var h=ee(150);h.write_shift(2,15),h.write_shift(2,61444),h.write_shift(4,150),h.write_shift(2,3234),h.write_shift(2,61450),h.write_shift(4,8),h.write_shift(4,Ei),h.write_shift(4,2560),h.write_shift(2,227),h.write_shift(2,61451),h.write_shift(4,84),h.write_shift(2,128),h.write_shift(4,0),h.write_shift(2,139),h.write_shift(4,2),h.write_shift(2,191),h.write_shift(4,524296),h.write_shift(2,344),h.l+=4,h.write_shift(2,385),h.write_shift(4,134217808),h.write_shift(2,387),h.write_shift(4,134217808),h.write_shift(2,389),h.write_shift(4,268435700),h.write_shift(2,447),h.write_shift(4,1048592),h.write_shift(2,448),h.write_shift(4,134217809),h.write_shift(2,451),h.write_shift(4,268435700),h.write_shift(2,513),h.write_shift(4,134217809),h.write_shift(2,515),h.write_shift(4,268435700),h.write_shift(2,575),h.write_shift(4,196609),h.write_shift(2,959),h.write_shift(4,131072|(l[0].hidden?2:0)),h.l+=2,h.write_shift(2,61456),h.write_shift(4,18),h.write_shift(2,3),h.write_shift(2,l[2]+2),h.l+=2,h.write_shift(2,l[1]+1),h.l+=2,h.write_shift(2,l[2]+4),h.l+=2,h.write_shift(2,l[1]+5),h.l+=2,h.l+=2,h.write_shift(2,61457),h.l+=4,h.l=150,c==0?a=h:ue(i,236,h)}n+=150;{var p=ee(52);p.write_shift(2,21),p.write_shift(2,18),p.write_shift(2,25),p.write_shift(2,Ei),p.write_shift(2,0),p.l=22,p.write_shift(2,13),p.write_shift(2,22),p.write_shift(4,1651663474),p.write_shift(4,2503426821),p.write_shift(4,2150634280),p.write_shift(4,1768515844+Ei*256),p.write_shift(2,0),p.write_shift(4,0),p.l+=4,ue(i,93,p)}{var g=ee(8);g.l+=2,g.write_shift(2,61453),g.l+=4,ue(i,236,g)}n+=8;{var x=ee(18);x.write_shift(2,18),x.l+=8,x.write_shift(2,d.length),x.write_shift(2,16),x.l+=4,ue(i,438,x);{var _=ee(1+d.length);_.write_shift(1,0),_.write_shift(d.length,d,"sbcs"),ue(i,60,_)}{var m=ee(16);m.l+=8,m.write_shift(2,d.length),m.l+=6,ue(i,60,m)}}{var w=ee(12+u.length);w.write_shift(2,l[1]),w.write_shift(2,l[2]),w.write_shift(2,0|(l[0].hidden?0:2)),w.write_shift(2,Ei),w.write_shift(2,u.length),w.write_shift(1,0),w.write_shift(u.length,u,"sbcs"),w.l++,r.push(w)}});{var o=ee(80);o.write_shift(2,15),o.write_shift(2,61442),o.write_shift(4,n+o.length-8),o.write_shift(2,16),o.write_shift(2,61448),o.write_shift(4,8),o.write_shift(4,e.length+1),o.write_shift(4,Ei),o.write_shift(2,15),o.write_shift(2,61443),o.write_shift(4,n+48),o.write_shift(2,15),o.write_shift(2,61444),o.write_shift(4,40),o.write_shift(2,1),o.write_shift(2,61449),o.write_shift(4,16),o.l+=16,o.write_shift(2,2),o.write_shift(2,61450),o.write_shift(4,8),o.write_shift(4,s),o.write_shift(4,5),ue(t,236,a?mr([o,a]):o)}t.push(i.end()),r.forEach(function(l){ue(t,28,l)}),ii.push([s,e.length+1,Ei]),++Ei}function zH(t,e,r){ue(t,49,dM({sz:12,name:"Arial"},r))}function HH(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ue(t,1054,xM(i,e[i],r))})}function $H(t,e){var r=ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ue(t,2151,r),r=ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),AA(Et(e["!ref"]||"A1"),r),r.write_shift(4,4),ue(t,2152,r)}function GH(t,e){for(var r=0;r<16;++r)ue(t,224,nE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ue(t,224,nE(n,0,e))})}function XH(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ue(t,440,JM(n)),n[1].Tooltip&&ue(t,2048,e7(n))}delete e["!links"]}function KH(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&ue(t,125,a7(up(i,n),i))})}}function qH(t,e,r,n,i,s){var a=16+Aa(i.cellXfs,e,i);if(e.v==null&&!e.bf){ue(t,513,wo(r,n,a));return}if(e.bf)ue(t,6,hj(e,r,n,i,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?nr(Jt(e.v,s),s):e.v;isNaN(o)?ue(t,517,pm(r,n,36,a,i,"e")):isFinite(o)?ue(t,515,BM(r,n,o,a)):ue(t,517,pm(r,n,7,a,i,"e"));break;case"b":case"e":ue(t,517,pm(r,n,e.v,a,i,e.t));break;case"s":case"str":if(i.bookSST){var l=zv(i.Strings,e.v==null?"":String(e.v),i.revStrings);ue(t,253,mM(r,n,l,a))}else ue(t,516,_M(r,n,(e.v==null?"":String(e.v)).slice(0,255),a,i));break;default:ue(t,513,wo(r,n,a))}}function YH(t,e,r){var n=gn(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=s["!data"]!=null,c=e.biff==8,u,d="",h=[],p=Et(s["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}ue(n,2057,Mv(r,16,e)),ue(n,13,si(1)),ue(n,12,si(100)),ue(n,15,cn(!0)),ue(n,17,cn(!1)),ue(n,16,xo(.001)),ue(n,95,cn(!0)),ue(n,42,cn(!1)),ue(n,43,cn(!1)),ue(n,130,si(1)),ue(n,128,OM()),ue(n,131,cn(!1)),ue(n,132,cn(!1)),c&&KH(n,s["!cols"]),ue(n,512,TM(p,e));var x=(((r||{}).Workbook||{}).WBProps||{}).date1904;c&&(s["!links"]=[]);for(var _=[],m=[],w=p.s.c;w<=p.e.c;++w)h[w]=et(w);for(var v=p.s.r;v<=p.e.r;++v)for(l&&(m=s["!data"][v]||[]),d=ht(v),w=p.s.c;w<=p.e.c;++w){u=h[w]+d;var R=l?m[w]:s[u];R&&(qH(n,R,v,w,e,x),c&&R.l&&s["!links"].push([u,R.l]),R.c&&_.push([R.c,v,w]))}var U=o.CodeName||o.name||i;return c?WH(n,_):hI(n,_),c&&ue(n,574,uM((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ue(n,229,GM(s["!merges"])),c&&XH(n,s),ue(n,442,TA(U)),c&&$H(n,s),ue(n,10),n.end()}function QH(t,e,r){var n=gn(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ue(n,2057,Mv(t,5,r)),r.bookType=="xla"&&ue(n,135),ue(n,225,o?si(1200):null),ue(n,193,NL(2)),l&&ue(n,191),l&&ue(n,192),ue(n,226),ue(n,92,QL("SheetJS",r)),ue(n,66,si(o?1200:1252)),o&&ue(n,353,si(0)),o&&ue(n,448),ue(n,317,c7(t.SheetNames.length)),o&&t.vbaraw&&ue(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";ue(n,442,TA(c))}ue(n,156,si(17)),ue(n,25,cn(!1)),ue(n,18,cn(!1)),ue(n,19,si(0)),o&&ue(n,431,cn(!1)),o&&ue(n,444,si(0)),ue(n,61,lM()),ue(n,64,cn(!1)),ue(n,141,si(0)),ue(n,34,cn(Fz(t)=="true")),ue(n,14,cn(!0)),o&&ue(n,439,cn(!1)),ue(n,218,si(0)),zH(n,t,r),HH(n,t.SSF,r),GH(n,r),o&&ue(n,352,cn(!1));var u=n.end(),d=gn();o&&ue(d,140,r7()),o&&ii.length&&ue(d,235,jH()),o&&r.Strings&&LH(d,252,rM(r.Strings)),ue(d,10);var h=d.end(),p=gn(),g=0,x=0;for(x=0;x<t.SheetNames.length;++x)g+=(o?12:11)+(o?2:1)*t.SheetNames[x].length;var _=u.length+g+h.length;for(x=0;x<t.SheetNames.length;++x){var m=s[x]||{};ue(p,133,eM({pos:_,hs:m.Hidden||0,dt:0,name:t.SheetNames[x]},r)),_+=e[x].length}var w=p.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var v=[];return u.length&&v.push(u),w.length&&v.push(w),h.length&&v.push(h),mr(v)}function JH(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Bt(ze)),t&&t.SSF&&(lc(),Jd(t.SSF),r.revssf=ep(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),Ei=1,ii=[],r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Xv(r),r.cellXfs=[],Aa(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=YH(i,r,t);return n.unshift(QH(t,n,r)),mr(n)}function dI(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Vr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return JH(t,e);case 4:case 3:case 2:return UH(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function wE(t,e){var r=e||{},n=r.dense!=null?r.dense:EO,i={};n&&(i["!data"]=[]),t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=s.index,l=a&&a.index||t.length,c=d9(t.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,p=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var _=c[o].trim(),m=_.slice(0,3).toLowerCase();if(m=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(m!="<td"&&m!="<th")){var w=_.split(/<\/t[dh]>/i);for(l=0;l<w.length;++l){var v=w[l].trim();if(v.match(/<t[dh]/i)){for(var R=v,U=0;R.charAt(0)=="<"&&(U=R.indexOf(">"))>-1;)R=R.slice(U+1);for(var H=0;H<x.length;++H){var E=x[H];E.s.c==d&&E.s.r<u&&u<=E.e.r&&(d=E.e.c+1,H=-1)}var T=Ve(v.slice(0,v.indexOf(">")));p=T.colspan?+T.colspan:1,((h=+T.rowspan)>1||p>1)&&x.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+p-1}});var k=T.t||T["data-t"]||"";if(!R.length){d+=p;continue}if(R=UC(R),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!R.length){d+=p;continue}var C={t:"s",v:R};r.raw||!R.trim().length||k=="s"||(R==="TRUE"?C={t:"b",v:!0}:R==="FALSE"?C={t:"b",v:!1}:isNaN(qn(R))?isNaN(ef(R).getDate())||(C={t:"d",v:Jt(R)},r.UTC===!1&&(C.v=vo(C.v)),r.cellDates||(C={t:"n",v:nr(C.v)}),C.z=r.dateNF||ze[14]):C={t:"n",v:qn(R)}),C.cellText!==!1&&(C.w=R),n?(i["!data"][u]||(i["!data"][u]=[]),i["!data"][u][d]=C):i[it({r:u,c:d})]=C,d+=p}}}}return i["!ref"]=Je(g),x.length&&(i["!merges"]=x),i}function ZH(t,e,r,n){for(var i=t["!merges"]||[],s=[],a={},o=t["!data"]!=null,l=e.s.c;l<=e.e.c;++l){for(var c=0,u=0,d=0;d<i.length;++d)if(!(i[d].s.r>r||i[d].s.c>l)&&!(i[d].e.r<r||i[d].e.c<l)){if(i[d].s.r<r||i[d].s.c<l){c=-1;break}c=i[d].e.r-i[d].s.r+1,u=i[d].e.c-i[d].s.c+1;break}if(!(c<0)){var h=et(l)+ht(r),p=o?(t["!data"][r]||[])[l]:t[h],g=p&&p.v!=null&&(p.h||ad(p.w||(Rs(p),p.w)||""))||"";a={},c>1&&(a.rowspan=c),u>1&&(a.colspan=u),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(a["data-t"]=p&&p.t||"z",p.v!=null&&(a["data-v"]=p.v instanceof Date?p.v.toISOString():p.v),p.z!=null&&(a["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+ad(p.l.Target)+'">'+g+"</a>")),a.id=(n.id||"sjs")+"-"+h,s.push(xe("td",g,a))}}var x="<tr>";return x+s.join("")+"</tr>"}var e$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',t$="</body></html>";function r$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1){var n=Ca(wE(r[0],e),e);return n.bookType="html",n}var i=Yv();return r.forEach(function(s,a){jf(i,wE(s,e),"Sheet"+(a+1))}),i.bookType="html",i}function n$(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function pI(t,e){var r=e||{},n=r.header!=null?r.header:e$,i=r.footer!=null?r.footer:t$,s=[n],a=Vr(t["!ref"]||"A1");if(s.push(n$(t,a,r)),t["!ref"])for(var o=a.s.r;o<=a.e.r;++o)s.push(ZH(t,a,o,r));return s.push("</table>"+i),s.join("")}function mI(t,e,r){var n=e.rows;if(!n)throw"Unsupported origin when "+e.tagName+" is not a TABLE";var i=r||{},s=t["!data"]!=null,a=0,o=0;if(i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var l=typeof i.origin=="string"?Pt(i.origin):i.origin;a=l.r,o=l.c}var c=Math.min(i.sheetRows||1e7,n.length),u={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var d=Vr(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var h=[],p=0,g=t["!rows"]||(t["!rows"]=[]),x=0,_=0,m=0,w=0,v=0,R=0;for(t["!cols"]||(t["!cols"]=[]);x<n.length&&_<c;++x){var U=n[x];if(EE(U)){if(i.display)continue;g[_]={hidden:!0}}var H=U.cells;for(m=w=0;m<H.length;++m){var E=H[m];if(!(i.display&&EE(E))){var T=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):UC(E.innerHTML),k=E.getAttribute("data-z")||E.getAttribute("z");for(p=0;p<h.length;++p){var C=h[p];C.s.c==w+o&&C.s.r<_+a&&_+a<=C.e.r&&(w=C.e.c+1-o,p=-1)}R=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||R>1)&&h.push({s:{r:_+a,c:w+o},e:{r:_+a+(v||1)-1,c:w+o+(R||1)-1}});var A={t:"s",v:T},b=E.getAttribute("data-t")||E.getAttribute("t")||"";T!=null&&(T.length==0?A.t=b||"z":i.raw||T.trim().length==0||b=="s"||(T==="TRUE"?A={t:"b",v:!0}:T==="FALSE"?A={t:"b",v:!1}:isNaN(qn(T))?isNaN(ef(T).getDate())||(A={t:"d",v:Jt(T)},i.UTC&&(A.v=tp(A.v)),i.cellDates||(A={t:"n",v:nr(A.v)}),A.z=i.dateNF||ze[14]):A={t:"n",v:qn(T)})),A.z===void 0&&k!=null&&(A.z=k);var N="",we=E.getElementsByTagName("A");if(we&&we.length)for(var he=0;he<we.length&&!(we[he].hasAttribute("href")&&(N=we[he].getAttribute("href"),N.charAt(0)!="#"));++he);N&&N.charAt(0)!="#"&&N.slice(0,11).toLowerCase()!="javascript:"&&(A.l={Target:N}),s?(t["!data"][_+a]||(t["!data"][_+a]=[]),t["!data"][_+a][w+o]=A):t[it({c:w+o,r:_+a})]=A,u.e.c<w+o&&(u.e.c=w+o),w+=R}}++_}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,_-1+a),t["!ref"]=Je(u),_>=c&&(t["!fullref"]=Je((u.e.r=n.length-x+_-1+a,u))),t}function gI(t,e){var r=e||{},n={};return r.dense&&(n["!data"]=[]),mI(n,t,e)}function i$(t,e){var r=Ca(gI(t,e),e);return r}function EE(t){var e="",r=s$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function s$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function a$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=mt(e.replace(/<[^>]*>/g,""));return[r]}function _I(t,e,r){var n=r||{},i=rp(t);Tr.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");for(var s,a,o="",l="",c,u=0,d=-1,h="";s=Tr.exec(i);)switch(s[3]=s[3].replace(/_.*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":s[1]==="/"?(a["truncate-on-overflow"]=="false"&&(o.match(/h/)?o=o.replace(/h+/,"[$&]"):o.match(/m/)?o=o.replace(/m+/,"[$&]"):o.match(/s/)&&(o=o.replace(/s+/,"[$&]"))),n[a.name]=o,o=""):s[0].charAt(s[0].length-2)!=="/"&&(o="",a=Ve(s[0],!1));break;case"boolean-style":s[1]==="/"?(n[a.name]="General",o=""):s[0].charAt(s[0].length-2)!=="/"&&(o="",a=Ve(s[0],!1));break;case"boolean":o+="General";break;case"text":s[1]==="/"?(h=i.slice(d,Tr.lastIndex-s[0].length),h=="%"&&a[0]=="<number:percentage-style"?o+="%":o+='"'+h.replace(/"/g,'""')+'"'):s[0].charAt(s[0].length-2)!=="/"&&(d=Tr.lastIndex);break;case"day":switch(c=Ve(s[0],!1),c.style){case"short":o+="d";break;case"long":o+="dd";break;default:o+="dd";break}break;case"day-of-week":switch(c=Ve(s[0],!1),c.style){case"short":o+="ddd";break;case"long":o+="dddd";break;default:o+="ddd";break}break;case"era":switch(c=Ve(s[0],!1),c.style){case"short":o+="ee";break;case"long":o+="eeee";break;default:o+="eeee";break}break;case"hours":switch(c=Ve(s[0],!1),c.style){case"short":o+="h";break;case"long":o+="hh";break;default:o+="hh";break}break;case"minutes":switch(c=Ve(s[0],!1),c.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="mm";break}break;case"month":switch(c=Ve(s[0],!1),c.textual&&(o+="mm"),c.style){case"short":o+="m";break;case"long":o+="mm";break;default:o+="m";break}break;case"seconds":{switch(c=Ve(s[0],!1),c.style){case"short":o+="s";break;case"long":o+="ss";break;default:o+="ss";break}c["decimal-places"]&&(o+="."+gt("0",+c["decimal-places"]))}break;case"year":switch(c=Ve(s[0],!1),c.style){case"short":o+="yy";break;case"long":o+="yyyy";break;default:o+="yy";break}break;case"am-pm":o+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+s[3]);break;case"fill-character":s[1]==="/"?(h=i.slice(d,Tr.lastIndex-s[0].length),o+='"'+h.replace(/"/g,'""')+'"*'):s[0].charAt(s[0].length-2)!=="/"&&(d=Tr.lastIndex);break;case"scientific-number":c=Ve(s[0],!1),o+="0."+gt("0",+c["min-decimal-places"]||+c["decimal-places"]||2)+gt("?",+c["decimal-places"]-+c["min-decimal-places"]||0)+"E"+(Ft(c["forced-exponent-sign"])?"+":"")+gt("0",+c["min-exponent-digits"]||2);break;case"fraction":c=Ve(s[0],!1),+c["min-integer-digits"]?o+=gt("0",+c["min-integer-digits"]):o+="#",o+=" ",o+=gt("?",+c["min-numerator-digits"]||1),o+="/",+c["denominator-value"]?o+=c["denominator-value"]:o+=gt("?",+c["min-denominator-digits"]||1);break;case"currency-symbol":s[1]==="/"?o+='"'+i.slice(d,Tr.lastIndex-s[0].length).replace(/"/g,'""')+'"':s[0].charAt(s[0].length-2)!=="/"?d=Tr.lastIndex:o+="$";break;case"text-properties":switch(c=Ve(s[0],!1),(c.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":o="[Red]"+o;break}break;case"text-content":o+="@";break;case"map":c=Ve(s[0],!1),mt(c.condition)=="value()>=0"?o=n[c["apply-style-name"]]+";"+o:console.error("ODS number format may be incorrect: "+c.condition);break;case"number":if(s[1]==="/")break;c=Ve(s[0],!1),l="",l+=gt("0",+c["min-integer-digits"]||1),Ft(c.grouping)&&(l=_s(gt("#",Math.max(0,4-l.length))+l)),(+c["min-decimal-places"]||+c["decimal-places"])&&(l+="."),+c["min-decimal-places"]&&(l+=gt("0",+c["min-decimal-places"]||1)),+c["decimal-places"]-(+c["min-decimal-places"]||0)&&(l+=gt("0",+c["decimal-places"]-(+c["min-decimal-places"]||0))),o+=l;break;case"embedded-text":s[1]==="/"?u==0?o+='"'+i.slice(d,Tr.lastIndex-s[0].length).replace(/"/g,'""')+'"':o=o.slice(0,u)+'"'+i.slice(d,Tr.lastIndex-s[0].length).replace(/"/g,'""')+'"'+o.slice(u):s[0].charAt(s[0].length-2)!=="/"&&(d=Tr.lastIndex,u=-+Ve(s[0],!1).position||0);break}return n}function vI(t,e,r){var n=e||{},i=rp(t),s=[],a,o,l,c="",u=0,d,h,p={},g=[],x={};n.dense&&(x["!data"]=[]);var _,m,w={value:""},v="",R=0,U="",H=0,E=[],T=[],k=-1,C=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},b=0,N=r||{},we={},he=[],Re={},de=0,re=0,ye=[],X=1,Ce=1,ce=[],fe={Names:[],WBProps:{}},le={},De=["",""],K=[],se={},F="",G=0,W=!1,z=!1,Q=0;for(Tr.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Tr.exec(i);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"":_[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?x["!ref"]=Je(A):x["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=A.e.r&&(x["!fullref"]=x["!ref"],A.e.r=n.sheetRows-1,x["!ref"]=Je(A)),he.length&&(x["!merges"]=he),ye.length&&(x["!rows"]=ye),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),p[d.name]=x,z=!1):_[0].charAt(_[0].length-2)!=="/"&&(d=Ve(_[0],!1),k=C=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,x={},n.dense&&(x["!data"]=[]),he=[],ye=[],z=!0);break;case"table-row-group":_[1]==="/"?--b:++b;break;case"table-row":case"":if(_[1]==="/"){k+=X,X=1;break}if(h=Ve(_[0],!1),h.?k=h.-1:k==-1&&(k=0),X=+h["number-rows-repeated"]||1,X<10)for(Q=0;Q<X;++Q)b>0&&(ye[k+Q]={level:b});C=-1;break;case"covered-table-cell":_[1]!=="/"&&++C,n.sheetStubs&&(n.dense?(x["!data"][k]||(x["!data"][k]=[]),x["!data"][k][C]={t:"z"}):x[it({r:k,c:C})]={t:"z"}),v="",E=[];break;case"table-cell":case"":if(_[0].charAt(_[0].length-2)==="/")++C,w=Ve(_[0],!1),Ce=parseInt(w["number-columns-repeated"]||"1",10),m={t:"z",v:null},w.formula&&n.cellFormula!=!1&&(m.f=vE(mt(w.formula))),w["style-name"]&&we[w["style-name"]]&&(m.z=we[w["style-name"]]),(w.||w["value-type"])=="string"&&(m.t="s",m.v=mt(w["string-value"]||""),n.dense?(x["!data"][k]||(x["!data"][k]=[]),x["!data"][k][C]=m):x[et(C)+ht(k)]=m),C+=Ce-1;else if(_[1]!=="/"){++C,v=U="",R=H=0,E=[],T=[],Ce=1;var O=X?k+X-1:k;if(C>A.e.c&&(A.e.c=C),C<A.s.c&&(A.s.c=C),k<A.s.r&&(A.s.r=k),O>A.e.r&&(A.e.r=O),w=Ve(_[0],!1),K=[],se={},m={t:w.||w["value-type"],v:null},w["style-name"]&&we[w["style-name"]]&&(m.z=we[w["style-name"]]),n.cellFormula)if(w.formula&&(w.formula=mt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(de=parseInt(w["number-matrix-rows-spanned"],10)||0,re=parseInt(w["number-matrix-columns-spanned"],10)||0,Re={s:{r:k,c:C},e:{r:k+de-1,c:C+re-1}},m.F=Je(Re),ce.push([Re,m.F])),w.formula)m.f=vE(w.formula);else for(Q=0;Q<ce.length;++Q)k>=ce[Q][0].s.r&&k<=ce[Q][0].e.r&&C>=ce[Q][0].s.c&&C<=ce[Q][0].e.c&&(m.F=ce[Q][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(de=parseInt(w["number-rows-spanned"],10)||0,re=parseInt(w["number-columns-spanned"],10)||0,Re={s:{r:k,c:C},e:{r:k+de-1,c:C+re-1}},he.push(Re)),w["number-columns-repeated"]&&(Ce=parseInt(w["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=Ft(w["boolean-value"])||+w["boolean-value"]>=1;break;case"float":m.t="n",m.v=parseFloat(w.value),n.cellDates&&m.z&&gi(m.z)&&(m.v=Es(m.v+(fe.WBProps.date1904?1462:0)),m.t=typeof m.v=="number"?"n":"d");break;case"percentage":m.t="n",m.v=parseFloat(w.value);break;case"currency":m.t="n",m.v=parseFloat(w.value);break;case"date":m.t="d",m.v=Jt(w["date-value"],fe.WBProps.date1904),n.cellDates||(m.t="n",m.v=nr(m.v,fe.WBProps.date1904)),m.z||(m.z="m/d/yy");break;case"time":m.t="n",m.v=n9(w["time-value"])/86400,n.cellDates&&(m.v=Es(m.v),m.t=typeof m.v=="number"?"n":"d"),m.z||(m.z="HH:MM:SS");break;case"number":m.t="n",m.v=parseFloat(w.);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",w["string-value"]!=null&&(v=mt(w["string-value"]),E=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(W=!1,m.t==="s"&&(m.v=v||"",E.length&&(m.R=E),W=R==0),le.Target&&(m.l=le),K.length>0&&(m.c=K,K=[]),v&&n.cellText!==!1&&(m.w=v),W&&(m.t="z",delete m.v),(!W||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=k))for(var ae=0;ae<X;++ae){if(Ce=parseInt(w["number-columns-repeated"]||"1",10),n.dense)for(x["!data"][k+ae]||(x["!data"][k+ae]=[]),x["!data"][k+ae][C]=ae==0?m:Bt(m);--Ce>0;)x["!data"][k+ae][C+Ce]=Bt(m);else for(x[it({r:k+ae,c:C})]=m;--Ce>0;)x[it({r:k+ae,c:C+Ce})]=Bt(m);A.e.c<=C&&(A.e.c=C)}Ce=parseInt(w["number-columns-repeated"]||"1",10),C+=Ce-1,Ce=0,m={},v="",E=[]}le={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((a=s.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((a=s.pop())[0]!==_[3])throw"Bad state: "+a;se.t=v,E.length&&(se.R=E),se.a=F,K.push(se),v=U,R=H,E=T}else if(_[0].charAt(_[0].length-2)!=="/"){s.push([_[3],!1]);var Ae=Ve(_[0],!0);Ae.display&&Ft(Ae.display)||(K.hidden=!0),U=v,H=R,T=E,v="",R=0,E=[]}F="",G=0;break;case"creator":_[1]==="/"?F=i.slice(G,_.index):G=_.index+_[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((a=s.pop())[0]!==_[3])throw"Bad state: "+a}else _[0].charAt(_[0].length-2)!=="/"&&s.push([_[3],!1]);v="",R=0,E=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){var ge=Tr.lastIndex;_I(i.slice(l,Tr.lastIndex),e,N),Tr.lastIndex=ge}else _[0].charAt(_[0].length-2)!=="/"&&(l=Tr.lastIndex-_[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var Pe=Ve(_[0],!1);Pe.family=="table-cell"&&N[Pe["data-style-name"]]&&(we[Pe.name]=N[Pe["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=i.slice(u,_.index);break}else u=_.index+_[0].length;break;case"named-range":o=Ve(_[0],!1),De=xm(o["cell-range-address"]);var Oe={Name:o.name,Ref:De[0]+"!"+De[1]};z&&(Oe.Sheet=g.length),fe.Names.push(Oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(o=Ve(_[0],!1),o["date-value"]){case"1904-01-01":fe.WBProps.date1904=!0;break}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(_[1]==="/"&&(!w||!w["string-value"])){var Ge=a$(i.slice(R,_.index));v=(v.length>0?v+`
`:"")+Ge[0]}else _[0].slice(-2)=="/>"?v+=`
`:(Ve(_[0],!1),R=_.index+_[0].length);break;case"s":break;case"database-range":if(_[1]==="/")break;try{De=xm(Ve(_[0])["target-range-address"]),p[De[0]]["!autofilter"]={ref:De[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"filter-set-item":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(le=Ve(_[0],!1),!le.href)break;le.Target=mt(le.href),delete le.href,le.Target.charAt(0)=="#"&&le.Target.indexOf(".")>-1?(De=xm(le.Target.slice(1)),le.Target="#"+De[0]+"!"+De[1]):le.Target.match(/^\.\.[\\\/]/)&&(le.Target=le.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(_)}}var ot={Sheets:p,SheetNames:g,Workbook:fe};return n.bookSheets&&delete ot.Sheets,ot}function TE(t,e){e=e||{},ni(t,"META-INF/manifest.xml")&&fL(Er(t,"META-INF/manifest.xml"),e);var r=Sn(t,"styles.xml"),n=r&&_I(Rt(r)),i=Sn(t,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var s=vI(Rt(i),e,n);return ni(t,"meta.xml")&&(s.Props=cA(Er(t,"meta.xml"))),s.bookType="ods",s}function kE(t,e){var r=vI(t,e);return r.bookType="fods",r}var o$=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+rf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return vr+e}}();function l$(t,e){var r="number",n="",i={"style:name":e},s="",a=0;t=t.replace(/"[$]"/g,"$");e:{if(t.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+t),t=t.slice(0,t.indexOf(";"))),t=="@"){r="text",n="<number:text-content/>";break e}if(t.indexOf(/\$/)>-1&&(r="currency"),t[a]=='"'){for(s="";t[++a]!='"'||t[++a]=='"';)s+=t[a];--a,t[a+1]=="*"?(a++,n+="<number:fill-character>"+Ze(s.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ze(s.replace(/""/g,'"'))+"</number:text>",t=t.slice(a+1),a=0}var o=t.match(/# (\?+)\/(\?+)/);if(o){n+=xe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:max-denominator-value":Math.max(+o[1].replace(/./g,"9"),+o[2].replace(/./g,"9"))});break e}if(o=t.match(/# (\?+)\/(\d+)/)){n+=xe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:denominator-value":+o[2]});break e}if(o=t.match(/(\d+)(|\.\d+)%/)){r="percentage",n+=xe("number:number",null,{"number:decimal-places":o[2]&&o.length-1||0,"number:min-decimal-places":o[2]&&o.length-1||0,"number:min-integer-digits":o[1].length})+"<number:text>%</number:text>";break e}var l=!1;if(["y","m","d"].indexOf(t[0])>-1){r="date";t:for(;a<t.length;++a)switch(s=t[a].toLowerCase()){case"h":case"s":l=!0,--a;break t;case"m":r:for(var c=a+1;c<t.length;++c)switch(t[c]){case"y":case"d":break r;case"h":case"s":l=!0,--a;break t}case"y":case"d":for(;(t[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':for(;t[++a]!='"'||t[++a]=='"';)s+=t[a];--a,n+="<number:text>"+Ze(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":s=t[++a],n+="<number:text>"+Ze(s)+"</number:text>";break;case"/":case":":n+="<number:text>"+Ze(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+t)}if(!l)break e;t=t.slice(a+1),a=0}if(t.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),t.match(/\[/)&&(t=t.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");a<t.length;++a)switch(s=t[a].toLowerCase()){case"h":case"m":case"s":for(;(t[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"h":case"hh":n+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(t[a+1]==".")do s+=t[a+1],++a;while(t[a+1]=="0");n+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;t[++a]!='"'||t[++a]=='"';)s+=t[a];--a,n+="<number:text>"+Ze(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+Ze(s)+"</number:text>";break;case"a":if(t.slice(a,a+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",a+=2;break}if(t.slice(a,a+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",a+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+t)}break e}if(t.indexOf(/\$/)>-1&&(r="currency"),t[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',t=t.slice(1),a=0),a=0,t[a]=='"'){for(;t[++a]!='"'||t[++a]=='"';)s+=t[a];--a,t[a+1]=="*"?(a++,n+="<number:fill-character>"+Ze(s.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ze(s.replace(/""/g,'"'))+"</number:text>",t=t.slice(a+1),a=0}var u=t.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!u||!u[0])console.error("Could not find numeric part of "+t);else{var d=u[1].replace(/,/g,"");n+="<number:"+(u[3]?"scientific-":"")+'number number:min-integer-digits="'+(d.indexOf("0")==-1?"0":d.length-d.indexOf("0"))+'"'+(u[0].indexOf(",")>-1?' number:grouping="true"':"")+(u[2]&&' number:decimal-places="'+(u[2].length-1)+'"'||' number:decimal-places="0"')+(u[3]&&u[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(u[3]?' number:min-exponent-digits="'+u[3].match(/0+/)[0].length+'"':"")+"></number:"+(u[3]?"scientific-":"")+"number>",a=u.index+u[0].length}if(t[a]=='"'){for(s="";t[++a]!='"'||t[++a]=='"';)s+=t[a];--a,n+="<number:text>"+Ze(s.replace(/""/g,'"'))+"</number:text>"}}return n?xe("number:"+r+"-style",n,i):(console.error("Could not generate ODS number format for |"+t+"|"),"")}function SE(t,e,r){for(var n=[],i=0;i<t.length;++i){var s=t[i];s&&s.Sheet==(r==-1?null:r)&&n.push(s)}return n.length?`      <table:named-expressions>
`+n.map(function(a){var o=(r==-1?"$":"")+tI(a.Ref);return"        "+xe("table:named-range",null,{"table:name":a.Name,"table:cell-range-address":o,"table:base-cell-address":o.replace(/[\.]?[^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var CE=function(){var t=function(i){return Ze(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=function(i,s,a,o,l,c){var u=[];u.push('      <table:table table:name="'+Ze(s.SheetNames[a])+`" table:style-name="ta1">
`);var d=0,h=0,p=Vr(i["!ref"]||"A1"),g=i["!merges"]||[],x=0,_=i["!data"]!=null;if(i["!cols"])for(h=0;h<=p.e.c;++h)u.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var m="",w=i["!rows"]||[];for(d=0;d<p.s.r;++d)m=w[d]?' table:style-name="ro'+w[d].ods+'"':"",u.push("        <table:table-row"+m+`></table:table-row>
`);for(;d<=p.e.r;++d){for(m=w[d]?' table:style-name="ro'+w[d].ods+'"':"",u.push("        <table:table-row"+m+`>
`),h=0;h<p.s.c;++h)u.push(e);for(;h<=p.e.c;++h){var v=!1,R={},U="";for(x=0;x!=g.length;++x)if(!(g[x].s.c>h)&&!(g[x].s.r>d)&&!(g[x].e.c<h)&&!(g[x].e.r<d)){(g[x].s.c!=h||g[x].s.r!=d)&&(v=!0),R["table:number-columns-spanned"]=g[x].e.c-g[x].s.c+1,R["table:number-rows-spanned"]=g[x].e.r-g[x].s.r+1;break}if(v){u.push(`          <table:covered-table-cell/>
`);continue}var H=it({r:d,c:h}),E=_?(i["!data"][d]||[])[h]:i[H];if(E&&E.f&&(R["table:formula"]=Ze(Fj(E.f)),E.F&&E.F.slice(0,H.length)==H)){var T=Vr(E.F);R["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,R["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!E){u.push(e);continue}switch(E.t){case"b":U=E.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=E.v?"true":"false";break;case"n":U=E.w||String(E.v||0),R["office:value-type"]="float",R["office:value"]=E.v||0;break;case"s":case"str":U=E.v==null?"":E.v,R["office:value-type"]="string";break;case"d":U=E.w||Jt(E.v,c).toISOString(),R["office:value-type"]="date",R["office:date-value"]=Jt(E.v,c).toISOString(),R["table:style-name"]="ce1";break;default:u.push(e);continue}var k=t(U);if(E.l&&E.l.Target){var C=E.l.Target;C=C.charAt(0)=="#"?"#"+tI(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),k=xe("text:a",k,{"xlink:href":C.replace(/&/g,"&amp;")})}l[E.z]&&(R["table:style-name"]="ce"+l[E.z].slice(1));var A=xe("text:p",k,{});if(E.c){for(var b="",N="",we={},he=0;he<E.c.length;++he)!b&&E.c[he].a&&(b=E.c[he].a),N+="<text:p>"+t(E.c[he].t)+"</text:p>";E.c.hidden||(we["office:display"]=!0),A=xe("office:annotation",N,we)+A}u.push("          "+xe("table:table-cell",A,R)+`
`)}u.push(`        </table:table-row>
`)}return(s.Workbook||{}).Names&&u.push(SE(s.Workbook.Names,s.SheetNames,a)),u.push(`      </table:table>
`),u.join("")},n=function(i,s){i.push(` <office:automatic-styles>
`);var a=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;ya(h),h.ods=a;var p=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++a}}});var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=o;var h=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l={},c=69;return s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u){var d=u["!data"]!=null;if(u["!ref"])for(var h=Vr(u["!ref"]),p=0;p<=h.e.r;++p)for(var g=0;g<=h.e.c;++g){var x=d?(u["!data"][p]||[])[g]:u[it({r:p,c:g})];if(!(!x||!x.z||x.z.toLowerCase()=="general")&&!l[x.z]){var _=l$(x.z,"N"+c);_&&(l[x.z]="N"+c,++c,i.push(_+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Xt(l).forEach(function(u){i.push('<style:style style:name="ce'+l[u].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+l[u]+`"/>
`)}),i.push(` </office:automatic-styles>
`),l};return function(s,a){var o=[vr],l=rf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=rf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(o.push("<office:document"+l+c+`>
`),o.push(lA().replace(/<office:document-meta.*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):o.push("<office:document-content"+l+`>
`);var u=n(o,s);o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`),((s.Workbook||{}).WBProps||{}).date1904&&o.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var d=0;d!=s.SheetNames.length;++d)o.push(r(s.Sheets[s.SheetNames[d]],s,d,a,u,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&o.push(SE(s.Workbook.Names,s.SheetNames,-1)),o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),a.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function xI(t,e){if(e.bookType=="fods")return CE(t,e);var r=Tv(),n="",i=[],s=[];return n="mimetype",Ye(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ye(r,n,CE(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ye(r,n,o$(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ye(r,n,vr+lA()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ye(r,n,pL(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ye(r,n,hL(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var gr=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function Ps(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Oi(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Rt(ts(t))}function wn(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Tn(qi(t))}function Ea(t){for(var e=0,r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),i=0;for(r=0;r<t.length;++r){var s=t[r],a=s.length;if(a<250)for(var o=0;o<a;++o)n[i++]=s[o];else n.set(s,i),i+=a}return n}function vu(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function c$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function u$(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function df(t,e){var r=e.l,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e.l=r,n}function Ue(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e[gr](0,r)}function yI(t){for(var e={l:0},r=[];e.l<t.length;)r.push(df(t,e));return r}function wI(t){return Ea(t.map(function(e){return Ue(e)}))}function ut(t){var e=0,r=t[e]&127;return t[e++]<128||(r|=(t[e]&127)<<7,t[e++]<128)||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128)||(r|=(t[e]&15)<<28),r}function Fe(t){for(var e=[],r={l:0};r.l<t.length;){var n=r.l,i=df(t,r),s=i&7;i=i/8|0;var a,o=r.l;switch(s){case 0:{for(;t[o++]>=128;);a=t[gr](r.l,o),r.l=o}break;case 1:a=t[gr](o,o+8),r.l=o+8;break;case 2:{var l=df(t,r);a=t[gr](r.l,r.l+l),r.l+=l}break;case 5:a=t[gr](o,o+4),r.l=o+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:a,type:s};e[i]==null&&(e[i]=[]),e[i].push(c)}return e}function We(t){var e=[];return t.forEach(function(r,n){n!=0&&r.forEach(function(i){i.data&&(e.push(Ue(n*8+i.type)),i.type==2&&e.push(Ue(i.data.length)),e.push(i.data))})}),Ea(e)}function Eo(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function pf(t){for(var e,r=[],n={l:0};n.l<t.length;){var i=df(t,n),s=Fe(t[gr](n.l,n.l+i));n.l+=i;var a={id:ut(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Fe(o.data),c=ut(l[3][0].data);a.messages.push({meta:l,data:t[gr](n.l,n.l+c)}),n.l+=c}),(e=s[3])!=null&&e[0]&&(a.merge=ut(s[3][0].data)>>>0>0),r.push(a)}return r}function Sl(t){var e=[];return t.forEach(function(r){var n=[[],[{data:Ue(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:Ue(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ue(a.data.length)}],n[2].push({data:We(a.meta),type:2})});var s=We(n);e.push(Ue(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Ea(e)}function f$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r={l:0},n=df(e,r),i=[],s=r.l;s<e.length;){var a=e[s]&3;if(a==0){var o=e[s++]>>2;if(o<60)++o;else{var l=o-59;o=e[s],l>1&&(o|=e[s+1]<<8),l>2&&(o|=e[s+2]<<16),l>3&&(o|=e[s+3]<<24),o>>>=0,o++,s+=l}i.push(e[gr](s,s+o)),s+=o;continue}else{var c=0,u=0;if(a==1?(u=(e[s]>>2&7)+4,c=(e[s++]&224)<<3,c|=e[s++]):(u=(e[s++]>>2)+1,a==2?(c=e[s]|e[s+1]<<8,s+=2):(c=(e[s]|e[s+1]<<8|e[s+2]<<16|e[s+3]<<24)>>>0,s+=4)),c==0)throw new Error("Invalid offset 0");for(var d=i.length-1,h=c;d>=0&&h>=i[d].length;)h-=i[d].length,--d;if(d<0)if(h==0)h=i[d=0].length;else throw new Error("Invalid offset beyond length");if(u<h)i.push(i[d][gr](i[d].length-h,i[d].length-h+u));else{for(h>0&&(i.push(i[d][gr](i[d].length-h)),u-=h),++d;u>=i[d].length;)i.push(i[d]),u-=i[d].length,++d;u&&i.push(i[d][gr](0,u))}i.length>25&&(i=[Ea(i)])}}for(var p=0,g=0;g<i.length;++g)p+=i[g].length;if(p!=n)throw new Error("Unexpected length: ".concat(p," != ").concat(n));return i}function mf(t){Array.isArray(t)&&(t=new Uint8Array(t));for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push.apply(e,f$(n,t[gr](r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return e.length==1?e[0]:Ea(e)}function Cl(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Ue(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t[gr](r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Ea(e)}var h$=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function EI(t,e,r,n,i){var s,a,o,l,c=e&255,u=e>>8,d=u>=5?i:n;e:if(r&(u>4?8:4)&&t.t=="n"&&c==7){var h=(s=d[7])!=null&&s[0]?ut(d[7][0].data):-1;if(h==-1)break e;var p=(a=d[15])!=null&&a[0]?ut(d[15][0].data):-1,g=(o=d[16])!=null&&o[0]?ut(d[16][0].data):-1,x=(l=d[40])!=null&&l[0]?ut(d[40][0].data):-1,_=t.v,m=_;t:if(x){if(_==0){p=g=2;break t}_>=604800?p=1:_>=86400?p=2:_>=3600?p=4:_>=60?p=8:_>=1?p=16:p=32,Math.floor(_)!=_?g=32:_%60?g=16:_%3600?g=8:_%86400?g=4:_%604800&&(g=2),g<p&&(g=p)}if(p==-1||g==-1)break e;var w=[],v=[];p==1&&(m=_/604800,g==1?v.push('d"d"'):(m|=0,_-=604800*m),w.push(m+(h==2?" week"+(m==1?"":"s"):h==1?"w":""))),p<=2&&g>=2&&(m=_/86400,g>2&&(m|=0,_-=86400*m),v.push('d"d"'),w.push(m+(h==2?" day"+(m==1?"":"s"):h==1?"d":""))),p<=4&&g>=4&&(m=_/3600,g>4&&(m|=0,_-=3600*m),v.push((p>=4?"[h]":"h")+'"h"'),w.push(m+(h==2?" hour"+(m==1?"":"s"):h==1?"h":""))),p<=8&&g>=8&&(m=_/60,g>8&&(m|=0,_-=60*m),v.push((p>=8?"[m]":"m")+'"m"'),h==0?w.push((p==8&&g==8||m>=10?"":"0")+m):w.push(m+(h==2?" minute"+(m==1?"":"s"):h==1?"m":""))),p<=16&&g>=16&&(m=_,g>16&&(m|=0,_-=m),v.push((p>=16?"[s]":"s")+'"s"'),h==0?w.push((g==16&&p==16||m>=10?"":"0")+m):w.push(m+(h==2?" second"+(m==1?"":"s"):h==1?"s":""))),g>=32&&(m=Math.round(1e3*_),p<32&&v.push('.000"ms"'),h==0?w.push((m>=100?"":m>=10?"0":"00")+m):w.push(m+(h==2?" millisecond"+(m==1?"":"s"):h==1?"ms":""))),t.w=w.join(h==0?":":" "),t.z=v.join(h==0?'":"':" "),h==0&&(t.w=t.w.replace(/:(\d\d\d)$/,".$1"))}}function d$(t,e,r,n){var i=Ps(t),s=i.getUint32(4,!0),a=-1,o=-1,l=-1,c=NaN,u=0,d=new Date(Date.UTC(2001,0,1)),h=r>1?12:8;s&2&&(l=i.getUint32(h,!0),h+=4),h+=vu(s&(r>1?3468:396))*4,s&512&&(a=i.getUint32(h,!0),h+=4),h+=vu(s&(r>1?12288:4096))*4,s&16&&(o=i.getUint32(h,!0),h+=4),s&32&&(c=i.getFloat64(h,!0),h+=8),s&64&&(d.setTime(d.getTime()+(u=i.getFloat64(h,!0))*1e3),h+=8),r>1&&(s=i.getUint32(8,!0)>>>16,s&255&&(l==-1&&(l=i.getUint32(h,!0)),h+=4));var p,g=t[r>=4?1:2];switch(g){case 0:return;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:e.sst[o]};break;case 5:n!=null&&n.cellDates?p={t:"d",v:d}:p={t:"n",v:u/86400+35430,z:ze[14]};break;case 6:p={t:"b",v:c>0};break;case 7:p={t:"n",v:c};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1){var x=e.rsst[a];p={t:"s",v:x.v},x.l&&(p.l={Target:x.l})}else throw new Error("Unsupported cell type ".concat(t[gr](0,4)));break;default:throw new Error("Unsupported cell type ".concat(t[gr](0,4)))}return l>-1&&EI(p,g|r<<8,s,e.ofmt[l],e.nfmt[l]),g==7&&(p.v/=86400),p}function p$(t,e,r){var n=Ps(t);n.getUint32(4,!0);var i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=-1,c=NaN,u=NaN,d=0,h=new Date(Date.UTC(2001,0,1));i&1&&(c=c$(t,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+(d=n.getFloat64(s,!0))*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4),s+=vu(i&480)*4,i&512&&(n.getUint32(s,!0),s+=4),s+=vu(i&1024)*4,i&2048&&(n.getUint32(s,!0),s+=4);var p,g=t[1];switch(g){case 0:p={t:"z"};break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:e.sst[o]};break;case 5:r!=null&&r.cellDates?p={t:"d",v:h}:p={t:"n",v:d/86400+35430,z:ze[14]};break;case 6:p={t:"b",v:u>0};break;case 7:p={t:"n",v:u};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1){var x=e.rsst[a];p={t:"s",v:x.v},x.l&&(p.l={Target:x.l})}else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t[gr](0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t[gr](0,4)))}if(s+=vu(i&4096)*4,i&516096&&(l==-1&&(l=n.getUint32(s,!0)),s+=4),i&524288){var _=n.getUint32(s,!0);s+=4,e.cmnt[_]&&(p.c=v$(e.cmnt[_]))}return l>-1&&EI(p,g|1280,i>>13,e.ofmt[l],e.nfmt[l]),g==7&&(p.v/=86400),p}function km(t,e){var r=new Uint8Array(32),n=Ps(r),i=12,s=0;switch(r[0]=5,t.t){case"n":if(t.z&&gi(t.z)){r[1]=5,n.setFloat64(i,(Es(t.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break}else r[1]=2,u$(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":{var a=t.v==null?"":String(t.v);if(t.l){var o=e.rsst.findIndex(function(c){var u;return c.v==a&&c.l==((u=t.l)==null?void 0:u.Target)});o==-1&&(e.rsst[o=e.rsst.length]={v:a,l:t.l.Target}),r[1]=9,n.setUint32(i,o,!0),s|=16,i+=4}else{var l=e.sst.indexOf(a);l==-1&&(e.sst[l=e.sst.length]=a),r[1]=3,n.setUint32(i,l,!0),s|=8,i+=4}}break;case"d":r[1]=5,n.setFloat64(i,(t.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+t.t}return t.c&&(e.cmnt.push(x$(t.c)),n.setUint32(i,e.cmnt.length-1,!0),s|=524288,i+=4),n.setUint32(8,s,!0),r[gr](0,i)}function Sm(t,e){var r=new Uint8Array(32),n=Ps(r),i=12,s=0,a="";switch(r[0]=4,t.t){case"n":break;case"b":break;case"s":if(a=t.v==null?"":String(t.v),t.l){var o=e.rsst.findIndex(function(c){var u;return c.v==a&&c.l==((u=t.l)==null?void 0:u.Target)});o==-1&&(e.rsst[o=e.rsst.length]={v:a,l:t.l.Target}),r[1]=9,n.setUint32(i,o,!0),s|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+t.t}switch(t.c&&(n.setUint32(i,e.cmnt.length-1,!0),s|=4096,i+=4),t.t){case"n":r[1]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(a=t.v==null?"":String(t.v),!t.l){var l=e.sst.indexOf(a);l==-1&&(e.sst[l=e.sst.length]=a),r[1]=3,n.setUint32(i,l,!0),s|=16,i+=4}break;case"d":r[1]=5,n.setFloat64(i,(t.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,i+=8;break;case"z":r[1]=0;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r[gr](0,i)}function m$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:case 4:return d$(t,e,t[0],r);case 5:return p$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function lt(t){var e=Fe(t);return ut(e[1][0].data)}function on(t){return We([[],[{type:0,data:Ue(t)}]])}function an(t,e){var r,n=(r=t.messages[0].meta[5])!=null&&r[0]?yI(t.messages[0].meta[5][0].data):[],i=n.indexOf(e);i==-1&&(n.push(e),t.messages[0].meta[5]=[{type:2,data:wI(n)}])}function us(t,e){var r,n=(r=t.messages[0].meta[5])!=null&&r[0]?yI(t.messages[0].meta[5][0].data):[];t.messages[0].meta[5]=[{type:2,data:wI(n.filter(function(i){return i!=e}))}]}function ba(t,e){var r=Fe(e.data),n=ut(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o,l,c=Fe(a.data);if(c[1]){var u=ut(c[1][0].data)>>>0;switch(n){case 1:s[u]=Oi(c[3][0].data);break;case 8:{var d=t[lt(c[9][0].data)][0],h=Fe(d.data),p=t[lt(h[1][0].data)][0],g=ut(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var x=Fe(p.data),_={v:x[3].map(function(v){return Oi(v.data)}).join("")};s[u]=_;e:if((o=x==null?void 0:x[11])!=null&&o[0]){var m=(l=Fe(x[11][0].data))==null?void 0:l[1];if(!m)break e;m.forEach(function(v){var R,U,H,E=Fe(v.data);if((R=E[2])!=null&&R[0]){var T=t[lt((U=E[2])==null?void 0:U[0].data)][0],k=ut(T.meta[1][0].data);switch(k){case 2032:var C=Fe(T.data);(H=C==null?void 0:C[2])!=null&&H[0]&&!_.l&&(_.l=Oi(C[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(k))}}})}}break;case 2:s[u]=Fe(c[6][0].data);break;case 3:s[u]=Fe(c[5][0].data);break;case 10:{var w=t[lt(c[10][0].data)][0];s[u]=TI(t,w.data)}break;default:throw n}}}),s}function g$(t,e){var r,n,i,s,a,o,l,c,u,d,h,p,g,x,_=Fe(t),m=ut(_[1][0].data)>>>0,w=ut(_[2][0].data)>>>0,v=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&ut(_[8][0].data)>0||!1,R,U;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)R=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,U=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=_[4])==null?void 0:u[0])!=null&&d.data&&e!=1)R=(p=(h=_[4])==null?void 0:h[0])==null?void 0:p.data,U=(x=(g=_[3])==null?void 0:g[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=v?4:1,E=Ps(R),T=[],k=0;k<R.length/2;++k){var C=E.getUint16(k*2,!0);C<65535&&T.push([k,C])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var A=[];for(k=0;k<T.length-1;++k)A[T[k][0]]=U[gr](T[k][1]*H,T[k+1][1]*H);return T.length>=1&&(A[T[T.length-1][0]]=U[gr](T[T.length-1][1]*H)),{R:m,cells:A}}function _$(t,e){var r,n=Fe(e.data),i=-1;(r=n==null?void 0:n[7])!=null&&r[0]&&(ut(n[7][0].data)>>>0?i=1:i=0);var s=Eo(n[5],function(a){return g$(a,i)});return{nrows:ut(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function TI(t,e){var r,n,i,s,a,o,l,c,u,d,h={t:"",a:""},p=Fe(e);if((n=(r=p==null?void 0:p[1])==null?void 0:r[0])!=null&&n.data&&(h.t=Oi((s=(i=p==null?void 0:p[1])==null?void 0:i[0])==null?void 0:s.data)||""),(o=(a=p==null?void 0:p[3])==null?void 0:a[0])!=null&&o.data){var g=t[lt((c=(l=p==null?void 0:p[3])==null?void 0:l[0])==null?void 0:c.data)][0],x=Fe(g.data);(d=(u=x[1])==null?void 0:u[0])!=null&&d.data&&(h.a=Oi(x[1][0].data))}return p!=null&&p[4]&&(h.replies=[],p[4].forEach(function(_){var m=t[lt(_.data)][0];h.replies.push(TI(t,m.data))})),h}function v$(t){var e=[];return e.push({t:t.t||"",a:t.a,T:t.replies&&t.replies.length>0}),t.replies&&t.replies.forEach(function(r){e.push({t:r.t||"",a:r.a,T:!0})}),e}function x$(t){for(var e={a:"",t:"",replies:[]},r=0;r<t.length;++r)r==0?(e.a=t[r].a,e.t=t[r].t):e.replies.push({a:t[r].a,t:t[r].t});return e}function y$(t,e,r,n){var i,s,a,o,l,c,u,d,h,p,g=Fe(e.data),x={s:{r:0,c:0},e:{r:0,c:0}};if(x.e.r=(ut(g[6][0].data)>>>0)-1,x.e.r<0)throw new Error("Invalid row varint ".concat(g[6][0].data));if(x.e.c=(ut(g[7][0].data)>>>0)-1,x.e.c<0)throw new Error("Invalid col varint ".concat(g[7][0].data));r["!ref"]=Je(x);var _=r["!data"]!=null,m=r,w=Fe(g[4][0].data),v=h$();(i=w[4])!=null&&i[0]&&(v.sst=ba(t,t[lt(w[4][0].data)][0])),(s=w[6])!=null&&s[0]&&(v.fmla=ba(t,t[lt(w[6][0].data)][0])),(a=w[11])!=null&&a[0]&&(v.ofmt=ba(t,t[lt(w[11][0].data)][0])),(o=w[12])!=null&&o[0]&&(v.ferr=ba(t,t[lt(w[12][0].data)][0])),(l=w[17])!=null&&l[0]&&(v.rsst=ba(t,t[lt(w[17][0].data)][0])),(c=w[19])!=null&&c[0]&&(v.cmnt=ba(t,t[lt(w[19][0].data)][0])),(u=w[22])!=null&&u[0]&&(v.nfmt=ba(t,t[lt(w[22][0].data)][0]));var R=Fe(w[3][0].data),U=0;if(!((d=w[9])!=null&&d[0]))throw"NUMBERS file missing row tree";var H=Fe(w[9][0].data)[1].map(function(k){return Fe(k.data)});if(H.forEach(function(k){U=ut(k[1][0].data);var C=ut(k[2][0].data),A=R[1][C];if(!A)throw"NUMBERS missing tile "+C;var b=Fe(A.data),N=t[lt(b[2][0].data)][0],we=ut(N.meta[1][0].data);if(we!=6002)throw new Error("6001 unexpected reference to ".concat(we));var he=_$(t,N);he.data.forEach(function(Re,de){Re.forEach(function(re,ye){var X=m$(re,v,n);X&&(_?(m["!data"][U+de]||(m["!data"][U+de]=[]),m["!data"][U+de][ye]=X):r[et(ye)+ht(U+de)]=X)})}),U+=he.nrows}),(h=w[13])!=null&&h[0]){var E=t[lt(w[13][0].data)][0],T=ut(E.meta[1][0].data);if(T!=6144)throw new Error("Expected merge type 6144, found ".concat(T));r["!merges"]=(p=Fe(E.data))==null?void 0:p[1].map(function(k){var C=Fe(k.data),A=Ps(Fe(C[1][0].data)[1][0].data),b=Ps(Fe(C[2][0].data)[1][0].data);return{s:{r:A.getUint16(0,!0),c:A.getUint16(2,!0)},e:{r:A.getUint16(0,!0)+b.getUint16(0,!0)-1,c:A.getUint16(2,!0)+b.getUint16(2,!0)-1}}})}}function w$(t,e,r){var n=Fe(e.data),i={"!ref":"A1"};r!=null&&r.dense&&(i["!data"]=[]);var s=t[lt(n[2][0].data)],a=ut(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return y$(t,s[0],i,r),i}function E$(t,e,r){var n,i=Fe(e.data),s={name:(n=i[1])!=null&&n[0]?Oi(i[1][0].data):"",sheets:[]},a=Eo(i[2],lt);return a.forEach(function(o){t[o].forEach(function(l){var c=ut(l.meta[1][0].data);c==6e3&&s.sheets.push(w$(t,l,r))})}),s}function T$(t,e,r){var n,i=Yv();i.Workbook={WBProps:{date1904:!0}};var s=Fe(e.data);if((n=s[2])!=null&&n[0])throw new Error("Keynote presentations are not supported");var a=Eo(s[1],lt);if(a.forEach(function(o){t[o].forEach(function(l){var c=ut(l.meta[1][0].data);if(c==2){var u=E$(t,l,r);u.sheets.forEach(function(d,h){jf(i,d,h==0?u.name:u.name+"_"+h,!0)})}})}),i.SheetNames.length==0)throw new Error("Empty NUMBERS file");return i.bookType="numbers",i}function Cm(t,e){var r,n,i,s,a,o,l,c={},u=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)&&h.content[0]==0){var p;try{p=mf(h.content)}catch(x){return console.log("?? "+h.content.length+" "+(x.message||x))}var g;try{g=pf(p)}catch(x){return console.log("## "+(x.message||x))}g.forEach(function(x){c[x.id]=x.messages,u.push(x.id)})}}),!u.length)throw new Error("File has no messages");if((i=(n=(r=c==null?void 0:c[1])==null?void 0:r[0].meta)==null?void 0:n[1])!=null&&i[0].data&&ut(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var d=((l=(o=(a=(s=c==null?void 0:c[1])==null?void 0:s[0])==null?void 0:a.meta)==null?void 0:o[1])==null?void 0:l[0].data)&&ut(c[1][0].meta[1][0].data)==1&&c[1][0];if(d||u.forEach(function(h){c[h].forEach(function(p){var g=ut(p.meta[1][0].data)>>>0;if(g==1)if(!d)d=p;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return T$(c,d,e)}function k$(t,e,r){var n,i,s,a=[[],[{type:0,data:Ue(0)}],[{type:0,data:Ue(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ue(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ue(1)}]];if(!((n=a[6])!=null&&n[0])||!((i=a[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=0;if(a[7][0].data.length<2*t.length){var l=new Uint8Array(2*t.length);l.set(a[7][0].data),a[7][0].data=l}if(a[4][0].data.length<2*t.length){var c=new Uint8Array(2*t.length);c.set(a[4][0].data),a[4][0].data=c}for(var u=Ps(a[7][0].data),d=0,h=[],p=Ps(a[4][0].data),g=0,x=[],_=4,m=0;m<t.length;++m){if(t[m]==null||t[m].t=="z"&&!((s=t[m].c)!=null&&s.length)||t[m].t=="e"){u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535);continue}u.setUint16(m*2,d/_,!0),p.setUint16(m*2,g/_,!0);var w,v;switch(t[m].t){case"d":if(t[m].v instanceof Date){w=km(t[m],e),v=Sm(t[m],e);break}w=km(t[m],e),v=Sm(t[m],e);break;case"s":case"n":case"b":case"z":w=km(t[m],e),v=Sm(t[m],e);break;default:throw new Error("Unsupported value "+t[m])}h.push(w),d+=w.length,x.push(v),g+=v.length,++o}for(a[2][0].data=Ue(o),a[5][0].data=Ue(5);m<a[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535,!0);return a[6][0].data=Ea(h),a[3][0].data=Ea(x),a[8]=[{type:0,data:Ue(1)}],a}function hg(t,e){return{meta:[[],[{type:0,data:Ue(t)}]],data:e}}function Hi(t,e){e.last||(e.last=927262);for(var r=e.last;r<2e6;++r)if(!e[r])return e[e.last=r]=t,r;throw new Error("Too many messages")}function S$(t){var e={},r=[];return t.FileIndex.map(function(n,i){return[n,t.FullPaths[i]]}).forEach(function(n){var i=n[0],s=n[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&pf(mf(i.content)).forEach(function(a){r.push(a.id),e[a.id]={deps:[],location:s,type:ut(a.messages[0].meta[1][0].data)}})}),t.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&pf(mf(n.content)).forEach(function(i){i.messages.forEach(function(s){[5,6].forEach(function(a){s.meta[a]&&s.meta[a].forEach(function(o){e[i.id].deps.push(ut(o.data))})})})})}),e}function V0(t,e,r){return We([[],[{type:0,data:Ue(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:Ue(1)}]])}function AE(t){switch(t){case 0:return V0(99,222,171);case 1:return V0(162,197,240);case 2:return V0(255,189,189)}return V0(Math.random()*255,Math.random()*255,Math.random()*255)}function C$(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=He.read(e.numbers,{type:"base64"}),n=S$(r),i=$i(r,n,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var s=Eo(Fe(i.messages[0].data)[1],lt);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return t.SheetNames.forEach(function(a,o){o>=1&&(I$(r,n,o+1),i=$i(r,n,1),s=Eo(Fe(i.messages[0].data)[1],lt)),F$(r,n,t.Sheets[a],a,o,s[o])}),r}function Ot(t,e,r,n){var i=He.find(t,e[r].location);if(!i)throw"Could not find ".concat(e[r].location," in Numbers template");var s=pf(mf(i.content)),a=s.find(function(o){return o.id==r});n(a,s),i.content=Cl(Sl(s)),i.size=i.content.length}function $i(t,e,r){var n=He.find(t,e[r].location);if(!n)throw"Could not find ".concat(e[r].location," in Numbers template");var i=pf(mf(n.content)),s=i.find(function(a){return a.id==r});return s}function dg(t,e,r){t[3].push({type:2,data:We([[],[{type:0,data:Ue(e)}],[{type:2,data:wn(r.replace(/-.*$/,""))}],[{type:2,data:wn(r)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ue(0)}],[],[{type:0,data:Ue(0)}]])}),t[1]=[{type:0,data:Ue(Math.max(e+1,ut(t[1][0].data)))}]}function Oa(t,e,r,n,i,s){s||(s=Hi({deps:[],location:"",type:e},i));var a="".concat(n,"-").concat(s,".iwa");i[s].location="Root Entry"+a,He.utils.cfb_add(t,a,Cl(Sl([{id:s,messages:[hg(e,We(r))]}])));var o=a.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return Ot(t,i,2,function(l){var c=Fe(l.messages[0].data);dg(c,s||0,o),l.messages[0].data=We(c)}),s}function Dn(t,e,r,n){var i=e[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=t[3].findIndex(function(o){var l,c,u=Fe(o.data);return(l=u[3])!=null&&l[0]?Oi(u[3][0].data)==i:!!((c=u[2])!=null&&c[0]&&Oi(u[2][0].data)==i)}),a=Fe(t[3][s].data);a[6]||(a[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(o){a[6].push({type:2,data:We([[],[{type:0,data:Ue(o)}]])})}),t[3][s].data=We(a)}function A$(t,e,r,n){var i=e[r].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=t[3].findIndex(function(o){var l,c,u=Fe(o.data);return(l=u[3])!=null&&l[0]?Oi(u[3][0].data)==i:!!((c=u[2])!=null&&c[0]&&Oi(u[2][0].data)==i)}),a=Fe(t[3][s].data);a[6]||(a[6]=[]),a[6]=a[6].filter(function(o){return ut(Fe(o.data)[1][0].data)!=n}),t[3][s].data=We(a)}function I$(t,e,r){var n=-1,i=-1,s={};Ot(t,e,1,function(l,c){var u=Fe(l.messages[0].data);n=lt(Fe(l.messages[0].data)[1][0].data),i=Hi({deps:[1],location:e[n].location,type:2},e),s[n]=i,an(l,i),u[1].push({type:2,data:on(i)});var d=$i(t,e,n);d.id=i,e[1].location==e[i].location?c.push(d):Ot(t,e,i,function(h,p){return p.push(d)}),l.messages[0].data=We(u)});var a=-1;Ot(t,e,i,function(l,c){for(var u=Fe(l.messages[0].data),d=3;d<=69;++d)delete u[d];var h=Eo(u[2],lt);h.forEach(function(g){return us(l,g)}),a=Hi({deps:[i],location:e[h[0]].location,type:e[h[0]].type},e),an(l,a),s[h[0]]=a,u[2]=[{type:2,data:on(a)}];var p=$i(t,e,h[0]);p.id=a,e[h[0]].location==e[i].location?c.push(p):(Ot(t,e,2,function(g){var x=Fe(g.messages[0].data);Dn(x,e,i,a),g.messages[0].data=We(x)}),Ot(t,e,a,function(g,x){return x.push(p)})),l.messages[0].data=We(u)});var o=-1;Ot(t,e,a,function(l,c){for(var u=Fe(l.messages[0].data),d=Fe(u[1][0].data),h=3;h<=69;++h)delete d[h];var p=lt(d[2][0].data);d[2][0].data=on(s[p]),u[1][0].data=We(d);var g=lt(u[2][0].data);us(l,g),o=Hi({deps:[a],location:e[g].location,type:e[g].type},e),an(l,o),s[g]=o,u[2][0].data=on(o);var x=$i(t,e,g);x.id=o,e[a].location==e[o].location?c.push(x):Ot(t,e,o,function(_,m){return m.push(x)}),l.messages[0].data=We(u)}),Ot(t,e,o,function(l,c){var u,d,h=Fe(l.messages[0].data),p=Oi(h[1][0].data),g=p.replace(/-[A-Z0-9]*/,"-".concat(("0000"+r.toString(16)).slice(-4)));if(h[1][0].data=wn(g),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(U){return delete h[U]}),h[45]){var x=Fe(h[45][0].data),_=lt(x[1][0].data);us(l,_),delete h[45]}if(h[70]){var m=Fe(h[70][0].data);(u=m[2])==null||u.forEach(function(U){var H=Fe(U.data);[2,3].map(function(E){return H[E][0]}).forEach(function(E){var T=Fe(E.data);if(T[8]){var k=lt(T[8][0].data);us(l,k)}})}),delete h[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(U){if(h[U]){var H=lt(h[U][0].data);delete h[U],us(l,H)}});var w=Fe(h[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(U){var H;if((H=w[U])!=null&&H[0]){var E=lt(w[U][0].data),T=Hi({deps:[o],location:e[E].location,type:e[E].type},e);us(l,E),an(l,T),s[E]=T;var k=$i(t,e,E);if(k.id=T,e[E].location==e[o].location)c.push(k);else{e[T].location=e[E].location.replace(E.toString(),T.toString()),e[T].location==e[E].location&&(e[T].location=e[T].location.replace(/\.iwa/,"-".concat(T,".iwa"))),He.utils.cfb_add(t,e[T].location,Cl(Sl([k])));var C=e[T].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Ot(t,e,2,function(A){var b=Fe(A.messages[0].data);dg(b,T,C),Dn(b,e,o,T),A.messages[0].data=We(b)})}w[U][0].data=on(T)}});var v=Fe(w[1][0].data);(d=v[2])==null||d.forEach(function(U){var H=lt(U.data),E=Hi({deps:[o],location:e[H].location,type:e[H].type},e);us(l,H),an(l,E),s[H]=E;var T=$i(t,e,H);if(T.id=E,e[H].location==e[o].location)c.push(T);else{e[E].location=e[H].location.replace(H.toString(),E.toString()),e[E].location==e[H].location&&(e[E].location=e[E].location.replace(/\.iwa/,"-".concat(E,".iwa"))),He.utils.cfb_add(t,e[E].location,Cl(Sl([T])));var k=e[E].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Ot(t,e,2,function(C){var A=Fe(C.messages[0].data);dg(A,E,k),Dn(A,e,o,E),C.messages[0].data=We(A)})}U.data=on(E)}),w[1][0].data=We(v);var R=Fe(w[3][0].data);R[1].forEach(function(U){var H=Fe(U.data),E=lt(H[2][0].data),T=s[E];if(!s[E]){T=Hi({deps:[o],location:"",type:e[E].type},e),e[T].location="Root Entry/Index/Tables/Tile-".concat(T,".iwa"),s[E]=T;var k=$i(t,e,E);k.id=T,us(l,E),an(l,T),He.utils.cfb_add(t,"/Index/Tables/Tile-".concat(T,".iwa"),Cl(Sl([k]))),Ot(t,e,2,function(C){var A=Fe(C.messages[0].data);A[3].push({type:2,data:We([[],[{type:0,data:Ue(T)}],[{type:2,data:wn("Tables/Tile")}],[{type:2,data:wn("Tables/Tile-".concat(T))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ue(0)}],[],[{type:0,data:Ue(0)}]])}),A[1]=[{type:0,data:Ue(Math.max(T+1,ut(A[1][0].data)))}],Dn(A,e,o,T),C.messages[0].data=We(A)})}H[2][0].data=on(T),U.data=We(H)}),w[3][0].data=We(R)}h[4][0].data=We(w),l.messages[0].data=We(h)})}function F$(t,e,r,n,i,s){var a=[];Ot(t,e,s,function(c){var u=Fe(c.messages[0].data);u[1]=[{type:2,data:wn(n)}],a=Eo(u[2],lt),c.messages[0].data=We(u)});var o=$i(t,e,a[0]),l=lt(Fe(o.messages[0].data)[2][0].data);Ot(t,e,l,function(c,u){return N$(t,e,r,c,u,l)})}function N$(t,e,r,n,i,s){if(!r["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var a=Vr(r["!ref"]);a.s.r=a.s.c=0;var o=!1;a.e.c>999&&(o=!0,a.e.c=999),a.e.r>999999&&(o=!0,a.e.r=999999),o&&console.error("Truncating to ".concat(Je(a)));var l=[];if(r["!data"])l=r["!data"];else{for(var c=[],u=0;u<=a.e.c;++u)c[u]=et(u);for(var d=0;d<=a.e.r;++d){l[d]=[];var h=""+(d+1);for(u=0;u<=a.e.c;++u){var p=r[c[u]+h];p&&(l[d][u]=p)}}}var g={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},x=Fe(n.messages[0].data);{x[6][0].data=Ue(a.e.r+1),x[7][0].data=Ue(a.e.c+1),delete x[46];var _=Fe(x[4][0].data);{var m=lt(Fe(_[1][0].data)[2][0].data);Ot(t,e,m,function(ce,fe){var le,De=Fe(ce.messages[0].data);if((le=De==null?void 0:De[2])!=null&&le[0])for(var K=0;K<l.length;++K){var se=Fe(De[2][0].data);se[1][0].data=Ue(K),se[4][0].data=Ue(l[K].length),De[2][K]={type:De[2][0].type,data:We(se)}}ce.messages[0].data=We(De)});var w=lt(_[2][0].data);Ot(t,e,w,function(ce,fe){for(var le=Fe(ce.messages[0].data),De=0;De<=a.e.c;++De){var K=Fe(le[2][0].data);K[1][0].data=Ue(De),K[4][0].data=Ue(a.e.r+1),le[2][De]={type:le[2][0].type,data:We(K)}}ce.messages[0].data=We(le)});var v=Fe(_[9][0].data);v[1]=[];var R=Fe(_[3][0].data);{var U=256;R[2]=[{type:0,data:Ue(U)}];var H=lt(Fe(R[1][0].data)[2][0].data),E=function(){var ce=$i(t,e,2),fe=Fe(ce.messages[0].data),le=fe[3].filter(function(De){return ut(Fe(De.data)[1][0].data)==H});return le!=null&&le.length?ut(Fe(le[0].data)[12][0].data):0}();He.utils.cfb_del(t,e[H].location),Ot(t,e,2,function(ce){var fe=Fe(ce.messages[0].data);fe[3]=fe[3].filter(function(le){return ut(Fe(le.data)[1][0].data)!=H}),A$(fe,e,s,H),ce.messages[0].data=We(fe)}),us(n,H),R[1]=[];for(var T=Math.ceil((a.e.r+1)/U),k=0;k<T;++k){var C=Hi({deps:[],location:"",type:6002},e);e[C].location="Root Entry/Index/Tables/Tile-".concat(C,".iwa");for(var A=[[],[{type:0,data:Ue(0)}],[{type:0,data:Ue(Math.min(a.e.r+1,(k+1)*U))}],[{type:0,data:Ue(0)}],[{type:0,data:Ue(Math.min((k+1)*U,a.e.r+1)-k*U)}],[],[{type:0,data:Ue(5)}],[{type:0,data:Ue(1)}],[{type:0,data:Ue(1)}]],b=k*U;b<=Math.min(a.e.r,(k+1)*U-1);++b){var N=k$(l[b],g);N[1][0].data=Ue(b-k*U),A[5].push({data:We(N),type:2})}R[1].push({type:2,data:We([[],[{type:0,data:Ue(k)}],[{type:2,data:on(C)}]])});var we={id:C,messages:[hg(6002,We(A))]},he=Cl(Sl([we]));He.utils.cfb_add(t,"/Index/Tables/Tile-".concat(C,".iwa"),he),Ot(t,e,2,function(ce){var fe=Fe(ce.messages[0].data);fe[3].push({type:2,data:We([[],[{type:0,data:Ue(C)}],[{type:2,data:wn("Tables/Tile")}],[{type:2,data:wn("Tables/Tile-".concat(C))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ue(0)}],[],[{type:0,data:Ue(E)}]])}),fe[1]=[{type:0,data:Ue(Math.max(C+1,ut(fe[1][0].data)))}],Dn(fe,e,s,C),ce.messages[0].data=We(fe)}),an(n,C),v[1].push({type:2,data:We([[],[{type:0,data:Ue(k*U)}],[{type:0,data:Ue(k)}]])})}}if(_[3][0].data=We(R),_[9][0].data=We(v),_[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var Re=Hi({type:6144,deps:[s],location:e[s].location},e);i.push({id:Re,messages:[hg(6144,We([[],r["!merges"].map(function(ce){return{type:2,data:We([[],[{type:2,data:We([[],[{type:5,data:new Uint8Array(new Uint16Array([ce.s.r,ce.s.c]).buffer)}]])}],[{type:2,data:We([[],[{type:5,data:new Uint8Array(new Uint16Array([ce.e.r-ce.s.r+1,ce.e.c-ce.s.c+1]).buffer)}]])}]])}})]))]}),_[13]=[{type:2,data:on(Re)}],Ot(t,e,2,function(ce){var fe=Fe(ce.messages[0].data);Dn(fe,e,s,Re),ce.messages[0].data=We(fe)}),an(n,Re)}else delete _[13];var de=lt(_[4][0].data);Ot(t,e,de,function(ce){var fe=Fe(ce.messages[0].data);fe[3]=[],g.sst.forEach(function(le,De){De!=0&&fe[3].push({type:2,data:We([[],[{type:0,data:Ue(De)}],[{type:0,data:Ue(1)}],[{type:2,data:wn(le)}]])})}),ce.messages[0].data=We(fe)});var re=lt(_[17][0].data);if(Ot(t,e,re,function(ce){var fe=Fe(ce.messages[0].data);fe[3]=[];var le=[904980,903835,903815,903845];g.rsst.forEach(function(De,K){if(K!=0){var se=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:wn(De.v)}]];se[10]=[{type:0,data:new Uint8Array([1])}],se[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],se[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],se[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],se[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],se[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],se[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],se[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],se[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var F=Hi({deps:[],location:"",type:2001},e),G=[];if(De.l){var W=Oa(t,2032,[[],[],[{type:2,data:wn(De.l)}]],"/Index/Tables/DataList",e);se[11]=[];var z=[[],[]];z[1]||(z[1]=[]),z[1].push({type:2,data:We([[],[{type:0,data:Ue(0)}],[{type:2,data:on(W)}]])}),se[11][0]={type:2,data:We(z)},G.push(W)}Oa(t,2001,se,"/Index/Tables/DataList",e,F),Ot(t,e,F,function(O){le.forEach(function(ae){return an(O,ae)}),G.forEach(function(ae){return an(O,ae)})});var Q=Oa(t,6218,[[],[{type:2,data:on(F)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",e);Ot(t,e,Q,function(O){return an(O,F)}),fe[3].push({type:2,data:We([[],[{type:0,data:Ue(K)}],[{type:0,data:Ue(1)}],[],[],[],[],[],[],[{type:2,data:on(Q)}]])}),an(ce,Q),Ot(t,e,2,function(O){var ae=Fe(O.messages[0].data);Dn(ae,e,re,Q),Dn(ae,e,Q,F),Dn(ae,e,F,G),Dn(ae,e,F,le),O.messages[0].data=We(ae)})}}),ce.messages[0].data=We(fe)}),g.cmnt.length>1){var ye=lt(_[19][0].data),X={},Ce=0;Ot(t,e,ye,function(ce){var fe=Fe(ce.messages[0].data);fe[3]=[],g.cmnt.forEach(function(le,De){if(De!=0){var K=[];le.replies&&le.replies.forEach(function(G){X[G.a||""]||(X[G.a||""]=Oa(t,212,[[],[{type:2,data:wn(G.a||"")}],[{type:2,data:AE(++Ce)}],[],[{type:0,data:Ue(0)}]],"/Index/Tables/DataList",e));var W=X[G.a||""],z=Oa(t,3056,[[],[{type:2,data:wn(G.t||"")}],[{type:2,data:We([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:on(W)}]],"/Index/Tables/DataList",e);Ot(t,e,z,function(Q){return an(Q,W)}),K.push(z),Ot(t,e,2,function(Q){var O=Fe(Q.messages[0].data);Dn(O,e,z,W),Q.messages[0].data=We(O)})}),X[le.a||""]||(X[le.a||""]=Oa(t,212,[[],[{type:2,data:wn(le.a||"")}],[{type:2,data:AE(++Ce)}],[],[{type:0,data:Ue(0)}]],"/Index/Tables/DataList",e));var se=X[le.a||""],F=Oa(t,3056,[[],[{type:2,data:wn(le.t||"")}],[{type:2,data:We([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:on(se)}],K.map(function(G){return{type:2,data:on(G)}}),[{type:2,data:We([[],[{type:0,data:Ue(De)}],[{type:0,data:Ue(0)}]])}]],"/Index/Tables/DataList",e);Ot(t,e,F,function(G){an(G,se),K.forEach(function(W){return an(G,W)})}),fe[3].push({type:2,data:We([[],[{type:0,data:Ue(De)}],[{type:0,data:Ue(1)}],[],[],[],[],[],[],[],[{type:2,data:on(F)}]])}),an(ce,F),Ot(t,e,2,function(G){var W=Fe(G.messages[0].data);Dn(W,e,ye,F),Dn(W,e,F,se),K.length&&Dn(W,e,F,K),G.messages[0].data=We(W)})}}),fe[2][0].data=Ue(g.cmnt.length+1),ce.messages[0].data=We(fe)})}}x[4][0].data=We(_)}n.messages[0].data=We(x)}function kI(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Gv(t){kI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Xv(t){kI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function R$(t){return nt.WS.indexOf(t)>-1?"sheet":t==nt.CS?"chart":t==nt.DS?"dialog":t==nt.MS?"macro":t&&t.length?t:"sheet"}function P$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,R$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function D$(t,e,r,n,i,s,a,o){if(!(!t||!t["!legdrawel"])){var l=ul(t["!legdrawel"].Target,n),c=Sn(r,l,!0);c&&AV(Rt(c),t,o||[])}}function b$(t,e,r,n,i,s,a,o,l,c,u,d){try{s[n]=du(Sn(t,r,!0),e);var h=Er(t,e),p;switch(o){case"sheet":p=Zz(h,e,i,l,s[n],c,u,d);break;case"chart":if(p=eH(h,e,i,l,s[n],c,u,d),!p||!p["!drawel"])break;var g=ul(p["!drawel"].Target,e),x=of(g),_=SV(Sn(t,g,!0),du(Sn(t,x,!0),g)),m=ul(_,g),w=of(m);p=Ez(Sn(t,m,!0),m,l,du(Sn(t,w,!0),m),c,p);break;case"macro":p=tH(h,e,i,l,s[n],c,u,d);break;case"dialog":p=rH(h,e,i,l,s[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var v=[],R=[];s&&s[n]&&Xt(s[n]).forEach(function(U){var H="";if(s[n][U].Type==nt.CMNT){if(H=ul(s[n][U].Target,e),v=sH(Er(t,H,!0),H,l),!v||!v.length)return;uE(p,v,!1)}s[n][U].Type==nt.TCMNT&&(H=ul(s[n][U].Target,e),R=R.concat(RV(Er(t,H,!0),l)))}),R&&R.length&&uE(p,R,!0,l.people||[]),D$(p,o,t,e,i,l,c,v)}catch(U){if(l.WTF)throw U}}function ti(t){return t.charAt(0)=="/"?t.slice(1):t}function O$(t,e){if(lc(),e=e||{},Gv(e),ni(t,"META-INF/manifest.xml")||ni(t,"objectdata.xml"))return TE(t,e);if(ni(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cm<"u"){if(t.FileIndex)return Cm(t,e);var r=He.utils.cfb_new();return Rw(t).forEach(function(he){Ye(r,he,m9(t,he))}),Cm(r,e)}throw new Error("Unsupported NUMBERS file")}if(!ni(t,"[Content_Types].xml")){if(ni(t,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(ni(t,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=He.find(t,"Index.zip");if(n)return e=Bt(e),delete e.type,typeof n.content=="string"&&(e.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(n.content)?gf(new Uint8Array(n.content),e):gf(n.content,e);throw new Error("Unsupported ZIP file")}var i=Rw(t),s=cL(Sn(t,"[Content_Types].xml")),a=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",Er(t,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!Er(t,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!e.bookSheets&&!e.bookProps){if(pu=[],s.sst)try{pu=iH(Er(t,ti(s.sst)),s.sst,e)}catch(he){if(e.WTF)throw he}e.cellStyles&&s.themes.length&&(c=zA(Sn(t,s.themes[0].replace(/^\//,""),!0)||"",e)),s.style&&(u=nH(Er(t,ti(s.style)),s.style,c,e))}s.links.map(function(he){try{var Re=du(Sn(t,of(ti(he))),he);return oH(Er(t,ti(he)),Re,he,e)}catch{}});var d=Jz(Er(t,ti(s.workbooks[0])),s.workbooks[0],e),h={},p="";s.coreprops.length&&(p=Er(t,ti(s.coreprops[0]),!0),p&&(h=cA(p)),s.extprops.length!==0&&(p=Er(t,ti(s.extprops[0]),!0),p&&gL(p,h,e)));var g={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(p=Sn(t,ti(s.custprops[0]),!0),p&&(g=vL(p,e)));var x={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(Re){return Re.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=g),e.bookSheets&&typeof o<"u"&&(x.SheetNames=o),e.bookSheets?x.SheetNames:e.bookProps))return x;o={};var _={};e.bookDeps&&s.calcchain&&(_=aH(Er(t,ti(s.calcchain)),s.calcchain));var m=0,w={},v,R;{var U=d.Sheets;h.Worksheets=U.length,h.SheetNames=[];for(var H=0;H!=U.length;++H)h.SheetNames[H]=U[H].name}var E=a?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),k=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ni(t,k)||(k="xl/_rels/workbook."+E+".rels");var C=du(Sn(t,k,!0),k.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=lH(Er(t,ti(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=PV(Er(t,ti(s.people[0])),e)),C&&(C=P$(C,d.Sheets));var A=Er(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=h.Worksheets;++m){var b="sheet";if(C&&C[m]?(v="xl/"+C[m][1].replace(/[\/]?xl\//,""),ni(t,v)||(v=C[m][1]),ni(t,v)||(v=k.replace(/_rels\/.*$/,"")+C[m][1]),b=C[m][2]):(v="xl/worksheets/sheet"+(m+1-A)+"."+E,v=v.replace(/sheet0\./,"sheet.")),R=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(m!=e.sheets)continue e;break;case"string":if(h.SheetNames[m].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,we=0;we!=e.sheets.length;++we)typeof e.sheets[we]=="number"&&e.sheets[we]==m&&(N=1),typeof e.sheets[we]=="string"&&e.sheets[we].toLowerCase()==h.SheetNames[m].toLowerCase()&&(N=1);if(!N)continue e}}b$(t,v,R,h.SheetNames[m],m,w,o,b,e,d,c,u)}return x={Directory:s,Workbook:d,Props:h,Custprops:g,Deps:_,Sheets:o,SheetNames:h.SheetNames,Strings:pu,Styles:u,Themes:c,SSF:Bt(ze)},e&&e.bookFiles&&(t.files?(x.keys=i,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(he,Re){he=he.replace(/^Root Entry[\/]/,""),x.keys.push(he),x.files[he]=t.FileIndex[Re]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=Er(t,ti(s.vba[0]),!0):s.defaults&&s.defaults.bin===BV&&(x.vbaraw=Er(t,"xl/vbaProject.bin",!0))),x.bookType=a?"xlsb":"xlsx",x}function L$(t,e){var r=e||{},n="Workbook",i=He.find(t,n);try{if(n="/!DataSpaces/Version",i=He.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(z7(i.content),n="/!DataSpaces/DataSpaceMap",i=He.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=$7(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=He.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=G7(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=He.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);K7(i.content)}catch{}if(n="/EncryptionInfo",i=He.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=q7(i.content);if(n="/EncryptedPackage",i=He.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function M$(t,e){t&&!t.SSF&&(t.SSF=Bt(ze)),t&&t.SSF&&(lc(),Jd(t.SSF),e.revssf=ep(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,mu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="bin",n=!0,i=Ov();Xv(e=e||{});var s=Tv(),a="",o=0;if(e.cellXfs=[],Aa(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ye(s,a,uA(t.Props,e)),i.coreprops.push(a),At(e.rels,2,a,nt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Ye(s,a,dA(t.Props)),i.extprops.push(a),At(e.rels,3,a,nt.EXT_PROPS),t.Custprops!==t.Props&&Xt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ye(s,a,pA(t.Custprops)),i.custprops.push(a),At(e.rels,4,a,nt.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ye(s,a,yz(o-1,e,t,d)),i.sheets.push(a),At(e.wbrels,-1,"worksheets/sheet"+o+"."+r,nt.WS[0])}if(h){var g=h["!comments"],x=!1,_="";if(g&&g.length>0){var m=!1;g.forEach(function(v){v[1].forEach(function(R){R.T==!0&&(m=!0)})}),m&&(_="xl/threadedComments/threadedComment"+o+".xml",Ye(s,_,$A(g,u,e)),i.threadedcomments.push(_),At(d,-1,"../threadedComments/threadedComment"+o+".xml",nt.TCMNT)),_="xl/comments"+o+"."+r,Ye(s,_,MV(g)),i.comments.push(_),At(d,-1,"../comments"+o+"."+r,nt.CMNT),x=!0}h["!legacy"]&&x&&Ye(s,"xl/drawings/vmlDrawing"+o+".vml",HA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ye(s,of(a),Tl(d))}e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Ye(s,a,W7(e.Strings)),i.strs.push(a),At(e.wbrels,-1,"sharedStrings."+r,nt.SST)),a="xl/workbook."+r,Ye(s,a,Qz(t)),i.workbooks.push(a),At(e.rels,1,a,nt.WB),a="xl/theme/theme1.xml";var w=jv(t.Themes,e);return Ye(s,a,w),i.themes.push(a),At(e.wbrels,-1,"theme/theme1.xml",nt.THEME),a="xl/styles."+r,Ye(s,a,GB(t,e)),i.styles.push(a),At(e.wbrels,-1,"styles."+r,nt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ye(s,a,t.vbaraw),i.vba.push(a),At(e.wbrels,-1,"vbaProject.bin",nt.VBA)),a="xl/metadata."+r,Ye(s,a,vV()),i.metadata.push(a),At(e.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(a="xl/persons/person.xml",Ye(s,a,GA(u)),i.people.push(a),At(e.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Ye(s,"[Content_Types].xml",oA(i,e)),Ye(s,"_rels/.rels",Tl(e.rels)),Ye(s,"xl/_rels/workbook."+r+".rels",Tl(e.wbrels)),delete e.revssf,delete e.ssf,s}function B$(t,e){t&&!t.SSF&&(t.SSF=Bt(ze)),t&&t.SSF&&(lc(),Jd(t.SSF),e.revssf=ep(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,mu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=jV.indexOf(e.bookType)>-1,i=Ov();Xv(e=e||{});var s=Tv(),a="",o=0;if(e.cellXfs=[],Aa(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ye(s,a,uA(t.Props,e)),i.coreprops.push(a),At(e.rels,2,a,nt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Ye(s,a,dA(t.Props)),i.extprops.push(a),At(e.rels,3,a,nt.EXT_PROPS),t.Custprops!==t.Props&&Xt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ye(s,a,pA(t.Custprops)),i.custprops.push(a),At(e.rels,4,a,nt.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ye(s,a,oW(o-1,e,t,d)),i.sheets.push(a),At(e.wbrels,-1,"worksheets/sheet"+o+"."+r,nt.WS[0])}if(h){var g=h["!comments"],x=!1,_="";if(g&&g.length>0){var m=!1;g.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(m=!0)})}),m&&(_="xl/threadedComments/threadedComment"+o+".xml",Ye(s,_,$A(g,u,e)),i.threadedcomments.push(_),At(d,-1,"../threadedComments/threadedComment"+o+".xml",nt.TCMNT)),_="xl/comments"+o+"."+r,Ye(s,_,NV(g)),i.comments.push(_),At(d,-1,"../comments"+o+"."+r,nt.CMNT),x=!0}h["!legacy"]&&x&&Ye(s,"xl/drawings/vmlDrawing"+o+".vml",HA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ye(s,of(a),Tl(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Ye(s,a,M7(e.Strings,e)),i.strs.push(a),At(e.wbrels,-1,"sharedStrings."+r,nt.SST)),a="xl/workbook."+r,Ye(s,a,Oz(t)),i.workbooks.push(a),At(e.rels,1,a,nt.WB),a="xl/theme/theme1.xml",Ye(s,a,jv(t.Themes,e)),i.themes.push(a),At(e.wbrels,-1,"theme/theme1.xml",nt.THEME),a="xl/styles."+r,Ye(s,a,kB(t,e)),i.styles.push(a),At(e.wbrels,-1,"styles."+r,nt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ye(s,a,t.vbaraw),i.vba.push(a),At(e.wbrels,-1,"vbaProject.bin",nt.VBA)),a="xl/metadata."+r,Ye(s,a,yV()),i.metadata.push(a),At(e.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(a="xl/persons/person.xml",Ye(s,a,GA(u)),i.people.push(a),At(e.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Ye(s,"[Content_Types].xml",oA(i,e)),Ye(s,"_rels/.rels",Tl(e.rels)),Ye(s,"xl/_rels/workbook."+r+".rels",Tl(e.wbrels)),delete e.revssf,delete e.ssf,s}function Kv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Qn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function V$(t,e){return He.find(t,"EncryptedPackage")?L$(t,e):fI(t,e)}function U$(t,e){var r,n=t,i=e||{};return i.type||(i.type=st&&Buffer.isBuffer(t)?"buffer":"base64"),r=MC(n,i),O$(r,i)}function SI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ug(t.slice(r),e);default:break e}return Kl.to_workbook(t,e)}function j$(t,e){var r="",n=Kv(t,e);switch(e.type){case"base64":r=Qn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=_o(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Rt(r)),e.type="binary",SI(r,e)}function W$(t,e){var r=t;return e.type=="base64"&&(r=Qn(r)),typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer&&(r=new Uint8Array(t)),r=st&&Buffer.isBuffer(t)?t.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&r instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(r.slice(2)):wO(r.slice(2)):EC(r.slice(2)),e.type="binary",SI(r,e)}function z$(t){return t.match(/[^\x00-\x7F]/)?qi(t):t}function Am(t,e,r,n){return n?(r.type="string",Kl.to_workbook(t,r)):Kl.to_workbook(e,r)}function gf(t,e){vv();var r=e||{};if(r.codepage&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return gf(new Uint8Array(t),(r=Bt(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),kl={},r.dateNF&&(kl.dateNF=r.dateNF),r.type||(r.type=st&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=st?"buffer":"binary",n=ZO(t),typeof Uint8Array<"u"&&!st&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=z$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Bt(r),r.type="array",gf(xv(n),r)}switch((i=Kv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return V$(He.read(n,r),r);break;case 9:if(i[1]<=8)return fI(n,r);break;case 60:return ug(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return S7(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return bA.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?U$(n,r):Am(t,n,r,s);case 239:return i[3]===60?ug(n,r):Am(t,n,r,s);case 255:if(i[1]===254)return W$(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return to.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return to.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return cg.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return oB(n,r);break;case 10:case 13:case 32:return j$(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(i[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(i[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(i[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return k7.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?cg.to_workbook(n,r):Am(t,n,r,s)}function CI(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return bf(e.file,He.write(t,{type:st?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return He.write(t,e)}function H$(t,e){switch(e.bookType){case"ods":return xI(t,e);case"numbers":return C$(t,e);case"xlsb":return M$(t,e);default:return B$(t,e)}}function $$(t,e){var r=Bt(e||{}),n=H$(t,r);return G$(n,r)}function G$(t,e){var r={},n=st?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?He.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Qd(i))}return e.password&&typeof encrypt_agile<"u"?CI(encrypt_agile(i,e.password),e):e.type==="file"?bf(e.file,i):e.type=="string"?Rt(i):i}function X$(t,e){var r=e||{},n=OH(t,r);return CI(n,r)}function Wi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return td(qi(n));case"binary":return qi(n);case"string":return t;case"file":return bf(e.file,n,"utf8");case"buffer":return st?ns(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Wi(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function K$(t,e){switch(e.type){case"base64":return TO(t);case"binary":return t;case"string":return t;case"file":return bf(e.file,t,"binary");case"buffer":return st?ns(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function U0(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?td(r):e.type=="string"?Rt(r):r;case"file":return bf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function AI(t,e){vv(),Pz(t);var r=Bt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=AI(t,r);return r.type="array",Qd(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Wi(IH(t,r),r);case"slk":case"sylk":return Wi(DA.from_sheet(t.Sheets[t.SheetNames[i]],r,t),r);case"htm":case"html":return Wi(pI(t.Sheets[t.SheetNames[i]],r),r);case"txt":return K$(II(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Wi(qv(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Wi(bA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return U0(cg.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Wi(Kl.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Wi(lB(t.Sheets[t.SheetNames[i]]),r);case"eth":return Wi(OA.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Wi(xI(t,r),r);case"wk1":return U0(to.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return U0(to.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),U0(dI(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),X$(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $$(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function q$(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Y$(t,e,r){var n=r||{};return n.type="file",n.file=e,q$(n),AI(t,n)}function Q$(t,e,r,n,i,s,a){var o=ht(r),l=a.defval,c=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),u=!0,d=t["!data"]!=null,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!d||t["!data"][r])for(var p=e.s.c;p<=e.e.c;++p){var g=d?(t["!data"][r]||[])[p]:t[n[p]+o];if(g==null||g.t===void 0){if(l===void 0)continue;s[p]!=null&&(h[s[p]]=l);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"b":case"n":if(!g.z||!gi(g.z)||(x=Es(x),typeof x=="number"))break;case"d":a&&(a.UTC||a.raw===!1)||(x=vo(new Date(x)));break;default:throw new Error("unrecognized type "+g.t)}if(s[p]!=null){if(x==null)if(g.t=="e"&&x===null)h[s[p]]=null;else if(l!==void 0)h[s[p]]=l;else if(c&&x===null)h[s[p]]=null;else continue;else h[s[p]]=(g.t==="n"&&typeof a.rawNumbers=="boolean"?a.rawNumbers:c)?x:Rs(g,x,a);x!=null&&(u=!1)}}return{row:h,isempty:u}}function pg(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Et(u);break;case"number":l=Et(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var d=ht(l.s.r),h=[],p=[],g=0,x=0,_=t["!data"]!=null,m=l.s.r,w=0,v={};_&&!t["!data"][m]&&(t["!data"][m]=[]);var R=c.skipHidden&&t["!cols"]||[],U=c.skipHidden&&t["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(R[w]||{}).hidden)switch(h[w]=et(w),r=_?t["!data"][m][w]:t[h[w]+d],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=h[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Rs(r,null,c),x=v[a]||0,!x)v[a]=1;else{do o=a+"_"+x++;while(v[o]);v[a]=x,v[o]=1}s[w]=o}for(m=l.s.r+i;m<=l.e.r;++m)if(!(U[m]||{}).hidden){var H=Q$(t,l,m,h,n,s,c);(H.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=H.row)}return p.length=g,p}var IE=/"/g;function J$(t,e,r,n,i,s,a,o){for(var l=!0,c=[],u="",d=ht(r),h=t["!data"]!=null,p=h&&t["!data"][r]||[],g=e.s.c;g<=e.e.c;++g)if(n[g]){var x=h?p[g]:t[n[g]+d];if(x==null)u="";else if(x.v!=null){l=!1,u=""+(o.rawNumbers&&x.t=="n"?x.v:Rs(x,null,o));for(var _=0,m=0;_!==u.length;++_)if((m=u.charCodeAt(_))===i||m===s||m===34||o.forceQuotes){u='"'+u.replace(IE,'""')+'"';break}u=="ID"&&(u='"ID"')}else x.f!=null&&!x.F?(l=!1,u="="+x.f,u.indexOf(",")>=0&&(u='"'+u.replace(IE,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function qv(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";for(var i=Et(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[],h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(d[g]=et(g));for(var x=0,_=i.s.r;_<=i.e.r;++_)(p[_]||{}).hidden||(u=J$(t,i,_,d,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((x++?o:"")+u)));return r.join("")}function II(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=qv(t,e);return r}function Z$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Et(t["!ref"]),s="",a=[],o,l=[],c=t["!data"]!=null;for(o=i.s.c;o<=i.e.c;++o)a[o]=et(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=ht(u),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t["!data"][u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function FI(t,e,r){var n=r||{},i=t?t["!data"]!=null:n.dense,s=+!n.skipHeader,a=t||{};!t&&i&&(a["!data"]=[]);var o=0,l=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(a["!ref"]){var d=Et(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(o=d.e.r+1,u.e.r=o+e.length-1+s)}else o==-1&&(o=0,u.e.r=e.length-1+s);var h=n.header||[],p=0,g=[];e.forEach(function(_,m){i&&!a["!data"][o+m+s]&&(a["!data"][o+m+s]=[]),i&&(g=a["!data"][o+m+s]),Xt(_).forEach(function(w){(p=h.indexOf(w))==-1&&(h[p=h.length]=w);var v=_[w],R="z",U="",H=i?"":et(l+p)+ht(o+m+s),E=i?g[l+p]:a[H];v&&typeof v=="object"&&!(v instanceof Date)?i?g[l+p]=v:a[H]=v:(typeof v=="number"?R="n":typeof v=="boolean"?R="b":typeof v=="string"?R="s":v instanceof Date?(R="d",n.UTC||(v=tp(v)),n.cellDates||(R="n",v=nr(v)),U=E!=null&&E.z&&gi(E.z)?E.z:n.dateNF||ze[14]):v===null&&n.nullError&&(R="e",v=0),E?(E.t=R,E.v=v,delete E.w,delete E.R,U&&(E.z=U)):i?g[l+p]=E={t:R,v}:a[H]=E={t:R,v},U&&(E.z=U))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var x=ht(o);if(i&&!a["!data"][o]&&(a["!data"][o]=[]),s)for(p=0;p<h.length;++p)i?a["!data"][o][p+l]={t:"s",v:h[p]}:a[et(p+l)+x]={t:"s",v:h[p]};return a["!ref"]=Je(u),a}function eG(t,e){return FI(null,t,e)}function _f(t,e,r){if(typeof e=="string"){if(t["!data"]!=null){var n=Pt(e);return t["!data"][n.r]||(t["!data"][n.r]=[]),t["!data"][n.r][n.c]||(t["!data"][n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?_f(t,it(e)):_f(t,et(r||0)+ht(e))}function tG(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Yv(t,e){var r={SheetNames:[],Sheets:{}};return t&&jf(r,t,e||"Sheet1"),r}function jf(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(oI(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function rG(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=tG(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function nG(t,e){return t.z=e,t}function NI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function iG(t,e,r){return NI(t,"#"+e,r)}function sG(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function aG(t,e,r,n){for(var i=typeof e!="string"?e:Et(e),s=typeof e=="string"?e:Je(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=_f(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}var c=Vr(t["!ref"]);return c.s.r>i.s.r&&(c.s.r=i.s.r),c.s.c>i.s.c&&(c.s.c=i.s.c),c.e.r<i.e.r&&(c.e.r=i.e.r),c.e.c<i.e.c&&(c.e.c=i.e.c),t["!ref"]=Je(c),t}var j0={encode_col:et,encode_row:ht,encode_cell:it,encode_range:Je,decode_col:Fv,decode_row:Iv,split_cell:V9,decode_cell:Pt,decode_range:Vr,format_cell:Rs,sheet_new:U9,sheet_add_aoa:tA,sheet_add_json:FI,sheet_add_dom:mI,aoa_to_sheet:cc,json_to_sheet:eG,table_to_sheet:gI,table_to_book:i$,sheet_to_csv:qv,sheet_to_txt:II,sheet_to_json:pg,sheet_to_html:pI,sheet_to_formulae:Z$,sheet_to_row_object_array:pg,sheet_get_cell:_f,book_new:Yv,book_append_sheet:jf,book_set_sheet_visibility:rG,cell_set_number_format:nG,cell_set_hyperlink:NI,cell_set_internal_link:iG,cell_add_comment:sG,sheet_set_array_formula:aG,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const oG="AIzaSyBlB6j_w_-Mb_ughrrz8BDFdiIJEDNTKGM",lG={apiKey:oG,authDomain:"label-c61eb.firebaseapp.com",databaseURL:"https://label-c61eb-default-rtdb.europe-west1.firebasedatabase.app",projectId:"label-c61eb",storageBucket:"label-c61eb.firebasestorage.app",messagingSenderId:"168446433946",appId:"1:168446433946:web:6536d1d40fb86ee1f61d23"};let oh;try{oh=t6().length===0?lS(lG):d_()}catch(t){console.error("Firebase init failed",t)}let ja,$c;try{if(oh){ja=S8(oh);try{$c=sO(oh)}catch(t){console.warn("Firestore not loaded",t)}}}catch(t){console.error("Database init failed",t)}const La="bb_label_db_v7_perfect",FE=()=>Math.random().toString(36).substring(2,15),cG={de:{labelGenerator:"Generator",importData:"Datenbank",packedOn:"Abgepackt am",searchPlaceholder:"Bundles durchsuchen...",availableBundles:"Verfgbare Bundles",selectedBundles:"Ausgewhlte Etiketten",clearAll:"Alles leeren",generatePdf:"PDF / Drucken",previewPdf:"Vorschau",downloadTemplate:"Template laden",uploadFile:"Excel/CSV Import",successImport:"Import erfolgreich abgeschlossen!",errorImport:"Fehler beim Datei-Import.",noSelected:"Keine Auswahl getroffen.",syncing:"Synchronisierung...",synced:"Cloud-Daten geladen",dataManagement:"Datenverwaltung",recoverData:"Daten aus Firestore laden"},en:{labelGenerator:"Generator",importData:"Database",packedOn:"Packed On",searchPlaceholder:"Search bundles...",availableBundles:"Available Bundles",selectedBundles:"Selected Labels",clearAll:"Clear All",generatePdf:"Print / PDF",previewPdf:"Preview",downloadTemplate:"Template laden",uploadFile:"Upload Excel/CSV",successImport:"Import completed successfully!",errorImport:"Error importing file.",noSelected:"Nothing selected yet.",syncing:"Syncing...",synced:"Cloud data loaded",dataManagement:"Data Management",recoverData:"Recover Data from Firestore"}},dd=({className:t="h-12"})=>P.jsx("div",{className:`font-serif font-bold tracking-tight select-none flex items-center justify-center leading-none ${t}`,style:{fontFamily:'"Bona Nova", serif'},children:P.jsx("span",{style:{fontSize:"inherit"},children:"BELLABONA"})}),RI=(t,e="card")=>{if(!t)return null;const r=t.toLowerCase(),n={gluten:"https://img.icons8.com/color/96/wheat.png",crustacean:"https://img.icons8.com/color/96/crab.png",egg:"https://img.icons8.com/color/96/egg.png",fish:"https://img.icons8.com/color/96/fish.png",peanut:"https://img.icons8.com/color/96/peanuts.png",soy:"https://img.icons8.com/color/96/soy.png",milk:"https://img.icons8.com/color/96/milk-bottle.png",nuts:"https://img.icons8.com/color/96/hazelnut.png",celery:"https://img.icons8.com/color/96/celery.png",mustard:"https://img.icons8.com/color/96/mustard.png",sesame:"https://img.icons8.com/color/96/sesame.png",sulphites:"https://img.icons8.com/color/96/wine-bottle.png",lupin:"https://img.icons8.com/color/96/bean.png",mollusc:"https://img.icons8.com/color/96/snail.png"},i=(o,l,c)=>e==="menu"?P.jsx("div",{className:"w-5 h-5 p-0.5 bg-white rounded-full border border-gray-100 shadow-sm",title:c,children:P.jsx("img",{src:l,alt:c,className:"w-full h-full object-contain"})},o):P.jsxs("div",{className:"flex flex-col items-center gap-0.5",title:c,children:[P.jsx("div",{className:"flex flex-col items-center justify-center w-10 h-10 rounded-full bg-white shadow-sm border border-slate-100 p-0.5",children:P.jsx("img",{src:l,alt:c,className:"w-full h-full object-contain"})}),P.jsx("span",{className:"text-[8px] font-bold text-[#024930] uppercase tracking-wide leading-none",children:c})]},o),s=[],a=(...o)=>o.some(l=>l.length===1?new RegExp(`\\b${l}\\b`).test(r):r.includes(l));return a("gluten","weizen","wheat","a")&&s.push(i("gluten",n.gluten,"Gluten")),a("krebstier","crustacean","krebs","b")&&s.push(i("crustacean",n.crustacean,"Crustaceans")),a("ei","egg","c")&&s.push(i("egg",n.egg,"Egg")),a("fisch","fish","d")&&s.push(i("fish",n.fish,"Fish")),a("erdnuss","peanut","e")&&s.push(i("peanut",n.peanut,"Peanuts")),a("soja","soy","f")&&s.push(i("soy",n.soy,"Soy")),a("milch","milk","lactose","laktose","g")&&s.push(i("milk",n.milk,"Milk")),a("nuss","nut","mandel","haselnuss","walnuss","h")&&s.push(i("nuts",n.nuts,"Nuts")),a("sellerie","celery","l")&&s.push(i("celery",n.celery,"Celery")),a("senf","mustard","m")&&s.push(i("mustard",n.mustard,"Mustard")),a("sesam","sesame","n")&&s.push(i("sesame",n.sesame,"Sesame")),a("schwefel","sulphite","sulfite","o")&&s.push(i("sulphites",n.sulphites,"Sulphites")),a("lupin","p")&&s.push(i("lupin",n.lupin,"Lupin")),a("weichtier","mollusc","r")&&s.push(i("mollusc",n.mollusc,"Molluscs")),s.length>0?P.jsx("div",{className:`flex gap-2 flex-wrap ${e==="card"?"justify-center":"justify-end"}`,children:s}):null},uG=(t,e=!0)=>{const r=t.toLowerCase(),n="flex items-center gap-1.5 px-3 py-1 rounded-full border border-current shadow-sm";return r.includes("vegan")?P.jsxs("div",{className:`${n} text-green-700 bg-green-50`,children:[P.jsx($k,{size:16}),P.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:e&&"Vegan"})]}):r.includes("vegetarisch")||r.includes("vegetarian")?P.jsxs("div",{className:`${n} text-green-600 bg-green-50`,children:[P.jsx(Ph,{size:16}),P.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:e&&"Veggie"})]}):r.includes("fish")||r.includes("fisch")?P.jsxs("div",{className:`${n} text-blue-600 bg-blue-50`,children:[P.jsx(Hk,{size:16}),P.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:e&&"Fish"})]}):r.includes("meat")||r.includes("fleisch")||r.includes("beef")?P.jsxs("div",{className:`${n} text-red-800 bg-red-50`,children:[P.jsx("span",{className:"text-lg leading-none",children:""}),P.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider",children:e&&"Meat"})]}):null},W0=({item:t,lang:e,forPrint:r})=>{const n=!!t.allergens_de;return P.jsxs("div",{className:`relative bg-white flex flex-col justify-between p-0 overflow-hidden ${r?"w-full h-full":"shadow-xl w-[105mm] h-[148.5mm]"}`,style:{width:r?"105mm":void 0,height:r?"148.5mm":void 0},children:[P.jsx("div",{className:"bg-[#024930] h-20 w-full flex items-center justify-center",children:P.jsx(dd,{className:"text-3xl font-black brightness-0 invert"})}),P.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-12 py-4 text-center",children:[P.jsx("div",{className:"mb-4 scale-125",children:uG(t.diet_de)}),P.jsx("h2",{className:"text-3xl leading-snug font-serif font-bold text-[#024930] uppercase mb-4",children:e==="de"?t.item_name_de:t.item_name_en}),P.jsx("div",{className:"w-16 h-[1px] bg-slate-300"})]}),n&&P.jsxs("div",{className:"bg-[#FFF1F6] min-h-[90px] border-t border-[#FEACCF] p-6 flex flex-col items-center justify-center",children:[P.jsx("span",{className:"text-[10px] uppercase font-bold text-[#024930] tracking-[0.2em] mb-2 opacity-70",children:"Allergens"}),P.jsx("div",{className:"flex flex-col items-center gap-1",children:RI(t.allergens_de,"card")})]}),!n&&P.jsx("div",{className:"h-10 w-full bg-white"})," "]})},Go={getBundles:async()=>{try{const t=Ho(ja),e=await _8(Xh(t,"bundles"));if(e.exists()){const r=e.val(),n=Object.values(r);return n.sort((i,s)=>i.name_de.localeCompare(s.name_de)),localStorage.setItem(La,JSON.stringify(n)),n}if(console.log("RTDB empty, attempting auto-migration from Firestore..."),$c)try{const r=await _w(pw($c,"bundles"));if(!r.empty){const n=[],i={};return r.forEach(s=>{const a=s.data();n.push(a),i["bundles/"+a.id]=a}),n.sort((s,a)=>s.name_de.localeCompare(a.name_de)),await nm(Ho(ja),i),localStorage.setItem(La,JSON.stringify(n)),n}}catch(r){console.warn("Auto-migration failed:",r)}return localStorage.setItem(La,JSON.stringify([])),[]}catch(t){console.error("Fetch Error:",t);const e=localStorage.getItem(La);return(e?JSON.parse(e):[]).sort((n,i)=>n.name_de.localeCompare(i.name_de))}},saveBundle:async t=>{const e=localStorage.getItem(La),r=e?JSON.parse(e):[],n=r.findIndex(i=>i.id===t.id);n>=0?r[n]=t:r.push(t),localStorage.setItem(La,JSON.stringify(r));try{await E4(Ho(ja,"bundles/"+t.id),t)}catch{}},saveBundles:async t=>{localStorage.setItem(La,JSON.stringify(t));const e={};t.forEach(r=>{e["bundles/"+r.id]=r});try{await nm(Ho(ja),e)}catch{}},deleteBundle:async t=>{try{await g8(Ho(ja,"bundles/"+t))}catch{}},migrateFromFirestore:async()=>{if(!$c)throw new Error("Firestore not initialized");const t=await _w(pw($c,"bundles")),e={};let r=0;return t.forEach(n=>{const i=n.data();e["bundles/"+i.id]=i,r++}),r>0&&await nm(Ho(ja),e),r}},NE=({bundle:t,lang:e,packedOn:r,forPrint:n,variant:i="standard"})=>{const s=(d,h,p="text-slate-700")=>{const g=d.diet_de.toLowerCase(),x=d.allergens_de.toLowerCase(),_=i==="catering"?20:h?22:32,m=[];return g.includes("vegan")?m.push(P.jsx($k,{size:_,className:i==="catering"?"text-[#024930]":"text-green-600"},"vegan")):g.includes("vegetarisch")?m.push(P.jsx(Ph,{size:_,className:i==="catering"?"text-[#024930]":"text-green-500"},"veggie")):g.includes("fish")||g.includes("fisch")?m.push(P.jsx(Hk,{size:_,className:i==="catering"?"text-[#024930]":"text-blue-500"},"fish")):(g.includes("meat")||g.includes("fleisch")||g.includes("beef"))&&m.push(P.jsx("div",{className:i==="catering"?"text-lg grayscale":h?"text-xl":"text-3xl",children:""},"meat")),i==="standard"&&((x.includes("gluten")||x.includes("weizen"))&&m.push(P.jsx(DN,{size:_,className:"text-amber-600"},"gluten")),(x.includes("egg")||x.includes("ei"))&&m.push(P.jsx(SN,{size:_,className:"text-amber-500"},"egg")),(x.includes("lactose")||x.includes("milch"))&&m.push(P.jsx(IN,{size:_,className:"text-blue-400"},"milk")),(x.includes("soja")||x.includes("soy"))&&m.push(P.jsx(kN,{size:_,className:"text-green-700"},"soy")),(x.includes("nuss")||x.includes("nut")||x.includes("mandel")||x.includes("hazel"))&&m.push(P.jsx(FN,{size:_,className:"text-amber-800"},"nut")),m.length===0&&m.push(P.jsx(Gk,{size:_,className:"text-blue-500"},"fallback"))),m};if(i==="catering")return P.jsxs("div",{className:`relative bg-white flex flex-col items-center justify-between p-10 text-center text-slate-900 border-[1px] border-gray-100 overflow-hidden ${n?"w-full h-full":"shadow-xl w-[105mm] h-[148.5mm]"}`,style:{width:n?"105mm":void 0,height:n?"148.5mm":void 0,fontFamily:"serif"},children:[P.jsx("div",{className:"absolute inset-3 border border-[#024930] pointer-events-none"}),P.jsx("div",{className:"absolute inset-4 border border-[#024930] opacity-30 pointer-events-none"}),P.jsxs("div",{className:"mt-8 z-10 w-full flex flex-col items-center",children:[P.jsx(dd,{className:"h-6 mb-4 opacity-80"}),P.jsx("h2",{className:"text-3xl font-bold text-[#024930] leading-tight font-serif px-6 underline decoration-[#FEACCF] decoration-2 underline-offset-8",children:e==="de"?t.name_de:t.name_en})]}),P.jsx("div",{className:"flex-1 flex flex-col justify-center items-center gap-6 w-full px-8 z-10",children:t.items.map((d,h)=>P.jsxs("div",{className:"flex flex-col items-center",children:[P.jsx("span",{className:"text-xl font-medium text-slate-800 italic font-serif leading-snug",children:e==="de"?d.item_name_de:d.item_name_en}),P.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[P.jsx("span",{className:"text-[9px] uppercase font-sans tracking-[0.2em] text-[#024930] border-b border-[#024930]/20 pb-0.5",children:d.allergens_de||"No Allergens"}),s(d,!1)]})]},h))}),P.jsx("div",{className:"mb-6 z-10 flex flex-col items-center",children:P.jsx("span",{className:"font-sans text-[8px] uppercase tracking-[0.3em] text-[#024930] mb-1",children:"Bon Apptit"})})]});const a=t.items.length,o=a>=5,l=a===1?"text-[32px]":a<=3?"text-[24px]":a<=5?"text-[20px]":a===6?"text-[18px]":a<=8?"text-[14px]":"text-[12px]",c=a===1?"py-8":a<=3?"py-5":a===4?"py-3":a<=6?"py-2":a<=8?"py-1":"py-0.5",u=a>6?"text-[8px]":"text-[10px]";return P.jsxs("div",{className:`label-card text-slate-900 flex flex-col overflow-hidden relative ${n?"h-full w-full":"shadow-2xl border border-slate-700 rounded-lg h-[148.5mm] w-[105mm]"}`,style:{fontFamily:"'Inter', sans-serif",boxSizing:"border-box",backgroundColor:"#fff",color:"#000",width:n?"105mm":void 0,height:n?"148.5mm":void 0},children:[P.jsx("div",{className:"bg-[#024930] py-3 px-6 flex flex-col items-center justify-center min-h-[55px] shrink-0 border-b-[3px] border-[#FEACCF]",children:P.jsx("h2",{className:"text-white text-center font-serif font-bold text-[18px] uppercase tracking-[0.2em] leading-tight",children:e==="de"?t.name_de:t.name_en})}),P.jsx("div",{className:"flex-1 px-8 py-2 flex flex-col overflow-hidden relative bg-white",children:P.jsx("div",{className:"flex-1 flex flex-col justify-center relative z-10 overflow-hidden",children:t.items.map((d,h)=>P.jsxs("div",{className:`flex justify-between items-center border-b border-gray-100 last:border-none ${c}`,children:[P.jsxs("div",{className:"flex-1 pr-4",children:[P.jsx("div",{className:`font-serif font-medium ${l} leading-[1.1] text-slate-900 mb-0.5`,children:e==="de"?d.item_name_de:d.item_name_en}),P.jsx("div",{className:"flex flex-wrap gap-1",children:d.allergens_de.split(/[,/]+/).map((p,g)=>{const x=p.trim();return x?P.jsx("span",{className:`text-[#024930] ${u} font-bold px-1 py-[0.5px] rounded-[1px] uppercase tracking-wider border border-[#FEACCF]/50 bg-[#F8F7F6]`,children:x},g):null})})]}),P.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[50px] ml-2",children:[P.jsx("div",{className:"flex gap-1 mb-1",children:s(d,o)}),P.jsx("span",{className:"text-[9px] uppercase tracking-widest text-[#024930] font-bold",children:d.diet_de})]})]},d.id))})}),P.jsxs("div",{className:"bg-[#FEACCF] py-2 px-8 flex justify-between items-center shrink-0 border-t border-[#024930]/10",children:[P.jsxs("div",{className:"flex flex-col",children:[P.jsx("span",{className:"text-[7px] uppercase tracking-[0.2em] text-[#024930]/80 font-bold",children:"Packed On"}),P.jsx("span",{className:"text-[11px] font-mono text-[#024930] font-bold",children:r})]}),P.jsx("div",{className:"flex flex-col items-end",children:P.jsx(dd,{className:"text-xl text-[#024930] h-[auto]"})})]})]})},fG=()=>{const[t,e]=Yt.useState("de"),r=cG[t],[n,i]=Yt.useState([]),[s,a]=Yt.useState([]),[o,l]=Yt.useState([]),[c,u]=Yt.useState([]),[d,h]=Yt.useState(""),[p,g]=Yt.useState(new Date().toLocaleDateString("en-GB")),[x,_]=Yt.useState(""),[m,w]=Yt.useState(new Date().toLocaleDateString("en-GB")),[v,R]=Yt.useState("generator"),[U,H]=Yt.useState(!1),[E,T]=Yt.useState(!1),[k,C]=Yt.useState(!1),[A,b]=Yt.useState("labels"),N=Yt.useRef(null),we=async()=>{try{const K=await Go.getBundles();i(K.filter(se=>!se.deleted)),a(K.filter(se=>se.deleted))}catch{}};Yt.useEffect(()=>{we()},[]);const he=Yt.useMemo(()=>n.filter(K=>{const se=K.name_de.toLowerCase().includes(x.toLowerCase())||K.name_en.toLowerCase().includes(x.toLowerCase()),F=K.type==="catering";return v==="catering"?se&&F:v==="generator"?se&&!F:se}),[n,x,v]),Re=(K,se=!1)=>{(se?u:l)(G=>G.find(z=>z.bundleId===K)?G.map(z=>z.bundleId===K?{...z,quantity:z.quantity+1}:z):[...G,{bundleId:K,quantity:1}])},de=async K=>{const se={...K,deleted:!0};i(F=>F.filter(G=>G.id!==K.id)),a(F=>[...F,se]),await Go.saveBundle(se)},re=async K=>{const se={...K,deleted:!1};a(F=>F.filter(G=>G.id!==K.id)),i(F=>[...F,se]),await Go.saveBundle(se)},ye=async K=>{confirm(`PERMANENTLY DELETE "${K.name_de}"? This cannot be undone.`)&&(a(se=>se.filter(F=>F.id!==K.id)),await Go.deleteBundle(K.id))},X=K=>{var G;const se=(G=K.target.files)==null?void 0:G[0];if(!se)return;H(!0);const F=new FileReader;F.onload=async W=>{var z;try{const Q=new Uint8Array((z=W.target)==null?void 0:z.result),O=gf(Q,{type:"array"}),ae=j0.sheet_to_json(O.Sheets[O.SheetNames[0]]),Ae={};ae.forEach(Pe=>{const Oe=String(Pe.bundle_name_de||"Unnamed").trim(),Ge=String(Pe.bundle_name_en||Oe).trim();Ae[Oe]||(Ae[Oe]={id:FE(),name_de:Oe,name_en:Ge,items:[]}),Ae[Oe].items.push({id:FE(),item_name_de:String(Pe.item_name_de||"").trim(),item_name_en:String(Pe.item_name_en||Pe.item_name_de||"").trim(),allergens_de:String(Pe.allergens_de||"").trim(),diet_de:String(Pe.diet_de||"").trim()}),Ae[Oe].type||(Ae[Oe].type=String(Pe.type||"standard").toLowerCase().includes("catering")?"catering":"standard"),Ae[Oe].type||(Ae[Oe].type=String(Pe.type||"standard").toLowerCase().includes("catering")?"catering":"standard");const ot=String(Pe.company_name||"").trim(),St=String(Pe.date||"").trim();ot&&h(ot),St&&g(St)});const ge=[...n,...Object.values(Ae)];i(ge),await Go.saveBundles(ge),alert(r.successImport)}catch{alert(r.errorImport)}finally{H(!1)}},F.readAsArrayBuffer(se)},Ce=Yt.useMemo(()=>{const se=(v==="catering"||k&&A==="menu"?c:o).flatMap(G=>{const W=n.find(z=>z.id===G.bundleId);return W?Array(G.quantity).fill(W):[]}),F=[];for(let G=0;G<se.length;G+=4)F.push(se.slice(G,G+4));return F},[o,c,n,v,k,A]),ce=()=>{const K=[];c.forEach(Q=>{const O=n.find(ae=>ae.id===Q.bundleId);O&&K.push(...O.items)});const se=Array.from(new Map(K.map(Q=>[Q.item_name_de.toLowerCase(),Q])).values()),F={},G=["Vegan","Vegetarisch","Vegetarian","Fish","Fisch","Meat","Fleisch","Beef"];se.forEach(Q=>{let O=Q.diet_de||"Other";O.toLowerCase().includes("vegan")?O="Vegan":O.toLowerCase().includes("vegetarisch")?O="Vegetarian":O.toLowerCase().includes("fish")||O.toLowerCase().includes("fisch")?O="Fish":(O.toLowerCase().includes("meat")||O.toLowerCase().includes("fleisch"))&&(O="Meat"),F[O]||(F[O]=[]),F[O].push(Q)});const W=Object.keys(F).sort((Q,O)=>{const ae=G.indexOf(Q),Ae=G.indexOf(O);return(ae===-1?99:ae)-(Ae===-1?99:Ae)}),z=se.length>15;return P.jsxs("div",{className:"w-[210mm] h-[297mm] relative flex flex-col items-center bg-[#F8F7F6] overflow-hidden",style:{fontFamily:"'Bona Nova', serif"},children:[P.jsx("div",{className:"absolute inset-0 z-0 bg-white/50"}),P.jsx("div",{className:"absolute inset-6 border-[3px] border-[#024930] pointer-events-none"}),P.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none z-0",children:P.jsx("div",{style:{fontFamily:'"Bona Nova", serif'},className:"text-[15rem] font-bold text-[#024930] tracking-wide -rotate-45 whitespace-nowrap",children:"BELLABONA"})}),P.jsx("div",{className:"absolute inset-7 border border-[#024930] pointer-events-none z-10"}),P.jsx("div",{className:"absolute top-6 left-6 w-16 h-16 border-r border-b border-[#F8F7F6] z-10"}),P.jsx("div",{className:"absolute top-6 right-6 w-16 h-16 border-l border-b border-[#F8F7F6] z-10"}),P.jsx("div",{className:"absolute bottom-6 left-6 w-16 h-16 border-r border-t border-[#F8F7F6] z-10"}),P.jsx("div",{className:"absolute bottom-6 right-6 w-16 h-16 border-l border-t border-[#F8F7F6] z-10"}),P.jsxs("div",{className:"flex flex-col items-center w-full pt-10 pb-3 z-20 px-24",children:[P.jsx(dd,{className:"h-[auto] text-5xl mb-4 text-[#024930]"}),d&&P.jsx("h1",{className:"text-3xl font-black text-[#024930] uppercase mb-2 tracking-wider text-center",style:{fontFamily:"'Playfair Display', serif"},children:d}),P.jsxs("div",{className:"flex items-center gap-6 mt-2",children:[P.jsx("span",{className:"h-[1px] w-16 bg-[#024930]/40"}),P.jsx("p",{className:"font-serif text-[#024930] text-base tracking-[0.1em] uppercase",style:{fontFamily:"'Playfair Display', serif"},children:new Date(p).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),P.jsx("span",{className:"h-[1px] w-16 bg-[#024930]/40"})]})]}),P.jsx("div",{className:"flex-1 w-full px-24 z-20 flex flex-col items-center justify-center",children:P.jsx("div",{className:`w-full ${z?"columns-2 gap-8":"flex flex-col items-center gap-6"} space-y-6`,children:W.map((Q,O)=>P.jsxs("div",{className:"break-inside-avoid mb-4 w-full",children:[P.jsx("div",{className:"flex items-center justify-center mb-4 border-b border-[#024930]/20 pb-2",children:P.jsx("h2",{className:"text-2xl font-bold text-[#024930] uppercase tracking-[0.25em]",style:{fontFamily:"'Playfair Display', serif"},children:t==="de"?Q==="Vegetarian"?"Vegetarisch":Q==="Meat"?"Fleisch":Q==="Fish"?"Fisch":Q:Q})}),P.jsx("div",{className:`flex flex-col ${z?"items-start text-left":"items-center text-center"} gap-3 flex-grow justify-center`,children:F[Q].map((ae,Ae)=>P.jsx("div",{className:"flex flex-col group w-full py-1",children:P.jsxs("div",{className:"flex items-start justify-between w-full",children:[P.jsx("span",{className:"text-2xl font-bold text-[#1a1a1a] leading-tight tracking-wide text-left flex-1",style:{fontFamily:"'Bona Nova', serif"},children:t==="de"?ae.item_name_de:ae.item_name_en}),P.jsx("div",{className:"flex flex-col items-end pl-6 shrink-0 max-w-[35%]",children:ae.allergens_de&&P.jsx("div",{className:"flex items-center gap-1 justify-end flex-wrap",children:RI(ae.allergens_de,"menu")})})]})},Ae))})]},O))})}),P.jsxs("div",{className:"w-full text-center pb-6 z-20 mt-auto flex flex-col items-center",children:[P.jsx("span",{className:"text-3xl text-[#024930]/40 rotate-180 mb-2",style:{fontFamily:"'Pinyon Script', cursive"},children:""}),P.jsx("p",{className:"text-2xl text-[#024930]",style:{fontFamily:"'Pinyon Script', cursive"},children:"Bon Apptit"}),P.jsx("p",{className:"text-[9px] font-sans uppercase tracking-[0.25em] text-[#024930]/50 mt-2",children:"Prepared Freshly for You"})]}),P.jsx("style",{children:`
          @media print {
            @page { size: A4; margin: 0; }
            body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
          }
        `})]})},fe=({size:K})=>{const se=K==="A4"?{w:"210mm",h:"297mm"}:{w:"105mm",h:"148.5mm"},F=K==="A4"?"text-7xl mb-24":"text-3xl mb-12",G=K==="A4"?"text-5xl leading-tight mb-20":"text-xl leading-tight mb-8",W=K==="A4"?"w-[400px] h-[400px]":"w-[150px] h-[150px]",z=K==="A4"?"text-5xl":"text-2xl";return P.jsxs("div",{className:"flex flex-col items-center text-center bg-[#FEACCF] relative font-sans p-10 overflow-hidden",style:{width:se.w,height:se.h},children:[P.jsx("h1",{className:`${F} font-black text-[#024930] uppercase mt-10 tracking-wide`,children:d||"COMPANY NAME"}),P.jsxs("h2",{className:`${G} font-bold text-[#024930] uppercase tracking-wide`,children:["RATE YOUR LUNCH",P.jsx("br",{}),"WITH US"]}),P.jsx("div",{className:"p-0",children:P.jsx("img",{src:"./review_qr.png",className:W,alt:"Review QR",style:{mixBlendMode:"normal"}})}),P.jsx("div",{className:`mt-auto font-black ${z} text-[#024930] uppercase tracking-tighter mb-4`,children:"BELLABONA"})]})},le=()=>{if(A==="menu"&&v==="catering")return P.jsxs(P.Fragment,{children:[P.jsx("div",{style:{width:"210mm",height:"297mm",pageBreakAfter:"always"},children:P.jsx(ce,{})}),P.jsx("div",{style:{width:"210mm",height:"297mm",pageBreakAfter:"always"},children:P.jsx(fe,{size:"A4"})})]});if(v==="catering"&&A==="labels"){const K=c.flatMap(F=>{const G=n.find(W=>W.id===F.bundleId);return G?Array(F.quantity).fill(G).flatMap(()=>G.items):[]}),se=[];for(let F=0;F<K.length;F+=4)se.push(K.slice(F,F+4));return P.jsx(P.Fragment,{children:se.map((F,G)=>P.jsx("div",{className:"w-[210mm] h-[297mm] bg-white grid grid-cols-2 grid-rows-2",style:{pageBreakAfter:"always",margin:0,padding:0},children:F.map((W,z)=>P.jsx("div",{className:"w-[105mm] h-[148.5mm] overflow-hidden flex items-center justify-center",children:P.jsx(W0,{item:W,lang:t,forPrint:!0})},z))},G))})}return A==="review-a4"?P.jsx(fe,{size:"A4"}):A==="review-a6"?P.jsx(fe,{size:"A6"}):A==="explode-a6"?De():P.jsx(P.Fragment,{children:Ce.map((K,se)=>P.jsx("div",{className:"label-page-group mb-12",style:{breakAfter:"always"},children:K.map((F,G)=>P.jsx("div",{className:"label-card-container",children:P.jsx(NE,{bundle:F,lang:t,packedOn:m,forPrint:!0,variant:"standard"})},G))},se))})},De=()=>{const K=o.flatMap(F=>{const G=n.find(W=>W.id===F.bundleId);return G?Array(F.quantity).fill(G).flatMap(()=>G.items):[]}),se=[];for(let F=0;F<K.length;F+=4)se.push(K.slice(F,F+4));return P.jsx(P.Fragment,{children:se.map((F,G)=>P.jsx("div",{className:"w-[210mm] h-[297mm] bg-white grid grid-cols-2 grid-rows-2",style:{pageBreakAfter:"always",margin:0,padding:0},children:F.map((W,z)=>P.jsx("div",{className:"w-[105mm] h-[148.5mm] overflow-hidden flex items-center justify-center",children:P.jsx(W0,{item:W,lang:t,forPrint:!0})},z))},G))})};return P.jsxs(P.Fragment,{children:[P.jsx("div",{className:"hidden print:block",children:le()}),P.jsx("div",{className:"print:hidden min-h-screen flex flex-col bg-[#F8F7F6] text-[#024930]",children:P.jsxs("div",{className:"flex flex-1",children:[P.jsxs("aside",{className:"w-20 lg:w-64 bg-[#024930] border-r border-[#024930] flex flex-col shadow-2xl z-20",children:[P.jsxs("div",{className:"p-6 border-b border-[#F8F7F6]/10 flex items-center gap-3",children:[P.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#FEACCF] flex items-center justify-center shadow-lg",children:P.jsx(Ph,{size:24,color:"#024930"})}),P.jsxs("div",{className:"hidden lg:block",children:[P.jsx("h1",{className:"font-black text-sm text-white tracking-widest",children:"BELLA&BONA"}),P.jsx("p",{className:"text-[9px] text-[#FEACCF] uppercase font-bold tracking-wider",children:"Label Factory"})]})]}),P.jsxs("nav",{className:"flex-1 p-4 space-y-2",children:[P.jsxs("button",{onClick:()=>R("generator"),className:`w-full flex items-center gap-4 px-4 py-3 rounded-xl transition-all font-bold ${v==="generator"?"bg-[#FEACCF] text-[#024930] shadow-lg translate-x-1":"text-[#F8F7F6]/60 hover:text-white hover:bg-white/5"}`,children:[P.jsx(Wo,{size:20}),P.jsx("span",{className:"hidden lg:block",children:"Generator"})]}),P.jsxs("button",{onClick:()=>R("catering"),className:`w-full flex items-center gap-4 px-4 py-3 rounded-xl transition-all font-bold ${v==="catering"?"bg-[#FEACCF] text-[#024930] shadow-lg translate-x-1":"text-[#F8F7F6]/60 hover:text-white hover:bg-white/5"}`,children:[P.jsx($p,{size:20}),P.jsx("span",{className:"hidden lg:block",children:"Special Catering"})]}),P.jsxs("button",{onClick:()=>R("database"),className:`w-full flex items-center gap-4 px-4 py-3 rounded-xl transition-all font-bold ${v==="database"?"bg-[#FEACCF] text-[#024930] shadow-lg translate-x-1":"text-[#F8F7F6]/60 hover:text-white hover:bg-white/5"}`,children:[P.jsx(My,{size:20}),P.jsx("span",{className:"hidden lg:block",children:"Database"})]})]}),P.jsx("div",{className:"p-4",children:P.jsxs("button",{onClick:()=>R("trash"),className:`w-full flex items-center gap-4 px-4 py-3 rounded-xl transition-all font-bold ${v==="trash"?"bg-red-500/20 text-red-200 shadow-lg":"text-[#F8F7F6]/40 hover:text-red-300 hover:bg-red-500/10"}`,children:[P.jsx(y0,{size:20}),P.jsx("span",{className:"hidden lg:block",children:"Trash"})]})}),P.jsxs("div",{className:"p-4 border-t border-[#F8F7F6]/10 space-y-4",children:[P.jsxs("div",{className:"hidden lg:block px-2",children:[P.jsx("label",{className:"text-[10px] uppercase text-[#F8F7F6]/50 font-bold tracking-wider",children:"Packed On"}),P.jsx("input",{type:"text",value:m,onChange:K=>w(K.target.value),className:"w-full bg-[#033b26] rounded-lg px-3 py-2 text-white text-xs mt-1 border-none focus:ring-2 focus:ring-[#FEACCF]"})]}),P.jsxs("div",{className:"flex bg-[#033b26] rounded-lg p-1",children:[P.jsx("button",{onClick:()=>e("de"),className:`flex-1 py-1.5 text-xs rounded-md transition-all font-bold ${t==="de"?"bg-[#FEACCF] text-[#024930] shadow-sm":"text-[#F8F7F6]/50 hover:text-white"}`,children:"DE"}),P.jsx("button",{onClick:()=>e("en"),className:`flex-1 py-1.5 text-xs rounded-md transition-all font-bold ${t==="en"?"bg-[#FEACCF] text-[#024930] shadow-sm":"text-[#F8F7F6]/50 hover:text-white"}`,children:"EN"})]})]})]}),P.jsx("main",{className:"flex-1 overflow-y-auto p-8 lg:p-12",children:v==="generator"?P.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-10",children:[P.jsxs("div",{className:"xl:col-span-5 space-y-8",children:[P.jsxs("div",{className:"relative",children:[P.jsx(Uy,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-[#024930]/40",size:20}),P.jsx("input",{type:"text",placeholder:r.searchPlaceholder,value:x,onChange:K=>_(K.target.value),className:"w-full bg-white rounded-2xl pl-14 pr-6 py-4 text-sm text-[#024930] border-none focus:ring-2 focus:ring-[#FEACCF] shadow-xl placeholder:text-[#024930]/20"})]}),P.jsx("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-3",children:he.map(K=>P.jsxs("div",{onClick:()=>Re(K.id),className:"bg-white rounded-2xl p-5 flex items-center justify-between cursor-pointer group hover:ring-2 hover:ring-[#FEACCF] transition-all shadow-sm hover:shadow-lg",children:[P.jsxs("div",{className:"flex items-center gap-4",children:[P.jsx("div",{className:"w-10 h-10 rounded-full bg-[#F8F7F6] flex items-center justify-center group-hover:bg-[#FEACCF] transition-colors",children:P.jsx(Gk,{size:20,className:"text-[#024930]"})}),P.jsxs("div",{children:[P.jsx("p",{className:"font-black text-[#024930] text-sm",children:t==="de"?K.name_de:K.name_en}),P.jsxs("p",{className:"text-[10px] font-bold text-[#024930]/40 uppercase tracking-wider",children:[K.items.length," item",K.items.length!==1?"s":""]})]})]}),P.jsx(Vy,{size:20,className:"text-[#024930]/20 group-hover:text-[#024930]"})]},K.id))})]}),P.jsx("div",{className:"xl:col-span-7",children:P.jsxs("section",{className:"bg-white rounded-3xl p-8 flex flex-col min-h-[500px] shadow-2xl relative overflow-hidden",children:[P.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.03] pointer-events-none",children:P.jsx(Ph,{size:400})}),P.jsxs("div",{className:"flex justify-between mb-10 relative z-10",children:[P.jsxs("h2",{className:"text-2xl font-black text-[#024930]",children:["Selected ",P.jsx("span",{className:"text-[#FEACCF]",children:o.length})]}),o.length>0&&P.jsx("button",{onClick:()=>l([]),className:"text-red-400 font-bold uppercase text-[10px] tracking-widest hover:text-red-500",children:"Clear All"})]}),P.jsxs("div",{className:"flex-1 space-y-4 relative z-10",children:[o.map(K=>{const se=n.find(F=>F.id===K.bundleId);return se?P.jsxs("div",{className:"flex items-center gap-4 bg-[#F8F7F6] rounded-xl p-4 border border-[#F8F7F6] hover:border-[#FEACCF]/50 transition-colors",children:[P.jsx("div",{className:"flex-1",children:P.jsx("p",{className:"font-bold text-[#024930]",children:t==="de"?se.name_de:se.name_en})}),P.jsx("input",{type:"number",min:"1",value:K.quantity,onChange:F=>l(G=>G.map(W=>W.bundleId===K.bundleId?{...W,quantity:parseInt(F.target.value)||1}:W)),className:"w-16 bg-white rounded-lg p-2 text-center text-[#024930] font-black border-none shadow-sm focus:ring-2 focus:ring-[#FEACCF]"}),P.jsx("button",{onClick:()=>l(F=>F.filter(G=>G.bundleId!==K.bundleId)),className:"text-[#024930]/20 hover:text-red-400 px-2",children:P.jsx(jy,{size:20})})]},K.bundleId):null}),o.length===0&&P.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-10 text-[#024930] mt-20",children:[P.jsx(Wo,{size:64,className:"mb-4"}),P.jsx("p",{className:"font-bold uppercase tracking-widest",children:"No bundles selected"})]})]}),o.length>0&&P.jsxs("div",{className:"mt-8 pt-8 border-t border-[#F8F7F6] flex justify-between items-center",children:[P.jsxs("button",{onClick:()=>C(!0),className:"flex items-center gap-2 text-[#024930] font-bold hover:text-[#FEACCF] transition-colors",children:[P.jsx(CN,{size:20})," Preview"]}),P.jsxs("button",{onClick:()=>window.print(),className:"bg-[#024930] text-white font-black px-10 py-4 rounded-xl flex items-center gap-3 shadow-xl hover:shadow-2xl hover:-translate-y-0.5 active:translate-y-0 transition-all uppercase tracking-wider text-xs",children:[P.jsx(Wo,{size:20})," Print A4 Grid"]}),P.jsxs("button",{onClick:()=>{b("explode-a6"),C(!0)},className:"bg-[#FEACCF] text-[#024930] font-black px-10 py-4 rounded-xl flex items-center gap-3 shadow-xl hover:shadow-2xl hover:-translate-y-0.5 active:translate-y-0 transition-all uppercase tracking-wider text-xs",children:[P.jsx(Ly,{size:20})," Separate A6"]})]})]})})]}):v==="catering"?P.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-10",children:[P.jsxs("div",{className:"xl:col-span-5 space-y-8",children:[P.jsxs("div",{className:"relative",children:[P.jsx(Uy,{className:"absolute left-5 top-1/2 -translate-y-1/2 text-[#024930]/40",size:20}),P.jsx("input",{type:"text",placeholder:"Search menu items...",value:x,onChange:K=>_(K.target.value),className:"w-full bg-white rounded-2xl pl-14 pr-6 py-4 text-sm text-[#024930] border-none focus:ring-2 focus:ring-[#FEACCF] shadow-xl placeholder:text-[#024930]/20"})]}),P.jsx("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto pr-3",children:he.map(K=>P.jsxs("div",{onClick:()=>Re(K.id,!0),className:"bg-white rounded-2xl p-5 flex items-center justify-between cursor-pointer group hover:ring-2 hover:ring-[#FEACCF] transition-all shadow-sm hover:shadow-lg",children:[P.jsxs("div",{className:"flex items-center gap-4",children:[P.jsx("div",{className:"w-10 h-10 rounded-full bg-[#F8F7F6] flex items-center justify-center group-hover:bg-[#FEACCF] transition-colors",children:P.jsx(PN,{size:20,className:"text-[#024930]"})}),P.jsx("div",{children:P.jsx("p",{className:"font-black text-[#024930] text-sm",children:t==="de"?K.name_de:K.name_en})})]}),P.jsx(Vy,{size:20,className:"text-[#024930]/20 group-hover:text-[#024930]"})]},K.id))})]}),P.jsx("div",{className:"xl:col-span-7",children:P.jsxs("section",{className:"bg-white rounded-3xl p-8 flex flex-col min-h-[600px] shadow-2xl relative overflow-hidden",children:[P.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-[0.03] pointer-events-none",children:P.jsx($p,{size:300})}),P.jsxs("div",{className:"flex justify-between mb-10 relative z-10",children:[P.jsxs("div",{children:[P.jsx("h2",{className:"text-2xl font-black text-[#024930]",children:"Catering Menu"}),P.jsxs("p",{className:"text-[#024930]/50 text-sm font-bold uppercase tracking-wider mt-1",children:[d||"Untitled Event","  ",p]})]}),c.length>0&&P.jsx("button",{onClick:()=>u([]),className:"text-red-400 font-bold uppercase text-[10px] tracking-widest hover:text-red-500",children:"Clear Menu"})]}),P.jsxs("div",{className:"flex-1 space-y-4 relative z-10",children:[c.map(K=>{const se=n.find(F=>F.id===K.bundleId);return se?P.jsxs("div",{className:"flex items-center gap-4 bg-[#F8F7F6] rounded-xl p-4 border border-[#F8F7F6] hover:border-[#FEACCF]/50 transition-colors",children:[P.jsxs("div",{className:"flex-1",children:[P.jsx("p",{className:"font-bold text-[#024930]",children:t==="de"?se.name_de:se.name_en}),P.jsxs("p",{className:"text-[10px] text-[#024930]/50 uppercase font-black tracking-wider",children:[se.items.length," item",se.items.length!==1?"s":""]})]}),P.jsx("input",{type:"number",min:"1",value:K.quantity,onChange:F=>u(G=>G.map(W=>W.bundleId===K.bundleId?{...W,quantity:parseInt(F.target.value)||1}:W)),className:"w-16 bg-white rounded-lg p-2 text-center text-[#024930] font-black border-none shadow-sm focus:ring-2 focus:ring-[#FEACCF]"}),P.jsx("button",{onClick:()=>u(F=>F.filter(G=>G.bundleId!==K.bundleId)),className:"text-[#024930]/20 hover:text-red-400 px-2",children:P.jsx(jy,{size:20})})]},K.bundleId):null}),c.length===0&&P.jsxs("div",{className:"h-full flex flex-col items-center justify-center opacity-10 text-[#024930] mt-20",children:[P.jsx($p,{size:64,className:"mb-4"}),P.jsx("p",{className:"font-bold uppercase tracking-widest",children:"Build your menu"})]})]}),c.length>0&&P.jsxs("div",{className:"mt-8 pt-8 border-t border-slate-800 grid grid-cols-2 gap-4 relative z-10",children:[P.jsxs("button",{onClick:()=>{b("menu"),C(!0)},className:"bg-slate-800 text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 hover:bg-slate-700 transition-all",children:[P.jsx(By,{size:20})," Preview Menu (A4)"]}),P.jsxs("button",{onClick:()=>{b("labels"),C(!0)},className:"bg-[#FEACCF] text-[#024930] font-black py-4 rounded-xl flex items-center justify-center gap-2 hover:bg-[#ff9ec6] transition-all shadow-lg",children:[P.jsx(Wo,{size:20})," Print Labels (A6)"]})]})]})})]}):v==="trash"?P.jsx("div",{className:"max-w-4xl mx-auto space-y-8",children:P.jsxs("section",{className:"bg-white p-10 rounded-3xl shadow-2xl relative overflow-hidden",children:[P.jsxs("h2",{className:"text-3xl font-black mb-8 text-red-400 flex items-center gap-4 relative z-10",children:[P.jsx(y0,{size:32})," Trash"]}),P.jsxs("div",{className:"space-y-2 relative z-10",children:[s.length===0&&P.jsx("p",{className:"text-[#024930]/40 text-center py-10 font-bold uppercase tracking-widest",children:"Trash is empty"}),s.map(K=>P.jsxs("div",{className:"flex justify-between p-4 bg-white rounded-lg border border-[#F8F7F6] items-center opacity-75 hover:opacity-100 transition-all hover:shadow-md",children:[P.jsx("span",{className:"font-bold text-[#024930]/60 line-through",children:K.name_de}),P.jsxs("div",{className:"flex gap-2",children:[P.jsxs("button",{onClick:()=>re(K),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-[#024930]/10 text-[#024930] hover:bg-[#024930]/20 text-xs font-bold uppercase",children:[P.jsx(NN,{size:14})," Restore"]}),P.jsxs("button",{onClick:()=>ye(K),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-red-100 text-red-400 hover:bg-red-200 text-xs font-bold uppercase",children:[P.jsx(y0,{size:14})," Delete Forever"]})]})]},K.id))]})]})}):P.jsx("div",{className:"max-w-4xl mx-auto space-y-8",children:P.jsxs("section",{className:"bg-white p-10 rounded-3xl shadow-2xl relative overflow-hidden",children:[P.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.03] pointer-events-none",children:P.jsx(My,{size:400})}),P.jsx("h2",{className:"text-3xl font-black mb-8 text-[#024930]",children:r.dataManagement}),P.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-10 relative z-10",children:[P.jsxs("div",{onClick:()=>{const K=[{type:"Standard",company_name:"Acme Corp",date:"12.12.2025",bundle_name_de:"Brunch Set",bundle_name_en:"Brunch Set",item_name_de:"Croissant",item_name_en:"Croissant",allergens_de:"Gluten, Eier",diet_de:"Vegetarisch"}],se=j0.json_to_sheet(K),F=j0.book_new();j0.book_append_sheet(F,se,"Labels"),Y$(F,"BellaBona_Template.xlsx")},className:"bg-[#F8F7F6] p-8 rounded-2xl border-2 border-dashed border-[#024930]/10 cursor-pointer hover:border-[#FEACCF] transition-all group hover:bg-white hover:shadow-lg",children:[P.jsx(By,{size:32,className:"text-[#024930] mb-4 group-hover:scale-110 transition-transform"}),P.jsx("p",{className:"font-bold text-[#024930]",children:"Download Template"})]}),P.jsxs("div",{onClick:()=>{var K;return(K=N.current)==null?void 0:K.click()},className:"bg-[#F8F7F6] p-8 rounded-2xl border-2 border-dashed border-[#024930]/10 cursor-pointer hover:border-[#FEACCF] transition-all relative group hover:bg-white hover:shadow-lg",children:[U&&P.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center rounded-2xl z-20",children:P.jsx(AN,{className:"animate-spin text-[#FEACCF]",size:32})}),P.jsx(RN,{size:32,className:"text-[#FEACCF] mb-4 group-hover:scale-110 transition-transform"}),P.jsx("p",{className:"font-bold text-[#024930]",children:"Upload Excel"}),P.jsx("input",{type:"file",ref:N,className:"hidden",accept:".xlsx",onChange:X})]})]}),P.jsx("div",{className:"mb-10 text-center",children:P.jsx("button",{onClick:async()=>{if(confirm("Attempt to migrate data from old Firestore database?")){T(!0);try{const K=await Go.migrateFromFirestore();alert(`Migration successful! Moved ${K} bundles.`),window.location.reload()}catch(K){console.error("Migration error",K),K.message&&K.message.includes("Missing or insufficient permissions")?(alert(`BLOCKED BY FIREBASE RULES! 

You must allow read access to your old database.

1. Go to Firebase Console > Firestore > Rules
2. Set: allow read, write: if true;
3. Publish

I will open the page for you now.`),window.open("https://console.firebase.google.com/u/0/project/label-c61eb/firestore/rules","_blank")):alert("Migration failed: "+K.message)}finally{T(!1)}}},className:"text-sm bg-[#024930]/5 hover:bg-[#024930]/10 text-[#024930] px-4 py-2 rounded-lg font-bold",disabled:E,children:E?r.syncing:r.recoverData})}),P.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto pr-2 relative z-10",children:n.slice().sort((K,se)=>K.name_de.localeCompare(se.name_de)).map(K=>P.jsxs("div",{className:"flex justify-between p-4 bg-white rounded-lg border border-[#F8F7F6] items-center hover:bg-[#F8F7F6] transition-colors shadow-sm",children:[P.jsx("span",{className:"font-bold text-[#024930]",children:t==="de"?K.name_de:K.name_en}),P.jsx("button",{onClick:()=>de(K),className:"text-[#024930]/40 hover:text-red-500 transition-colors",children:P.jsx(y0,{size:18})})]},K.id))})]})})})]})}),k&&P.jsx(jE.Fragment,{children:P.jsx("div",{className:"print:hidden fixed inset-0 z-[200] bg-[#024930]/90 backdrop-blur-xl flex items-center justify-center p-8 overflow-y-auto",children:P.jsxs("div",{className:"bg-[#F8F7F6] w-full max-w-6xl h-[90vh] rounded-3xl flex flex-col shadow-2xl overflow-hidden",children:[P.jsxs("div",{className:"p-8 border-b border-[#024930]/10 flex justify-between items-center bg-white",children:[P.jsxs("div",{className:"flex items-center gap-4",children:[P.jsx("div",{className:"bg-[#024930]/5 p-3 rounded-xl",children:P.jsx(Wo,{className:"text-[#024930] w-6 h-6"})}),P.jsxs("div",{children:[P.jsx("h2",{className:"text-2xl font-serif font-bold text-[#024930]",children:"Print Preview"}),P.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[P.jsx("span",{className:"text-xs font-sans text-slate-500",children:"Checking layout for"}),P.jsx("span",{className:"text-xs bg-[#FEACCF]/20 px-2 py-0.5 rounded text-[#024930] uppercase font-bold tracking-wider",children:A})]})]})]}),P.jsxs("div",{className:"flex gap-4",children:[P.jsx("button",{onClick:()=>C(!1),className:"px-6 py-3 rounded-xl text-slate-500 font-medium hover:bg-slate-50 transition-colors",children:"Close"}),A==="labels"&&P.jsxs("button",{onClick:()=>window.print(),className:"bg-[#FEACCF] hover:bg-[#ffbfe0] text-[#024930] font-bold px-6 py-3 rounded-xl shadow-lg shadow-[#FEACCF]/20 flex items-center gap-2 transition-all transform hover:-translate-y-0.5",children:[P.jsx(Ly,{size:20})," Print Label Sheets"]}),P.jsxs("button",{onClick:()=>window.print(),className:"bg-[#024930] hover:bg-[#035e3e] text-white font-bold px-8 py-3 rounded-xl shadow-lg shadow-[#024930]/30 flex items-center gap-2 transition-all transform hover:-translate-y-0.5",children:[P.jsx(Wo,{size:20})," Print Now"]})]})]}),P.jsx("div",{className:"flex-1 overflow-auto bg-[#F8F7F6] p-8 flex justify-center items-start",children:A==="menu"&&v==="catering"?P.jsxs("div",{className:"flex flex-col gap-12",children:[P.jsx("div",{className:"bg-white shadow-2xl scale-[0.6] origin-top",style:{width:"210mm",height:"297mm"},children:P.jsx(ce,{})}),P.jsx("div",{className:"bg-white shadow-2xl scale-[0.6] origin-top",style:{width:"210mm",height:"297mm"},children:P.jsx(fe,{size:"A4"})})]}):v==="catering"?(()=>{const K=c.flatMap(F=>{const G=n.find(W=>W.id===F.bundleId);return G?Array(F.quantity).fill(G).flatMap(()=>G.items):[]});K.push({isReviewCard:!0});const se=[];for(let F=0;F<K.length;F+=4)se.push(K.slice(F,F+4));return P.jsx("div",{className:"flex flex-col gap-12 pb-12",children:se.map((F,G)=>P.jsx("div",{className:"bg-white shadow-2xl origin-top scale-[0.6]",style:{width:"210mm",height:"297mm",display:"grid",gridTemplateColumns:"105mm 105mm",gridTemplateRows:"148.5mm 148.5mm"},children:F.map((W,z)=>P.jsx("div",{style:{width:"105mm",height:"148.5mm"},children:"isReviewCard"in W?P.jsx(fe,{size:"A6"}):P.jsx(W0,{item:W,lang:t,forPrint:!0})},z))},G))})})():A==="explode-a6"?(()=>{const K=o.flatMap(F=>{const G=n.find(W=>W.id===F.bundleId);return G?Array(F.quantity).fill(G).flatMap(()=>G.items):[]}),se=[];for(let F=0;F<K.length;F+=4)se.push(K.slice(F,F+4));return P.jsx("div",{className:"flex flex-col gap-12 pb-12",children:se.map((F,G)=>P.jsx("div",{className:"bg-white shadow-2xl origin-top scale-[0.6]",style:{width:"210mm",height:"297mm",display:"grid",gridTemplateColumns:"105mm 105mm",gridTemplateRows:"148.5mm 148.5mm"},children:F.map((W,z)=>P.jsx("div",{style:{width:"105mm",height:"148.5mm"},children:P.jsx(W0,{item:W,lang:t,forPrint:!0})},z))},G))})})():P.jsx("div",{className:"flex flex-col gap-12",children:Ce.map((K,se)=>P.jsx("div",{className:"bg-white shadow-2xl mb-12 scale-[0.6] origin-top",style:{width:"210mm",height:"297mm"},children:P.jsx("div",{className:"label-page-group",children:K.map((F,G)=>P.jsx("div",{className:"label-card-container",children:P.jsx(NE,{bundle:F,lang:t,packedOn:m,forPrint:!0,variant:"standard"})},G))})},se))})})]})},`${t}-${A}-${v}`)})]})};Im.createRoot(document.getElementById("root")).render(P.jsx(jE.StrictMode,{children:P.jsx(fG,{})}));
